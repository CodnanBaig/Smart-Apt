(self.webpackChunkSmartAssessment=self.webpackChunkSmartAssessment||[]).push([[179],{1456:(Ie,_e,Y)=>{"use strict";var h=Y(5e3);let Te=null;function Ve(){return Te}const ye=new h.OlP("DocumentToken");let xe=(()=>{class i{historyGo(e){throw new Error("Not implemented")}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=h.Yz7({token:i,factory:function(){return function ne(){return(0,h.LFG)(ke)}()},providedIn:"platform"}),i})();const Le=new h.OlP("Location Initialized");let ke=(()=>{class i extends xe{constructor(e){super(),this._doc=e,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Ve().getBaseHref(this._doc)}onPopState(e){const n=Ve().getGlobalEventTarget(this._doc,"window");return n.addEventListener("popstate",e,!1),()=>n.removeEventListener("popstate",e)}onHashChange(e){const n=Ve().getGlobalEventTarget(this._doc,"window");return n.addEventListener("hashchange",e,!1),()=>n.removeEventListener("hashchange",e)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(e){this.location.pathname=e}pushState(e,n,l){Be()?this._history.pushState(e,n,l):this.location.hash=l}replaceState(e,n,l){Be()?this._history.replaceState(e,n,l):this.location.hash=l}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(ye))},i.\u0275prov=h.Yz7({token:i,factory:function(){return function yt(){return new ke((0,h.LFG)(ye))}()},providedIn:"platform"}),i})();function Be(){return!!window.history.pushState}function gt(i,t){if(0==i.length)return t;if(0==t.length)return i;let e=0;return i.endsWith("/")&&e++,t.startsWith("/")&&e++,2==e?i+t.substring(1):1==e?i+t:i+"/"+t}function vt(i){const t=i.match(/#|\?|$/),e=t&&t.index||i.length;return i.slice(0,e-("/"===i[e-1]?1:0))+i.slice(e)}function Tt(i){return i&&"?"!==i[0]?"?"+i:i}let nt=(()=>{class i{historyGo(e){throw new Error("Not implemented")}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=h.Yz7({token:i,factory:function(){return function Dt(i){const t=(0,h.LFG)(ye).location;return new $t((0,h.LFG)(xe),t&&t.origin||"")}()},providedIn:"root"}),i})();const Ht=new h.OlP("appBaseHref");let $t=(()=>{class i extends nt{constructor(e,n){if(super(),this._platformLocation=e,this._removeListenerFns=[],null==n&&(n=this._platformLocation.getBaseHrefFromDOM()),null==n)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=n}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return gt(this._baseHref,e)}path(e=!1){const n=this._platformLocation.pathname+Tt(this._platformLocation.search),l=this._platformLocation.hash;return l&&e?`${n}${l}`:n}pushState(e,n,l,f){const D=this.prepareExternalUrl(l+Tt(f));this._platformLocation.pushState(e,n,D)}replaceState(e,n,l,f){const D=this.prepareExternalUrl(l+Tt(f));this._platformLocation.replaceState(e,n,D)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(e=0){var n,l;null===(l=(n=this._platformLocation).historyGo)||void 0===l||l.call(n,e)}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(xe),h.LFG(Ht,8))},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac}),i})(),xt=(()=>{class i extends nt{constructor(e,n){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=n&&(this._baseHref=n)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let n=this._platformLocation.hash;return null==n&&(n="#"),n.length>0?n.substring(1):n}prepareExternalUrl(e){const n=gt(this._baseHref,e);return n.length>0?"#"+n:n}pushState(e,n,l,f){let D=this.prepareExternalUrl(l+Tt(f));0==D.length&&(D=this._platformLocation.pathname),this._platformLocation.pushState(e,n,D)}replaceState(e,n,l,f){let D=this.prepareExternalUrl(l+Tt(f));0==D.length&&(D=this._platformLocation.pathname),this._platformLocation.replaceState(e,n,D)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(e=0){var n,l;null===(l=(n=this._platformLocation).historyGo)||void 0===l||l.call(n,e)}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(xe),h.LFG(Ht,8))},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac}),i})(),ut=(()=>{class i{constructor(e,n){this._subject=new h.vpe,this._urlChangeListeners=[],this._platformStrategy=e;const l=this._platformStrategy.getBaseHref();this._platformLocation=n,this._baseHref=vt(ni(l)),this._platformStrategy.onPopState(f=>{this._subject.emit({url:this.path(!0),pop:!0,state:f.state,type:f.type})})}path(e=!1){return this.normalize(this._platformStrategy.path(e))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(e,n=""){return this.path()==this.normalize(e+Tt(n))}normalize(e){return i.stripTrailingSlash(function qt(i,t){return i&&t.startsWith(i)?t.substring(i.length):t}(this._baseHref,ni(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)}go(e,n="",l=null){this._platformStrategy.pushState(l,"",e,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Tt(n)),l)}replaceState(e,n="",l=null){this._platformStrategy.replaceState(l,"",e,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Tt(n)),l)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(e=0){var n,l;null===(l=(n=this._platformStrategy).historyGo)||void 0===l||l.call(n,e)}onUrlChange(e){this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(n=>{this._notifyUrlChangeListeners(n.url,n.state)}))}_notifyUrlChangeListeners(e="",n){this._urlChangeListeners.forEach(l=>l(e,n))}subscribe(e,n,l){return this._subject.subscribe({next:e,error:n,complete:l})}}return i.normalizeQueryParams=Tt,i.joinWithSlash=gt,i.stripTrailingSlash=vt,i.\u0275fac=function(e){return new(e||i)(h.LFG(nt),h.LFG(xe))},i.\u0275prov=h.Yz7({token:i,factory:function(){return function kt(){return new ut((0,h.LFG)(nt),(0,h.LFG)(xe))}()},providedIn:"root"}),i})();function ni(i){return i.replace(/\/index.html$/,"")}let Lr=(()=>{class i{constructor(e,n,l,f){this._iterableDiffers=e,this._keyValueDiffers=n,this._ngEl=l,this._renderer=f,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&((0,h.sIi)(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){const e=this._keyValueDiffer.diff(this._rawClass);e&&this._applyKeyValueChanges(e)}}_applyKeyValueChanges(e){e.forEachAddedItem(n=>this._toggleClass(n.key,n.currentValue)),e.forEachChangedItem(n=>this._toggleClass(n.key,n.currentValue)),e.forEachRemovedItem(n=>{n.previousValue&&this._toggleClass(n.key,!1)})}_applyIterableChanges(e){e.forEachAddedItem(n=>{if("string"!=typeof n.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${(0,h.AaK)(n.item)}`);this._toggleClass(n.item,!0)}),e.forEachRemovedItem(n=>this._toggleClass(n.item,!1))}_applyClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(n=>this._toggleClass(n,!0)):Object.keys(e).forEach(n=>this._toggleClass(n,!!e[n])))}_removeClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(n=>this._toggleClass(n,!1)):Object.keys(e).forEach(n=>this._toggleClass(n,!1)))}_toggleClass(e,n){(e=e.trim())&&e.split(/\s+/g).forEach(l=>{n?this._renderer.addClass(this._ngEl.nativeElement,l):this._renderer.removeClass(this._ngEl.nativeElement,l)})}}return i.\u0275fac=function(e){return new(e||i)(h.Y36(h.ZZ4),h.Y36(h.aQg),h.Y36(h.SBq),h.Y36(h.Qsj))},i.\u0275dir=h.lG2({type:i,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),i})();class tt{constructor(t,e,n,l){this.$implicit=t,this.ngForOf=e,this.index=n,this.count=l}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Ae=(()=>{class i{constructor(e,n,l){this._viewContainer=e,this._template=n,this._differs=l,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const n=this._viewContainer;e.forEachOperation((l,f,D)=>{if(null==l.previousIndex)n.createEmbeddedView(this._template,new tt(l.item,this._ngForOf,-1,-1),null===D?void 0:D);else if(null==D)n.remove(null===f?void 0:f);else if(null!==f){const I=n.get(f);n.move(I,D),Fe(I,l)}});for(let l=0,f=n.length;l<f;l++){const I=n.get(l).context;I.index=l,I.count=f,I.ngForOf=this._ngForOf}e.forEachIdentityChange(l=>{Fe(n.get(l.currentIndex),l)})}static ngTemplateContextGuard(e,n){return!0}}return i.\u0275fac=function(e){return new(e||i)(h.Y36(h.s_b),h.Y36(h.Rgc),h.Y36(h.ZZ4))},i.\u0275dir=h.lG2({type:i,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),i})();function Fe(i,t){i.context.$implicit=t.item}let At=(()=>{class i{constructor(e,n){this._viewContainer=e,this._context=new ui,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){Kn("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){Kn("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,n){return!0}}return i.\u0275fac=function(e){return new(e||i)(h.Y36(h.s_b),h.Y36(h.Rgc))},i.\u0275dir=h.lG2({type:i,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),i})();class ui{constructor(){this.$implicit=null,this.ngIf=null}}function Kn(i,t){if(t&&!t.createEmbeddedView)throw new Error(`${i} must be a TemplateRef, but received '${(0,h.AaK)(t)}'.`)}class pn{constructor(t,e){this._viewContainerRef=t,this._templateRef=e,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(t){t&&!this._created?this.create():!t&&this._created&&this.destroy()}}let mn=(()=>{class i{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(e){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(e)}_matchCase(e){const n=e==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||n,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),n}_updateDefaultCases(e){if(this._defaultViews&&e!==this._defaultUsed){this._defaultUsed=e;for(let n=0;n<this._defaultViews.length;n++)this._defaultViews[n].enforceState(e)}}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=h.lG2({type:i,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"}}),i})(),Bi=(()=>{class i{constructor(e,n,l){this.ngSwitch=l,l._addCase(),this._view=new pn(e,n)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return i.\u0275fac=function(e){return new(e||i)(h.Y36(h.s_b),h.Y36(h.Rgc),h.Y36(mn,9))},i.\u0275dir=h.lG2({type:i,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"}}),i})();class Id{createSubscription(t,e){return t.subscribe({next:e,error:n=>{throw n}})}dispose(t){t.unsubscribe()}onDestroy(t){t.unsubscribe()}}class bl{createSubscription(t,e){return t.then(e,n=>{throw n})}dispose(t){}onDestroy(t){}}const cc=new bl,lr=new Id;let uc=(()=>{class i{constructor(e){this._ref=e,this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null}ngOnDestroy(){this._subscription&&this._dispose()}transform(e){return this._obj?e!==this._obj?(this._dispose(),this.transform(e)):this._latestValue:(e&&this._subscribe(e),this._latestValue)}_subscribe(e){this._obj=e,this._strategy=this._selectStrategy(e),this._subscription=this._strategy.createSubscription(e,n=>this._updateLatestValue(e,n))}_selectStrategy(e){if((0,h.QGY)(e))return cc;if((0,h.F4k)(e))return lr;throw function lo(i,t){return new h.vHH(2100,"")}()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(e,n){e===this._obj&&(this._latestValue=n,this._ref.markForCheck())}}return i.\u0275fac=function(e){return new(e||i)(h.Y36(h.sBO,16))},i.\u0275pipe=h.Yjl({name:"async",type:i,pure:!1}),i})(),Pn=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({}),i})();const Cl="browser";let Hh=(()=>{class i{}return i.\u0275prov=(0,h.Yz7)({token:i,providedIn:"root",factory:()=>new hu((0,h.LFG)(ye),window)}),i})();class hu{constructor(t,e){this.document=t,this.window=e,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const e=function pu(i,t){const e=i.getElementById(t)||i.getElementsByName(t)[0];if(e)return e;if("function"==typeof i.createTreeWalker&&i.body&&(i.body.createShadowRoot||i.body.attachShadow)){const n=i.createTreeWalker(i.body,NodeFilter.SHOW_ELEMENT);let l=n.currentNode;for(;l;){const f=l.shadowRoot;if(f){const D=f.getElementById(t)||f.querySelector(`[name="${t}"]`);if(D)return D}l=n.nextNode()}}return null}(this.document,t);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),n=e.left+this.window.pageXOffset,l=e.top+this.window.pageYOffset,f=this.offset();this.window.scrollTo(n-f[0],l-f[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=Nd(this.window.history)||Nd(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch(t){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(t){return!1}}}function Nd(i){return Object.getOwnPropertyDescriptor(i,"scrollRestoration")}class El extends class hc extends class Pe{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function Me(i){Te||(Te=i)}(new El)}onAndCancel(t,e,n){return t.addEventListener(e,n,!1),()=>{t.removeEventListener(e,n,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=function Vd(){return dn=dn||document.querySelector("base"),dn?dn.getAttribute("href"):null}();return null==e?null:function La(i){pc=pc||document.createElement("a"),pc.setAttribute("href",i);const t=pc.pathname;return"/"===t.charAt(0)?t:`/${t}`}(e)}resetBaseElement(){dn=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return function $n(i,t){t=encodeURIComponent(t);for(const e of i.split(";")){const n=e.indexOf("="),[l,f]=-1==n?[e,""]:[e.slice(0,n),e.slice(n+1)];if(l.trim()===t)return decodeURIComponent(f)}return null}(document.cookie,t)}}let pc,dn=null;const cr=new h.OlP("TRANSITION_ID"),zs=[{provide:h.ip1,useFactory:function zd(i,t,e){return()=>{e.get(h.CZH).donePromise.then(()=>{const n=Ve(),l=t.querySelectorAll(`style[ng-transition="${i}"]`);for(let f=0;f<l.length;f++)n.remove(l[f])})}},deps:[cr,ye,h.zs3],multi:!0}];class uo{static init(){(0,h.VLi)(new uo)}addToWindow(t){h.dqk.getAngularTestability=(n,l=!0)=>{const f=t.findTestabilityInTree(n,l);if(null==f)throw new Error("Could not find testability for element.");return f},h.dqk.getAllAngularTestabilities=()=>t.getAllTestabilities(),h.dqk.getAllAngularRootElements=()=>t.getAllRootElements(),h.dqk.frameworkStabilizers||(h.dqk.frameworkStabilizers=[]),h.dqk.frameworkStabilizers.push(n=>{const l=h.dqk.getAllAngularTestabilities();let f=l.length,D=!1;const I=function(B){D=D||B,f--,0==f&&n(D)};l.forEach(function(B){B.whenStable(I)})})}findTestabilityInTree(t,e,n){if(null==e)return null;const l=t.getTestability(e);return null!=l?l:n?Ve().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null}}let ho=(()=>{class i{build(){return new XMLHttpRequest}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac}),i})();const aa=new h.OlP("EventManagerPlugins");let Ji=(()=>{class i{constructor(e,n){this._zone=n,this._eventNameToPlugin=new Map,e.forEach(l=>l.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,n,l){return this._findPluginFor(n).addEventListener(e,n,l)}addGlobalEventListener(e,n,l){return this._findPluginFor(n).addGlobalEventListener(e,n,l)}getZone(){return this._zone}_findPluginFor(e){const n=this._eventNameToPlugin.get(e);if(n)return n;const l=this._plugins;for(let f=0;f<l.length;f++){const D=l[f];if(D.supports(e))return this._eventNameToPlugin.set(e,D),D}throw new Error(`No event manager plugin found for event ${e}`)}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(aa),h.LFG(h.R0b))},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac}),i})();class Ln{constructor(t){this._doc=t}addGlobalEventListener(t,e,n){const l=Ve().getGlobalEventTarget(this._doc,t);if(!l)throw new Error(`Unsupported event target ${l} for event ${e}`);return this.addEventListener(l,e,n)}}let Es=(()=>{class i{constructor(){this._stylesSet=new Set}addStyles(e){const n=new Set;e.forEach(l=>{this._stylesSet.has(l)||(this._stylesSet.add(l),n.add(l))}),this.onStylesAdded(n)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac}),i})(),$i=(()=>{class i extends Es{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,n,l){e.forEach(f=>{const D=this._doc.createElement("style");D.textContent=f,l.push(n.appendChild(D))})}addHost(e){const n=[];this._addStylesToHost(this._stylesSet,e,n),this._hostNodes.set(e,n)}removeHost(e){const n=this._hostNodes.get(e);n&&n.forEach(as),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((n,l)=>{this._addStylesToHost(e,l,n)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(as))}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(ye))},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac}),i})();function as(i){Ve().remove(i)}const Qt={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Bn=/%COMP%/g;function dt(i,t,e){for(let n=0;n<t.length;n++){let l=t[n];Array.isArray(l)?dt(i,l,e):(l=l.replace(Bn,i),e.push(l))}return e}function qi(i){return t=>{if("__ngUnwrap__"===t)return i;!1===i(t)&&(t.preventDefault(),t.returnValue=!1)}}let gn=(()=>{class i{constructor(e,n,l){this.eventManager=e,this.sharedStylesHost=n,this.appId=l,this.rendererByCompId=new Map,this.defaultRenderer=new po(e)}createRenderer(e,n){if(!e||!n)return this.defaultRenderer;switch(n.encapsulation){case h.ifc.Emulated:{let l=this.rendererByCompId.get(n.id);return l||(l=new mc(this.eventManager,this.sharedStylesHost,n,this.appId),this.rendererByCompId.set(n.id,l)),l.applyToHost(e),l}case 1:case h.ifc.ShadowDom:return new js(this.eventManager,this.sharedStylesHost,e,n);default:if(!this.rendererByCompId.has(n.id)){const l=dt(n.id,n.styles,[]);this.sharedStylesHost.addStyles(l),this.rendererByCompId.set(n.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(Ji),h.LFG($i),h.LFG(h.AFp))},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac}),i})();class po{constructor(t){this.eventManager=t,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,e){return e?document.createElementNS(Qt[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){t.appendChild(e)}insertBefore(t,e,n){t&&t.insertBefore(e,n)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let n="string"==typeof t?document.querySelector(t):t;if(!n)throw new Error(`The selector "${t}" did not match any elements`);return e||(n.textContent=""),n}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,n,l){if(l){e=l+":"+e;const f=Qt[l];f?t.setAttributeNS(f,e,n):t.setAttribute(e,n)}else t.setAttribute(e,n)}removeAttribute(t,e,n){if(n){const l=Qt[n];l?t.removeAttributeNS(l,e):t.removeAttribute(`${n}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,n,l){l&(h.JOm.DashCase|h.JOm.Important)?t.style.setProperty(e,n,l&h.JOm.Important?"important":""):t.style[e]=n}removeStyle(t,e,n){n&h.JOm.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,n){t[e]=n}setValue(t,e){t.nodeValue=e}listen(t,e,n){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,qi(n)):this.eventManager.addEventListener(t,e,qi(n))}}class mc extends po{constructor(t,e,n,l){super(t),this.component=n;const f=dt(l+"-"+n.id,n.styles,[]);e.addStyles(f),this.contentAttr=function fc(i){return"_ngcontent-%COMP%".replace(Bn,i)}(l+"-"+n.id),this.hostAttr=function gu(i){return"_nghost-%COMP%".replace(Bn,i)}(l+"-"+n.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const n=super.createElement(t,e);return super.setAttribute(n,this.contentAttr,""),n}}class js extends po{constructor(t,e,n,l){super(t),this.sharedStylesHost=e,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const f=dt(l.id,l.styles,[]);for(let D=0;D<f.length;D++){const I=document.createElement("style");I.textContent=f[D],this.shadowRoot.appendChild(I)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,n){return super.insertBefore(this.nodeOrShadowRoot(t),e,n)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let _u=(()=>{class i extends Ln{constructor(e){super(e)}supports(e){return!0}addEventListener(e,n,l){return e.addEventListener(n,l,!1),()=>this.removeEventListener(e,n,l)}removeEventListener(e,n,l){return e.removeEventListener(n,l)}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(ye))},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac}),i})();const gc=["alt","control","meta","shift"],la={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Er={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},So={alt:i=>i.altKey,control:i=>i.ctrlKey,meta:i=>i.metaKey,shift:i=>i.shiftKey};let Al=(()=>{class i extends Ln{constructor(e){super(e)}supports(e){return null!=i.parseEventName(e)}addEventListener(e,n,l){const f=i.parseEventName(n),D=i.eventCallback(f.fullKey,l,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Ve().onAndCancel(e,f.domEventName,D))}static parseEventName(e){const n=e.toLowerCase().split("."),l=n.shift();if(0===n.length||"keydown"!==l&&"keyup"!==l)return null;const f=i._normalizeKey(n.pop());let D="";if(gc.forEach(B=>{const Z=n.indexOf(B);Z>-1&&(n.splice(Z,1),D+=B+".")}),D+=f,0!=n.length||0===f.length)return null;const I={};return I.domEventName=l,I.fullKey=D,I}static getEventFullKey(e){let n="",l=function Ss(i){let t=i.key;if(null==t){if(t=i.keyIdentifier,null==t)return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===i.location&&Er.hasOwnProperty(t)&&(t=Er[t]))}return la[t]||t}(e);return l=l.toLowerCase()," "===l?l="space":"."===l&&(l="dot"),gc.forEach(f=>{f!=l&&So[f](e)&&(n+=f+".")}),n+=l,n}static eventCallback(e,n,l){return f=>{i.getEventFullKey(f)===e&&l.runGuarded(()=>n(f))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(ye))},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac}),i})();const vc=(0,h.eFA)(h._c5,"browser",[{provide:h.Lbi,useValue:Cl},{provide:h.g9A,useValue:function ls(){El.makeCurrent(),uo.init()},multi:!0},{provide:ye,useFactory:function ca(){return(0,h.RDi)(document),document},deps:[]}]),bc=[{provide:h.zSh,useValue:"root"},{provide:h.qLn,useFactory:function yc(){return new h.qLn},deps:[]},{provide:aa,useClass:_u,multi:!0,deps:[ye,h.R0b,h.Lbi]},{provide:aa,useClass:Al,multi:!0,deps:[ye]},{provide:gn,useClass:gn,deps:[Ji,$i,h.AFp]},{provide:h.FYo,useExisting:gn},{provide:Es,useExisting:$i},{provide:$i,useClass:$i,deps:[ye]},{provide:h.dDg,useClass:h.dDg,deps:[h.R0b]},{provide:Ji,useClass:Ji,deps:[aa,h.R0b]},{provide:class qn{},useClass:ho,deps:[]}];let Us=(()=>{class i{constructor(e){if(e)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(e){return{ngModule:i,providers:[{provide:h.AFp,useValue:e.appId},{provide:cr,useExisting:h.AFp},zs]}}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(i,12))},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({providers:bc,imports:[Pn,h.hGG]}),i})();"undefined"!=typeof window&&window;class Cu{}const En="*";function an(i,t){return{type:7,name:i,definitions:t,options:{}}}function zi(i,t=null){return{type:4,styles:t,timings:i}}function As(i,t=null){return{type:3,steps:i,options:t}}function Ol(i,t=null){return{type:2,steps:i,options:t}}function zt(i){return{type:6,styles:i,offset:null}}function Ei(i,t,e){return{type:0,name:i,styles:t,options:e}}function Jt(i,t,e=null){return{type:1,expr:i,animation:t,options:e}}function Wo(i=null){return{type:9,options:i}}function qs(i,t,e=null){return{type:11,selector:i,animation:t,options:e}}function $d(i){Promise.resolve(null).then(i)}class fo{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){$d(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(n=>n()),e.length=0}}class Is{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,n=0,l=0;const f=this.players.length;0==f?$d(()=>this._onFinish()):this.players.forEach(D=>{D.onDone(()=>{++e==f&&this._onFinish()}),D.onDestroy(()=>{++n==f&&this._onDestroy()}),D.onStart(()=>{++l==f&&this._onStart()})}),this.totalTime=this.players.reduce((D,I)=>Math.max(D,I.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(n=>{const l=n.totalTime?Math.min(1,e/n.totalTime):1;n.setPosition(l)})}getPosition(){const t=this.players.reduce((e,n)=>null===e||n.totalTime>e.totalTime?n:e,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(n=>n()),e.length=0}}const Mt=!1;function Ys(i){return new h.vHH(3e3,Mt)}function ht(){return"undefined"!=typeof window&&void 0!==window.document}function mt(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function ot(i){switch(i.length){case 0:return new fo;case 1:return i[0];default:return new Is(i)}}function Zt(i,t,e,n,l={},f={}){const D=[],I=[];let B=-1,Z=null;if(n.forEach(se=>{const ge=se.offset,qe=ge==B,it=qe&&Z||{};Object.keys(se).forEach(bt=>{let ti=bt,yi=se[bt];if("offset"!==bt)switch(ti=t.normalizePropertyName(ti,D),yi){case"!":yi=l[bt];break;case En:yi=f[bt];break;default:yi=t.normalizeStyleValue(bt,ti,yi,D)}it[ti]=yi}),qe||I.push(it),Z=it,B=ge}),D.length)throw function X(i){return new h.vHH(3502,Mt)}();return I}function St(i,t,e,n){switch(t){case"start":i.onStart(()=>n(e&&oi(e,"start",i)));break;case"done":i.onDone(()=>n(e&&oi(e,"done",i)));break;case"destroy":i.onDestroy(()=>n(e&&oi(e,"destroy",i)))}}function oi(i,t,e){const n=e.totalTime,f=Zi(i.element,i.triggerName,i.fromState,i.toState,t||i.phaseName,null==n?i.totalTime:n,!!e.disabled),D=i._data;return null!=D&&(f._data=D),f}function Zi(i,t,e,n,l="",f=0,D){return{element:i,triggerName:t,fromState:e,toState:n,phaseName:l,totalTime:f,disabled:!!D}}function mi(i,t,e){let n;return i instanceof Map?(n=i.get(t),n||i.set(t,n=e)):(n=i[t],n||(n=i[t]=e)),n}function Ii(i){const t=i.indexOf(":");return[i.substring(1,t),i.substr(t+1)]}let wn=(i,t)=>!1,Si=(i,t,e)=>[],Ni=null;function Sn(i){const t=i.parentNode||i.host;return t===Ni?null:t}(mt()||"undefined"!=typeof Element)&&(ht()?(Ni=(()=>document.documentElement)(),wn=(i,t)=>{for(;t;){if(t===i)return!0;t=Sn(t)}return!1}):wn=(i,t)=>i.contains(t),Si=(i,t,e)=>{if(e)return Array.from(i.querySelectorAll(t));const n=i.querySelector(t);return n?[n]:[]});let ln=null,_o=!1;function dr(i){ln||(ln=function us(){return"undefined"!=typeof document?document.body:null}()||{},_o=!!ln.style&&"WebkitAppearance"in ln.style);let t=!0;return ln.style&&!function go(i){return"ebkit"==i.substring(1,6)}(i)&&(t=i in ln.style,!t&&_o&&(t="Webkit"+i.charAt(0).toUpperCase()+i.substr(1)in ln.style)),t}const ds=wn,Ws=Si;let ir=(()=>{class i{validateStyleProperty(e){return dr(e)}matchesElement(e,n){return!1}containsElement(e,n){return ds(e,n)}getParentElement(e){return Sn(e)}query(e,n,l){return Ws(e,n,l)}computeStyle(e,n,l){return l||""}animate(e,n,l,f,D,I=[],B){return new fo(l,f)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac}),i})(),Ki=(()=>{class i{}return i.NOOP=new ir,i})();const Vo="ng-enter",ks="ng-leave",To="ng-trigger",Rs=".ng-trigger",Ya="ng-animating",Nl=".ng-animating";function yo(i){if("number"==typeof i)return i;const t=i.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:Ps(parseFloat(t[1]),t[2])}function Ps(i,t){return"s"===t?1e3*i:i}function Zo(i,t,e){return i.hasOwnProperty("duration")?i:function Sc(i,t,e){let l,f=0,D="";if("string"==typeof i){const I=i.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===I)return t.push(Ys()),{duration:0,delay:0,easing:""};l=Ps(parseFloat(I[1]),I[2]);const B=I[3];null!=B&&(f=Ps(parseFloat(B),I[4]));const Z=I[5];Z&&(D=Z)}else l=i;if(!e){let I=!1,B=t.length;l<0&&(t.push(function Ll(){return new h.vHH(3100,Mt)}()),I=!0),f<0&&(t.push(function qr(){return new h.vHH(3101,Mt)}()),I=!0),I&&t.splice(B,0,Ys())}return{duration:l,delay:f,easing:D}}(i,t,e)}function Os(i,t={}){return Object.keys(i).forEach(e=>{t[e]=i[e]}),t}function Zs(i,t,e={}){if(t)for(let n in i)e[n]=i[n];else Os(i,e);return e}function Xn(i,t,e){return e?t+":"+e+";":""}function Wa(i){let t="";for(let e=0;e<i.style.length;e++){const n=i.style.item(e);t+=Xn(0,n,i.style.getPropertyValue(n))}for(const e in i.style)i.style.hasOwnProperty(e)&&!e.startsWith("_")&&(t+=Xn(0,Vl(e),i.style[e]));i.setAttribute("style",t)}function Sr(i,t,e){i.style&&(Object.keys(t).forEach(n=>{const l=Ka(n);e&&!e.hasOwnProperty(n)&&(e[n]=i.style[l]),i.style[l]=t[n]}),mt()&&Wa(i))}function Tr(i,t){i.style&&(Object.keys(t).forEach(e=>{const n=Ka(e);i.style[n]=""}),mt()&&Wa(i))}function vo(i){return Array.isArray(i)?1==i.length?i[0]:Ol(i):i}const ha=new RegExp("{{\\s*(.+?)\\s*}}","g");function mf(i){let t=[];if("string"==typeof i){let e;for(;e=ha.exec(i);)t.push(e[1]);ha.lastIndex=0}return t}function Za(i,t,e){const n=i.toString(),l=n.replace(ha,(f,D)=>{let I=t[D];return t.hasOwnProperty(D)||(e.push(function mo(i){return new h.vHH(3003,Mt)}()),I=""),I.toString()});return l==n?i:l}function Cn(i){const t=[];let e=i.next();for(;!e.done;)t.push(e.value),e=i.next();return t}const qd=/-+([a-z0-9])/g;function Ka(i){return i.replace(qd,(...t)=>t[1].toUpperCase())}function Vl(i){return i.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function Nr(i,t,e){switch(t.type){case 7:return i.visitTrigger(t,e);case 0:return i.visitState(t,e);case 1:return i.visitTransition(t,e);case 2:return i.visitSequence(t,e);case 3:return i.visitGroup(t,e);case 4:return i.visitAnimate(t,e);case 5:return i.visitKeyframes(t,e);case 6:return i.visitStyle(t,e);case 8:return i.visitReference(t,e);case 9:return i.visitAnimateChild(t,e);case 10:return i.visitAnimateRef(t,e);case 11:return i.visitQuery(t,e);case 12:return i.visitStagger(t,e);default:throw function Ga(i){return new h.vHH(3004,Mt)}()}}function Yd(i,t){return window.getComputedStyle(i)[t]}function Eu(i,t){const e=[];return"string"==typeof i?i.split(/\s*,\s*/).forEach(n=>function Jm(i,t,e){if(":"==i[0]){const B=function Su(i,t){switch(i){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,n)=>parseFloat(n)>parseFloat(e);case":decrement":return(e,n)=>parseFloat(n)<parseFloat(e);default:return t.push(function F(i){return new h.vHH(3016,Mt)}()),"* => *"}}(i,e);if("function"==typeof B)return void t.push(B);i=B}const n=i.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==n||n.length<4)return e.push(function R(i){return new h.vHH(3015,Mt)}()),t;const l=n[1],f=n[2],D=n[3];t.push(Zd(l,D));"<"==f[0]&&!("*"==l&&"*"==D)&&t.push(Zd(D,l))}(n,e,t)):e.push(i),e}const jl=new Set(["true","1"]),Ks=new Set(["false","0"]);function Zd(i,t){const e=jl.has(i)||Ks.has(i),n=jl.has(t)||Ks.has(t);return(l,f)=>{let D="*"==i||i==l,I="*"==t||t==f;return!D&&e&&"boolean"==typeof l&&(D=l?jl.has(i):Ks.has(i)),!I&&n&&"boolean"==typeof f&&(I=f?jl.has(t):Ks.has(t)),D&&I}}const Hl=new RegExp("s*:selfs*,?","g");function Tu(i,t,e,n){return new Kd(i).build(t,e,n)}class Kd{constructor(t){this._driver=t}build(t,e,n){const l=new ku(e);this._resetContextStyleTimingState(l);const f=Nr(this,vo(t),l);return l.unsupportedCSSPropertiesFound.size&&l.unsupportedCSSPropertiesFound.keys(),f}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles={},t.collectedStyles[""]={},t.currentTime=0}visitTrigger(t,e){let n=e.queryCount=0,l=e.depCount=0;const f=[],D=[];return"@"==t.name.charAt(0)&&e.errors.push(function Vn(){return new h.vHH(3006,Mt)}()),t.definitions.forEach(I=>{if(this._resetContextStyleTimingState(e),0==I.type){const B=I,Z=B.name;Z.toString().split(/\s*,\s*/).forEach(se=>{B.name=se,f.push(this.visitState(B,e))}),B.name=Z}else if(1==I.type){const B=this.visitTransition(I,e);n+=B.queryCount,l+=B.depCount,D.push(B)}else e.errors.push(function xn(){return new h.vHH(3007,Mt)}())}),{type:7,name:t.name,states:f,transitions:D,queryCount:n,depCount:l,options:null}}visitState(t,e){const n=this.visitStyle(t.styles,e),l=t.options&&t.options.params||null;if(n.containsDynamicStyles){const f=new Set,D=l||{};n.styles.forEach(I=>{if(Fs(I)){const B=I;Object.keys(B).forEach(Z=>{mf(B[Z]).forEach(se=>{D.hasOwnProperty(se)||f.add(se)})})}}),f.size&&(Cn(f.values()),e.errors.push(function $a(i,t){return new h.vHH(3008,Mt)}()))}return{type:0,name:t.name,style:n,options:l?{params:l}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const n=Nr(this,vo(t.animation),e);return{type:1,matchers:Eu(t.expr,e.errors),animation:n,queryCount:e.queryCount,depCount:e.depCount,options:pa(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(n=>Nr(this,n,e)),options:pa(t.options)}}visitGroup(t,e){const n=e.currentTime;let l=0;const f=t.steps.map(D=>{e.currentTime=n;const I=Nr(this,D,e);return l=Math.max(l,e.currentTime),I});return e.currentTime=l,{type:3,steps:f,options:pa(t.options)}}visitAnimate(t,e){const n=function eg(i,t){let e=null;if(i.hasOwnProperty("duration"))e=i;else if("number"==typeof i)return Xd(Zo(i,t).duration,0,"");const n=i;if(n.split(/\s+/).some(f=>"{"==f.charAt(0)&&"{"==f.charAt(1))){const f=Xd(0,0,"");return f.dynamic=!0,f.strValue=n,f}return e=e||Zo(n,t),Xd(e.duration,e.delay,e.easing)}(t.timings,e.errors);e.currentAnimateTimings=n;let l,f=t.styles?t.styles:zt({});if(5==f.type)l=this.visitKeyframes(f,e);else{let D=t.styles,I=!1;if(!D){I=!0;const Z={};n.easing&&(Z.easing=n.easing),D=zt(Z)}e.currentTime+=n.duration+n.delay;const B=this.visitStyle(D,e);B.isEmptyStep=I,l=B}return e.currentAnimateTimings=null,{type:4,timings:n,style:l,options:null}}visitStyle(t,e){const n=this._makeStyleAst(t,e);return this._validateStyleAst(n,e),n}_makeStyleAst(t,e){const n=[];Array.isArray(t.styles)?t.styles.forEach(D=>{"string"==typeof D?D==En?n.push(D):e.errors.push(function Bl(i){return new h.vHH(3002,Mt)}()):n.push(D)}):n.push(t.styles);let l=!1,f=null;return n.forEach(D=>{if(Fs(D)){const I=D,B=I.easing;if(B&&(f=B,delete I.easing),!l)for(let Z in I)if(I[Z].toString().indexOf("{{")>=0){l=!0;break}}}),{type:6,styles:n,easing:f,offset:t.offset,containsDynamicStyles:l,options:null}}_validateStyleAst(t,e){const n=e.currentAnimateTimings;let l=e.currentTime,f=e.currentTime;n&&f>0&&(f-=n.duration+n.delay),t.styles.forEach(D=>{"string"!=typeof D&&Object.keys(D).forEach(I=>{if(!this._driver.validateStyleProperty(I))return delete D[I],void e.unsupportedCSSPropertiesFound.add(I);const B=e.collectedStyles[e.currentQuerySelector],Z=B[I];let se=!0;Z&&(f!=l&&f>=Z.startTime&&l<=Z.endTime&&(e.errors.push(function qa(i,t,e,n,l){return new h.vHH(3010,Mt)}()),se=!1),f=Z.startTime),se&&(B[I]={startTime:f,endTime:l}),e.options&&function ff(i,t,e){const n=t.params||{},l=mf(i);l.length&&l.forEach(f=>{n.hasOwnProperty(f)||e.push(function cs(i){return new h.vHH(3001,Mt)}())})}(D[I],e.options,e.errors)})})}visitKeyframes(t,e){const n={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function b(){return new h.vHH(3011,Mt)}()),n;let f=0;const D=[];let I=!1,B=!1,Z=0;const se=t.steps.map(Mn=>{const vn=this._makeStyleAst(Mn,e);let fr=null!=vn.offset?vn.offset:function Wh(i){if("string"==typeof i)return null;let t=null;if(Array.isArray(i))i.forEach(e=>{if(Fs(e)&&e.hasOwnProperty("offset")){const n=e;t=parseFloat(n.offset),delete n.offset}});else if(Fs(i)&&i.hasOwnProperty("offset")){const e=i;t=parseFloat(e.offset),delete e.offset}return t}(vn.styles),vr=0;return null!=fr&&(f++,vr=vn.offset=fr),B=B||vr<0||vr>1,I=I||vr<Z,Z=vr,D.push(vr),vn});B&&e.errors.push(function a(){return new h.vHH(3012,Mt)}()),I&&e.errors.push(function p(){return new h.vHH(3200,Mt)}());const ge=t.steps.length;let qe=0;f>0&&f<ge?e.errors.push(function y(){return new h.vHH(3202,Mt)}()):0==f&&(qe=1/(ge-1));const it=ge-1,bt=e.currentTime,ti=e.currentAnimateTimings,yi=ti.duration;return se.forEach((Mn,vn)=>{const fr=qe>0?vn==it?1:qe*vn:D[vn],vr=fr*yi;e.currentTime=bt+ti.delay+vr,ti.duration=vr,this._validateStyleAst(Mn,e),Mn.offset=fr,n.styles.push(Mn)}),n}visitReference(t,e){return{type:8,animation:Nr(this,vo(t.animation),e),options:pa(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:pa(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:pa(t.options)}}visitQuery(t,e){const n=e.currentQuerySelector,l=t.options||{};e.queryCount++,e.currentQuery=t;const[f,D]=function Au(i){const t=!!i.split(/\s*,\s*/).find(e=>":self"==e);return t&&(i=i.replace(Hl,"")),i=i.replace(/@\*/g,Rs).replace(/@\w+/g,e=>Rs+"-"+e.substr(1)).replace(/:animating/g,Nl),[i,t]}(t.selector);e.currentQuerySelector=n.length?n+" "+f:f,mi(e.collectedStyles,e.currentQuerySelector,{});const I=Nr(this,vo(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=n,{type:11,selector:f,limit:l.limit||0,optional:!!l.optional,includeSelf:D,animation:I,originalSelector:t.selector,options:pa(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push(function w(){return new h.vHH(3013,Mt)}());const n="full"===t.timings?{duration:0,delay:0,easing:"full"}:Zo(t.timings,e.errors,!0);return{type:12,animation:Nr(this,vo(t.animation),e),timings:n,options:null}}}class ku{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Fs(i){return!Array.isArray(i)&&"object"==typeof i}function pa(i){return i?(i=Os(i)).params&&(i.params=function Iu(i){return i?Os(i):null}(i.params)):i={},i}function Xd(i,t,e){return{duration:i,delay:t,easing:e}}function Ru(i,t,e,n,l,f,D=null,I=!1){return{type:1,element:i,keyframes:t,preStyleProps:e,postStyleProps:n,duration:l,delay:f,totalTime:l+f,easing:D,subTimeline:I}}class Qa{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,e){let n=this._map.get(t);n||this._map.set(t,n=[]),n.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const yf=new RegExp(":enter","g"),ig=new RegExp(":leave","g");function Pu(i,t,e,n,l,f={},D={},I,B,Z=[]){return(new Qd).buildKeyframes(i,t,e,n,l,f,D,I,B,Z)}class Qd{buildKeyframes(t,e,n,l,f,D,I,B,Z,se=[]){Z=Z||new Qa;const ge=new Ls(t,e,Z,l,f,se,[]);ge.options=B,ge.currentTimeline.setStyles([D],null,ge.errors,B),Nr(this,n,ge);const qe=ge.timelines.filter(it=>it.containsAnimation());if(Object.keys(I).length){let it;for(let bt=qe.length-1;bt>=0;bt--){const ti=qe[bt];if(ti.element===e){it=ti;break}}it&&!it.allowOnlyTimelineStyles()&&it.setStyles([I],null,ge.errors,B)}return qe.length?qe.map(it=>it.buildKeyframes()):[Ru(e,[],[],[],0,0,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const n=e.subInstructions.get(e.element);if(n){const l=e.createSubContext(t.options),f=e.currentTimeline.currentTime,D=this._visitSubInstructions(n,l,l.options);f!=D&&e.transformIntoNewTimeline(D)}e.previousNode=t}visitAnimateRef(t,e){const n=e.createSubContext(t.options);n.transformIntoNewTimeline(),this.visitReference(t.animation,n),e.transformIntoNewTimeline(n.currentTimeline.currentTime),e.previousNode=t}_visitSubInstructions(t,e,n){let f=e.currentTimeline.currentTime;const D=null!=n.duration?yo(n.duration):null,I=null!=n.delay?yo(n.delay):null;return 0!==D&&t.forEach(B=>{const Z=e.appendInstructionToTimeline(B,D,I);f=Math.max(f,Z.duration+Z.delay)}),f}visitReference(t,e){e.updateOptions(t.options,!0),Nr(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const n=e.subContextCount;let l=e;const f=t.options;if(f&&(f.params||f.delay)&&(l=e.createSubContext(f),l.transformIntoNewTimeline(),null!=f.delay)){6==l.previousNode.type&&(l.currentTimeline.snapshotCurrentStyles(),l.previousNode=Ou);const D=yo(f.delay);l.delayNextStep(D)}t.steps.length&&(t.steps.forEach(D=>Nr(this,D,l)),l.currentTimeline.applyStylesToKeyframe(),l.subContextCount>n&&l.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const n=[];let l=e.currentTimeline.currentTime;const f=t.options&&t.options.delay?yo(t.options.delay):0;t.steps.forEach(D=>{const I=e.createSubContext(t.options);f&&I.delayNextStep(f),Nr(this,D,I),l=Math.max(l,I.currentTimeline.currentTime),n.push(I.currentTimeline)}),n.forEach(D=>e.currentTimeline.mergeTimelineCollectedStyles(D)),e.transformIntoNewTimeline(l),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const n=t.strValue;return Zo(e.params?Za(n,e.params,e.errors):n,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const n=e.currentAnimateTimings=this._visitTiming(t.timings,e),l=e.currentTimeline;n.delay&&(e.incrementTime(n.delay),l.snapshotCurrentStyles());const f=t.style;5==f.type?this.visitKeyframes(f,e):(e.incrementTime(n.duration),this.visitStyle(f,e),l.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const n=e.currentTimeline,l=e.currentAnimateTimings;!l&&n.getCurrentStyleProperties().length&&n.forwardFrame();const f=l&&l.easing||t.easing;t.isEmptyStep?n.applyEmptyStep(f):n.setStyles(t.styles,f,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const n=e.currentAnimateTimings,l=e.currentTimeline.duration,f=n.duration,I=e.createSubContext().currentTimeline;I.easing=n.easing,t.styles.forEach(B=>{I.forwardTime((B.offset||0)*f),I.setStyles(B.styles,B.easing,e.errors,e.options),I.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(I),e.transformIntoNewTimeline(l+f),e.previousNode=t}visitQuery(t,e){const n=e.currentTimeline.currentTime,l=t.options||{},f=l.delay?yo(l.delay):0;f&&(6===e.previousNode.type||0==n&&e.currentTimeline.getCurrentStyleProperties().length)&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=Ou);let D=n;const I=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!l.optional,e.errors);e.currentQueryTotal=I.length;let B=null;I.forEach((Z,se)=>{e.currentQueryIndex=se;const ge=e.createSubContext(t.options,Z);f&&ge.delayNextStep(f),Z===e.element&&(B=ge.currentTimeline),Nr(this,t.animation,ge),ge.currentTimeline.applyStylesToKeyframe(),D=Math.max(D,ge.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(D),B&&(e.currentTimeline.mergeTimelineCollectedStyles(B),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const n=e.parentContext,l=e.currentTimeline,f=t.timings,D=Math.abs(f.duration),I=D*(e.currentQueryTotal-1);let B=D*e.currentQueryIndex;switch(f.duration<0?"reverse":f.easing){case"reverse":B=I-B;break;case"full":B=n.currentStaggerTime}const se=e.currentTimeline;B&&se.delayNextStep(B);const ge=se.currentTime;Nr(this,t.animation,e),e.previousNode=t,n.currentStaggerTime=l.currentTime-ge+(l.startTime-n.currentTimeline.startTime)}}const Ou={};class Ls{constructor(t,e,n,l,f,D,I,B){this._driver=t,this.element=e,this.subInstructions=n,this._enterClassName=l,this._leaveClassName=f,this.errors=D,this.timelines=I,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Ou,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=B||new Ja(this._driver,e,0),I.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const n=t;let l=this.options;null!=n.duration&&(l.duration=yo(n.duration)),null!=n.delay&&(l.delay=yo(n.delay));const f=n.params;if(f){let D=l.params;D||(D=this.options.params={}),Object.keys(f).forEach(I=>{(!e||!D.hasOwnProperty(I))&&(D[I]=Za(f[I],D,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const n=t.params={};Object.keys(e).forEach(l=>{n[l]=e[l]})}}return t}createSubContext(t=null,e,n){const l=e||this.element,f=new Ls(this._driver,l,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(l,n||0));return f.previousNode=this.previousNode,f.currentAnimateTimings=this.currentAnimateTimings,f.options=this._copyOptions(),f.updateOptions(t),f.currentQueryIndex=this.currentQueryIndex,f.currentQueryTotal=this.currentQueryTotal,f.parentContext=this,this.subContextCount++,f}transformIntoNewTimeline(t){return this.previousNode=Ou,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,n){const l={duration:null!=e?e:t.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+t.delay,easing:""},f=new ng(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,l,t.stretchStartingKeyframe);return this.timelines.push(f),l}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,n,l,f,D){let I=[];if(l&&I.push(this.element),t.length>0){t=(t=t.replace(yf,"."+this._enterClassName)).replace(ig,"."+this._leaveClassName);let Z=this._driver.query(this.element,t,1!=n);0!==n&&(Z=n<0?Z.slice(Z.length+n,Z.length):Z.slice(0,n)),I.push(...Z)}return!f&&0==I.length&&D.push(function S(i){return new h.vHH(3014,Mt)}()),I}}class Ja{constructor(t,e,n,l){this._driver=t,this.element=e,this.startTime=n,this._elementTimelineStylesLookup=l,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new Ja(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles[t]=e,this._globalTimelineStyles[t]=e,this._styleSummary[t]={time:this.currentTime,value:e}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&(this._previousKeyframe.easing=t),Object.keys(this._globalTimelineStyles).forEach(e=>{this._backFill[e]=this._globalTimelineStyles[e]||En,this._currentKeyframe[e]=En}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,n,l){e&&(this._previousKeyframe.easing=e);const f=l&&l.params||{},D=function rg(i,t){const e={};let n;return i.forEach(l=>{"*"===l?(n=n||Object.keys(t),n.forEach(f=>{e[f]=En})):Zs(l,!1,e)}),e}(t,this._globalTimelineStyles);Object.keys(D).forEach(I=>{const B=Za(D[I],f,n);this._pendingStyles[I]=B,this._localTimelineStyles.hasOwnProperty(I)||(this._backFill[I]=this._globalTimelineStyles.hasOwnProperty(I)?this._globalTimelineStyles[I]:En),this._updateStyle(I,B)})}applyStylesToKeyframe(){const t=this._pendingStyles,e=Object.keys(t);0!=e.length&&(this._pendingStyles={},e.forEach(n=>{this._currentKeyframe[n]=t[n]}),Object.keys(this._localTimelineStyles).forEach(n=>{this._currentKeyframe.hasOwnProperty(n)||(this._currentKeyframe[n]=this._localTimelineStyles[n])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(t=>{const e=this._localTimelineStyles[t];this._pendingStyles[t]=e,this._updateStyle(t,e)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){Object.keys(t._styleSummary).forEach(e=>{const n=this._styleSummary[e],l=t._styleSummary[e];(!n||l.time>n.time)&&this._updateStyle(e,l.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,n=1===this._keyframes.size&&0===this.duration;let l=[];this._keyframes.forEach((I,B)=>{const Z=Zs(I,!0);Object.keys(Z).forEach(se=>{const ge=Z[se];"!"==ge?t.add(se):ge==En&&e.add(se)}),n||(Z.offset=B/this.duration),l.push(Z)});const f=t.size?Cn(t.values()):[],D=e.size?Cn(e.values()):[];if(n){const I=l[0],B=Os(I);I.offset=0,B.offset=1,l=[I,B]}return Ru(this.element,l,f,D,this.duration,this.startTime,this.easing,!1)}}class ng extends Ja{constructor(t,e,n,l,f,D,I=!1){super(t,e,D.delay),this.keyframes=n,this.preStyleProps=l,this.postStyleProps=f,this._stretchStartingKeyframe=I,this.timings={duration:D.duration,delay:D.delay,easing:D.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:n,easing:l}=this.timings;if(this._stretchStartingKeyframe&&e){const f=[],D=n+e,I=e/D,B=Zs(t[0],!1);B.offset=0,f.push(B);const Z=Zs(t[0],!1);Z.offset=vf(I),f.push(Z);const se=t.length-1;for(let ge=1;ge<=se;ge++){let qe=Zs(t[ge],!1);qe.offset=vf((e+qe.offset*n)/D),f.push(qe)}n=D,e=0,l="",t=f}return Ru(this.element,t,this.preStyleProps,this.postStyleProps,n,e,l,!0)}}function vf(i,t=3){const e=Math.pow(10,t-1);return Math.round(i*e)/e}class Zh{}class bf extends Zh{normalizePropertyName(t,e){return Ka(t)}normalizeStyleValue(t,e,n,l){let f="";const D=n.toString().trim();if(hs[e]&&0!==n&&"0"!==n)if("number"==typeof n)f="px";else{const I=n.match(/^[+-]?[\d\.]+([a-z]*)$/);I&&0==I[1].length&&l.push(function Dc(i,t){return new h.vHH(3005,Mt)}())}return D+f}}const hs=(()=>function Fu(i){const t={};return i.forEach(e=>t[e]=!0),t}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function el(i,t,e,n,l,f,D,I,B,Z,se,ge,qe){return{type:0,element:i,triggerName:t,isRemovalTransition:l,fromState:e,fromStyles:f,toState:n,toStyles:D,timelines:I,queriedElements:B,preStyleProps:Z,postStyleProps:se,totalTime:ge,errors:qe}}const eh={};class zn{constructor(t,e,n){this._triggerName=t,this.ast=e,this._stateStyles=n}match(t,e,n,l){return function Kh(i,t,e,n,l){return i.some(f=>f(t,e,n,l))}(this.ast.matchers,t,e,n,l)}buildStyles(t,e,n){const l=this._stateStyles["*"],f=this._stateStyles[t],D=l?l.buildStyles(e,n):{};return f?f.buildStyles(e,n):D}build(t,e,n,l,f,D,I,B,Z,se){const ge=[],qe=this.ast.options&&this.ast.options.params||eh,bt=this.buildStyles(n,I&&I.params||eh,ge),ti=B&&B.params||eh,yi=this.buildStyles(l,ti,ge),Mn=new Set,vn=new Map,fr=new Map,vr="void"===l,Ed={params:Object.assign(Object.assign({},qe),ti)},ou=se?[]:Pu(t,e,this.ast.animation,f,D,bt,yi,Ed,Z,ge);let Ns=0;if(ou.forEach(Td=>{Ns=Math.max(Td.duration+Td.delay,Ns)}),ge.length)return el(e,this._triggerName,n,l,vr,bt,yi,[],[],vn,fr,Ns,ge);ou.forEach(Td=>{const Ad=Td.element,VS=mi(vn,Ad,{});Td.preStyleProps.forEach(cf=>VS[cf]=!0);const Cy=mi(fr,Ad,{});Td.postStyleProps.forEach(cf=>Cy[cf]=!0),Ad!==e&&Mn.add(Ad)});const Sd=Cn(Mn.values());return el(e,this._triggerName,n,l,vr,bt,yi,ou,Sd,vn,fr,Ns)}}class og{constructor(t,e,n){this.styles=t,this.defaultParams=e,this.normalizer=n}buildStyles(t,e){const n={},l=Os(this.defaultParams);return Object.keys(t).forEach(f=>{const D=t[f];null!=D&&(l[f]=D)}),this.styles.styles.forEach(f=>{if("string"!=typeof f){const D=f;Object.keys(D).forEach(I=>{let B=D[I];B.length>1&&(B=Za(B,l,e));const Z=this.normalizer.normalizePropertyName(I,e);B=this.normalizer.normalizeStyleValue(I,Z,B,e),n[Z]=B})}}),n}}class Ic{constructor(t,e,n){this.name=t,this.ast=e,this._normalizer=n,this.transitionFactories=[],this.states={},e.states.forEach(l=>{this.states[l.name]=new og(l.style,l.options&&l.options.params||{},n)}),Lu(this.states,"true","1"),Lu(this.states,"false","0"),e.transitions.forEach(l=>{this.transitionFactories.push(new zn(t,l,this.states))}),this.fallbackTransition=function $l(i,t,e){return new zn(i,{type:1,animation:{type:2,steps:[],options:null},matchers:[(D,I)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,n,l){return this.transitionFactories.find(D=>D.match(t,e,n,l))||null}matchStyles(t,e,n){return this.fallbackTransition.buildStyles(t,e,n)}}function Lu(i,t,e){i.hasOwnProperty(t)?i.hasOwnProperty(e)||(i[e]=i[t]):i.hasOwnProperty(e)&&(i[t]=i[e])}const sg=new Qa;class th{constructor(t,e,n){this.bodyNode=t,this._driver=e,this._normalizer=n,this._animations={},this._playersById={},this.players=[]}register(t,e){const n=[],f=Tu(this._driver,e,n,[]);if(n.length)throw function te(i){return new h.vHH(3503,Mt)}();this._animations[t]=f}_buildPlayer(t,e,n){const l=t.element,f=Zt(0,this._normalizer,0,t.keyframes,e,n);return this._driver.animate(l,f,t.duration,t.delay,t.easing,[],!0)}create(t,e,n={}){const l=[],f=this._animations[t];let D;const I=new Map;if(f?(D=Pu(this._driver,e,f,Vo,ks,{},{},n,sg,l),D.forEach(se=>{const ge=mi(I,se.element,{});se.postStyleProps.forEach(qe=>ge[qe]=null)})):(l.push(function ce(){return new h.vHH(3300,Mt)}()),D=[]),l.length)throw function oe(i){return new h.vHH(3504,Mt)}();I.forEach((se,ge)=>{Object.keys(se).forEach(qe=>{se[qe]=this._driver.computeStyle(ge,qe,En)})});const Z=ot(D.map(se=>{const ge=I.get(se.element);return this._buildPlayer(se,{},ge)}));return this._playersById[t]=Z,Z.onDestroy(()=>this.destroy(t)),this.players.push(Z),Z}destroy(t){const e=this._getPlayer(t);e.destroy(),delete this._playersById[t];const n=this.players.indexOf(e);n>=0&&this.players.splice(n,1)}_getPlayer(t){const e=this._playersById[t];if(!e)throw function he(i){return new h.vHH(3301,Mt)}();return e}listen(t,e,n,l){const f=Zi(e,"","","");return St(this._getPlayer(t),n,f,l),()=>{}}command(t,e,n,l){if("register"==n)return void this.register(t,l[0]);if("create"==n)return void this.create(t,e,l[0]||{});const f=this._getPlayer(t);switch(n){case"play":f.play();break;case"pause":f.pause();break;case"reset":f.reset();break;case"restart":f.restart();break;case"finish":f.finish();break;case"init":f.init();break;case"setPosition":f.setPosition(parseFloat(l[0]));break;case"destroy":this.destroy(t)}}}const Bu="ng-animate-queued",ih="ng-animate-disabled",nh=[],Nu={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Jh={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},zo="__ng_removed";class jn{constructor(t,e=""){this.namespaceId=e;const n=t&&t.hasOwnProperty("value");if(this.value=function lg(i){return null!=i?i:null}(n?t.value:t),n){const f=Os(t);delete f.value,this.options=f}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const e=t.params;if(e){const n=this.options.params;Object.keys(e).forEach(l=>{null==n[l]&&(n[l]=e[l])})}}}const ql="void",ep=new jn(ql);class tp{constructor(t,e,n){this.id=t,this.hostElement=e,this._engine=n,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,Tn(e,this._hostClassName)}listen(t,e,n,l){if(!this._triggers.hasOwnProperty(e))throw function Ce(i,t){return new h.vHH(3302,Mt)}();if(null==n||0==n.length)throw function De(i){return new h.vHH(3303,Mt)}();if(!function Rc(i){return"start"==i||"done"==i}(n))throw function Ne(i,t){return new h.vHH(3400,Mt)}();const f=mi(this._elementListeners,t,[]),D={name:e,phase:n,callback:l};f.push(D);const I=mi(this._engine.statesByElement,t,{});return I.hasOwnProperty(e)||(Tn(t,To),Tn(t,To+"-"+e),I[e]=ep),()=>{this._engine.afterFlush(()=>{const B=f.indexOf(D);B>=0&&f.splice(B,1),this._triggers[e]||delete I[e]})}}register(t,e){return!this._triggers[t]&&(this._triggers[t]=e,!0)}_getTrigger(t){const e=this._triggers[t];if(!e)throw function Se(i){return new h.vHH(3401,Mt)}();return e}trigger(t,e,n,l=!0){const f=this._getTrigger(e),D=new ip(this.id,e,t);let I=this._engine.statesByElement.get(t);I||(Tn(t,To),Tn(t,To+"-"+e),this._engine.statesByElement.set(t,I={}));let B=I[e];const Z=new jn(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&B&&Z.absorbOptions(B.options),I[e]=Z,B||(B=ep),Z.value!==ql&&B.value===Z.value){if(!function zu(i,t){const e=Object.keys(i),n=Object.keys(t);if(e.length!=n.length)return!1;for(let l=0;l<e.length;l++){const f=e[l];if(!t.hasOwnProperty(f)||i[f]!==t[f])return!1}return!0}(B.params,Z.params)){const ti=[],yi=f.matchStyles(B.value,B.params,ti),Mn=f.matchStyles(Z.value,Z.params,ti);ti.length?this._engine.reportError(ti):this._engine.afterFlush(()=>{Tr(t,yi),Sr(t,Mn)})}return}const qe=mi(this._engine.playersByElement,t,[]);qe.forEach(ti=>{ti.namespaceId==this.id&&ti.triggerName==e&&ti.queued&&ti.destroy()});let it=f.matchTransition(B.value,Z.value,t,Z.params),bt=!1;if(!it){if(!l)return;it=f.fallbackTransition,bt=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:it,fromState:B,toState:Z,player:D,isFallbackTransition:bt}),bt||(Tn(t,Bu),D.onStart(()=>{fa(t,Bu)})),D.onDone(()=>{let ti=this.players.indexOf(D);ti>=0&&this.players.splice(ti,1);const yi=this._engine.playersByElement.get(t);if(yi){let Mn=yi.indexOf(D);Mn>=0&&yi.splice(Mn,1)}}),this.players.push(D),qe.push(D),D}deregister(t){delete this._triggers[t],this._engine.statesByElement.forEach((e,n)=>{delete e[t]}),this._elementListeners.forEach((e,n)=>{this._elementListeners.set(n,e.filter(l=>l.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(n=>n.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const n=this._engine.driver.query(t,Rs,!0);n.forEach(l=>{if(l[zo])return;const f=this._engine.fetchNamespacesByElement(l);f.size?f.forEach(D=>D.triggerLeaveAnimation(l,e,!1,!0)):this.clearElementCache(l)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(l=>this.clearElementCache(l)))}triggerLeaveAnimation(t,e,n,l){const f=this._engine.statesByElement.get(t),D=new Map;if(f){const I=[];if(Object.keys(f).forEach(B=>{if(D.set(B,f[B].value),this._triggers[B]){const Z=this.trigger(t,B,ql,l);Z&&I.push(Z)}}),I.length)return this._engine.markElementAsRemoved(this.id,t,!0,e,D),n&&ot(I).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t),n=this._engine.statesByElement.get(t);if(e&&n){const l=new Set;e.forEach(f=>{const D=f.name;if(l.has(D))return;l.add(D);const B=this._triggers[D].fallbackTransition,Z=n[D]||ep,se=new jn(ql),ge=new ip(this.id,D,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:D,transition:B,fromState:Z,toState:se,player:ge,isFallbackTransition:!0})})}}removeNode(t,e){const n=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let l=!1;if(n.totalAnimations){const f=n.players.length?n.playersByQueriedElement.get(t):[];if(f&&f.length)l=!0;else{let D=t;for(;D=D.parentNode;)if(n.statesByElement.get(D)){l=!0;break}}}if(this.prepareLeaveAnimationListeners(t),l)n.markElementAsRemoved(this.id,t,!1,e);else{const f=t[zo];(!f||f===Nu)&&(n.afterFlush(()=>this.clearElementCache(t)),n.destroyInnerAnimations(t),n._onRemovalComplete(t,e))}}insertNode(t,e){Tn(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(n=>{const l=n.player;if(l.destroyed)return;const f=n.element,D=this._elementListeners.get(f);D&&D.forEach(I=>{if(I.name==n.triggerName){const B=Zi(f,n.triggerName,n.fromState.value,n.toState.value);B._data=t,St(n.player,I.phase,B,I.callback)}}),l.markedForDestroy?this._engine.afterFlush(()=>{l.destroy()}):e.push(n)}),this._queue=[],e.sort((n,l)=>{const f=n.transition.ast.depCount,D=l.transition.ast.depCount;return 0==f||0==D?f-D:this._engine.driver.containsElement(n.element,l.element)?1:-1})}destroy(t){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find(n=>n.element===t)||e,e}}class wf{constructor(t,e,n){this.bodyNode=t,this.driver=e,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(l,f)=>{}}_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(n=>{n.queued&&t.push(n)})}),t}createNamespace(t,e){const n=new tp(t,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(n,e):(this.newHostElements.set(e,n),this.collectEnterElement(e)),this._namespaceLookup[t]=n}_balanceNamespaceList(t,e){const n=this._namespaceList,l=this.namespacesByHostElement,f=n.length-1;if(f>=0){let D=!1;if(void 0!==this.driver.getParentElement){let I=this.driver.getParentElement(e);for(;I;){const B=l.get(I);if(B){const Z=n.indexOf(B);n.splice(Z+1,0,t),D=!0;break}I=this.driver.getParentElement(I)}}else for(let I=f;I>=0;I--)if(this.driver.containsElement(n[I].hostElement,e)){n.splice(I+1,0,t),D=!0;break}D||n.unshift(t)}else n.push(t);return l.set(e,t),t}register(t,e){let n=this._namespaceLookup[t];return n||(n=this.createNamespace(t,e)),n}registerTrigger(t,e,n){let l=this._namespaceLookup[t];l&&l.register(e,n)&&this.totalAnimations++}destroy(t,e){if(!t)return;const n=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[t];const l=this._namespaceList.indexOf(n);l>=0&&this._namespaceList.splice(l,1)}),this.afterFlushAnimationsDone(()=>n.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,n=this.statesByElement.get(t);if(n){const l=Object.keys(n);for(let f=0;f<l.length;f++){const D=n[l[f]].namespaceId;if(D){const I=this._fetchNamespace(D);I&&e.add(I)}}}return e}trigger(t,e,n,l){if(Vu(e)){const f=this._fetchNamespace(t);if(f)return f.trigger(e,n,l),!0}return!1}insertNode(t,e,n,l){if(!Vu(e))return;const f=e[zo];if(f&&f.setForRemoval){f.setForRemoval=!1,f.setForMove=!0;const D=this.collectedLeaveElements.indexOf(e);D>=0&&this.collectedLeaveElements.splice(D,1)}if(t){const D=this._fetchNamespace(t);D&&D.insertNode(e,n)}l&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),Tn(t,ih)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),fa(t,ih))}removeNode(t,e,n,l){if(Vu(e)){const f=t?this._fetchNamespace(t):null;if(f?f.removeNode(e,l):this.markElementAsRemoved(t,e,!1,l),n){const D=this.namespacesByHostElement.get(e);D&&D.id!==t&&D.removeNode(e,l)}}else this._onRemovalComplete(e,l)}markElementAsRemoved(t,e,n,l,f){this.collectedLeaveElements.push(e),e[zo]={namespaceId:t,setForRemoval:l,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:f}}listen(t,e,n,l,f){return Vu(e)?this._fetchNamespace(t).listen(e,n,l,f):()=>{}}_buildInstruction(t,e,n,l,f){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,n,l,t.fromState.options,t.toState.options,e,f)}destroyInnerAnimations(t){let e=this.driver.query(t,Rs,!0);e.forEach(n=>this.destroyActiveAnimationsForElement(n)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,Nl,!0),e.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return ot(this.players).onDone(()=>t());t()})}processLeaveNode(t){var e;const n=t[zo];if(n&&n.setForRemoval){if(t[zo]=Nu,n.namespaceId){this.destroyInnerAnimations(t);const l=this._fetchNamespace(n.namespaceId);l&&l.clearElementCache(t)}this._onRemovalComplete(t,n.setForRemoval)}(null===(e=t.classList)||void 0===e?void 0:e.contains(ih))&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(l=>{this.markElementAsDisabled(l,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,l)=>this._balanceNamespaceList(n,l)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)Tn(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{e=this._flushAnimations(n,t)}finally{for(let l=0;l<n.length;l++)n[l]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){const n=this._whenQuietFns;this._whenQuietFns=[],e.length?ot(e).onDone(()=>{n.forEach(l=>l())}):n.forEach(l=>l())}}reportError(t){throw function Je(i){return new h.vHH(3402,Mt)}()}_flushAnimations(t,e){const n=new Qa,l=[],f=new Map,D=[],I=new Map,B=new Map,Z=new Map,se=new Set;this.disabledNodes.forEach(gi=>{se.add(gi);const Ai=this.driver.query(gi,".ng-animate-queued",!0);for(let Oi=0;Oi<Ai.length;Oi++)se.add(Ai[Oi])});const ge=this.bodyNode,qe=Array.from(this.statesByElement.keys()),it=Pc(qe,this.collectedEnterElements),bt=new Map;let ti=0;it.forEach((gi,Ai)=>{const Oi=Vo+ti++;bt.set(Ai,Oi),gi.forEach(bn=>Tn(bn,Oi))});const yi=[],Mn=new Set,vn=new Set;for(let gi=0;gi<this.collectedLeaveElements.length;gi++){const Ai=this.collectedLeaveElements[gi],Oi=Ai[zo];Oi&&Oi.setForRemoval&&(yi.push(Ai),Mn.add(Ai),Oi.hasAnimation?this.driver.query(Ai,".ng-star-inserted",!0).forEach(bn=>Mn.add(bn)):vn.add(Ai))}const fr=new Map,vr=Pc(qe,Array.from(Mn));vr.forEach((gi,Ai)=>{const Oi=ks+ti++;fr.set(Ai,Oi),gi.forEach(bn=>Tn(bn,Oi))}),t.push(()=>{it.forEach((gi,Ai)=>{const Oi=bt.get(Ai);gi.forEach(bn=>fa(bn,Oi))}),vr.forEach((gi,Ai)=>{const Oi=fr.get(Ai);gi.forEach(bn=>fa(bn,Oi))}),yi.forEach(gi=>{this.processLeaveNode(gi)})});const Ed=[],ou=[];for(let gi=this._namespaceList.length-1;gi>=0;gi--)this._namespaceList[gi].drainQueuedTransitions(e).forEach(Oi=>{const bn=Oi.player,$o=Oi.element;if(Ed.push(bn),this.collectedEnterElements.length){const Vs=$o[zo];if(Vs&&Vs.setForMove){if(Vs.previousTriggersValues&&Vs.previousTriggersValues.has(Oi.triggerName)){const uf=Vs.previousTriggersValues.get(Oi.triggerName),Nh=this.statesByElement.get(Oi.element);Nh&&Nh[Oi.triggerName]&&(Nh[Oi.triggerName].value=uf)}return void bn.destroy()}}const su=!ge||!this.driver.containsElement(ge,$o),ka=fr.get($o),Bh=bt.get($o),Rr=this._buildInstruction(Oi,n,Bh,ka,su);if(Rr.errors&&Rr.errors.length)return void ou.push(Rr);if(su)return bn.onStart(()=>Tr($o,Rr.fromStyles)),bn.onDestroy(()=>Sr($o,Rr.toStyles)),void l.push(bn);if(Oi.isFallbackTransition)return bn.onStart(()=>Tr($o,Rr.fromStyles)),bn.onDestroy(()=>Sr($o,Rr.toStyles)),void l.push(bn);const US=[];Rr.timelines.forEach(Vs=>{Vs.stretchStartingKeyframe=!0,this.disabledNodes.has(Vs.element)||US.push(Vs)}),Rr.timelines=US,n.append($o,Rr.timelines),D.push({instruction:Rr,player:bn,element:$o}),Rr.queriedElements.forEach(Vs=>mi(I,Vs,[]).push(bn)),Rr.preStyleProps.forEach((Vs,uf)=>{const Nh=Object.keys(Vs);if(Nh.length){let df=B.get(uf);df||B.set(uf,df=new Set),Nh.forEach(SM=>df.add(SM))}}),Rr.postStyleProps.forEach((Vs,uf)=>{const Nh=Object.keys(Vs);let df=Z.get(uf);df||Z.set(uf,df=new Set),Nh.forEach(SM=>df.add(SM))})});if(ou.length){const gi=[];ou.forEach(Ai=>{gi.push(function Ge(i,t){return new h.vHH(3505,Mt)}())}),Ed.forEach(Ai=>Ai.destroy()),this.reportError(gi)}const Ns=new Map,Sd=new Map;D.forEach(gi=>{const Ai=gi.element;n.has(Ai)&&(Sd.set(Ai,Ai),this._beforeAnimationBuild(gi.player.namespaceId,gi.instruction,Ns))}),l.forEach(gi=>{const Ai=gi.element;this._getPreviousPlayers(Ai,!1,gi.namespaceId,gi.triggerName,null).forEach(bn=>{mi(Ns,Ai,[]).push(bn),bn.destroy()})});const Td=yi.filter(gi=>Oc(gi,B,Z)),Ad=new Map;ug(Ad,this.driver,vn,Z,En).forEach(gi=>{Oc(gi,B,Z)&&Td.push(gi)});const Cy=new Map;it.forEach((gi,Ai)=>{ug(Cy,this.driver,new Set(gi),B,"!")}),Td.forEach(gi=>{const Ai=Ad.get(gi),Oi=Cy.get(gi);Ad.set(gi,Object.assign(Object.assign({},Ai),Oi))});const cf=[],zS=[],jS={};D.forEach(gi=>{const{element:Ai,player:Oi,instruction:bn}=gi;if(n.has(Ai)){if(se.has(Ai))return Oi.onDestroy(()=>Sr(Ai,bn.toStyles)),Oi.disabled=!0,Oi.overrideTotalTime(bn.totalTime),void l.push(Oi);let $o=jS;if(Sd.size>1){let ka=Ai;const Bh=[];for(;ka=ka.parentNode;){const Rr=Sd.get(ka);if(Rr){$o=Rr;break}Bh.push(ka)}Bh.forEach(Rr=>Sd.set(Rr,$o))}const su=this._buildAnimation(Oi.namespaceId,bn,Ns,f,Cy,Ad);if(Oi.setRealPlayer(su),$o===jS)cf.push(Oi);else{const ka=this.playersByElement.get($o);ka&&ka.length&&(Oi.parentPlayer=ot(ka)),l.push(Oi)}}else Tr(Ai,bn.fromStyles),Oi.onDestroy(()=>Sr(Ai,bn.toStyles)),zS.push(Oi),se.has(Ai)&&l.push(Oi)}),zS.forEach(gi=>{const Ai=f.get(gi.element);if(Ai&&Ai.length){const Oi=ot(Ai);gi.setRealPlayer(Oi)}}),l.forEach(gi=>{gi.parentPlayer?gi.syncPlayerEvents(gi.parentPlayer):gi.destroy()});for(let gi=0;gi<yi.length;gi++){const Ai=yi[gi],Oi=Ai[zo];if(fa(Ai,ks),Oi&&Oi.hasAnimation)continue;let bn=[];if(I.size){let su=I.get(Ai);su&&su.length&&bn.push(...su);let ka=this.driver.query(Ai,Nl,!0);for(let Bh=0;Bh<ka.length;Bh++){let Rr=I.get(ka[Bh]);Rr&&Rr.length&&bn.push(...Rr)}}const $o=bn.filter(su=>!su.destroyed);$o.length?Cf(this,Ai,$o):this.processLeaveNode(Ai)}return yi.length=0,cf.forEach(gi=>{this.players.push(gi),gi.onDone(()=>{gi.destroy();const Ai=this.players.indexOf(gi);this.players.splice(Ai,1)}),gi.play()}),cf}elementContainsData(t,e){let n=!1;const l=e[zo];return l&&l.setForRemoval&&(n=!0),this.playersByElement.has(e)&&(n=!0),this.playersByQueriedElement.has(e)&&(n=!0),this.statesByElement.has(e)&&(n=!0),this._fetchNamespace(t).elementContainsData(e)||n}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,n,l,f){let D=[];if(e){const I=this.playersByQueriedElement.get(t);I&&(D=I)}else{const I=this.playersByElement.get(t);if(I){const B=!f||f==ql;I.forEach(Z=>{Z.queued||!B&&Z.triggerName!=l||D.push(Z)})}}return(n||l)&&(D=D.filter(I=>!(n&&n!=I.namespaceId||l&&l!=I.triggerName))),D}_beforeAnimationBuild(t,e,n){const f=e.element,D=e.isRemovalTransition?void 0:t,I=e.isRemovalTransition?void 0:e.triggerName;for(const B of e.timelines){const Z=B.element,se=Z!==f,ge=mi(n,Z,[]);this._getPreviousPlayers(Z,se,D,I,e.toState).forEach(it=>{const bt=it.getRealPlayer();bt.beforeDestroy&&bt.beforeDestroy(),it.destroy(),ge.push(it)})}Tr(f,e.fromStyles)}_buildAnimation(t,e,n,l,f,D){const I=e.triggerName,B=e.element,Z=[],se=new Set,ge=new Set,qe=e.timelines.map(bt=>{const ti=bt.element;se.add(ti);const yi=ti[zo];if(yi&&yi.removedBeforeQueried)return new fo(bt.duration,bt.delay);const Mn=ti!==B,vn=function Mf(i){const t=[];return Zr(i,t),t}((n.get(ti)||nh).map(Ns=>Ns.getRealPlayer())).filter(Ns=>!!Ns.element&&Ns.element===ti),fr=f.get(ti),vr=D.get(ti),Ed=Zt(0,this._normalizer,0,bt.keyframes,fr,vr),ou=this._buildPlayer(bt,Ed,vn);if(bt.subTimeline&&l&&ge.add(ti),Mn){const Ns=new ip(t,I,ti);Ns.setRealPlayer(ou),Z.push(Ns)}return ou});Z.forEach(bt=>{mi(this.playersByQueriedElement,bt.element,[]).push(bt),bt.onDone(()=>function tl(i,t,e){let n;if(i instanceof Map){if(n=i.get(t),n){if(n.length){const l=n.indexOf(e);n.splice(l,1)}0==n.length&&i.delete(t)}}else if(n=i[t],n){if(n.length){const l=n.indexOf(e);n.splice(l,1)}0==n.length&&delete i[t]}return n}(this.playersByQueriedElement,bt.element,bt))}),se.forEach(bt=>Tn(bt,Ya));const it=ot(qe);return it.onDestroy(()=>{se.forEach(bt=>fa(bt,Ya)),Sr(B,e.toStyles)}),ge.forEach(bt=>{mi(l,bt,[]).push(it)}),it}_buildPlayer(t,e,n){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,n):new fo(t.duration,t.delay)}}class ip{constructor(t,e,n){this.namespaceId=t,this.triggerName=e,this.element=n,this._player=new fo,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,Object.keys(this._queuedCallbacks).forEach(e=>{this._queuedCallbacks[e].forEach(n=>St(t,e,void 0,n))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){mi(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function Vu(i){return i&&1===i.nodeType}function cg(i,t){const e=i.style.display;return i.style.display=null!=t?t:"none",e}function ug(i,t,e,n,l){const f=[];e.forEach(B=>f.push(cg(B)));const D=[];n.forEach((B,Z)=>{const se={};B.forEach(ge=>{const qe=se[ge]=t.computeStyle(Z,ge,l);(!qe||0==qe.length)&&(Z[zo]=Jh,D.push(Z))}),i.set(Z,se)});let I=0;return e.forEach(B=>cg(B,f[I++])),D}function Pc(i,t){const e=new Map;if(i.forEach(I=>e.set(I,[])),0==t.length)return e;const l=new Set(t),f=new Map;function D(I){if(!I)return 1;let B=f.get(I);if(B)return B;const Z=I.parentNode;return B=e.has(Z)?Z:l.has(Z)?1:D(Z),f.set(I,B),B}return t.forEach(I=>{const B=D(I);1!==B&&e.get(B).push(I)}),e}function Tn(i,t){var e;null===(e=i.classList)||void 0===e||e.add(t)}function fa(i,t){var e;null===(e=i.classList)||void 0===e||e.remove(t)}function Cf(i,t,e){ot(e).onDone(()=>i.processLeaveNode(t))}function Zr(i,t){for(let e=0;e<i.length;e++){const n=i[e];n instanceof Is?Zr(n.players,t):t.push(n)}}function Oc(i,t,e){const n=e.get(i);if(!n)return!1;let l=t.get(i);return l?n.forEach(f=>l.add(f)):t.set(i,n),e.delete(i),!0}class il{constructor(t,e,n){this.bodyNode=t,this._driver=e,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(l,f)=>{},this._transitionEngine=new wf(t,e,n),this._timelineEngine=new th(t,e,n),this._transitionEngine.onRemovalComplete=(l,f)=>this.onRemovalComplete(l,f)}registerTrigger(t,e,n,l,f){const D=t+"-"+l;let I=this._triggerCache[D];if(!I){const B=[],se=Tu(this._driver,f,B,[]);if(B.length)throw function q(i,t){return new h.vHH(3404,Mt)}();I=function Xh(i,t,e){return new Ic(i,t,e)}(l,se,this._normalizer),this._triggerCache[D]=I}this._transitionEngine.registerTrigger(e,l,I)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,n,l){this._transitionEngine.insertNode(t,e,n,l)}onRemove(t,e,n,l){this._transitionEngine.removeNode(t,e,l||!1,n)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,n,l){if("@"==n.charAt(0)){const[f,D]=Ii(n);this._timelineEngine.command(f,e,D,l)}else this._transitionEngine.trigger(t,e,n,l)}listen(t,e,n,l,f){if("@"==n.charAt(0)){const[D,I]=Ii(n);return this._timelineEngine.listen(D,e,I,f)}return this._transitionEngine.listen(t,e,n,l,f)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let Df=(()=>{class i{constructor(e,n,l){this._element=e,this._startStyles=n,this._endStyles=l,this._state=0;let f=i.initialStylesByElement.get(e);f||i.initialStylesByElement.set(e,f={}),this._initialStyles=f}start(){this._state<1&&(this._startStyles&&Sr(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Sr(this._element,this._initialStyles),this._endStyles&&(Sr(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(i.initialStylesByElement.delete(this._element),this._startStyles&&(Tr(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Tr(this._element,this._endStyles),this._endStyles=null),Sr(this._element,this._initialStyles),this._state=3)}}return i.initialStylesByElement=new WeakMap,i})();function rp(i){let t=null;const e=Object.keys(i);for(let n=0;n<e.length;n++){const l=e[n];Ef(l)&&(t=t||{},t[l]=i[l])}return t}function Ef(i){return"display"===i||"position"===i}class Fc{constructor(t,e,n,l){this.element=t,this.keyframes=e,this.options=n,this._specialStyles=l,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(t,e,n){return t.animate(e,n)}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t={};if(this.hasStarted()){const e=this._finalKeyframe;Object.keys(e).forEach(n=>{"offset"!=n&&(t[n]=this._finished?e[n]:Yd(this.element,n))})}this.currentSnapshot=t}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(n=>n()),e.length=0}}class op{validateStyleProperty(t){return dr(t)}matchesElement(t,e){return!1}containsElement(t,e){return ds(t,e)}getParentElement(t){return Sn(t)}query(t,e,n){return Ws(t,e,n)}computeStyle(t,e,n){return window.getComputedStyle(t)[e]}animate(t,e,n,l,f,D=[]){const B={duration:n,delay:l,fill:0==l?"both":"forwards"};f&&(B.easing=f);const Z={},se=D.filter(qe=>qe instanceof Fc);(function Xa(i,t){return 0===i||0===t})(n,l)&&se.forEach(qe=>{let it=qe.currentSnapshot;Object.keys(it).forEach(bt=>Z[bt]=it[bt])}),e=function Tc(i,t,e){const n=Object.keys(e);if(n.length&&t.length){let f=t[0],D=[];if(n.forEach(I=>{f.hasOwnProperty(I)||D.push(I),f[I]=e[I]}),D.length)for(var l=1;l<t.length;l++){let I=t[l];D.forEach(function(B){I[B]=Yd(i,B)})}}return t}(t,e=e.map(qe=>Zs(qe,!1)),Z);const ge=function np(i,t){let e=null,n=null;return Array.isArray(t)&&t.length?(e=rp(t[0]),t.length>1&&(n=rp(t[t.length-1]))):t&&(e=rp(t)),e||n?new Df(i,e,n):null}(t,e);return new Fc(t,e,B,ge)}}let dg=(()=>{class i extends Cu{constructor(e,n){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(n.body,{id:"0",encapsulation:h.ifc.None,styles:[],data:{animation:[]}})}build(e){const n=this._nextAnimationId.toString();this._nextAnimationId++;const l=Array.isArray(e)?Ol(e):e;return Sf(this._renderer,null,n,"register",[l]),new hg(n,this._renderer)}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(h.FYo),h.LFG(ye))},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac}),i})();class hg extends class Hd{}{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new sp(this._id,t,e||{},this._renderer)}}class sp{constructor(t,e,n,l){this.id=t,this.element=e,this._renderer=l,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return Sf(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){var t,e;return null!==(e=null===(t=this._renderer.engine.players[+this.id])||void 0===t?void 0:t.getPosition())&&void 0!==e?e:0}}function Sf(i,t,e,n,l){return i.setProperty(t,`@@${e}:${n}`,l)}const oh="@.disabled";let Tf=(()=>{class i{constructor(e,n,l){this.delegate=e,this.engine=n,this._zone=l,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=(f,D)=>{const I=null==D?void 0:D.parentNode(f);I&&D.removeChild(I,f)}}createRenderer(e,n){const f=this.delegate.createRenderer(e,n);if(!(e&&n&&n.data&&n.data.animation)){let se=this._rendererCache.get(f);return se||(se=new sh("",f,this.engine),this._rendererCache.set(f,se)),se}const D=n.id,I=n.id+"-"+this._currentId;this._currentId++,this.engine.register(I,e);const B=se=>{Array.isArray(se)?se.forEach(B):this.engine.registerTrigger(D,I,e,se.name,se)};return n.data.animation.forEach(B),new ah(this,I,f,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,n,l){e>=0&&e<this._microtaskId?this._zone.run(()=>n(l)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(f=>{const[D,I]=f;D(I)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([n,l]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(h.FYo),h.LFG(il),h.LFG(h.R0b))},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac}),i})();class sh{constructor(t,e,n){this.namespaceId=t,this.delegate=e,this.engine=n,this.destroyNode=this.delegate.destroyNode?l=>e.destroyNode(l):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,n,l=!0){this.delegate.insertBefore(t,e,n),this.engine.onInsert(this.namespaceId,e,t,l)}removeChild(t,e,n){this.engine.onRemove(this.namespaceId,e,this.delegate,n)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,n,l){this.delegate.setAttribute(t,e,n,l)}removeAttribute(t,e,n){this.delegate.removeAttribute(t,e,n)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,n,l){this.delegate.setStyle(t,e,n,l)}removeStyle(t,e,n){this.delegate.removeStyle(t,e,n)}setProperty(t,e,n){"@"==e.charAt(0)&&e==oh?this.disableAnimations(t,!!n):this.delegate.setProperty(t,e,n)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,n){return this.delegate.listen(t,e,n)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class ah extends sh{constructor(t,e,n,l){super(e,n,l),this.factory=t,this.namespaceId=e}setProperty(t,e,n){"@"==e.charAt(0)?"."==e.charAt(1)&&e==oh?this.disableAnimations(t,n=void 0===n||!!n):this.engine.process(this.namespaceId,t,e.substr(1),n):this.delegate.setProperty(t,e,n)}listen(t,e,n){if("@"==e.charAt(0)){const l=function Af(i){switch(i){case"body":return document.body;case"document":return document;case"window":return window;default:return i}}(t);let f=e.substr(1),D="";return"@"!=f.charAt(0)&&([f,D]=function If(i){const t=i.indexOf(".");return[i.substring(0,t),i.substr(t+1)]}(f)),this.engine.listen(this.namespaceId,l,f,D,I=>{this.factory.scheduleListenerCallback(I._data||-1,n,I)})}return this.delegate.listen(t,e,n)}}let kf=(()=>{class i extends il{constructor(e,n,l){super(e.body,n,l)}ngOnDestroy(){this.flush()}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(ye),h.LFG(Ki),h.LFG(Zh))},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac}),i})();const ps=new h.OlP("AnimationModuleType"),ap=[{provide:Cu,useClass:dg},{provide:Zh,useFactory:function pg(){return new bf}},{provide:il,useClass:kf},{provide:h.FYo,useFactory:function fg(i,t,e){return new Tf(i,t,e)},deps:[gn,il,h.R0b]}],Rf=[{provide:Ki,useFactory:()=>new op},{provide:ps,useValue:"BrowserAnimations"},...ap],mg=[{provide:Ki,useClass:ir},{provide:ps,useValue:"NoopAnimations"},...ap];let ju=(()=>{class i{static withConfig(e){return{ngModule:i,providers:e.disableAnimations?mg:Rf}}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({providers:Rf,imports:[Us]}),i})();function Ao(i,t=0){return function Pf(i){return!isNaN(parseFloat(i))&&!isNaN(Number(i))}(i)?Number(i):t}function Xi(i){return Array.isArray(i)?i:[i]}function en(i){return null==i?"":"string"==typeof i?i:`${i}px`}function nl(i){return i instanceof h.SBq?i.nativeElement:i}var ki=Y(7579),di=Y(9646),Un=Y(8306),Yl=Y(8421),zr=Y(5577),gg=Y(1144),fs=Y(576),ji=Y(4004);const{isArray:Of}=Array;function Uu(i){return(0,ji.U)(t=>function Ff(i,t){return Of(t)?i(...t):i(t)}(i,t))}const lp=["addListener","removeListener"],Lf=["addEventListener","removeEventListener"],cp=["on","off"];function bo(i,t,e,n){if((0,fs.m)(e)&&(n=e,e=void 0),n)return bo(i,t,e).pipe(Uu(n));const[l,f]=function up(i){return(0,fs.m)(i.addEventListener)&&(0,fs.m)(i.removeEventListener)}(i)?Lf.map(D=>I=>i[D](t,I,e)):function Bf(i){return(0,fs.m)(i.addListener)&&(0,fs.m)(i.removeListener)}(i)?lp.map(Hu(i,t)):function _g(i){return(0,fs.m)(i.on)&&(0,fs.m)(i.off)}(i)?cp.map(Hu(i,t)):[];if(!l&&(0,gg.z)(i))return(0,zr.z)(D=>bo(D,t,e))((0,Yl.Xf)(i));if(!l)throw new TypeError("Invalid event target");return new Un.y(D=>{const I=(...B)=>D.next(1<B.length?B:B[0]);return l(I),()=>f(I)})}function Hu(i,t){return e=>n=>i[e](t,n)}var dp=Y(4408),jo=Y(727);const Lc={schedule(i){let t=requestAnimationFrame,e=cancelAnimationFrame;const{delegate:n}=Lc;n&&(t=n.requestAnimationFrame,e=n.cancelAnimationFrame);const l=t(f=>{e=void 0,i(f)});return new jo.w0(()=>null==e?void 0:e(l))},requestAnimationFrame(...i){const{delegate:t}=Lc;return((null==t?void 0:t.requestAnimationFrame)||requestAnimationFrame)(...i)},cancelAnimationFrame(...i){const{delegate:t}=Lc;return((null==t?void 0:t.cancelAnimationFrame)||cancelAnimationFrame)(...i)},delegate:void 0};var Bc=Y(7565);new class Nc extends Bc.v{flush(t){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:n}=this;let l;t=t||n.shift();do{if(l=t.execute(t.state,t.delay))break}while((t=n[0])&&t.id===e&&n.shift());if(this._active=!1,l){for(;(t=n[0])&&t.id===e&&n.shift();)t.unsubscribe();throw l}}}(class lh extends dp.o{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,n=0){return null!==n&&n>0?super.requestAsyncId(t,e,n):(t.actions.push(this),t._scheduled||(t._scheduled=Lc.requestAnimationFrame(()=>t.flush(void 0))))}recycleAsyncId(t,e,n=0){if(null!=n&&n>0||null==n&&this.delay>0)return super.recycleAsyncId(t,e,n);t.actions.some(l=>l.id===e)||(Lc.cancelAnimationFrame(e),t._scheduled=void 0)}});let Vc,Nf=1;const qu={};function Vf(i){return i in qu&&(delete qu[i],!0)}const hp={setImmediate(i){const t=Nf++;return qu[t]=!0,Vc||(Vc=Promise.resolve()),Vc.then(()=>Vf(t)&&i()),t},clearImmediate(i){Vf(i)}},{setImmediate:ma,clearImmediate:ch}=hp,Yu={setImmediate(...i){const{delegate:t}=Yu;return((null==t?void 0:t.setImmediate)||ma)(...i)},clearImmediate(i){const{delegate:t}=Yu;return((null==t?void 0:t.clearImmediate)||ch)(i)},delegate:void 0};new class Wu extends Bc.v{flush(t){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:n}=this;let l;t=t||n.shift();do{if(l=t.execute(t.state,t.delay))break}while((t=n[0])&&t.id===e&&n.shift());if(this._active=!1,l){for(;(t=n[0])&&t.id===e&&n.shift();)t.unsubscribe();throw l}}}(class yg extends dp.o{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,n=0){return null!==n&&n>0?super.requestAsyncId(t,e,n):(t.actions.push(this),t._scheduled||(t._scheduled=Yu.setImmediate(t.flush.bind(t,void 0))))}recycleAsyncId(t,e,n=0){if(null!=n&&n>0||null==n&&this.delay>0)return super.recycleAsyncId(t,e,n);t.actions.some(l=>l.id===e)||(Yu.clearImmediate(e),t._scheduled=void 0)}});var Zu=Y(4986),ms=Y(4482),Ko=Y(5403),Ku=Y(3532),Xu=Y(1165);function Qu(i,t=Zu.z){return function ga(i){return(0,ms.e)((t,e)=>{let n=!1,l=null,f=null,D=!1;const I=()=>{if(null==f||f.unsubscribe(),f=null,n){n=!1;const Z=l;l=null,e.next(Z)}D&&e.complete()},B=()=>{f=null,D&&e.complete()};t.subscribe((0,Ko.x)(e,Z=>{n=!0,l=Z,f||(0,Yl.Xf)(i(Z)).subscribe(f=(0,Ko.x)(e,I,B))},()=>{D=!0,(!n||!f||f.closed)&&e.complete()}))})}(()=>function uh(i=0,t,e=Zu.P){let n=-1;return null!=t&&((0,Ku.K)(t)?e=t:n=t),new Un.y(l=>{let f=(0,Xu.q)(i)?+i-e.now():i;f<0&&(f=0);let D=0;return e.schedule(function(){l.closed||(l.next(D++),0<=n?this.schedule(void 0,n):l.complete())},f)})}(i,t))}var Kr=Y(9300);let Ju;try{Ju="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(i){Ju=!1}let _a,ol,sl,jr=(()=>{class i{constructor(e){this._platformId=e,this.isBrowser=this._platformId?function co(i){return i===Cl}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!Ju)&&"undefined"!=typeof CSS&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(h.Lbi))},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function gs(i){return function zc(){if(null==_a&&"undefined"!=typeof window)try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>_a=!0}))}finally{_a=_a||!1}return _a}()?i:!!i.capture}function xg(){if(null==ol){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return ol=!1,ol;if("scrollBehavior"in document.documentElement.style)ol=!0;else{const i=Element.prototype.scrollTo;ol=!!i&&!/\{\s*\[native code\]\s*\}/.test(i.toString())}}return ol}function Xo(i){if(function mp(){if(null==sl){const i="undefined"!=typeof document?document.head:null;sl=!(!i||!i.createShadowRoot&&!i.attachShadow)}return sl}()){const t=i.getRootNode?i.getRootNode():null;if("undefined"!=typeof ShadowRoot&&ShadowRoot&&t instanceof ShadowRoot)return t}return null}function td(){let i="undefined"!=typeof document&&document?document.activeElement:null;for(;i&&i.shadowRoot;){const t=i.shadowRoot.activeElement;if(t===i)break;i=t}return i}function ya(i){return i.composedPath?i.composedPath()[0]:i.target}function Qs(){return"undefined"!=typeof __karma__&&!!__karma__||"undefined"!=typeof jasmine&&!!jasmine||"undefined"!=typeof jest&&!!jest||"undefined"!=typeof Mocha&&!!Mocha}const jf=new h.OlP("cdk-dir-doc",{providedIn:"root",factory:function Uf(){return(0,h.f3M)(ye)}}),Cg=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let al=(()=>{class i{constructor(e){if(this.value="ltr",this.change=new h.vpe,e){const l=e.documentElement?e.documentElement.dir:null;this.value=function Hf(i){const t=(null==i?void 0:i.toLowerCase())||"";return"auto"===t&&"undefined"!=typeof navigator&&(null==navigator?void 0:navigator.language)?Cg.test(navigator.language)?"rtl":"ltr":"rtl"===t?"rtl":"ltr"}((e.body?e.body.dir:null)||l||"ltr")}}ngOnDestroy(){this.change.complete()}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(jf,8))},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),ll=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({}),i})(),dh=(()=>{class i{constructor(e,n,l){this._ngZone=e,this._platform=n,this._scrolled=new ki.x,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=l}register(e){this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe(()=>this._scrolled.next(e)))}deregister(e){const n=this.scrollContainers.get(e);n&&(n.unsubscribe(),this.scrollContainers.delete(e))}scrolled(e=20){return this._platform.isBrowser?new Un.y(n=>{this._globalSubscription||this._addGlobalListener();const l=e>0?this._scrolled.pipe(Qu(e)).subscribe(n):this._scrolled.subscribe(n);return this._scrolledCount++,()=>{l.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):(0,di.of)()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((e,n)=>this.deregister(n)),this._scrolled.complete()}ancestorScrolled(e,n){const l=this.getAncestorScrollContainers(e);return this.scrolled(n).pipe((0,Kr.h)(f=>!f||l.indexOf(f)>-1))}getAncestorScrollContainers(e){const n=[];return this.scrollContainers.forEach((l,f)=>{this._scrollableContainsElement(f,e)&&n.push(f)}),n}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(e,n){let l=nl(n),f=e.getElementRef().nativeElement;do{if(l==f)return!0}while(l=l.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>bo(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(h.R0b),h.LFG(jr),h.LFG(ye,8))},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Wl=(()=>{class i{constructor(e,n,l){this._platform=e,this._change=new ki.x,this._changeListener=f=>{this._change.next(f)},this._document=l,n.runOutsideAngular(()=>{if(e.isBrowser){const f=this._getWindow();f.addEventListener("resize",this._changeListener),f.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const e=this._getWindow();e.removeEventListener("resize",this._changeListener),e.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){const e=this.getViewportScrollPosition(),{width:n,height:l}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+l,right:e.left+n,height:l,width:n}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const e=this._document,n=this._getWindow(),l=e.documentElement,f=l.getBoundingClientRect();return{top:-f.top||e.body.scrollTop||n.scrollY||l.scrollTop||0,left:-f.left||e.body.scrollLeft||n.scrollX||l.scrollLeft||0}}change(e=20){return e>0?this._change.pipe(Qu(e)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(jr),h.LFG(h.R0b),h.LFG(ye,8))},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Ur=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({}),i})(),Zl=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[ll,Ur],ll,Ur]}),i})();var Xr=Y(1135);var Ap=Y(4671);function Gr(i,t,e){const n=(0,fs.m)(i)||t||e?{next:i,error:t,complete:e}:i;return n?(0,ms.e)((l,f)=>{var D;null===(D=n.subscribe)||void 0===D||D.call(n);let I=!0;l.subscribe((0,Ko.x)(f,B=>{var Z;null===(Z=n.next)||void 0===Z||Z.call(n,B),f.next(B)},()=>{var B;I=!1,null===(B=n.complete)||void 0===B||B.call(n),f.complete()},B=>{var Z;I=!1,null===(Z=n.error)||void 0===Z||Z.call(n,B),f.error(B)},()=>{var B,Z;I&&(null===(B=n.unsubscribe)||void 0===B||B.call(n)),null===(Z=n.finalize)||void 0===Z||Z.call(n)}))}):Ap.y}Y(8372);var ko=Y(5698),ky=Y(5684),P0=Y(1884),$r=Y(2722);let Ry=(()=>{class i{create(e){return"undefined"==typeof MutationObserver?null:new MutationObserver(e)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),ul=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({providers:[Ry]}),i})(),Fy=(()=>{class i{constructor(e){this._platform=e}isDisabled(e){return e.hasAttribute("disabled")}isVisible(e){return function z0(i){return!!(i.offsetWidth||i.offsetHeight||"function"==typeof i.getClientRects&&i.getClientRects().length)}(e)&&"visible"===getComputedStyle(e).visibility}isTabbable(e){if(!this._platform.isBrowser)return!1;const n=function V0(i){try{return i.frameElement}catch(t){return null}}(function Ny(i){return i.ownerDocument&&i.ownerDocument.defaultView||window}(e));if(n&&(-1===G0(n)||!this.isVisible(n)))return!1;let l=e.nodeName.toLowerCase(),f=G0(e);return e.hasAttribute("contenteditable")?-1!==f:!("iframe"===l||"object"===l||this._platform.WEBKIT&&this._platform.IOS&&!function Bg(i){let t=i.nodeName.toLowerCase(),e="input"===t&&i.type;return"text"===e||"password"===e||"select"===t||"textarea"===t}(e))&&("audio"===l?!!e.hasAttribute("controls")&&-1!==f:"video"===l?-1!==f&&(null!==f||this._platform.FIREFOX||e.hasAttribute("controls")):e.tabIndex>=0)}isFocusable(e,n){return function $0(i){return!function FM(i){return function j0(i){return"input"==i.nodeName.toLowerCase()}(i)&&"hidden"==i.type}(i)&&(function Ly(i){let t=i.nodeName.toLowerCase();return"input"===t||"select"===t||"button"===t||"textarea"===t}(i)||function By(i){return function U0(i){return"a"==i.nodeName.toLowerCase()}(i)&&i.hasAttribute("href")}(i)||i.hasAttribute("contenteditable")||H0(i))}(e)&&!this.isDisabled(e)&&((null==n?void 0:n.ignoreVisibility)||this.isVisible(e))}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(jr))},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function H0(i){if(!i.hasAttribute("tabindex")||void 0===i.tabIndex)return!1;let t=i.getAttribute("tabindex");return!(!t||isNaN(parseInt(t,10)))}function G0(i){if(!H0(i))return null;const t=parseInt(i.getAttribute("tabindex")||"",10);return isNaN(t)?-1:t}class Vy{constructor(t,e,n,l,f=!1){this._element=t,this._checker=e,this._ngZone=n,this._document=l,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,f||this.attachAnchors()}get enabled(){return this._enabled}set enabled(t){this._enabled=t,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}destroy(){const t=this._startAnchor,e=this._endAnchor;t&&(t.removeEventListener("focus",this.startAnchorListener),t.remove()),e&&(e.removeEventListener("focus",this.endAnchorListener),e.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusInitialElement(t)))})}focusFirstTabbableElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusFirstTabbableElement(t)))})}focusLastTabbableElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusLastTabbableElement(t)))})}_getRegionBoundary(t){const e=this._element.querySelectorAll(`[cdk-focus-region-${t}], [cdkFocusRegion${t}], [cdk-focus-${t}]`);return"start"==t?e.length?e[0]:this._getFirstTabbableElement(this._element):e.length?e[e.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(t){const e=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(e){if(!this._checker.isFocusable(e)){const n=this._getFirstTabbableElement(e);return null==n||n.focus(t),!!n}return e.focus(t),!0}return this.focusFirstTabbableElement(t)}focusFirstTabbableElement(t){const e=this._getRegionBoundary("start");return e&&e.focus(t),!!e}focusLastTabbableElement(t){const e=this._getRegionBoundary("end");return e&&e.focus(t),!!e}hasAttached(){return this._hasAttached}_getFirstTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;const e=t.children;for(let n=0;n<e.length;n++){const l=e[n].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(e[n]):null;if(l)return l}return null}_getLastTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;const e=t.children;for(let n=e.length-1;n>=0;n--){const l=e[n].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(e[n]):null;if(l)return l}return null}_createAnchor(){const t=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,t),t.classList.add("cdk-visually-hidden"),t.classList.add("cdk-focus-trap-anchor"),t.setAttribute("aria-hidden","true"),t}_toggleAnchorTabIndex(t,e){t?e.setAttribute("tabindex","0"):e.removeAttribute("tabindex")}toggleAnchors(t){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}_executeOnStable(t){this._ngZone.isStable?t():this._ngZone.onStable.pipe((0,ko.q)(1)).subscribe(t)}}let LM=(()=>{class i{constructor(e,n,l){this._checker=e,this._ngZone=n,this._document=l}create(e,n=!1){return new Vy(e,this._checker,this._ngZone,this._document,n)}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(Fy),h.LFG(h.R0b),h.LFG(ye))},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const jy=new h.OlP("cdk-input-modality-detector-options"),Ng={ignoreKeys:[18,17,224,91,16]},Gc=gs({passive:!0,capture:!0});let K0=(()=>{class i{constructor(e,n,l,f){this._platform=e,this._mostRecentTarget=null,this._modality=new Xr.X(null),this._lastTouchMs=0,this._onKeydown=D=>{var I,B;(null===(B=null===(I=this._options)||void 0===I?void 0:I.ignoreKeys)||void 0===B?void 0:B.some(Z=>Z===D.keyCode))||(this._modality.next("keyboard"),this._mostRecentTarget=ya(D))},this._onMousedown=D=>{Date.now()-this._lastTouchMs<650||(this._modality.next(function zy(i){return 0===i.buttons||0===i.offsetX&&0===i.offsetY}(D)?"keyboard":"mouse"),this._mostRecentTarget=ya(D))},this._onTouchstart=D=>{!function Z0(i){const t=i.touches&&i.touches[0]||i.changedTouches&&i.changedTouches[0];return!(!t||-1!==t.identifier||null!=t.radiusX&&1!==t.radiusX||null!=t.radiusY&&1!==t.radiusY)}(D)?(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=ya(D)):this._modality.next("keyboard")},this._options=Object.assign(Object.assign({},Ng),f),this.modalityDetected=this._modality.pipe((0,ky.T)(1)),this.modalityChanged=this.modalityDetected.pipe((0,P0.x)()),e.isBrowser&&n.runOutsideAngular(()=>{l.addEventListener("keydown",this._onKeydown,Gc),l.addEventListener("mousedown",this._onMousedown,Gc),l.addEventListener("touchstart",this._onTouchstart,Gc)})}get mostRecentModality(){return this._modality.value}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,Gc),document.removeEventListener("mousedown",this._onMousedown,Gc),document.removeEventListener("touchstart",this._onTouchstart,Gc))}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(jr),h.LFG(h.R0b),h.LFG(ye),h.LFG(jy,8))},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const Jf=new h.OlP("cdk-focus-monitor-default-options"),Ql=gs({passive:!0,capture:!0});let ud=(()=>{class i{constructor(e,n,l,f,D){this._ngZone=e,this._platform=n,this._inputModalityDetector=l,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new ki.x,this._rootNodeFocusAndBlurListener=I=>{const B=ya(I),Z="focus"===I.type?this._onFocus:this._onBlur;for(let se=B;se;se=se.parentElement)Z.call(this,I,se)},this._document=f,this._detectionMode=(null==D?void 0:D.detectionMode)||0}monitor(e,n=!1){const l=nl(e);if(!this._platform.isBrowser||1!==l.nodeType)return(0,di.of)(null);const f=Xo(l)||this._getDocument(),D=this._elementInfo.get(l);if(D)return n&&(D.checkChildren=!0),D.subject;const I={checkChildren:n,subject:new ki.x,rootNode:f};return this._elementInfo.set(l,I),this._registerGlobalListeners(I),I.subject}stopMonitoring(e){const n=nl(e),l=this._elementInfo.get(n);l&&(l.subject.complete(),this._setClasses(n),this._elementInfo.delete(n),this._removeGlobalListeners(l))}focusVia(e,n,l){const f=nl(e);f===this._getDocument().activeElement?this._getClosestElementsInfo(f).forEach(([I,B])=>this._originChanged(I,n,B)):(this._setOrigin(n),"function"==typeof f.focus&&f.focus(l))}ngOnDestroy(){this._elementInfo.forEach((e,n)=>this.stopMonitoring(n))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(e){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(e)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:"program"}_shouldBeAttributedToTouch(e){return 1===this._detectionMode||!!(null==e?void 0:e.contains(this._inputModalityDetector._mostRecentTarget))}_setClasses(e,n){e.classList.toggle("cdk-focused",!!n),e.classList.toggle("cdk-touch-focused","touch"===n),e.classList.toggle("cdk-keyboard-focused","keyboard"===n),e.classList.toggle("cdk-mouse-focused","mouse"===n),e.classList.toggle("cdk-program-focused","program"===n)}_setOrigin(e,n=!1){this._ngZone.runOutsideAngular(()=>{this._origin=e,this._originFromTouchInteraction="touch"===e&&n,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(e,n){const l=this._elementInfo.get(n),f=ya(e);!l||!l.checkChildren&&n!==f||this._originChanged(n,this._getFocusOrigin(f),l)}_onBlur(e,n){const l=this._elementInfo.get(n);!l||l.checkChildren&&e.relatedTarget instanceof Node&&n.contains(e.relatedTarget)||(this._setClasses(n),this._emitOrigin(l.subject,null))}_emitOrigin(e,n){this._ngZone.run(()=>e.next(n))}_registerGlobalListeners(e){if(!this._platform.isBrowser)return;const n=e.rootNode,l=this._rootNodeFocusListenerCount.get(n)||0;l||this._ngZone.runOutsideAngular(()=>{n.addEventListener("focus",this._rootNodeFocusAndBlurListener,Ql),n.addEventListener("blur",this._rootNodeFocusAndBlurListener,Ql)}),this._rootNodeFocusListenerCount.set(n,l+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe((0,$r.R)(this._stopInputModalityDetector)).subscribe(f=>{this._setOrigin(f,!0)}))}_removeGlobalListeners(e){const n=e.rootNode;if(this._rootNodeFocusListenerCount.has(n)){const l=this._rootNodeFocusListenerCount.get(n);l>1?this._rootNodeFocusListenerCount.set(n,l-1):(n.removeEventListener("focus",this._rootNodeFocusAndBlurListener,Ql),n.removeEventListener("blur",this._rootNodeFocusAndBlurListener,Ql),this._rootNodeFocusListenerCount.delete(n))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(e,n,l){this._setClasses(e,n),this._emitOrigin(l.subject,n),this._lastFocusOrigin=n}_getClosestElementsInfo(e){const n=[];return this._elementInfo.forEach((l,f)=>{(f===e||l.checkChildren&&f.contains(e))&&n.push([f,l])}),n}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(h.R0b),h.LFG(jr),h.LFG(K0),h.LFG(ye,8),h.LFG(Jf,8))},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const Hy="cdk-high-contrast-black-on-white",Gy="cdk-high-contrast-white-on-black",Ip="cdk-high-contrast-active";let xa=(()=>{class i{constructor(e,n){this._platform=e,this._document=n}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const e=this._document.createElement("div");e.style.backgroundColor="rgb(1,2,3)",e.style.position="absolute",this._document.body.appendChild(e);const n=this._document.defaultView||window,l=n&&n.getComputedStyle?n.getComputedStyle(e):null,f=(l&&l.backgroundColor||"").replace(/ /g,"");switch(e.remove(),f){case"rgb(0,0,0)":return 2;case"rgb(255,255,255)":return 1}return 0}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const e=this._document.body.classList;e.remove(Ip),e.remove(Hy),e.remove(Gy),this._hasCheckedHighContrastMode=!0;const n=this.getHighContrastMode();1===n?(e.add(Ip),e.add(Hy)):2===n&&(e.add(Ip),e.add(Gy))}}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(jr),h.LFG(ye))},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),$c=(()=>{class i{constructor(e){e._applyBodyHighContrastModeCssClasses()}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(xa))},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[ul]]}),i})();var to=Y(8189),qc=Y(3269),Hn=Y(457);function vh(...i){return function dd(){return(0,to.J)(1)}()((0,Hn.D)(i,(0,qc.yG)(i)))}function wa(...i){const t=(0,qc.yG)(i);return(0,ms.e)((e,n)=>{(t?vh(i,e,t):vh(i,e)).subscribe(n)})}const qy=new h.OlP("mat-sanity-checks",{providedIn:"root",factory:function $y(){return!0}});let ii=(()=>{class i{constructor(e,n,l){this._sanityChecks=n,this._document=l,this._hasDoneGlobalChecks=!1,e._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(e){return!Qs()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[e])}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(xa),h.LFG(qy,8),h.LFG(ye))},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[ll],ll]}),i})();function bh(i,t){return class extends i{constructor(...e){super(...e),this.defaultColor=t,this.color=t}get color(){return this._color}set color(e){const n=e||this.defaultColor;n!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),n&&this._elementRef.nativeElement.classList.add(`mat-${n}`),this._color=n)}}}let wh=(()=>{class i{isErrorState(e,n){return!!(e&&e.invalid&&(e.touched||n&&n.submitted))}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),zg=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[ii],ii]}),i})(),ra=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[ii],ii]}),i})(),Ug=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[ii]]}),i})(),Gg=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[ra,Pn,ii,Ug]]}),i})(),Bp=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[Pn,ii,Ur],Ur,ii]}),i})(),nm=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[ii],ii]}),i})();class rm{attach(t){return this._attachedHost=t,t.attach(this)}detach(){let t=this._attachedHost;null!=t&&(this._attachedHost=null,t.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(t){this._attachedHost=t}}class mv extends rm{constructor(t,e,n,l){super(),this.component=t,this.viewContainerRef=e,this.injector=n,this.componentFactoryResolver=l}}class Zg extends rm{constructor(t,e,n){super(),this.templateRef=t,this.viewContainerRef=e,this.context=n}get origin(){return this.templateRef.elementRef}attach(t,e=this.context){return this.context=e,super.attach(t)}detach(){return this.context=void 0,super.detach()}}class Cx extends rm{constructor(t){super(),this.element=t instanceof h.SBq?t.nativeElement:t}}class om{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(t){return t instanceof mv?(this._attachedPortal=t,this.attachComponentPortal(t)):t instanceof Zg?(this._attachedPortal=t,this.attachTemplatePortal(t)):this.attachDomPortal&&t instanceof Cx?(this._attachedPortal=t,this.attachDomPortal(t)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(t){this._disposeFn=t}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class io extends om{constructor(t,e,n,l,f){super(),this.outletElement=t,this._componentFactoryResolver=e,this._appRef=n,this._defaultInjector=l,this.attachDomPortal=D=>{const I=D.element,B=this._document.createComment("dom-portal");I.parentNode.insertBefore(B,I),this.outletElement.appendChild(I),this._attachedPortal=D,super.setDisposeFn(()=>{B.parentNode&&B.parentNode.replaceChild(I,B)})},this._document=f}attachComponentPortal(t){const n=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component);let l;return t.viewContainerRef?(l=t.viewContainerRef.createComponent(n,t.viewContainerRef.length,t.injector||t.viewContainerRef.injector),this.setDisposeFn(()=>l.destroy())):(l=n.create(t.injector||this._defaultInjector||h.zs3.NULL),this._appRef.attachView(l.hostView),this.setDisposeFn(()=>{this._appRef.detachView(l.hostView),l.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(l)),this._attachedPortal=t,l}attachTemplatePortal(t){let e=t.viewContainerRef,n=e.createEmbeddedView(t.templateRef,t.context);return n.rootNodes.forEach(l=>this.outletElement.appendChild(l)),n.detectChanges(),this.setDisposeFn(()=>{let l=e.indexOf(n);-1!==l&&e.remove(l)}),this._attachedPortal=t,n}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(t){return t.hostView.rootNodes[0]}}let Kg=(()=>{class i extends om{constructor(e,n,l){super(),this._componentFactoryResolver=e,this._viewContainerRef=n,this._isInitialized=!1,this.attached=new h.vpe,this.attachDomPortal=f=>{const D=f.element,I=this._document.createComment("dom-portal");f.setAttachedHost(this),D.parentNode.insertBefore(I,D),this._getRootNode().appendChild(D),this._attachedPortal=f,super.setDisposeFn(()=>{I.parentNode&&I.parentNode.replaceChild(D,I)})},this._document=l}get portal(){return this._attachedPortal}set portal(e){this.hasAttached()&&!e&&!this._isInitialized||(this.hasAttached()&&super.detach(),e&&super.attach(e),this._attachedPortal=e||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedPortal=null,this._attachedRef=null}attachComponentPortal(e){e.setAttachedHost(this);const n=null!=e.viewContainerRef?e.viewContainerRef:this._viewContainerRef,f=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component),D=n.createComponent(f,n.length,e.injector||n.injector);return n!==this._viewContainerRef&&this._getRootNode().appendChild(D.hostView.rootNodes[0]),super.setDisposeFn(()=>D.destroy()),this._attachedPortal=e,this._attachedRef=D,this.attached.emit(D),D}attachTemplatePortal(e){e.setAttachedHost(this);const n=this._viewContainerRef.createEmbeddedView(e.templateRef,e.context);return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=e,this._attachedRef=n,this.attached.emit(n),n}_getRootNode(){const e=this._viewContainerRef.element.nativeElement;return e.nodeType===e.ELEMENT_NODE?e:e.parentNode}}return i.\u0275fac=function(e){return new(e||i)(h.Y36(h._Vd),h.Y36(h.s_b),h.Y36(ye))},i.\u0275dir=h.lG2({type:i,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[h.qOj]}),i})(),ec=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({}),i})();var ws=Y(6451);const gv=xg();class Ex{constructor(t,e){this._viewportRuler=t,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=e}attach(){}enable(){if(this._canBeEnabled()){const t=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=t.style.left||"",this._previousHTMLStyles.top=t.style.top||"",t.style.left=en(-this._previousScrollPosition.left),t.style.top=en(-this._previousScrollPosition.top),t.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const t=this._document.documentElement,n=t.style,l=this._document.body.style,f=n.scrollBehavior||"",D=l.scrollBehavior||"";this._isEnabled=!1,n.left=this._previousHTMLStyles.left,n.top=this._previousHTMLStyles.top,t.classList.remove("cdk-global-scrollblock"),gv&&(n.scrollBehavior=l.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),gv&&(n.scrollBehavior=f,l.scrollBehavior=D)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const e=this._document.body,n=this._viewportRuler.getViewportSize();return e.scrollHeight>n.height||e.scrollWidth>n.width}}class Tx{constructor(t,e,n,l){this._scrollDispatcher=t,this._ngZone=e,this._viewportRuler=n,this._config=l,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(t){this._overlayRef=t}enable(){if(this._scrollSubscription)return;const t=this._scrollDispatcher.scrolled(0);this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=t.subscribe(()=>{const e=this._viewportRuler.getViewportScrollPosition().top;Math.abs(e-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=t.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class Xg{enable(){}disable(){}attach(){}}function _v(i,t){return t.some(e=>i.bottom<e.top||i.top>e.bottom||i.right<e.left||i.left>e.right)}function sm(i,t){return t.some(e=>i.top<e.top||i.bottom>e.bottom||i.left<e.left||i.right>e.right)}class Qg{constructor(t,e,n,l){this._scrollDispatcher=t,this._viewportRuler=e,this._ngZone=n,this._config=l,this._scrollSubscription=null}attach(t){this._overlayRef=t}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const e=this._overlayRef.overlayElement.getBoundingClientRect(),{width:n,height:l}=this._viewportRuler.getViewportSize();_v(e,[{width:n,height:l,bottom:l,right:n,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let pl=(()=>{class i{constructor(e,n,l,f){this._scrollDispatcher=e,this._viewportRuler=n,this._ngZone=l,this.noop=()=>new Xg,this.close=D=>new Tx(this._scrollDispatcher,this._ngZone,this._viewportRuler,D),this.block=()=>new Ex(this._viewportRuler,this._document),this.reposition=D=>new Qg(this._scrollDispatcher,this._viewportRuler,this._ngZone,D),this._document=f}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(dh),h.LFG(Wl),h.LFG(h.R0b),h.LFG(ye))},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class Jg{constructor(t){if(this.scrollStrategy=new Xg,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,t){const e=Object.keys(t);for(const n of e)void 0!==t[n]&&(this[n]=t[n])}}}class Ca{constructor(t,e){this.connectionPair=t,this.scrollableViewProperties=e}}class yv{constructor(t,e,n,l,f,D,I,B,Z){this._portalOutlet=t,this._host=e,this._pane=n,this._config=l,this._ngZone=f,this._keyboardDispatcher=D,this._document=I,this._location=B,this._outsideClickDispatcher=Z,this._backdropElement=null,this._backdropClick=new ki.x,this._attachments=new ki.x,this._detachments=new ki.x,this._locationChanges=jo.w0.EMPTY,this._backdropClickHandler=se=>this._backdropClick.next(se),this._backdropTransitionendHandler=se=>{this._disposeBackdrop(se.target)},this._keydownEvents=new ki.x,this._outsidePointerEvents=new ki.x,l.scrollStrategy&&(this._scrollStrategy=l.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=l.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(t){let e=this._portalOutlet.attach(t);return!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host),this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe((0,ko.q)(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),e}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const t=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),t}dispose(){var t;const e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),null===(t=this._host)||void 0===t||t.remove(),this._previousHostParent=this._pane=this._host=null,e&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(t){t!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=t,this.hasAttached()&&(t.attach(this),this.updatePosition()))}updateSize(t){this._config=Object.assign(Object.assign({},this._config),t),this._updateElementSize()}setDirection(t){this._config=Object.assign(Object.assign({},this._config),{direction:t}),this._updateElementDirection()}addPanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!0)}removePanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!1)}getDirection(){const t=this._config.direction;return t?"string"==typeof t?t:t.value:"ltr"}updateScrollStrategy(t){t!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=t,this.hasAttached()&&(t.attach(this),t.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const t=this._pane.style;t.width=en(this._config.width),t.height=en(this._config.height),t.minWidth=en(this._config.minWidth),t.minHeight=en(this._config.minHeight),t.maxWidth=en(this._config.maxWidth),t.maxHeight=en(this._config.maxHeight)}_togglePointerEvents(t){this._pane.style.pointerEvents=t?"":"none"}_attachBackdrop(){const t="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),"undefined"!=typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(t)})}):this._backdropElement.classList.add(t)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const t=this._backdropElement;!t||(t.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{t.addEventListener("transitionend",this._backdropTransitionendHandler)}),t.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(t)},500)))}_toggleClasses(t,e,n){const l=Xi(e||[]).filter(f=>!!f);l.length&&(n?t.classList.add(...l):t.classList.remove(...l))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const t=this._ngZone.onStable.pipe((0,$r.R)((0,ws.T)(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),t.unsubscribe())})})}_disposeScrollStrategy(){const t=this._scrollStrategy;t&&(t.disable(),t.detach&&t.detach())}_disposeBackdrop(t){t&&(t.removeEventListener("click",this._backdropClickHandler),t.removeEventListener("transitionend",this._backdropTransitionendHandler),t.remove(),this._backdropElement===t&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}let e_=(()=>{class i{constructor(e,n){this._platform=n,this._document=e}ngOnDestroy(){var e;null===(e=this._containerElement)||void 0===e||e.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const e="cdk-overlay-container";if(this._platform.isBrowser||Qs()){const l=this._document.querySelectorAll(`.${e}[platform="server"], .${e}[platform="test"]`);for(let f=0;f<l.length;f++)l[f].remove()}const n=this._document.createElement("div");n.classList.add(e),Qs()?n.setAttribute("platform","test"):this._platform.isBrowser||n.setAttribute("platform","server"),this._document.body.appendChild(n),this._containerElement=n}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(ye),h.LFG(jr))},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const vv="cdk-overlay-connected-position-bounding-box",Ix=/([A-Za-z%]+)$/;class kx{constructor(t,e,n,l,f){this._viewportRuler=e,this._document=n,this._platform=l,this._overlayContainer=f,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new ki.x,this._resizeSubscription=jo.w0.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(t)}get positions(){return this._preferredPositions}attach(t){this._validatePositions(),t.hostElement.classList.add(vv),this._overlayRef=t,this._boundingBox=t.hostElement,this._pane=t.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._originRect,e=this._overlayRect,n=this._viewportRect,l=this._containerRect,f=[];let D;for(let I of this._preferredPositions){let B=this._getOriginPoint(t,l,I),Z=this._getOverlayPoint(B,e,I),se=this._getOverlayFit(Z,e,n,I);if(se.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(I,B);this._canFitWithFlexibleDimensions(se,Z,n)?f.push({position:I,origin:B,overlayRect:e,boundingBoxRect:this._calculateBoundingBoxRect(B,I)}):(!D||D.overlayFit.visibleArea<se.visibleArea)&&(D={overlayFit:se,overlayPoint:Z,originPoint:B,position:I,overlayRect:e})}if(f.length){let I=null,B=-1;for(const Z of f){const se=Z.boundingBoxRect.width*Z.boundingBoxRect.height*(Z.position.weight||1);se>B&&(B=se,I=Z)}return this._isPushed=!1,void this._applyPosition(I.position,I.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(D.position,D.originPoint);this._applyPosition(D.position,D.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&ic(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(vv),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const t=this._lastPosition;if(t){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const e=this._getOriginPoint(this._originRect,this._containerRect,t);this._applyPosition(t,e)}else this.apply()}withScrollableContainers(t){return this._scrollables=t,this}withPositions(t){return this._preferredPositions=t,-1===t.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(t){return this._viewportMargin=t,this}withFlexibleDimensions(t=!0){return this._hasFlexibleDimensions=t,this}withGrowAfterOpen(t=!0){return this._growAfterOpen=t,this}withPush(t=!0){return this._canPush=t,this}withLockedPosition(t=!0){return this._positionLocked=t,this}setOrigin(t){return this._origin=t,this}withDefaultOffsetX(t){return this._offsetX=t,this}withDefaultOffsetY(t){return this._offsetY=t,this}withTransformOriginOn(t){return this._transformOriginSelector=t,this}_getOriginPoint(t,e,n){let l,f;if("center"==n.originX)l=t.left+t.width/2;else{const D=this._isRtl()?t.right:t.left,I=this._isRtl()?t.left:t.right;l="start"==n.originX?D:I}return e.left<0&&(l-=e.left),f="center"==n.originY?t.top+t.height/2:"top"==n.originY?t.top:t.bottom,e.top<0&&(f-=e.top),{x:l,y:f}}_getOverlayPoint(t,e,n){let l,f;return l="center"==n.overlayX?-e.width/2:"start"===n.overlayX?this._isRtl()?-e.width:0:this._isRtl()?0:-e.width,f="center"==n.overlayY?-e.height/2:"top"==n.overlayY?0:-e.height,{x:t.x+l,y:t.y+f}}_getOverlayFit(t,e,n,l){const f=bv(e);let{x:D,y:I}=t,B=this._getOffset(l,"x"),Z=this._getOffset(l,"y");B&&(D+=B),Z&&(I+=Z);let qe=0-I,it=I+f.height-n.height,bt=this._subtractOverflows(f.width,0-D,D+f.width-n.width),ti=this._subtractOverflows(f.height,qe,it),yi=bt*ti;return{visibleArea:yi,isCompletelyWithinViewport:f.width*f.height===yi,fitsInViewportVertically:ti===f.height,fitsInViewportHorizontally:bt==f.width}}_canFitWithFlexibleDimensions(t,e,n){if(this._hasFlexibleDimensions){const l=n.bottom-e.y,f=n.right-e.x,D=Ch(this._overlayRef.getConfig().minHeight),I=Ch(this._overlayRef.getConfig().minWidth),Z=t.fitsInViewportHorizontally||null!=I&&I<=f;return(t.fitsInViewportVertically||null!=D&&D<=l)&&Z}return!1}_pushOverlayOnScreen(t,e,n){if(this._previousPushAmount&&this._positionLocked)return{x:t.x+this._previousPushAmount.x,y:t.y+this._previousPushAmount.y};const l=bv(e),f=this._viewportRect,D=Math.max(t.x+l.width-f.width,0),I=Math.max(t.y+l.height-f.height,0),B=Math.max(f.top-n.top-t.y,0),Z=Math.max(f.left-n.left-t.x,0);let se=0,ge=0;return se=l.width<=f.width?Z||-D:t.x<this._viewportMargin?f.left-n.left-t.x:0,ge=l.height<=f.height?B||-I:t.y<this._viewportMargin?f.top-n.top-t.y:0,this._previousPushAmount={x:se,y:ge},{x:t.x+se,y:t.y+ge}}_applyPosition(t,e){if(this._setTransformOrigin(t),this._setOverlayElementStyles(e,t),this._setBoundingBoxStyles(e,t),t.panelClass&&this._addPanelClasses(t.panelClass),this._lastPosition=t,this._positionChanges.observers.length){const n=this._getScrollVisibility(),l=new Ca(t,n);this._positionChanges.next(l)}this._isInitialRender=!1}_setTransformOrigin(t){if(!this._transformOriginSelector)return;const e=this._boundingBox.querySelectorAll(this._transformOriginSelector);let n,l=t.overlayY;n="center"===t.overlayX?"center":this._isRtl()?"start"===t.overlayX?"right":"left":"start"===t.overlayX?"left":"right";for(let f=0;f<e.length;f++)e[f].style.transformOrigin=`${n} ${l}`}_calculateBoundingBoxRect(t,e){const n=this._viewportRect,l=this._isRtl();let f,D,I,se,ge,qe;if("top"===e.overlayY)D=t.y,f=n.height-D+this._viewportMargin;else if("bottom"===e.overlayY)I=n.height-t.y+2*this._viewportMargin,f=n.height-I+this._viewportMargin;else{const it=Math.min(n.bottom-t.y+n.top,t.y),bt=this._lastBoundingBoxSize.height;f=2*it,D=t.y-it,f>bt&&!this._isInitialRender&&!this._growAfterOpen&&(D=t.y-bt/2)}if("end"===e.overlayX&&!l||"start"===e.overlayX&&l)qe=n.width-t.x+this._viewportMargin,se=t.x-this._viewportMargin;else if("start"===e.overlayX&&!l||"end"===e.overlayX&&l)ge=t.x,se=n.right-t.x;else{const it=Math.min(n.right-t.x+n.left,t.x),bt=this._lastBoundingBoxSize.width;se=2*it,ge=t.x-it,se>bt&&!this._isInitialRender&&!this._growAfterOpen&&(ge=t.x-bt/2)}return{top:D,left:ge,bottom:I,right:qe,width:se,height:f}}_setBoundingBoxStyles(t,e){const n=this._calculateBoundingBoxRect(t,e);!this._isInitialRender&&!this._growAfterOpen&&(n.height=Math.min(n.height,this._lastBoundingBoxSize.height),n.width=Math.min(n.width,this._lastBoundingBoxSize.width));const l={};if(this._hasExactPosition())l.top=l.left="0",l.bottom=l.right=l.maxHeight=l.maxWidth="",l.width=l.height="100%";else{const f=this._overlayRef.getConfig().maxHeight,D=this._overlayRef.getConfig().maxWidth;l.height=en(n.height),l.top=en(n.top),l.bottom=en(n.bottom),l.width=en(n.width),l.left=en(n.left),l.right=en(n.right),l.alignItems="center"===e.overlayX?"center":"end"===e.overlayX?"flex-end":"flex-start",l.justifyContent="center"===e.overlayY?"center":"bottom"===e.overlayY?"flex-end":"flex-start",f&&(l.maxHeight=en(f)),D&&(l.maxWidth=en(D))}this._lastBoundingBoxSize=n,ic(this._boundingBox.style,l)}_resetBoundingBoxStyles(){ic(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){ic(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(t,e){const n={},l=this._hasExactPosition(),f=this._hasFlexibleDimensions,D=this._overlayRef.getConfig();if(l){const se=this._viewportRuler.getViewportScrollPosition();ic(n,this._getExactOverlayY(e,t,se)),ic(n,this._getExactOverlayX(e,t,se))}else n.position="static";let I="",B=this._getOffset(e,"x"),Z=this._getOffset(e,"y");B&&(I+=`translateX(${B}px) `),Z&&(I+=`translateY(${Z}px)`),n.transform=I.trim(),D.maxHeight&&(l?n.maxHeight=en(D.maxHeight):f&&(n.maxHeight="")),D.maxWidth&&(l?n.maxWidth=en(D.maxWidth):f&&(n.maxWidth="")),ic(this._pane.style,n)}_getExactOverlayY(t,e,n){let l={top:"",bottom:""},f=this._getOverlayPoint(e,this._overlayRect,t);return this._isPushed&&(f=this._pushOverlayOnScreen(f,this._overlayRect,n)),"bottom"===t.overlayY?l.bottom=this._document.documentElement.clientHeight-(f.y+this._overlayRect.height)+"px":l.top=en(f.y),l}_getExactOverlayX(t,e,n){let D,l={left:"",right:""},f=this._getOverlayPoint(e,this._overlayRect,t);return this._isPushed&&(f=this._pushOverlayOnScreen(f,this._overlayRect,n)),D=this._isRtl()?"end"===t.overlayX?"left":"right":"end"===t.overlayX?"right":"left","right"===D?l.right=this._document.documentElement.clientWidth-(f.x+this._overlayRect.width)+"px":l.left=en(f.x),l}_getScrollVisibility(){const t=this._getOriginRect(),e=this._pane.getBoundingClientRect(),n=this._scrollables.map(l=>l.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:sm(t,n),isOriginOutsideView:_v(t,n),isOverlayClipped:sm(e,n),isOverlayOutsideView:_v(e,n)}}_subtractOverflows(t,...e){return e.reduce((n,l)=>n-Math.max(l,0),t)}_getNarrowedViewportRect(){const t=this._document.documentElement.clientWidth,e=this._document.documentElement.clientHeight,n=this._viewportRuler.getViewportScrollPosition();return{top:n.top+this._viewportMargin,left:n.left+this._viewportMargin,right:n.left+t-this._viewportMargin,bottom:n.top+e-this._viewportMargin,width:t-2*this._viewportMargin,height:e-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(t,e){return"x"===e?null==t.offsetX?this._offsetX:t.offsetX:null==t.offsetY?this._offsetY:t.offsetY}_validatePositions(){}_addPanelClasses(t){this._pane&&Xi(t).forEach(e=>{""!==e&&-1===this._appliedPanelClasses.indexOf(e)&&(this._appliedPanelClasses.push(e),this._pane.classList.add(e))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(t=>{this._pane.classList.remove(t)}),this._appliedPanelClasses=[])}_getOriginRect(){const t=this._origin;if(t instanceof h.SBq)return t.nativeElement.getBoundingClientRect();if(t instanceof Element)return t.getBoundingClientRect();const e=t.width||0,n=t.height||0;return{top:t.y,bottom:t.y+n,left:t.x,right:t.x+e,height:n,width:e}}}function ic(i,t){for(let e in t)t.hasOwnProperty(e)&&(i[e]=t[e]);return i}function Ch(i){if("number"!=typeof i&&null!=i){const[t,e]=i.split(Ix);return e&&"px"!==e?null:parseFloat(t)}return i||null}function bv(i){return{top:Math.floor(i.top),right:Math.floor(i.right),bottom:Math.floor(i.bottom),left:Math.floor(i.left),width:Math.floor(i.width),height:Math.floor(i.height)}}const t_="cdk-global-overlay-wrapper";class Rx{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._leftOffset="",this._rightOffset="",this._alignItems="",this._justifyContent="",this._width="",this._height=""}attach(t){const e=t.getConfig();this._overlayRef=t,this._width&&!e.width&&t.updateSize({width:this._width}),this._height&&!e.height&&t.updateSize({height:this._height}),t.hostElement.classList.add(t_),this._isDisposed=!1}top(t=""){return this._bottomOffset="",this._topOffset=t,this._alignItems="flex-start",this}left(t=""){return this._rightOffset="",this._leftOffset=t,this._justifyContent="flex-start",this}bottom(t=""){return this._topOffset="",this._bottomOffset=t,this._alignItems="flex-end",this}right(t=""){return this._leftOffset="",this._rightOffset=t,this._justifyContent="flex-end",this}width(t=""){return this._overlayRef?this._overlayRef.updateSize({width:t}):this._width=t,this}height(t=""){return this._overlayRef?this._overlayRef.updateSize({height:t}):this._height=t,this}centerHorizontally(t=""){return this.left(t),this._justifyContent="center",this}centerVertically(t=""){return this.top(t),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement.style,n=this._overlayRef.getConfig(),{width:l,height:f,maxWidth:D,maxHeight:I}=n,B=!("100%"!==l&&"100vw"!==l||D&&"100%"!==D&&"100vw"!==D),Z=!("100%"!==f&&"100vh"!==f||I&&"100%"!==I&&"100vh"!==I);t.position=this._cssPosition,t.marginLeft=B?"0":this._leftOffset,t.marginTop=Z?"0":this._topOffset,t.marginBottom=this._bottomOffset,t.marginRight=this._rightOffset,B?e.justifyContent="flex-start":"center"===this._justifyContent?e.justifyContent="center":"rtl"===this._overlayRef.getConfig().direction?"flex-start"===this._justifyContent?e.justifyContent="flex-end":"flex-end"===this._justifyContent&&(e.justifyContent="flex-start"):e.justifyContent=this._justifyContent,e.alignItems=Z?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement,n=e.style;e.classList.remove(t_),n.justifyContent=n.alignItems=t.marginTop=t.marginBottom=t.marginLeft=t.marginRight=t.position="",this._overlayRef=null,this._isDisposed=!0}}let xv=(()=>{class i{constructor(e,n,l,f){this._viewportRuler=e,this._document=n,this._platform=l,this._overlayContainer=f}global(){return new Rx}flexibleConnectedTo(e){return new kx(e,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(Wl),h.LFG(ye),h.LFG(jr),h.LFG(e_))},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),i_=(()=>{class i{constructor(e){this._attachedOverlays=[],this._document=e}ngOnDestroy(){this.detach()}add(e){this.remove(e),this._attachedOverlays.push(e)}remove(e){const n=this._attachedOverlays.indexOf(e);n>-1&&this._attachedOverlays.splice(n,1),0===this._attachedOverlays.length&&this.detach()}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(ye))},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),am=(()=>{class i extends i_{constructor(e,n){super(e),this._ngZone=n,this._keydownListener=l=>{const f=this._attachedOverlays;for(let D=f.length-1;D>-1;D--)if(f[D]._keydownEvents.observers.length>0){const I=f[D]._keydownEvents;this._ngZone?this._ngZone.run(()=>I.next(l)):I.next(l);break}}}add(e){super.add(e),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(ye),h.LFG(h.R0b,8))},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Px=(()=>{class i extends i_{constructor(e,n,l){super(e),this._platform=n,this._ngZone=l,this._cursorStyleIsSet=!1,this._pointerDownListener=f=>{this._pointerDownEventTarget=ya(f)},this._clickListener=f=>{const D=ya(f),I="click"===f.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:D;this._pointerDownEventTarget=null;const B=this._attachedOverlays.slice();for(let Z=B.length-1;Z>-1;Z--){const se=B[Z];if(se._outsidePointerEvents.observers.length<1||!se.hasAttached())continue;if(se.overlayElement.contains(D)||se.overlayElement.contains(I))break;const ge=se._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>ge.next(f)):ge.next(f)}}}add(e){if(super.add(e),!this._isAttached){const n=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(n)):this._addEventListeners(n),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=n.style.cursor,n.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const e=this._document.body;e.removeEventListener("pointerdown",this._pointerDownListener,!0),e.removeEventListener("click",this._clickListener,!0),e.removeEventListener("auxclick",this._clickListener,!0),e.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(e.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(e){e.addEventListener("pointerdown",this._pointerDownListener,!0),e.addEventListener("click",this._clickListener,!0),e.addEventListener("auxclick",this._clickListener,!0),e.addEventListener("contextmenu",this._clickListener,!0)}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(ye),h.LFG(jr),h.LFG(h.R0b,8))},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),wv=0,Ma=(()=>{class i{constructor(e,n,l,f,D,I,B,Z,se,ge,qe){this.scrollStrategies=e,this._overlayContainer=n,this._componentFactoryResolver=l,this._positionBuilder=f,this._keyboardDispatcher=D,this._injector=I,this._ngZone=B,this._document=Z,this._directionality=se,this._location=ge,this._outsideClickDispatcher=qe}create(e){const n=this._createHostElement(),l=this._createPaneElement(n),f=this._createPortalOutlet(l),D=new Jg(e);return D.direction=D.direction||this._directionality.value,new yv(f,n,l,D,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher)}position(){return this._positionBuilder}_createPaneElement(e){const n=this._document.createElement("div");return n.id="cdk-overlay-"+wv++,n.classList.add("cdk-overlay-pane"),e.appendChild(n),n}_createHostElement(){const e=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(e),e}_createPortalOutlet(e){return this._appRef||(this._appRef=this._injector.get(h.z2F)),new io(e,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(pl),h.LFG(e_),h.LFG(h._Vd),h.LFG(xv),h.LFG(am),h.LFG(h.zs3),h.LFG(h.R0b),h.LFG(ye),h.LFG(al),h.LFG(ut),h.LFG(Px))},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac}),i})();const Ev={provide:new h.OlP("cdk-connected-overlay-scroll-strategy"),deps:[Ma],useFactory:function Dv(i){return()=>i.scrollStrategies.reposition()}};let nc=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({providers:[Ma,Ev],imports:[[ll,ec,Zl],Zl]}),i})();const Iv={provide:new h.OlP("mat-menu-scroll-strategy"),deps:[Ma],useFactory:function Av(i){return()=>i.scrollStrategies.reposition()}};let Np=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({providers:[Iv],imports:[[Pn,ii,ra,nc],Ur,ii]}),i})();function fd(i,t){const e=(0,fs.m)(i)?i:()=>i,n=l=>l.error(e());return new Un.y(t?l=>t.schedule(n,0,l):n)}const{isArray:md}=Array,{getPrototypeOf:$x,prototype:qx,keys:Mh}=Object;var rc=Y(262);Y(3099);var Dh=Y(4351);let gm=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[ii],ii]}),i})(),_m=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[ii],ii]}),i})(),ef=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[zg,ra,ii,Ug,Pn],zg,ii,Ug,_m]}),i})();function tf(i){return new Un.y(t=>{(0,Yl.Xf)(i()).subscribe(t)})}let Bm=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[Pn,ii,ul],ii]}),i})();var _l=Y(3900);Y(5032);const CC={provide:new h.OlP("mat-autocomplete-scroll-strategy"),deps:[Ma],useFactory:function Nb(i){return()=>i.scrollStrategies.reposition()}};let zb=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({providers:[CC],imports:[[nc,Gg,ii,Pn],Ur,Gg,ii]}),i})(),RC=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({}),i})(),PC=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[ra,ii,ul,RC],ii,RC]}),i})(),o=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[ra,ii],ii]}),i})(),C=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({}),i})(),ve=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({providers:[wh],imports:[[C,Bm,ii],C,Bm]}),i})(),kT=(()=>{class i{constructor(){this.changes=new ki.x,this.calendarLabel="Calendar",this.openCalendarLabel="Open calendar",this.closeCalendarLabel="Close calendar",this.prevMonthLabel="Previous month",this.nextMonthLabel="Next month",this.prevYearLabel="Previous year",this.nextYearLabel="Next year",this.prevMultiYearLabel="Previous 24 years",this.nextMultiYearLabel="Next 24 years",this.switchToMonthViewLabel="Choose date",this.switchToMultiYearViewLabel="Choose month and year"}formatYearRange(e,n){return`${e} \u2013 ${n}`}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const OT={provide:new h.OlP("mat-datepicker-scroll-strategy"),deps:[Ma],useFactory:function PT(i){return()=>i.scrollStrategies.reposition()}};let F1=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({providers:[kT,OT],imports:[[Pn,o,nc,$c,ec,ii],Ur]}),i})(),V1=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[ra,ii],ii]}),i})();const tA={provide:new h.OlP("mat-select-scroll-strategy"),deps:[Ma],useFactory:function eA(i){return()=>i.scrollStrategies.reposition()}};let OC=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({providers:[tA],imports:[[Pn,nc,Gg,ii],Ur,Bm,Gg,ii]}),i})(),H1=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[Pn,ii],ii]}),i})(),G1=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({}),i})(),$1=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[G1,ra,ii,ul],G1,ii]}),i})(),q1=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[ii],ii]}),i})(),DA=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({}),i})(),W1=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[Pn,ii,DA,ec]]}),i})(),K1=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[zg,ii],zg,ii]}),i})(),TA=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[ll]]}),i})(),LC=(()=>{class i{constructor(){this.changes=new ki.x,this.optionalLabel="Optional",this.completedLabel="Completed",this.editableLabel="Editable"}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const VA={provide:LC,deps:[[new h.FiY,new h.tp0,LC]],useFactory:function NA(i){return i||new LC}};let Q1=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({providers:[VA,wh],imports:[[ii,Pn,ec,o,TA,gm,ra],ii]}),i})(),J1=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[Pn,ii,ec,ra,ul,$c],ii]}),i})(),WA=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({}),i})(),eE=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[WA,ii],ii]}),i})(),oE=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[ii,ra],ii]}),i})(),sE=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[$c,ii],ii]}),i})();const uE=new h.OlP("mat-chips-default-options");let dE=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({providers:[wh,{provide:uE,useValue:{separatorKeyCodes:[13]}}],imports:[[ii]]}),i})();function bI(i,t){if(1&i&&(h.O4$(),h._UZ(0,"circle",4)),2&i){const e=h.oxw(),n=h.MAs(1);h.Udp("animation-name","mat-progress-spinner-stroke-rotate-"+e._spinnerAnimationLabel)("stroke-dashoffset",e._getStrokeDashOffset(),"px")("stroke-dasharray",e._getStrokeCircumference(),"px")("stroke-width",e._getCircleStrokeWidth(),"%")("transform-origin",e._getCircleTransformOrigin(n)),h.uIk("r",e._getCircleRadius())}}function xI(i,t){if(1&i&&(h.O4$(),h._UZ(0,"circle",4)),2&i){const e=h.oxw(),n=h.MAs(1);h.Udp("stroke-dashoffset",e._getStrokeDashOffset(),"px")("stroke-dasharray",e._getStrokeCircumference(),"px")("stroke-width",e._getCircleStrokeWidth(),"%")("transform-origin",e._getCircleTransformOrigin(n)),h.uIk("r",e._getCircleRadius())}}const CI=bh(class{constructor(i){this._elementRef=i}},"primary"),MI=new h.OlP("mat-progress-spinner-default-options",{providedIn:"root",factory:function DI(){return{diameter:100}}});class Oh extends CI{constructor(t,e,n,l,f,D,I,B){super(t),this._document=n,this._diameter=100,this._value=0,this._resizeSubscription=jo.w0.EMPTY,this.mode="determinate";const Z=Oh._diameters;this._spinnerAnimationLabel=this._getSpinnerAnimationLabel(),Z.has(n.head)||Z.set(n.head,new Set([100])),this._noopAnimations="NoopAnimations"===l&&!!f&&!f._forceAnimations,"mat-spinner"===t.nativeElement.nodeName.toLowerCase()&&(this.mode="indeterminate"),f&&(f.diameter&&(this.diameter=f.diameter),f.strokeWidth&&(this.strokeWidth=f.strokeWidth)),e.isBrowser&&e.SAFARI&&I&&D&&B&&(this._resizeSubscription=I.change(150).subscribe(()=>{"indeterminate"===this.mode&&B.run(()=>D.markForCheck())}))}get diameter(){return this._diameter}set diameter(t){this._diameter=Ao(t),this._spinnerAnimationLabel=this._getSpinnerAnimationLabel(),this._styleRoot&&this._attachStyleNode()}get strokeWidth(){return this._strokeWidth||this.diameter/10}set strokeWidth(t){this._strokeWidth=Ao(t)}get value(){return"determinate"===this.mode?this._value:0}set value(t){this._value=Math.max(0,Math.min(100,Ao(t)))}ngOnInit(){const t=this._elementRef.nativeElement;this._styleRoot=Xo(t)||this._document.head,this._attachStyleNode(),t.classList.add("mat-progress-spinner-indeterminate-animation")}ngOnDestroy(){this._resizeSubscription.unsubscribe()}_getCircleRadius(){return(this.diameter-10)/2}_getViewBox(){const t=2*this._getCircleRadius()+this.strokeWidth;return`0 0 ${t} ${t}`}_getStrokeCircumference(){return 2*Math.PI*this._getCircleRadius()}_getStrokeDashOffset(){return"determinate"===this.mode?this._getStrokeCircumference()*(100-this._value)/100:null}_getCircleStrokeWidth(){return this.strokeWidth/this.diameter*100}_getCircleTransformOrigin(t){var e;const n=50*(null!==(e=t.currentScale)&&void 0!==e?e:1);return`${n}% ${n}%`}_attachStyleNode(){const t=this._styleRoot,e=this._diameter,n=Oh._diameters;let l=n.get(t);if(!l||!l.has(e)){const f=this._document.createElement("style");f.setAttribute("mat-spinner-animation",this._spinnerAnimationLabel),f.textContent=this._getAnimationText(),t.appendChild(f),l||(l=new Set,n.set(t,l)),l.add(e)}}_getAnimationText(){const t=this._getStrokeCircumference();return"\n @keyframes mat-progress-spinner-stroke-rotate-DIAMETER {\n    0%      { stroke-dashoffset: START_VALUE;  transform: rotate(0); }\n    12.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(0); }\n    12.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(72.5deg); }\n    25%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(72.5deg); }\n\n    25.0001%   { stroke-dashoffset: START_VALUE;  transform: rotate(270deg); }\n    37.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(270deg); }\n    37.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(161.5deg); }\n    50%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(161.5deg); }\n\n    50.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(180deg); }\n    62.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(180deg); }\n    62.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(251.5deg); }\n    75%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(251.5deg); }\n\n    75.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(90deg); }\n    87.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(90deg); }\n    87.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(341.5deg); }\n    100%    { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(341.5deg); }\n  }\n".replace(/START_VALUE/g,""+.95*t).replace(/END_VALUE/g,""+.2*t).replace(/DIAMETER/g,`${this._spinnerAnimationLabel}`)}_getSpinnerAnimationLabel(){return this.diameter.toString().replace(".","_")}}Oh._diameters=new WeakMap,Oh.\u0275fac=function(t){return new(t||Oh)(h.Y36(h.SBq),h.Y36(jr),h.Y36(ye,8),h.Y36(ps,8),h.Y36(MI),h.Y36(h.sBO),h.Y36(Wl),h.Y36(h.R0b))},Oh.\u0275cmp=h.Xpm({type:Oh,selectors:[["mat-progress-spinner"],["mat-spinner"]],hostAttrs:["role","progressbar","tabindex","-1",1,"mat-progress-spinner","mat-spinner"],hostVars:10,hostBindings:function(t,e){2&t&&(h.uIk("aria-valuemin","determinate"===e.mode?0:null)("aria-valuemax","determinate"===e.mode?100:null)("aria-valuenow","determinate"===e.mode?e.value:null)("mode",e.mode),h.Udp("width",e.diameter,"px")("height",e.diameter,"px"),h.ekj("_mat-animation-noopable",e._noopAnimations))},inputs:{color:"color",diameter:"diameter",strokeWidth:"strokeWidth",mode:"mode",value:"value"},exportAs:["matProgressSpinner"],features:[h.qOj],decls:4,vars:8,consts:[["preserveAspectRatio","xMidYMid meet","focusable","false","aria-hidden","true",3,"ngSwitch"],["svg",""],["cx","50%","cy","50%",3,"animation-name","stroke-dashoffset","stroke-dasharray","stroke-width","transform-origin",4,"ngSwitchCase"],["cx","50%","cy","50%",3,"stroke-dashoffset","stroke-dasharray","stroke-width","transform-origin",4,"ngSwitchCase"],["cx","50%","cy","50%"]],template:function(t,e){1&t&&(h.O4$(),h.TgZ(0,"svg",0,1),h.YNc(2,bI,1,11,"circle",2),h.YNc(3,xI,1,9,"circle",3),h.qZA()),2&t&&(h.Udp("width",e.diameter,"px")("height",e.diameter,"px"),h.Q6J("ngSwitch","indeterminate"===e.mode),h.uIk("viewBox",e._getViewBox()),h.xp6(2),h.Q6J("ngSwitchCase",!0),h.xp6(1),h.Q6J("ngSwitchCase",!1))},directives:[mn,Bi],styles:[".mat-progress-spinner{display:block;position:relative;overflow:hidden}.mat-progress-spinner svg{position:absolute;transform:rotate(-90deg);top:0;left:0;transform-origin:center;overflow:visible}.mat-progress-spinner circle{fill:transparent;transition:stroke-dashoffset 225ms linear}._mat-animation-noopable.mat-progress-spinner circle{transition:none;animation:none}.cdk-high-contrast-active .mat-progress-spinner circle{stroke:CanvasText}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] svg{animation:mat-progress-spinner-linear-rotate 2000ms linear infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] svg{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition-property:stroke;animation-duration:4000ms;animation-timing-function:cubic-bezier(0.35, 0, 0.25, 1);animation-iteration-count:infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition:none;animation:none}@keyframes mat-progress-spinner-linear-rotate{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes mat-progress-spinner-stroke-rotate-100{0%{stroke-dashoffset:268.606171575px;transform:rotate(0)}12.5%{stroke-dashoffset:56.5486677px;transform:rotate(0)}12.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(72.5deg)}25%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(72.5deg)}25.0001%{stroke-dashoffset:268.606171575px;transform:rotate(270deg)}37.5%{stroke-dashoffset:56.5486677px;transform:rotate(270deg)}37.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(161.5deg)}50%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(161.5deg)}50.0001%{stroke-dashoffset:268.606171575px;transform:rotate(180deg)}62.5%{stroke-dashoffset:56.5486677px;transform:rotate(180deg)}62.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(251.5deg)}75%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(251.5deg)}75.0001%{stroke-dashoffset:268.606171575px;transform:rotate(90deg)}87.5%{stroke-dashoffset:56.5486677px;transform:rotate(90deg)}87.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(341.5deg)}100%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(341.5deg)}}\n"],encapsulation:2,changeDetection:0});let hE=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[ii,Pn],ii]}),i})(),pE=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[Pn,ii],ii]}),i})(),fE=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[nc,ii,ec],ii]}),i})();function TI(i,t){}class GC{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.maxWidth="80vw",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.delayFocusTrap=!0,this.closeOnNavigation=!0}}const AI={dialogContainer:an("dialogContainer",[Ei("void, exit",zt({opacity:0,transform:"scale(0.7)"})),Ei("enter",zt({transform:"none"})),Jt("* => enter",As([zi("150ms cubic-bezier(0, 0, 0.2, 1)",zt({transform:"none",opacity:1})),qs("@*",Wo(),{optional:!0})])),Jt("* => void, * => exit",As([zi("75ms cubic-bezier(0.4, 0.0, 0.2, 1)",zt({opacity:0})),qs("@*",Wo(),{optional:!0})]))])};let II=(()=>{class i extends om{constructor(e,n,l,f,D,I,B,Z){super(),this._elementRef=e,this._focusTrapFactory=n,this._changeDetectorRef=l,this._config=D,this._interactivityChecker=I,this._ngZone=B,this._focusMonitor=Z,this._animationStateChanged=new h.vpe,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this.attachDomPortal=se=>(this._portalOutlet.hasAttached(),this._portalOutlet.attachDomPortal(se)),this._ariaLabelledBy=D.ariaLabelledBy||null,this._document=f}_initializeWithAttachedContent(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=td())}attachComponentPortal(e){return this._portalOutlet.hasAttached(),this._portalOutlet.attachComponentPortal(e)}attachTemplatePortal(e){return this._portalOutlet.hasAttached(),this._portalOutlet.attachTemplatePortal(e)}_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(e,n){this._interactivityChecker.isFocusable(e)||(e.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const l=()=>{e.removeEventListener("blur",l),e.removeEventListener("mousedown",l),e.removeAttribute("tabindex")};e.addEventListener("blur",l),e.addEventListener("mousedown",l)})),e.focus(n)}_focusByCssSelector(e,n){let l=this._elementRef.nativeElement.querySelector(e);l&&this._forceFocus(l,n)}_trapFocus(){const e=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||e.focus();break;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(n=>{n||this._focusDialogContainer()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this._config.autoFocus)}}_restoreFocus(){const e=this._elementFocusedBeforeDialogWasOpened;if(this._config.restoreFocus&&e&&"function"==typeof e.focus){const n=td(),l=this._elementRef.nativeElement;(!n||n===this._document.body||n===l||l.contains(n))&&(this._focusMonitor?(this._focusMonitor.focusVia(e,this._closeInteractionType),this._closeInteractionType=null):e.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){const e=this._elementRef.nativeElement,n=td();return e===n||e.contains(n)}}return i.\u0275fac=function(e){return new(e||i)(h.Y36(h.SBq),h.Y36(LM),h.Y36(h.sBO),h.Y36(ye,8),h.Y36(GC),h.Y36(Fy),h.Y36(h.R0b),h.Y36(ud))},i.\u0275dir=h.lG2({type:i,viewQuery:function(e,n){if(1&e&&h.Gf(Kg,7),2&e){let l;h.iGM(l=h.CRH())&&(n._portalOutlet=l.first)}},features:[h.qOj]}),i})(),kI=(()=>{class i extends II{constructor(){super(...arguments),this._state="enter"}_onAnimationDone({toState:e,totalTime:n}){"enter"===e?(this._config.delayFocusTrap&&this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:n})):"exit"===e&&(this._restoreFocus(),this._animationStateChanged.next({state:"closed",totalTime:n}))}_onAnimationStart({toState:e,totalTime:n}){"enter"===e?this._animationStateChanged.next({state:"opening",totalTime:n}):("exit"===e||"void"===e)&&this._animationStateChanged.next({state:"closing",totalTime:n})}_startExitAnimation(){this._state="exit",this._changeDetectorRef.markForCheck()}_initializeWithAttachedContent(){super._initializeWithAttachedContent(),this._config.delayFocusTrap||this._trapFocus()}}return i.\u0275fac=function(){let t;return function(n){return(t||(t=h.n5z(i)))(n||i)}}(),i.\u0275cmp=h.Xpm({type:i,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1","aria-modal","true",1,"mat-dialog-container"],hostVars:6,hostBindings:function(e,n){1&e&&h.WFA("@dialogContainer.start",function(f){return n._onAnimationStart(f)})("@dialogContainer.done",function(f){return n._onAnimationDone(f)}),2&e&&(h.Ikx("id",n._id),h.uIk("role",n._config.role)("aria-labelledby",n._config.ariaLabel?null:n._ariaLabelledBy)("aria-label",n._config.ariaLabel)("aria-describedby",n._config.ariaDescribedBy||null),h.d8E("@dialogContainer",n._state))},features:[h.qOj],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(e,n){1&e&&h.YNc(0,TI,0,0,"ng-template",0)},directives:[Kg],styles:[".mat-dialog-container{display:block;padding:24px;border-radius:4px;box-sizing:border-box;overflow:auto;outline:0;width:100%;height:100%;min-height:inherit;max-height:inherit}.cdk-high-contrast-active .mat-dialog-container{outline:solid 1px}.mat-dialog-content{display:block;margin:0 -24px;padding:0 24px;max-height:65vh;overflow:auto;-webkit-overflow-scrolling:touch}.mat-dialog-title{margin:0 0 20px;display:block}.mat-dialog-actions{padding:8px 0;display:flex;flex-wrap:wrap;min-height:52px;align-items:center;box-sizing:content-box;margin-bottom:-24px}.mat-dialog-actions[align=end]{justify-content:flex-end}.mat-dialog-actions[align=center]{justify-content:center}.mat-dialog-actions .mat-button-base+.mat-button-base,.mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}\n"],encapsulation:2,data:{animation:[AI.dialogContainer]}}),i})(),RI=0;class PI{constructor(t,e,n="mat-dialog-"+RI++){this._overlayRef=t,this._containerInstance=e,this.id=n,this.disableClose=this._containerInstance._config.disableClose,this._afterOpened=new ki.x,this._afterClosed=new ki.x,this._beforeClosed=new ki.x,this._state=0,e._id=n,e._animationStateChanged.pipe((0,Kr.h)(l=>"opened"===l.state),(0,ko.q)(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),e._animationStateChanged.pipe((0,Kr.h)(l=>"closed"===l.state),(0,ko.q)(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),t.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._afterClosed.next(this._result),this._afterClosed.complete(),this.componentInstance=null,this._overlayRef.dispose()}),t.keydownEvents().pipe((0,Kr.h)(l=>27===l.keyCode&&!this.disableClose&&!function xs(i,...t){return t.length?t.some(e=>i[e]):i.altKey||i.shiftKey||i.ctrlKey||i.metaKey}(l))).subscribe(l=>{l.preventDefault(),mE(this,"keyboard")}),t.backdropClick().subscribe(()=>{this.disableClose?this._containerInstance._recaptureFocus():mE(this,"mouse")})}close(t){this._result=t,this._containerInstance._animationStateChanged.pipe((0,Kr.h)(e=>"closing"===e.state),(0,ko.q)(1)).subscribe(e=>{this._beforeClosed.next(t),this._beforeClosed.complete(),this._overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),e.totalTime+100)}),this._state=1,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._afterClosed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._overlayRef.backdropClick()}keydownEvents(){return this._overlayRef.keydownEvents()}updatePosition(t){let e=this._getPositionStrategy();return t&&(t.left||t.right)?t.left?e.left(t.left):e.right(t.right):e.centerHorizontally(),t&&(t.top||t.bottom)?t.top?e.top(t.top):e.bottom(t.bottom):e.centerVertically(),this._overlayRef.updatePosition(),this}updateSize(t="",e=""){return this._overlayRef.updateSize({width:t,height:e}),this._overlayRef.updatePosition(),this}addPanelClass(t){return this._overlayRef.addPanelClass(t),this}removePanelClass(t){return this._overlayRef.removePanelClass(t),this}getState(){return this._state}_finishDialogClose(){this._state=2,this._overlayRef.dispose()}_getPositionStrategy(){return this._overlayRef.getConfig().positionStrategy}}function mE(i,t,e){return void 0!==i._containerInstance&&(i._containerInstance._closeInteractionType=t),i.close(e)}const OI=new h.OlP("MatDialogData"),FI=new h.OlP("mat-dialog-default-options"),gE=new h.OlP("mat-dialog-scroll-strategy"),BI={provide:gE,deps:[Ma],useFactory:function LI(i){return()=>i.scrollStrategies.block()}};let NI=(()=>{class i{constructor(e,n,l,f,D,I,B,Z,se,ge){this._overlay=e,this._injector=n,this._defaultOptions=l,this._parentDialog=f,this._overlayContainer=D,this._dialogRefConstructor=B,this._dialogContainerType=Z,this._dialogDataToken=se,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new ki.x,this._afterOpenedAtThisLevel=new ki.x,this._ariaHiddenElements=new Map,this.afterAllClosed=tf(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(wa(void 0))),this._scrollStrategy=I}get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){const e=this._parentDialog;return e?e._getAfterAllClosed():this._afterAllClosedAtThisLevel}open(e,n){n=function zI(i,t){return Object.assign(Object.assign({},t),i)}(n,this._defaultOptions||new GC),n.id&&this.getDialogById(n.id);const l=this._createOverlay(n),f=this._attachDialogContainer(l,n),D=this._attachDialogContent(e,f,l,n);return this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(D),D.afterClosed().subscribe(()=>this._removeOpenDialog(D)),this.afterOpened.next(D),f._initializeWithAttachedContent(),D}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(e){return this.openDialogs.find(n=>n.id===e)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_createOverlay(e){const n=this._getOverlayConfig(e);return this._overlay.create(n)}_getOverlayConfig(e){const n=new Jg({positionStrategy:this._overlay.position().global(),scrollStrategy:e.scrollStrategy||this._scrollStrategy(),panelClass:e.panelClass,hasBackdrop:e.hasBackdrop,direction:e.direction,minWidth:e.minWidth,minHeight:e.minHeight,maxWidth:e.maxWidth,maxHeight:e.maxHeight,disposeOnNavigation:e.closeOnNavigation});return e.backdropClass&&(n.backdropClass=e.backdropClass),n}_attachDialogContainer(e,n){const f=h.zs3.create({parent:n&&n.viewContainerRef&&n.viewContainerRef.injector||this._injector,providers:[{provide:GC,useValue:n}]}),D=new mv(this._dialogContainerType,n.viewContainerRef,f,n.componentFactoryResolver);return e.attach(D).instance}_attachDialogContent(e,n,l,f){const D=new this._dialogRefConstructor(l,n,f.id);if(e instanceof h.Rgc)n.attachTemplatePortal(new Zg(e,null,{$implicit:f.data,dialogRef:D}));else{const I=this._createInjector(f,D,n),B=n.attachComponentPortal(new mv(e,f.viewContainerRef,I,f.componentFactoryResolver));D.componentInstance=B.instance}return D.updateSize(f.width,f.height).updatePosition(f.position),D}_createInjector(e,n,l){const f=e&&e.viewContainerRef&&e.viewContainerRef.injector,D=[{provide:this._dialogContainerType,useValue:l},{provide:this._dialogDataToken,useValue:e.data},{provide:this._dialogRefConstructor,useValue:n}];return e.direction&&(!f||!f.get(al,null,h.XFs.Optional))&&D.push({provide:al,useValue:{value:e.direction,change:(0,di.of)()}}),h.zs3.create({parent:f||this._injector,providers:D})}_removeOpenDialog(e){const n=this.openDialogs.indexOf(e);n>-1&&(this.openDialogs.splice(n,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((l,f)=>{l?f.setAttribute("aria-hidden",l):f.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){const e=this._overlayContainer.getContainerElement();if(e.parentElement){const n=e.parentElement.children;for(let l=n.length-1;l>-1;l--){let f=n[l];f!==e&&"SCRIPT"!==f.nodeName&&"STYLE"!==f.nodeName&&!f.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(f,f.getAttribute("aria-hidden")),f.setAttribute("aria-hidden","true"))}}}_closeDialogs(e){let n=e.length;for(;n--;)e[n].close()}}return i.\u0275fac=function(e){h.$Z()},i.\u0275dir=h.lG2({type:i}),i})(),VI=(()=>{class i extends NI{constructor(e,n,l,f,D,I,B,Z){super(e,n,f,I,B,D,PI,kI,OI,Z)}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(Ma),h.LFG(h.zs3),h.LFG(ut,8),h.LFG(FI,8),h.LFG(gE),h.LFG(i,12),h.LFG(e_),h.LFG(ps,8))},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac}),i})(),_E=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({providers:[VI,BI],imports:[[nc,ec,ii],ii]}),i})(),yE=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[nc,ec,Pn,o,ii],ii]}),i})();const YI={provide:new h.OlP("mat-tooltip-scroll-strategy"),deps:[Ma],useFactory:function qI(i){return()=>i.scrollStrategies.reposition({scrollThrottle:20})}};let $C=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({providers:[YI],imports:[[$c,Pn,nc,ii],ii,Ur]}),i})(),qC=(()=>{class i{constructor(){this.changes=new ki.x,this.itemsPerPageLabel="Items per page:",this.nextPageLabel="Next page",this.previousPageLabel="Previous page",this.firstPageLabel="First page",this.lastPageLabel="Last page",this.getRangeLabel=(e,n,l)=>{if(0==l||0==n)return`0 of ${l}`;const f=e*n;return`${f+1} \u2013 ${f<(l=Math.max(l,0))?Math.min(f+n,l):f+n} of ${l}`}}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const JI={provide:qC,deps:[[new h.FiY,new h.tp0,qC]],useFactory:function QI(i){return i||new qC}};let vE=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({providers:[JI],imports:[[Pn,o,OC,$C,ii]]}),i})(),YC=(()=>{class i{constructor(){this.changes=new ki.x}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const tk={provide:YC,deps:[[new h.FiY,new h.tp0,YC]],useFactory:function ek(i){return i||new YC}};let bE=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({providers:[tk],imports:[[Pn,ii]]}),i})(),mk=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[Zl]]}),i})(),kE=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[mk,ii],ii]}),i})(),Pk=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[Pn,zb,PC,F1,Bm,ve,V1,OC,H1,$1,Np,Bp,nm,q1,_m,W1,K1,ef,Q1,J1,eE,o,oE,sE,dE,gm,hE,pE,ra,fE,_E,yE,$C,vE,bE,kE],zb,PC,F1,Bm,ve,V1,OC,H1,$1,Np,Bp,nm,q1,_m,W1,K1,ef,Q1,J1,eE,o,oE,sE,dE,gm,hE,pE,ra,fE,_E,yE,$C,vE,bE,kE]}),i})();var Ok=Y(9672);function Fk(...i){const t=(0,qc.yG)(i),e=(0,qc.jO)(i),{args:n,keys:l}=function Yx(i){if(1===i.length){const t=i[0];if(md(t))return{args:t,keys:null};if(function n_(i){return i&&"object"==typeof i&&$x(i)===qx}(t)){const e=Mh(t);return{args:e.map(n=>t[n]),keys:e}}}return{args:i,keys:null}}(i);if(0===n.length)return(0,Hn.D)([],t);const f=new Un.y(function Lk(i,t,e=Ap.y){return n=>{RE(t,()=>{const{length:l}=i,f=new Array(l);let D=l,I=l;for(let B=0;B<l;B++)RE(t,()=>{const Z=(0,Hn.D)(i[B],t);let se=!1;Z.subscribe((0,Ko.x)(n,ge=>{f[B]=ge,se||(se=!0,I--),I||n.next(e(f.slice()))},()=>{--D||n.complete()}))},n)},n)}}(n,t,l?D=>function Wx(i,t){return i.reduce((e,n,l)=>(e[n]=t[l],e),{})}(l,D):Ap.y));return e?f.pipe(Uu(e)):f}function RE(i,t,e){i?(0,Ok.f)(e,i,t):t()}const p0=(0,Y(3888).d)(i=>function(){i(this),this.name="EmptyError",this.message="no elements in sequence"});var Gm=Y(515);function PE(){return(0,ms.e)((i,t)=>{let e=null;i._refCount++;const n=(0,Ko.x)(t,void 0,void 0,void 0,()=>{if(!i||i._refCount<=0||0<--i._refCount)return void(e=null);const l=i._connection,f=e;e=null,l&&(!f||l===f)&&l.unsubscribe(),t.unsubscribe()});i.subscribe(n),n.closed||(e=i.connect())})}class Nk extends Un.y{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,(0,ms.A)(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,null==t||t.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new jo.w0;const e=this.getSubject();t.add(this.source.subscribe((0,Ko.x)(e,void 0,()=>{this._teardown(),e.complete()},n=>{this._teardown(),e.error(n)},()=>this._teardown()))),t.closed&&(this._connection=null,t=jo.w0.EMPTY)}return t}refCount(){return PE()(this)}}var OE=Y(5026);function rM(i){return i<=0?()=>Gm.E:(0,ms.e)((t,e)=>{let n=[];t.subscribe((0,Ko.x)(e,l=>{n.push(l),i<n.length&&n.shift()},()=>{for(const l of n)e.next(l);e.complete()},void 0,()=>{n=null}))})}function FE(i=Vk){return(0,ms.e)((t,e)=>{let n=!1;t.subscribe((0,Ko.x)(e,l=>{n=!0,e.next(l)},()=>n?e.complete():e.error(i())))})}function Vk(){return new p0}function LE(i){return(0,ms.e)((t,e)=>{let n=!1;t.subscribe((0,Ko.x)(e,l=>{n=!0,e.next(l)},()=>{n||e.next(i),e.complete()}))})}function $m(i,t){const e=arguments.length>=2;return n=>n.pipe(i?(0,Kr.h)((l,f)=>i(l,f,n)):Ap.y,(0,ko.q)(1),e?LE(t):FE(()=>new p0))}class Md{constructor(t,e){this.id=t,this.url=e}}class oM extends Md{constructor(t,e,n="imperative",l=null){super(t,e),this.navigationTrigger=n,this.restoredState=l}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class dy extends Md{constructor(t,e,n){super(t,e),this.urlAfterRedirects=n}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class BE extends Md{constructor(t,e,n){super(t,e),this.reason=n}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class jk extends Md{constructor(t,e,n){super(t,e),this.error=n}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Uk extends Md{constructor(t,e,n,l){super(t,e),this.urlAfterRedirects=n,this.state=l}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Hk extends Md{constructor(t,e,n,l){super(t,e),this.urlAfterRedirects=n,this.state=l}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Gk extends Md{constructor(t,e,n,l,f){super(t,e),this.urlAfterRedirects=n,this.state=l,this.shouldActivate=f}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class $k extends Md{constructor(t,e,n,l){super(t,e),this.urlAfterRedirects=n,this.state=l}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class qk extends Md{constructor(t,e,n,l){super(t,e),this.urlAfterRedirects=n,this.state=l}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class NE{constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class VE{constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Yk{constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Wk{constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Zk{constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Kk{constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class zE{constructor(t,e,n){this.routerEvent=t,this.position=e,this.anchor=n}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const rn="primary";class Xk{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function qm(i){return new Xk(i)}const jE="ngNavigationCancelingError";function sM(i){const t=Error("NavigationCancelingError: "+i);return t[jE]=!0,t}function Jk(i,t,e){const n=e.path.split("/");if(n.length>i.length||"full"===e.pathMatch&&(t.hasChildren()||n.length<i.length))return null;const l={};for(let f=0;f<n.length;f++){const D=n[f],I=i[f];if(D.startsWith(":"))l[D.substring(1)]=I;else if(D!==I.path)return null}return{consumed:i.slice(0,n.length),posParams:l}}function nu(i,t){const e=i?Object.keys(i):void 0,n=t?Object.keys(t):void 0;if(!e||!n||e.length!=n.length)return!1;let l;for(let f=0;f<e.length;f++)if(l=e[f],!UE(i[l],t[l]))return!1;return!0}function UE(i,t){if(Array.isArray(i)&&Array.isArray(t)){if(i.length!==t.length)return!1;const e=[...i].sort(),n=[...t].sort();return e.every((l,f)=>n[f]===l)}return i===t}function HE(i){return Array.prototype.concat.apply([],i)}function GE(i){return i.length>0?i[i.length-1]:null}function ts(i,t){for(const e in i)i.hasOwnProperty(e)&&t(i[e],e)}function ru(i){return(0,h.CqO)(i)?i:(0,h.QGY)(i)?(0,Hn.D)(Promise.resolve(i)):(0,di.of)(i)}const iR={exact:function YE(i,t,e){if(!sf(i.segments,t.segments)||!f0(i.segments,t.segments,e)||i.numberOfChildren!==t.numberOfChildren)return!1;for(const n in t.children)if(!i.children[n]||!YE(i.children[n],t.children[n],e))return!1;return!0},subset:WE},$E={exact:function nR(i,t){return nu(i,t)},subset:function rR(i,t){return Object.keys(t).length<=Object.keys(i).length&&Object.keys(t).every(e=>UE(i[e],t[e]))},ignored:()=>!0};function qE(i,t,e){return iR[e.paths](i.root,t.root,e.matrixParams)&&$E[e.queryParams](i.queryParams,t.queryParams)&&!("exact"===e.fragment&&i.fragment!==t.fragment)}function WE(i,t,e){return ZE(i,t,t.segments,e)}function ZE(i,t,e,n){if(i.segments.length>e.length){const l=i.segments.slice(0,e.length);return!(!sf(l,e)||t.hasChildren()||!f0(l,e,n))}if(i.segments.length===e.length){if(!sf(i.segments,e)||!f0(i.segments,e,n))return!1;for(const l in t.children)if(!i.children[l]||!WE(i.children[l],t.children[l],n))return!1;return!0}{const l=e.slice(0,i.segments.length),f=e.slice(i.segments.length);return!!(sf(i.segments,l)&&f0(i.segments,l,n)&&i.children[rn])&&ZE(i.children[rn],t,f,n)}}function f0(i,t,e){return t.every((n,l)=>$E[e](i[l].parameters,n.parameters))}class rf{constructor(t,e,n){this.root=t,this.queryParams=e,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=qm(this.queryParams)),this._queryParamMap}toString(){return aR.serialize(this)}}class un{constructor(t,e){this.segments=t,this.children=e,this.parent=null,ts(e,(n,l)=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return m0(this)}}class hy{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=qm(this.parameters)),this._parameterMap}toString(){return eS(this)}}function sf(i,t){return i.length===t.length&&i.every((e,n)=>e.path===t[n].path)}class KE{}class XE{parse(t){const e=new gR(t);return new rf(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){const e=`/${py(t.root,!0)}`,n=function uR(i){const t=Object.keys(i).map(e=>{const n=i[e];return Array.isArray(n)?n.map(l=>`${g0(e)}=${g0(l)}`).join("&"):`${g0(e)}=${g0(n)}`}).filter(e=>!!e);return t.length?`?${t.join("&")}`:""}(t.queryParams);return`${e}${n}${"string"==typeof t.fragment?`#${function lR(i){return encodeURI(i)}(t.fragment)}`:""}`}}const aR=new XE;function m0(i){return i.segments.map(t=>eS(t)).join("/")}function py(i,t){if(!i.hasChildren())return m0(i);if(t){const e=i.children[rn]?py(i.children[rn],!1):"",n=[];return ts(i.children,(l,f)=>{f!==rn&&n.push(`${f}:${py(l,!1)}`)}),n.length>0?`${e}(${n.join("//")})`:e}{const e=function sR(i,t){let e=[];return ts(i.children,(n,l)=>{l===rn&&(e=e.concat(t(n,l)))}),ts(i.children,(n,l)=>{l!==rn&&(e=e.concat(t(n,l)))}),e}(i,(n,l)=>l===rn?[py(i.children[rn],!1)]:[`${l}:${py(n,!1)}`]);return 1===Object.keys(i.children).length&&null!=i.children[rn]?`${m0(i)}/${e[0]}`:`${m0(i)}/(${e.join("//")})`}}function QE(i){return encodeURIComponent(i).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function g0(i){return QE(i).replace(/%3B/gi,";")}function aM(i){return QE(i).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function _0(i){return decodeURIComponent(i)}function JE(i){return _0(i.replace(/\+/g,"%20"))}function eS(i){return`${aM(i.path)}${function cR(i){return Object.keys(i).map(t=>`;${aM(t)}=${aM(i[t])}`).join("")}(i.parameters)}`}const dR=/^[^\/()?;=#]+/;function y0(i){const t=i.match(dR);return t?t[0]:""}const hR=/^[^=?&#]+/,fR=/^[^&#]+/;class gR{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new un([],{}):new un([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(n[rn]=new un(t,e)),n}parseSegment(){const t=y0(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(t),new hy(_0(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=y0(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const l=y0(this.remaining);l&&(n=l,this.capture(n))}t[_0(e)]=_0(n)}parseQueryParam(t){const e=function pR(i){const t=i.match(hR);return t?t[0]:""}(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const D=function mR(i){const t=i.match(fR);return t?t[0]:""}(this.remaining);D&&(n=D,this.capture(n))}const l=JE(e),f=JE(n);if(t.hasOwnProperty(l)){let D=t[l];Array.isArray(D)||(D=[D],t[l]=D),D.push(f)}else t[l]=f}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=y0(this.remaining),l=this.remaining[n.length];if("/"!==l&&")"!==l&&";"!==l)throw new Error(`Cannot parse url '${this.url}'`);let f;n.indexOf(":")>-1?(f=n.substr(0,n.indexOf(":")),this.capture(f),this.capture(":")):t&&(f=rn);const D=this.parseChildren();e[f]=1===Object.keys(D).length?D[rn]:new un([],D),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Error(`Expected "${t}".`)}}class tS{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=lM(t,this._root);return e?e.children.map(n=>n.value):[]}firstChild(t){const e=lM(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=cM(t,this._root);return e.length<2?[]:e[e.length-2].children.map(l=>l.value).filter(l=>l!==t)}pathFromRoot(t){return cM(t,this._root).map(e=>e.value)}}function lM(i,t){if(i===t.value)return t;for(const e of t.children){const n=lM(i,e);if(n)return n}return null}function cM(i,t){if(i===t.value)return[t];for(const e of t.children){const n=cM(i,e);if(n.length)return n.unshift(t),n}return[]}class Dd{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function Ym(i){const t={};return i&&i.children.forEach(e=>t[e.value.outlet]=e),t}class iS extends tS{constructor(t,e){super(t),this.snapshot=e,uM(this,t)}toString(){return this.snapshot.toString()}}function nS(i,t){const e=function _R(i,t){const D=new v0([],{},{},"",{},rn,t,null,i.root,-1,{});return new oS("",new Dd(D,[]))}(i,t),n=new Xr.X([new hy("",{})]),l=new Xr.X({}),f=new Xr.X({}),D=new Xr.X({}),I=new Xr.X(""),B=new Wm(n,l,D,I,f,rn,t,e.root);return B.snapshot=e.root,new iS(new Dd(B,[]),e)}class Wm{constructor(t,e,n,l,f,D,I,B){this.url=t,this.params=e,this.queryParams=n,this.fragment=l,this.data=f,this.outlet=D,this.component=I,this._futureSnapshot=B}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,ji.U)(t=>qm(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,ji.U)(t=>qm(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function rS(i,t="emptyOnly"){const e=i.pathFromRoot;let n=0;if("always"!==t)for(n=e.length-1;n>=1;){const l=e[n],f=e[n-1];if(l.routeConfig&&""===l.routeConfig.path)n--;else{if(f.component)break;n--}}return function yR(i){return i.reduce((t,e)=>({params:Object.assign(Object.assign({},t.params),e.params),data:Object.assign(Object.assign({},t.data),e.data),resolve:Object.assign(Object.assign({},t.resolve),e._resolvedData)}),{params:{},data:{},resolve:{}})}(e.slice(n))}class v0{constructor(t,e,n,l,f,D,I,B,Z,se,ge){this.url=t,this.params=e,this.queryParams=n,this.fragment=l,this.data=f,this.outlet=D,this.component=I,this.routeConfig=B,this._urlSegment=Z,this._lastPathIndex=se,this._resolve=ge}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=qm(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=qm(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(n=>n.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class oS extends tS{constructor(t,e){super(e),this.url=t,uM(this,e)}toString(){return sS(this._root)}}function uM(i,t){t.value._routerState=i,t.children.forEach(e=>uM(i,e))}function sS(i){const t=i.children.length>0?` { ${i.children.map(sS).join(", ")} } `:"";return`${i.value}${t}`}function dM(i){if(i.snapshot){const t=i.snapshot,e=i._futureSnapshot;i.snapshot=e,nu(t.queryParams,e.queryParams)||i.queryParams.next(e.queryParams),t.fragment!==e.fragment&&i.fragment.next(e.fragment),nu(t.params,e.params)||i.params.next(e.params),function eR(i,t){if(i.length!==t.length)return!1;for(let e=0;e<i.length;++e)if(!nu(i[e],t[e]))return!1;return!0}(t.url,e.url)||i.url.next(e.url),nu(t.data,e.data)||i.data.next(e.data)}else i.snapshot=i._futureSnapshot,i.data.next(i._futureSnapshot.data)}function hM(i,t){const e=nu(i.params,t.params)&&function oR(i,t){return sf(i,t)&&i.every((e,n)=>nu(e.parameters,t[n].parameters))}(i.url,t.url);return e&&!(!i.parent!=!t.parent)&&(!i.parent||hM(i.parent,t.parent))}function fy(i,t,e){if(e&&i.shouldReuseRoute(t.value,e.value.snapshot)){const n=e.value;n._futureSnapshot=t.value;const l=function bR(i,t,e){return t.children.map(n=>{for(const l of e.children)if(i.shouldReuseRoute(n.value,l.value.snapshot))return fy(i,n,l);return fy(i,n)})}(i,t,e);return new Dd(n,l)}{if(i.shouldAttach(t.value)){const f=i.retrieve(t.value);if(null!==f){const D=f.route;return D.value._futureSnapshot=t.value,D.children=t.children.map(I=>fy(i,I)),D}}const n=function xR(i){return new Wm(new Xr.X(i.url),new Xr.X(i.params),new Xr.X(i.queryParams),new Xr.X(i.fragment),new Xr.X(i.data),i.outlet,i.component,i)}(t.value),l=t.children.map(f=>fy(i,f));return new Dd(n,l)}}function b0(i){return"object"==typeof i&&null!=i&&!i.outlets&&!i.segmentPath}function my(i){return"object"==typeof i&&null!=i&&i.outlets}function pM(i,t,e,n,l){let f={};if(n&&ts(n,(I,B)=>{f[B]=Array.isArray(I)?I.map(Z=>`${Z}`):`${I}`}),i===t)return new rf(e,f,l);const D=aS(i,t,e);return new rf(D,f,l)}function aS(i,t,e){const n={};return ts(i.children,(l,f)=>{n[f]=l===t?e:aS(l,t,e)}),new un(i.segments,n)}class lS{constructor(t,e,n){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=n,t&&n.length>0&&b0(n[0]))throw new Error("Root segment cannot have matrix parameters");const l=n.find(my);if(l&&l!==GE(n))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class fM{constructor(t,e,n){this.segmentGroup=t,this.processChildren=e,this.index=n}}function cS(i,t,e){if(i||(i=new un([],{})),0===i.segments.length&&i.hasChildren())return x0(i,t,e);const n=function SR(i,t,e){let n=0,l=t;const f={match:!1,pathIndex:0,commandIndex:0};for(;l<i.segments.length;){if(n>=e.length)return f;const D=i.segments[l],I=e[n];if(my(I))break;const B=`${I}`,Z=n<e.length-1?e[n+1]:null;if(l>0&&void 0===B)break;if(B&&Z&&"object"==typeof Z&&void 0===Z.outlets){if(!dS(B,Z,D))return f;n+=2}else{if(!dS(B,{},D))return f;n++}l++}return{match:!0,pathIndex:l,commandIndex:n}}(i,t,e),l=e.slice(n.commandIndex);if(n.match&&n.pathIndex<i.segments.length){const f=new un(i.segments.slice(0,n.pathIndex),{});return f.children[rn]=new un(i.segments.slice(n.pathIndex),i.children),x0(f,0,l)}return n.match&&0===l.length?new un(i.segments,{}):n.match&&!i.hasChildren()?mM(i,t,e):n.match?x0(i,0,l):mM(i,t,e)}function x0(i,t,e){if(0===e.length)return new un(i.segments,{});{const n=function ER(i){return my(i[0])?i[0].outlets:{[rn]:i}}(e),l={};return ts(n,(f,D)=>{"string"==typeof f&&(f=[f]),null!==f&&(l[D]=cS(i.children[D],t,f))}),ts(i.children,(f,D)=>{void 0===n[D]&&(l[D]=f)}),new un(i.segments,l)}}function mM(i,t,e){const n=i.segments.slice(0,t);let l=0;for(;l<e.length;){const f=e[l];if(my(f)){const B=TR(f.outlets);return new un(n,B)}if(0===l&&b0(e[0])){n.push(new hy(i.segments[t].path,uS(e[0]))),l++;continue}const D=my(f)?f.outlets[rn]:`${f}`,I=l<e.length-1?e[l+1]:null;D&&I&&b0(I)?(n.push(new hy(D,uS(I))),l+=2):(n.push(new hy(D,{})),l++)}return new un(n,{})}function TR(i){const t={};return ts(i,(e,n)=>{"string"==typeof e&&(e=[e]),null!==e&&(t[n]=mM(new un([],{}),0,e))}),t}function uS(i){const t={};return ts(i,(e,n)=>t[n]=`${e}`),t}function dS(i,t,e){return i==e.path&&nu(t,e.parameters)}class IR{constructor(t,e,n,l){this.routeReuseStrategy=t,this.futureState=e,this.currState=n,this.forwardEvent=l}activate(t){const e=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,n,t),dM(this.futureState.root),this.activateChildRoutes(e,n,t)}deactivateChildRoutes(t,e,n){const l=Ym(e);t.children.forEach(f=>{const D=f.value.outlet;this.deactivateRoutes(f,l[D],n),delete l[D]}),ts(l,(f,D)=>{this.deactivateRouteAndItsChildren(f,n)})}deactivateRoutes(t,e,n){const l=t.value,f=e?e.value:null;if(l===f)if(l.component){const D=n.getContext(l.outlet);D&&this.deactivateChildRoutes(t,e,D.children)}else this.deactivateChildRoutes(t,e,n);else f&&this.deactivateRouteAndItsChildren(e,n)}deactivateRouteAndItsChildren(t,e){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const n=e.getContext(t.value.outlet),l=n&&t.value.component?n.children:e,f=Ym(t);for(const D of Object.keys(f))this.deactivateRouteAndItsChildren(f[D],l);if(n&&n.outlet){const D=n.outlet.detach(),I=n.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:D,route:t,contexts:I})}}deactivateRouteAndOutlet(t,e){const n=e.getContext(t.value.outlet),l=n&&t.value.component?n.children:e,f=Ym(t);for(const D of Object.keys(f))this.deactivateRouteAndItsChildren(f[D],l);n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated(),n.attachRef=null,n.resolver=null,n.route=null)}activateChildRoutes(t,e,n){const l=Ym(e);t.children.forEach(f=>{this.activateRoutes(f,l[f.value.outlet],n),this.forwardEvent(new Kk(f.value.snapshot))}),t.children.length&&this.forwardEvent(new Wk(t.value.snapshot))}activateRoutes(t,e,n){const l=t.value,f=e?e.value:null;if(dM(l),l===f)if(l.component){const D=n.getOrCreateContext(l.outlet);this.activateChildRoutes(t,e,D.children)}else this.activateChildRoutes(t,e,n);else if(l.component){const D=n.getOrCreateContext(l.outlet);if(this.routeReuseStrategy.shouldAttach(l.snapshot)){const I=this.routeReuseStrategy.retrieve(l.snapshot);this.routeReuseStrategy.store(l.snapshot,null),D.children.onOutletReAttached(I.contexts),D.attachRef=I.componentRef,D.route=I.route.value,D.outlet&&D.outlet.attach(I.componentRef,I.route.value),dM(I.route.value),this.activateChildRoutes(t,null,D.children)}else{const I=function kR(i){for(let t=i.parent;t;t=t.parent){const e=t.routeConfig;if(e&&e._loadedConfig)return e._loadedConfig;if(e&&e.component)return null}return null}(l.snapshot),B=I?I.module.componentFactoryResolver:null;D.attachRef=null,D.route=l,D.resolver=B,D.outlet&&D.outlet.activateWith(l,B),this.activateChildRoutes(t,null,D.children)}}else this.activateChildRoutes(t,null,n)}}class gM{constructor(t,e){this.routes=t,this.module=e}}function Lh(i){return"function"==typeof i}function af(i){return i instanceof rf}const gy=Symbol("INITIAL_VALUE");function _y(){return(0,_l.w)(i=>Fk(i.map(t=>t.pipe((0,ko.q)(1),wa(gy)))).pipe((0,OE.R)((t,e)=>{let n=!1;return e.reduce((l,f,D)=>l!==gy?l:(f===gy&&(n=!0),n||!1!==f&&D!==e.length-1&&!af(f)?l:f),t)},gy),(0,Kr.h)(t=>t!==gy),(0,ji.U)(t=>af(t)?t:!0===t),(0,ko.q)(1)))}class BR{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new yy,this.attachRef=null}}class yy{constructor(){this.contexts=new Map}onChildOutletCreated(t,e){const n=this.getOrCreateContext(t);n.outlet=e,this.contexts.set(t,n)}onChildOutletDestroyed(t){const e=this.getContext(t);e&&(e.outlet=null,e.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let e=this.getContext(t);return e||(e=new BR,this.contexts.set(t,e)),e}getContext(t){return this.contexts.get(t)||null}}let _M=(()=>{class i{constructor(e,n,l,f,D){this.parentContexts=e,this.location=n,this.resolver=l,this.changeDetector=D,this.activated=null,this._activatedRoute=null,this.activateEvents=new h.vpe,this.deactivateEvents=new h.vpe,this.attachEvents=new h.vpe,this.detachEvents=new h.vpe,this.name=f||rn,e.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,n){this.activated=e,this._activatedRoute=n,this.location.insert(e.hostView),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,n){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=e;const D=(n=n||this.resolver).resolveComponentFactory(e._futureSnapshot.routeConfig.component),I=this.parentContexts.getOrCreateContext(this.name).children,B=new NR(e,I,this.location.injector);this.activated=this.location.createComponent(D,this.location.length,B),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return i.\u0275fac=function(e){return new(e||i)(h.Y36(yy),h.Y36(h.s_b),h.Y36(h._Vd),h.$8M("name"),h.Y36(h.sBO))},i.\u0275dir=h.lG2({type:i,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),i})();class NR{constructor(t,e,n){this.route=t,this.childContexts=e,this.parent=n}get(t,e){return t===Wm?this.route:t===yy?this.childContexts:this.parent.get(t,e)}}let hS=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=h.Xpm({type:i,selectors:[["ng-component"]],decls:1,vars:0,template:function(e,n){1&e&&h._UZ(0,"router-outlet")},directives:[_M],encapsulation:2}),i})();function pS(i,t=""){for(let e=0;e<i.length;e++){const n=i[e];VR(n,zR(t,n))}}function VR(i,t){i.children&&pS(i.children,t)}function zR(i,t){return t?i||t.path?i&&!t.path?`${i}/`:!i&&t.path?t.path:`${i}/${t.path}`:"":i}function yM(i){const t=i.children&&i.children.map(yM),e=t?Object.assign(Object.assign({},i),{children:t}):Object.assign({},i);return!e.component&&(t||e.loadChildren)&&e.outlet&&e.outlet!==rn&&(e.component=hS),e}function vl(i){return i.outlet||rn}function fS(i,t){const e=i.filter(n=>vl(n)===t);return e.push(...i.filter(n=>vl(n)!==t)),e}const mS={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function w0(i,t,e){var n;if(""===t.path)return"full"===t.pathMatch&&(i.hasChildren()||e.length>0)?Object.assign({},mS):{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};const f=(t.matcher||Jk)(e,i,t);if(!f)return Object.assign({},mS);const D={};ts(f.posParams,(B,Z)=>{D[Z]=B.path});const I=f.consumed.length>0?Object.assign(Object.assign({},D),f.consumed[f.consumed.length-1].parameters):D;return{matched:!0,consumedSegments:f.consumed,remainingSegments:e.slice(f.consumed.length),parameters:I,positionalParamSegments:null!==(n=f.posParams)&&void 0!==n?n:{}}}function C0(i,t,e,n,l="corrected"){if(e.length>0&&function HR(i,t,e){return e.some(n=>M0(i,t,n)&&vl(n)!==rn)}(i,e,n)){const D=new un(t,function UR(i,t,e,n){const l={};l[rn]=n,n._sourceSegment=i,n._segmentIndexShift=t.length;for(const f of e)if(""===f.path&&vl(f)!==rn){const D=new un([],{});D._sourceSegment=i,D._segmentIndexShift=t.length,l[vl(f)]=D}return l}(i,t,n,new un(e,i.children)));return D._sourceSegment=i,D._segmentIndexShift=t.length,{segmentGroup:D,slicedSegments:[]}}if(0===e.length&&function GR(i,t,e){return e.some(n=>M0(i,t,n))}(i,e,n)){const D=new un(i.segments,function jR(i,t,e,n,l,f){const D={};for(const I of n)if(M0(i,e,I)&&!l[vl(I)]){const B=new un([],{});B._sourceSegment=i,B._segmentIndexShift="legacy"===f?i.segments.length:t.length,D[vl(I)]=B}return Object.assign(Object.assign({},l),D)}(i,t,e,n,i.children,l));return D._sourceSegment=i,D._segmentIndexShift=t.length,{segmentGroup:D,slicedSegments:e}}const f=new un(i.segments,i.children);return f._sourceSegment=i,f._segmentIndexShift=t.length,{segmentGroup:f,slicedSegments:e}}function M0(i,t,e){return(!(i.hasChildren()||t.length>0)||"full"!==e.pathMatch)&&""===e.path}function gS(i,t,e,n){return!!(vl(i)===n||n!==rn&&M0(t,e,i))&&("**"===i.path||w0(t,i,e).matched)}function _S(i,t,e){return 0===t.length&&!i.children[e]}class D0{constructor(t){this.segmentGroup=t||null}}class yS{constructor(t){this.urlTree=t}}function vy(i){return fd(new D0(i))}function vS(i){return fd(new yS(i))}class WR{constructor(t,e,n,l,f){this.configLoader=e,this.urlSerializer=n,this.urlTree=l,this.config=f,this.allowRedirects=!0,this.ngModule=t.get(h.h0i)}apply(){const t=C0(this.urlTree.root,[],[],this.config).segmentGroup,e=new un(t.segments,t.children);return this.expandSegmentGroup(this.ngModule,this.config,e,rn).pipe((0,ji.U)(f=>this.createUrlTree(vM(f),this.urlTree.queryParams,this.urlTree.fragment))).pipe((0,rc.K)(f=>{if(f instanceof yS)return this.allowRedirects=!1,this.match(f.urlTree);throw f instanceof D0?this.noMatchError(f):f}))}match(t){return this.expandSegmentGroup(this.ngModule,this.config,t.root,rn).pipe((0,ji.U)(l=>this.createUrlTree(vM(l),t.queryParams,t.fragment))).pipe((0,rc.K)(l=>{throw l instanceof D0?this.noMatchError(l):l}))}noMatchError(t){return new Error(`Cannot match any routes. URL Segment: '${t.segmentGroup}'`)}createUrlTree(t,e,n){const l=t.segments.length>0?new un([],{[rn]:t}):t;return new rf(l,e,n)}expandSegmentGroup(t,e,n,l){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(t,e,n).pipe((0,ji.U)(f=>new un([],f))):this.expandSegment(t,n,e,n.segments,l,!0)}expandChildren(t,e,n){const l=[];for(const f of Object.keys(n.children))"primary"===f?l.unshift(f):l.push(f);return(0,Hn.D)(l).pipe((0,Dh.b)(f=>{const D=n.children[f],I=fS(e,f);return this.expandSegmentGroup(t,I,D,f).pipe((0,ji.U)(B=>({segment:B,outlet:f})))}),(0,OE.R)((f,D)=>(f[D.outlet]=D.segment,f),{}),function zk(i,t){const e=arguments.length>=2;return n=>n.pipe(i?(0,Kr.h)((l,f)=>i(l,f,n)):Ap.y,rM(1),e?LE(t):FE(()=>new p0))}())}expandSegment(t,e,n,l,f,D){return(0,Hn.D)(n).pipe((0,Dh.b)(I=>this.expandSegmentAgainstRoute(t,e,n,I,l,f,D).pipe((0,rc.K)(Z=>{if(Z instanceof D0)return(0,di.of)(null);throw Z}))),$m(I=>!!I),(0,rc.K)((I,B)=>{if(I instanceof p0||"EmptyError"===I.name)return _S(e,l,f)?(0,di.of)(new un([],{})):vy(e);throw I}))}expandSegmentAgainstRoute(t,e,n,l,f,D,I){return gS(l,e,f,D)?void 0===l.redirectTo?this.matchSegmentAgainstRoute(t,e,l,f,D):I&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,n,l,f,D):vy(e):vy(e)}expandSegmentAgainstRouteUsingRedirect(t,e,n,l,f,D){return"**"===l.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,n,l,D):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,l,f,D)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,n,l){const f=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?vS(f):this.lineralizeSegments(n,f).pipe((0,zr.z)(D=>{const I=new un(D,{});return this.expandSegment(t,I,e,D,l,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,l,f,D){const{matched:I,consumedSegments:B,remainingSegments:Z,positionalParamSegments:se}=w0(e,l,f);if(!I)return vy(e);const ge=this.applyRedirectCommands(B,l.redirectTo,se);return l.redirectTo.startsWith("/")?vS(ge):this.lineralizeSegments(l,ge).pipe((0,zr.z)(qe=>this.expandSegment(t,e,n,qe.concat(Z),D,!1)))}matchSegmentAgainstRoute(t,e,n,l,f){if("**"===n.path)return n.loadChildren?(n._loadedConfig?(0,di.of)(n._loadedConfig):this.configLoader.load(t.injector,n)).pipe((0,ji.U)(ge=>(n._loadedConfig=ge,new un(l,{})))):(0,di.of)(new un(l,{}));const{matched:D,consumedSegments:I,remainingSegments:B}=w0(e,n,l);return D?this.getChildConfig(t,n,l).pipe((0,zr.z)(se=>{const ge=se.module,qe=se.routes,{segmentGroup:it,slicedSegments:bt}=C0(e,I,B,qe),ti=new un(it.segments,it.children);if(0===bt.length&&ti.hasChildren())return this.expandChildren(ge,qe,ti).pipe((0,ji.U)(fr=>new un(I,fr)));if(0===qe.length&&0===bt.length)return(0,di.of)(new un(I,{}));const yi=vl(n)===f;return this.expandSegment(ge,ti,qe,bt,yi?rn:f,!0).pipe((0,ji.U)(vn=>new un(I.concat(vn.segments),vn.children)))})):vy(e)}getChildConfig(t,e,n){return e.children?(0,di.of)(new gM(e.children,t)):e.loadChildren?void 0!==e._loadedConfig?(0,di.of)(e._loadedConfig):this.runCanLoadGuards(t.injector,e,n).pipe((0,zr.z)(l=>l?this.configLoader.load(t.injector,e).pipe((0,ji.U)(f=>(e._loadedConfig=f,f))):function qR(i){return fd(sM(`Cannot load children because the guard of the route "path: '${i.path}'" returned false`))}(e))):(0,di.of)(new gM([],t))}runCanLoadGuards(t,e,n){const l=e.canLoad;if(!l||0===l.length)return(0,di.of)(!0);const f=l.map(D=>{const I=t.get(D);let B;if(function PR(i){return i&&Lh(i.canLoad)}(I))B=I.canLoad(e,n);else{if(!Lh(I))throw new Error("Invalid CanLoad guard");B=I(e,n)}return ru(B)});return(0,di.of)(f).pipe(_y(),Gr(D=>{if(!af(D))return;const I=sM(`Redirecting to "${this.urlSerializer.serialize(D)}"`);throw I.url=D,I}),(0,ji.U)(D=>!0===D))}lineralizeSegments(t,e){let n=[],l=e.root;for(;;){if(n=n.concat(l.segments),0===l.numberOfChildren)return(0,di.of)(n);if(l.numberOfChildren>1||!l.children[rn])return fd(new Error(`Only absolute redirects can have named outlets. redirectTo: '${t.redirectTo}'`));l=l.children[rn]}}applyRedirectCommands(t,e,n){return this.applyRedirectCreatreUrlTree(e,this.urlSerializer.parse(e),t,n)}applyRedirectCreatreUrlTree(t,e,n,l){const f=this.createSegmentGroup(t,e.root,n,l);return new rf(f,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const n={};return ts(t,(l,f)=>{if("string"==typeof l&&l.startsWith(":")){const I=l.substring(1);n[f]=e[I]}else n[f]=l}),n}createSegmentGroup(t,e,n,l){const f=this.createSegments(t,e.segments,n,l);let D={};return ts(e.children,(I,B)=>{D[B]=this.createSegmentGroup(t,I,n,l)}),new un(f,D)}createSegments(t,e,n,l){return e.map(f=>f.path.startsWith(":")?this.findPosParam(t,f,l):this.findOrReturn(f,n))}findPosParam(t,e,n){const l=n[e.path.substring(1)];if(!l)throw new Error(`Cannot redirect to '${t}'. Cannot find '${e.path}'.`);return l}findOrReturn(t,e){let n=0;for(const l of e){if(l.path===t.path)return e.splice(n),l;n++}return t}}function vM(i){const t={};for(const n of Object.keys(i.children)){const f=vM(i.children[n]);(f.segments.length>0||f.hasChildren())&&(t[n]=f)}return function ZR(i){if(1===i.numberOfChildren&&i.children[rn]){const t=i.children[rn];return new un(i.segments.concat(t.segments),t.children)}return i}(new un(i.segments,t))}class bS{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class E0{constructor(t,e){this.component=t,this.route=e}}function XR(i,t,e){const n=i._root;return by(n,t?t._root:null,e,[n.value])}function S0(i,t,e){const n=function JR(i){if(!i)return null;for(let t=i.parent;t;t=t.parent){const e=t.routeConfig;if(e&&e._loadedConfig)return e._loadedConfig}return null}(t);return(n?n.module.injector:e).get(i)}function by(i,t,e,n,l={canDeactivateChecks:[],canActivateChecks:[]}){const f=Ym(t);return i.children.forEach(D=>{(function eP(i,t,e,n,l={canDeactivateChecks:[],canActivateChecks:[]}){const f=i.value,D=t?t.value:null,I=e?e.getContext(i.value.outlet):null;if(D&&f.routeConfig===D.routeConfig){const B=function tP(i,t,e){if("function"==typeof e)return e(i,t);switch(e){case"pathParamsChange":return!sf(i.url,t.url);case"pathParamsOrQueryParamsChange":return!sf(i.url,t.url)||!nu(i.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!hM(i,t)||!nu(i.queryParams,t.queryParams);default:return!hM(i,t)}}(D,f,f.routeConfig.runGuardsAndResolvers);B?l.canActivateChecks.push(new bS(n)):(f.data=D.data,f._resolvedData=D._resolvedData),by(i,t,f.component?I?I.children:null:e,n,l),B&&I&&I.outlet&&I.outlet.isActivated&&l.canDeactivateChecks.push(new E0(I.outlet.component,D))}else D&&xy(t,I,l),l.canActivateChecks.push(new bS(n)),by(i,null,f.component?I?I.children:null:e,n,l)})(D,f[D.value.outlet],e,n.concat([D.value]),l),delete f[D.value.outlet]}),ts(f,(D,I)=>xy(D,e.getContext(I),l)),l}function xy(i,t,e){const n=Ym(i),l=i.value;ts(n,(f,D)=>{xy(f,l.component?t?t.children.getContext(D):null:t,e)}),e.canDeactivateChecks.push(new E0(l.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,l))}class uP{}function xS(i){return new Un.y(t=>t.error(i))}class hP{constructor(t,e,n,l,f,D){this.rootComponentType=t,this.config=e,this.urlTree=n,this.url=l,this.paramsInheritanceStrategy=f,this.relativeLinkResolution=D}recognize(){const t=C0(this.urlTree.root,[],[],this.config.filter(D=>void 0===D.redirectTo),this.relativeLinkResolution).segmentGroup,e=this.processSegmentGroup(this.config,t,rn);if(null===e)return null;const n=new v0([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},rn,this.rootComponentType,null,this.urlTree.root,-1,{}),l=new Dd(n,e),f=new oS(this.url,l);return this.inheritParamsAndData(f._root),f}inheritParamsAndData(t){const e=t.value,n=rS(e,this.paramsInheritanceStrategy);e.params=Object.freeze(n.params),e.data=Object.freeze(n.data),t.children.forEach(l=>this.inheritParamsAndData(l))}processSegmentGroup(t,e,n){return 0===e.segments.length&&e.hasChildren()?this.processChildren(t,e):this.processSegment(t,e,e.segments,n)}processChildren(t,e){const n=[];for(const f of Object.keys(e.children)){const D=e.children[f],I=fS(t,f),B=this.processSegmentGroup(I,D,f);if(null===B)return null;n.push(...B)}const l=wS(n);return function pP(i){i.sort((t,e)=>t.value.outlet===rn?-1:e.value.outlet===rn?1:t.value.outlet.localeCompare(e.value.outlet))}(l),l}processSegment(t,e,n,l){for(const f of t){const D=this.processSegmentAgainstRoute(f,e,n,l);if(null!==D)return D}return _S(e,n,l)?[]:null}processSegmentAgainstRoute(t,e,n,l){if(t.redirectTo||!gS(t,e,n,l))return null;let f,D=[],I=[];if("**"===t.path){const it=n.length>0?GE(n).parameters:{};f=new v0(n,it,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,DS(t),vl(t),t.component,t,CS(e),MS(e)+n.length,ES(t))}else{const it=w0(e,t,n);if(!it.matched)return null;D=it.consumedSegments,I=it.remainingSegments,f=new v0(D,it.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,DS(t),vl(t),t.component,t,CS(e),MS(e)+D.length,ES(t))}const B=function fP(i){return i.children?i.children:i.loadChildren?i._loadedConfig.routes:[]}(t),{segmentGroup:Z,slicedSegments:se}=C0(e,D,I,B.filter(it=>void 0===it.redirectTo),this.relativeLinkResolution);if(0===se.length&&Z.hasChildren()){const it=this.processChildren(B,Z);return null===it?null:[new Dd(f,it)]}if(0===B.length&&0===se.length)return[new Dd(f,[])];const ge=vl(t)===l,qe=this.processSegment(B,Z,se,ge?rn:l);return null===qe?null:[new Dd(f,qe)]}}function mP(i){const t=i.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}function wS(i){const t=[],e=new Set;for(const n of i){if(!mP(n)){t.push(n);continue}const l=t.find(f=>n.value.routeConfig===f.value.routeConfig);void 0!==l?(l.children.push(...n.children),e.add(l)):t.push(n)}for(const n of e){const l=wS(n.children);t.push(new Dd(n.value,l))}return t.filter(n=>!e.has(n))}function CS(i){let t=i;for(;t._sourceSegment;)t=t._sourceSegment;return t}function MS(i){let t=i,e=t._segmentIndexShift?t._segmentIndexShift:0;for(;t._sourceSegment;)t=t._sourceSegment,e+=t._segmentIndexShift?t._segmentIndexShift:0;return e-1}function DS(i){return i.data||{}}function ES(i){return i.resolve||{}}function SS(i){return[...Object.keys(i),...Object.getOwnPropertySymbols(i)]}function bM(i){return(0,_l.w)(t=>{const e=i(t);return e?(0,Hn.D)(e).pipe((0,ji.U)(()=>t)):(0,di.of)(t)})}class CP extends class wP{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}{}const xM=new h.OlP("ROUTES");class TS{constructor(t,e,n,l){this.injector=t,this.compiler=e,this.onLoadStartListener=n,this.onLoadEndListener=l}load(t,e){if(e._loader$)return e._loader$;this.onLoadStartListener&&this.onLoadStartListener(e);const l=this.loadModuleFactory(e.loadChildren).pipe((0,ji.U)(f=>{this.onLoadEndListener&&this.onLoadEndListener(e);const D=f.create(t);return new gM(HE(D.injector.get(xM,void 0,h.XFs.Self|h.XFs.Optional)).map(yM),D)}),(0,rc.K)(f=>{throw e._loader$=void 0,f}));return e._loader$=new Nk(l,()=>new ki.x).pipe(PE()),e._loader$}loadModuleFactory(t){return ru(t()).pipe((0,zr.z)(e=>e instanceof h.YKP?(0,di.of)(e):(0,Hn.D)(this.compiler.compileModuleAsync(e))))}}class DP{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,e){return t}}function EP(i){throw i}function SP(i,t,e){return t.parse("/")}function AS(i,t){return(0,di.of)(null)}const TP={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},AP={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Ia=(()=>{class i{constructor(e,n,l,f,D,I,B){this.rootComponentType=e,this.urlSerializer=n,this.rootContexts=l,this.location=f,this.config=B,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new ki.x,this.errorHandler=EP,this.malformedUriErrorHandler=SP,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:AS,afterPreactivation:AS},this.urlHandlingStrategy=new DP,this.routeReuseStrategy=new CP,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=D.get(h.h0i),this.console=D.get(h.c2e);const ge=D.get(h.R0b);this.isNgZoneEnabled=ge instanceof h.R0b&&h.R0b.isInAngularZone(),this.resetConfig(B),this.currentUrlTree=function tR(){return new rf(new un([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new TS(D,I,qe=>this.triggerEvent(new NE(qe)),qe=>this.triggerEvent(new VE(qe))),this.routerState=nS(this.currentUrlTree,this.rootComponentType),this.transitions=new Xr.X({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var e;return null===(e=this.location.getState())||void 0===e?void 0:e.\u0275routerPageId}setupNavigations(e){const n=this.events;return e.pipe((0,Kr.h)(l=>0!==l.id),(0,ji.U)(l=>Object.assign(Object.assign({},l),{extractedUrl:this.urlHandlingStrategy.extract(l.rawUrl)})),(0,_l.w)(l=>{let f=!1,D=!1;return(0,di.of)(l).pipe(Gr(I=>{this.currentNavigation={id:I.id,initialUrl:I.currentRawUrl,extractedUrl:I.extractedUrl,trigger:I.source,extras:I.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),(0,_l.w)(I=>{const B=this.browserUrlTree.toString(),Z=!this.navigated||I.extractedUrl.toString()!==B||B!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||Z)&&this.urlHandlingStrategy.shouldProcessUrl(I.rawUrl))return IS(I.source)&&(this.browserUrlTree=I.extractedUrl),(0,di.of)(I).pipe((0,_l.w)(ge=>{const qe=this.transitions.getValue();return n.next(new oM(ge.id,this.serializeUrl(ge.extractedUrl),ge.source,ge.restoredState)),qe!==this.transitions.getValue()?Gm.E:Promise.resolve(ge)}),function KR(i,t,e,n){return(0,_l.w)(l=>function YR(i,t,e,n,l){return new WR(i,t,e,n,l).apply()}(i,t,e,l.extractedUrl,n).pipe((0,ji.U)(f=>Object.assign(Object.assign({},l),{urlAfterRedirects:f}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),Gr(ge=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:ge.urlAfterRedirects})}),function gP(i,t,e,n,l){return(0,zr.z)(f=>function dP(i,t,e,n,l="emptyOnly",f="legacy"){try{const D=new hP(i,t,e,n,l,f).recognize();return null===D?xS(new uP):(0,di.of)(D)}catch(D){return xS(D)}}(i,t,f.urlAfterRedirects,e(f.urlAfterRedirects),n,l).pipe((0,ji.U)(D=>Object.assign(Object.assign({},f),{targetSnapshot:D}))))}(this.rootComponentType,this.config,ge=>this.serializeUrl(ge),this.paramsInheritanceStrategy,this.relativeLinkResolution),Gr(ge=>{if("eager"===this.urlUpdateStrategy){if(!ge.extras.skipLocationChange){const it=this.urlHandlingStrategy.merge(ge.urlAfterRedirects,ge.rawUrl);this.setBrowserUrl(it,ge)}this.browserUrlTree=ge.urlAfterRedirects}const qe=new Uk(ge.id,this.serializeUrl(ge.extractedUrl),this.serializeUrl(ge.urlAfterRedirects),ge.targetSnapshot);n.next(qe)}));if(Z&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:qe,extractedUrl:it,source:bt,restoredState:ti,extras:yi}=I,Mn=new oM(qe,this.serializeUrl(it),bt,ti);n.next(Mn);const vn=nS(it,this.rootComponentType).snapshot;return(0,di.of)(Object.assign(Object.assign({},I),{targetSnapshot:vn,urlAfterRedirects:it,extras:Object.assign(Object.assign({},yi),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=I.rawUrl,I.resolve(null),Gm.E}),bM(I=>{const{targetSnapshot:B,id:Z,extractedUrl:se,rawUrl:ge,extras:{skipLocationChange:qe,replaceUrl:it}}=I;return this.hooks.beforePreactivation(B,{navigationId:Z,appliedUrlTree:se,rawUrlTree:ge,skipLocationChange:!!qe,replaceUrl:!!it})}),Gr(I=>{const B=new Hk(I.id,this.serializeUrl(I.extractedUrl),this.serializeUrl(I.urlAfterRedirects),I.targetSnapshot);this.triggerEvent(B)}),(0,ji.U)(I=>Object.assign(Object.assign({},I),{guards:XR(I.targetSnapshot,I.currentSnapshot,this.rootContexts)})),function iP(i,t){return(0,zr.z)(e=>{const{targetSnapshot:n,currentSnapshot:l,guards:{canActivateChecks:f,canDeactivateChecks:D}}=e;return 0===D.length&&0===f.length?(0,di.of)(Object.assign(Object.assign({},e),{guardsResult:!0})):function nP(i,t,e,n){return(0,Hn.D)(i).pipe((0,zr.z)(l=>function cP(i,t,e,n,l){const f=t&&t.routeConfig?t.routeConfig.canDeactivate:null;if(!f||0===f.length)return(0,di.of)(!0);const D=f.map(I=>{const B=S0(I,t,l);let Z;if(function LR(i){return i&&Lh(i.canDeactivate)}(B))Z=ru(B.canDeactivate(i,t,e,n));else{if(!Lh(B))throw new Error("Invalid CanDeactivate guard");Z=ru(B(i,t,e,n))}return Z.pipe($m())});return(0,di.of)(D).pipe(_y())}(l.component,l.route,e,t,n)),$m(l=>!0!==l,!0))}(D,n,l,i).pipe((0,zr.z)(I=>I&&function RR(i){return"boolean"==typeof i}(I)?function rP(i,t,e,n){return(0,Hn.D)(t).pipe((0,Dh.b)(l=>vh(function sP(i,t){return null!==i&&t&&t(new Yk(i)),(0,di.of)(!0)}(l.route.parent,n),function oP(i,t){return null!==i&&t&&t(new Zk(i)),(0,di.of)(!0)}(l.route,n),function lP(i,t,e){const n=t[t.length-1],f=t.slice(0,t.length-1).reverse().map(D=>function QR(i){const t=i.routeConfig?i.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:i,guards:t}:null}(D)).filter(D=>null!==D).map(D=>tf(()=>{const I=D.guards.map(B=>{const Z=S0(B,D.node,e);let se;if(function FR(i){return i&&Lh(i.canActivateChild)}(Z))se=ru(Z.canActivateChild(n,i));else{if(!Lh(Z))throw new Error("Invalid CanActivateChild guard");se=ru(Z(n,i))}return se.pipe($m())});return(0,di.of)(I).pipe(_y())}));return(0,di.of)(f).pipe(_y())}(i,l.path,e),function aP(i,t,e){const n=t.routeConfig?t.routeConfig.canActivate:null;if(!n||0===n.length)return(0,di.of)(!0);const l=n.map(f=>tf(()=>{const D=S0(f,t,e);let I;if(function OR(i){return i&&Lh(i.canActivate)}(D))I=ru(D.canActivate(t,i));else{if(!Lh(D))throw new Error("Invalid CanActivate guard");I=ru(D(t,i))}return I.pipe($m())}));return(0,di.of)(l).pipe(_y())}(i,l.route,e))),$m(l=>!0!==l,!0))}(n,f,i,t):(0,di.of)(I)),(0,ji.U)(I=>Object.assign(Object.assign({},e),{guardsResult:I})))})}(this.ngModule.injector,I=>this.triggerEvent(I)),Gr(I=>{if(af(I.guardsResult)){const Z=sM(`Redirecting to "${this.serializeUrl(I.guardsResult)}"`);throw Z.url=I.guardsResult,Z}const B=new Gk(I.id,this.serializeUrl(I.extractedUrl),this.serializeUrl(I.urlAfterRedirects),I.targetSnapshot,!!I.guardsResult);this.triggerEvent(B)}),(0,Kr.h)(I=>!!I.guardsResult||(this.restoreHistory(I),this.cancelNavigationTransition(I,""),!1)),bM(I=>{if(I.guards.canActivateChecks.length)return(0,di.of)(I).pipe(Gr(B=>{const Z=new $k(B.id,this.serializeUrl(B.extractedUrl),this.serializeUrl(B.urlAfterRedirects),B.targetSnapshot);this.triggerEvent(Z)}),(0,_l.w)(B=>{let Z=!1;return(0,di.of)(B).pipe(function _P(i,t){return(0,zr.z)(e=>{const{targetSnapshot:n,guards:{canActivateChecks:l}}=e;if(!l.length)return(0,di.of)(e);let f=0;return(0,Hn.D)(l).pipe((0,Dh.b)(D=>function yP(i,t,e,n){return function vP(i,t,e,n){const l=SS(i);if(0===l.length)return(0,di.of)({});const f={};return(0,Hn.D)(l).pipe((0,zr.z)(D=>function bP(i,t,e,n){const l=S0(i,t,n);return ru(l.resolve?l.resolve(t,e):l(t,e))}(i[D],t,e,n).pipe(Gr(I=>{f[D]=I}))),rM(1),(0,zr.z)(()=>SS(f).length===l.length?(0,di.of)(f):Gm.E))}(i._resolve,i,t,n).pipe((0,ji.U)(f=>(i._resolvedData=f,i.data=Object.assign(Object.assign({},i.data),rS(i,e).resolve),null)))}(D.route,n,i,t)),Gr(()=>f++),rM(1),(0,zr.z)(D=>f===l.length?(0,di.of)(e):Gm.E))})}(this.paramsInheritanceStrategy,this.ngModule.injector),Gr({next:()=>Z=!0,complete:()=>{Z||(this.restoreHistory(B),this.cancelNavigationTransition(B,"At least one route resolver didn't emit any value."))}}))}),Gr(B=>{const Z=new qk(B.id,this.serializeUrl(B.extractedUrl),this.serializeUrl(B.urlAfterRedirects),B.targetSnapshot);this.triggerEvent(Z)}))}),bM(I=>{const{targetSnapshot:B,id:Z,extractedUrl:se,rawUrl:ge,extras:{skipLocationChange:qe,replaceUrl:it}}=I;return this.hooks.afterPreactivation(B,{navigationId:Z,appliedUrlTree:se,rawUrlTree:ge,skipLocationChange:!!qe,replaceUrl:!!it})}),(0,ji.U)(I=>{const B=function vR(i,t,e){const n=fy(i,t._root,e?e._root:void 0);return new iS(n,t)}(this.routeReuseStrategy,I.targetSnapshot,I.currentRouterState);return Object.assign(Object.assign({},I),{targetRouterState:B})}),Gr(I=>{this.currentUrlTree=I.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(I.urlAfterRedirects,I.rawUrl),this.routerState=I.targetRouterState,"deferred"===this.urlUpdateStrategy&&(I.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,I),this.browserUrlTree=I.urlAfterRedirects)}),((i,t,e)=>(0,ji.U)(n=>(new IR(t,n.targetRouterState,n.currentRouterState,e).activate(i),n)))(this.rootContexts,this.routeReuseStrategy,I=>this.triggerEvent(I)),Gr({next(){f=!0},complete(){f=!0}}),function Zx(i){return(0,ms.e)((t,e)=>{try{t.subscribe(e)}finally{e.add(i)}})}(()=>{var I;f||D||this.cancelNavigationTransition(l,`Navigation ID ${l.id} is not equal to the current navigation id ${this.navigationId}`),(null===(I=this.currentNavigation)||void 0===I?void 0:I.id)===l.id&&(this.currentNavigation=null)}),(0,rc.K)(I=>{if(D=!0,function Qk(i){return i&&i[jE]}(I)){const B=af(I.url);B||(this.navigated=!0,this.restoreHistory(l,!0));const Z=new BE(l.id,this.serializeUrl(l.extractedUrl),I.message);n.next(Z),B?setTimeout(()=>{const se=this.urlHandlingStrategy.merge(I.url,this.rawUrlTree),ge={skipLocationChange:l.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||IS(l.source)};this.scheduleNavigation(se,"imperative",null,ge,{resolve:l.resolve,reject:l.reject,promise:l.promise})},0):l.resolve(!1)}else{this.restoreHistory(l,!0);const B=new jk(l.id,this.serializeUrl(l.extractedUrl),I);n.next(B);try{l.resolve(this.errorHandler(I))}catch(Z){l.reject(Z)}}return Gm.E}))}))}resetRootComponentType(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}setTransition(e){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),e))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const n="popstate"===e.type?"popstate":"hashchange";"popstate"===n&&setTimeout(()=>{var l;const f={replaceUrl:!0},D=(null===(l=e.state)||void 0===l?void 0:l.navigationId)?e.state:null;if(D){const B=Object.assign({},D);delete B.navigationId,delete B.\u0275routerPageId,0!==Object.keys(B).length&&(f.state=B)}const I=this.parseUrl(e.url);this.scheduleNavigation(I,n,D,f)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(e){this.events.next(e)}resetConfig(e){pS(e),this.config=e.map(yM),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(e,n={}){const{relativeTo:l,queryParams:f,fragment:D,queryParamsHandling:I,preserveFragment:B}=n,Z=l||this.routerState.root,se=B?this.currentUrlTree.fragment:D;let ge=null;switch(I){case"merge":ge=Object.assign(Object.assign({},this.currentUrlTree.queryParams),f);break;case"preserve":ge=this.currentUrlTree.queryParams;break;default:ge=f||null}return null!==ge&&(ge=this.removeEmptyProps(ge)),function wR(i,t,e,n,l){if(0===e.length)return pM(t.root,t.root,t.root,n,l);const f=function CR(i){if("string"==typeof i[0]&&1===i.length&&"/"===i[0])return new lS(!0,0,i);let t=0,e=!1;const n=i.reduce((l,f,D)=>{if("object"==typeof f&&null!=f){if(f.outlets){const I={};return ts(f.outlets,(B,Z)=>{I[Z]="string"==typeof B?B.split("/"):B}),[...l,{outlets:I}]}if(f.segmentPath)return[...l,f.segmentPath]}return"string"!=typeof f?[...l,f]:0===D?(f.split("/").forEach((I,B)=>{0==B&&"."===I||(0==B&&""===I?e=!0:".."===I?t++:""!=I&&l.push(I))}),l):[...l,f]},[]);return new lS(e,t,n)}(e);if(f.toRoot())return pM(t.root,t.root,new un([],{}),n,l);const D=function MR(i,t,e){if(i.isAbsolute)return new fM(t.root,!0,0);if(-1===e.snapshot._lastPathIndex){const f=e.snapshot._urlSegment;return new fM(f,f===t.root,0)}const n=b0(i.commands[0])?0:1;return function DR(i,t,e){let n=i,l=t,f=e;for(;f>l;){if(f-=l,n=n.parent,!n)throw new Error("Invalid number of '../'");l=n.segments.length}return new fM(n,!1,l-f)}(e.snapshot._urlSegment,e.snapshot._lastPathIndex+n,i.numberOfDoubleDots)}(f,t,i),I=D.processChildren?x0(D.segmentGroup,D.index,f.commands):cS(D.segmentGroup,D.index,f.commands);return pM(t.root,D.segmentGroup,I,n,l)}(Z,this.currentUrlTree,e,ge,null!=se?se:null)}navigateByUrl(e,n={skipLocationChange:!1}){const l=af(e)?e:this.parseUrl(e),f=this.urlHandlingStrategy.merge(l,this.rawUrlTree);return this.scheduleNavigation(f,"imperative",null,n)}navigate(e,n={skipLocationChange:!1}){return function IP(i){for(let t=0;t<i.length;t++){const e=i[t];if(null==e)throw new Error(`The requested path contains ${e} segment at index ${t}`)}}(e),this.navigateByUrl(this.createUrlTree(e,n),n)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let n;try{n=this.urlSerializer.parse(e)}catch(l){n=this.malformedUriErrorHandler(l,this.urlSerializer,e)}return n}isActive(e,n){let l;if(l=!0===n?Object.assign({},TP):!1===n?Object.assign({},AP):n,af(e))return qE(this.currentUrlTree,e,l);const f=this.parseUrl(e);return qE(this.currentUrlTree,f,l)}removeEmptyProps(e){return Object.keys(e).reduce((n,l)=>{const f=e[l];return null!=f&&(n[l]=f),n},{})}processNavigations(){this.navigations.subscribe(e=>{this.navigated=!0,this.lastSuccessfulId=e.id,this.currentPageId=e.targetPageId,this.events.next(new dy(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,e.resolve(!0)},e=>{this.console.warn(`Unhandled Navigation Error: ${e}`)})}scheduleNavigation(e,n,l,f,D){var I,B;if(this.disposed)return Promise.resolve(!1);let Z,se,ge;D?(Z=D.resolve,se=D.reject,ge=D.promise):ge=new Promise((bt,ti)=>{Z=bt,se=ti});const qe=++this.navigationId;let it;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(l=this.location.getState()),it=l&&l.\u0275routerPageId?l.\u0275routerPageId:f.replaceUrl||f.skipLocationChange?null!==(I=this.browserPageId)&&void 0!==I?I:0:(null!==(B=this.browserPageId)&&void 0!==B?B:0)+1):it=0,this.setTransition({id:qe,targetPageId:it,source:n,restoredState:l,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:f,resolve:Z,reject:se,promise:ge,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),ge.catch(bt=>Promise.reject(bt))}setBrowserUrl(e,n){const l=this.urlSerializer.serialize(e),f=Object.assign(Object.assign({},n.extras.state),this.generateNgRouterState(n.id,n.targetPageId));this.location.isCurrentPathEqualTo(l)||n.extras.replaceUrl?this.location.replaceState(l,"",f):this.location.go(l,"",f)}restoreHistory(e,n=!1){var l,f;if("computed"===this.canceledNavigationResolution){const D=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(l=this.currentNavigation)||void 0===l?void 0:l.finalUrl)||0===D?this.currentUrlTree===(null===(f=this.currentNavigation)||void 0===f?void 0:f.finalUrl)&&0===D&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(D)}else"replace"===this.canceledNavigationResolution&&(n&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(e,n){const l=new BE(e.id,this.serializeUrl(e.extractedUrl),n);this.triggerEvent(l),e.resolve(!1)}generateNgRouterState(e,n){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:n}:{navigationId:e}}}return i.\u0275fac=function(e){h.$Z()},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac}),i})();function IS(i){return"imperative"!==i}class kS{}class RS{preload(t,e){return(0,di.of)(null)}}let PS=(()=>{class i{constructor(e,n,l,f){this.router=e,this.injector=l,this.preloadingStrategy=f,this.loader=new TS(l,n,B=>e.triggerEvent(new NE(B)),B=>e.triggerEvent(new VE(B)))}setUpPreloading(){this.subscription=this.router.events.pipe((0,Kr.h)(e=>e instanceof dy),(0,Dh.b)(()=>this.preload())).subscribe(()=>{})}preload(){const e=this.injector.get(h.h0i);return this.processRoutes(e,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,n){const l=[];for(const f of n)if(f.loadChildren&&!f.canLoad&&f._loadedConfig){const D=f._loadedConfig;l.push(this.processRoutes(D.module,D.routes))}else f.loadChildren&&!f.canLoad?l.push(this.preloadConfig(e,f)):f.children&&l.push(this.processRoutes(e,f.children));return(0,Hn.D)(l).pipe((0,to.J)(),(0,ji.U)(f=>{}))}preloadConfig(e,n){return this.preloadingStrategy.preload(n,()=>(n._loadedConfig?(0,di.of)(n._loadedConfig):this.loader.load(e.injector,n)).pipe((0,zr.z)(f=>(n._loadedConfig=f,this.processRoutes(f.module,f.routes)))))}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(Ia),h.LFG(h.Sil),h.LFG(h.zs3),h.LFG(kS))},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac}),i})(),MM=(()=>{class i{constructor(e,n,l={}){this.router=e,this.viewportScroller=n,this.options=l,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},l.scrollPositionRestoration=l.scrollPositionRestoration||"disabled",l.anchorScrolling=l.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(e=>{e instanceof oM?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof dy&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.router.parseUrl(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(e=>{e instanceof zE&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,n){this.router.triggerEvent(new zE(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,n))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return i.\u0275fac=function(e){h.$Z()},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac}),i})();const lf=new h.OlP("ROUTER_CONFIGURATION"),OS=new h.OlP("ROUTER_FORROOT_GUARD"),OP=[ut,{provide:KE,useClass:XE},{provide:Ia,useFactory:function VP(i,t,e,n,l,f,D={},I,B){const Z=new Ia(null,i,t,e,n,l,HE(f));return I&&(Z.urlHandlingStrategy=I),B&&(Z.routeReuseStrategy=B),function zP(i,t){i.errorHandler&&(t.errorHandler=i.errorHandler),i.malformedUriErrorHandler&&(t.malformedUriErrorHandler=i.malformedUriErrorHandler),i.onSameUrlNavigation&&(t.onSameUrlNavigation=i.onSameUrlNavigation),i.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=i.paramsInheritanceStrategy),i.relativeLinkResolution&&(t.relativeLinkResolution=i.relativeLinkResolution),i.urlUpdateStrategy&&(t.urlUpdateStrategy=i.urlUpdateStrategy),i.canceledNavigationResolution&&(t.canceledNavigationResolution=i.canceledNavigationResolution)}(D,Z),D.enableTracing&&Z.events.subscribe(se=>{var ge,qe;null===(ge=console.group)||void 0===ge||ge.call(console,`Router Event: ${se.constructor.name}`),console.log(se.toString()),console.log(se),null===(qe=console.groupEnd)||void 0===qe||qe.call(console)}),Z},deps:[KE,yy,ut,h.zs3,h.Sil,xM,lf,[class MP{},new h.FiY],[class xP{},new h.FiY]]},yy,{provide:Wm,useFactory:function jP(i){return i.routerState.root},deps:[Ia]},PS,RS,class PP{preload(t,e){return e().pipe((0,rc.K)(()=>(0,di.of)(null)))}},{provide:lf,useValue:{enableTracing:!1}}];function FP(){return new h.PXZ("Router",Ia)}let FS=(()=>{class i{constructor(e,n){}static forRoot(e,n){return{ngModule:i,providers:[OP,LS(e),{provide:OS,useFactory:NP,deps:[[Ia,new h.FiY,new h.tp0]]},{provide:lf,useValue:n||{}},{provide:nt,useFactory:BP,deps:[xe,[new h.tBr(Ht),new h.FiY],lf]},{provide:MM,useFactory:LP,deps:[Ia,Hh,lf]},{provide:kS,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:RS},{provide:h.PXZ,multi:!0,useFactory:FP},[DM,{provide:h.ip1,multi:!0,useFactory:UP,deps:[DM]},{provide:BS,useFactory:HP,deps:[DM]},{provide:h.tb,multi:!0,useExisting:BS}]]}}static forChild(e){return{ngModule:i,providers:[LS(e)]}}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(OS,8),h.LFG(Ia,8))},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({}),i})();function LP(i,t,e){return e.scrollOffset&&t.setOffset(e.scrollOffset),new MM(i,t,e)}function BP(i,t,e={}){return e.useHash?new xt(i,t):new $t(i,t)}function NP(i){return"guarded"}function LS(i){return[{provide:h.deG,multi:!0,useValue:i},{provide:xM,multi:!0,useValue:i}]}let DM=(()=>{class i{constructor(e){this.injector=e,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new ki.x}appInitializer(){return this.injector.get(Le,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let n=null;const l=new Promise(I=>n=I),f=this.injector.get(Ia),D=this.injector.get(lf);return"disabled"===D.initialNavigation?(f.setUpLocationChangeListener(),n(!0)):"enabled"===D.initialNavigation||"enabledBlocking"===D.initialNavigation?(f.hooks.afterPreactivation=()=>this.initNavigation?(0,di.of)(null):(this.initNavigation=!0,n(!0),this.resultOfPreactivationDone),f.initialNavigation()):n(!0),l})}bootstrapListener(e){const n=this.injector.get(lf),l=this.injector.get(PS),f=this.injector.get(MM),D=this.injector.get(Ia),I=this.injector.get(h.z2F);e===I.components[0]&&(("enabledNonBlocking"===n.initialNavigation||void 0===n.initialNavigation)&&D.initialNavigation(),l.setUpPreloading(),f.init(),D.resetRootComponentType(I.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return i.\u0275fac=function(e){return new(e||i)(h.LFG(h.zs3))},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac}),i})();function UP(i){return i.appInitializer.bind(i)}function HP(i){return i.bootstrapListener.bind(i)}const BS=new h.OlP("Router Initializer");let wy=(()=>{class i{constructor(){this.data=new ki.x,this.coOrdinateObject=new ki.x,this.isShowSlider=!1}setData(e){this.data.next(e)}setLatLong(e,n){this.coOrdinateObject.next({lat:e,long:n})}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=h.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var sa=Y(5620);const $P=(0,sa.ZF)("agent"),qP=(0,sa.P1)($P,i=>i.agentInfo),YP=(0,sa.ZF)("list"),NS=(0,sa.P1)(YP,i=>i.records);function WP(i,t){if(1&i&&(h.TgZ(0,"h3",4),h._uU(1),h.qZA()),2&i){const e=t.$implicit;h.xp6(1),h.lnq("",e.firstname," ",e.lastname," | ",e.company,"")}}function ZP(i,t){if(1&i){const e=h.EpF();h.TgZ(0,"div",5),h.NdJ("click",function(){const f=h.CHM(e).$implicit;return h.oxw().openSlider(f)}),h.TgZ(1,"p",6),h._uU(2),h.qZA(),h.TgZ(3,"div",7),h._UZ(4,"img",8),h.TgZ(5,"p",9),h._uU(6),h.qZA()()()}if(2&i){const e=t.$implicit;h.xp6(2),h.Oqu(e.name),h.xp6(2),h.s9C("src",e.photo,h.LSH),h.xp6(2),h.lnq("",e.streetAddress,", ",e.city,", ",e.state,"")}}let KP=(()=>{class i{constructor(e,n){this.store=e,this.commonService=n,this.showComponent=new h.vpe(!1),this.specificDetail=[]}ngOnInit(){this.list=this.store.select(NS),this.agent=this.store.select(qP)}openSlider(e){this.commonService.setData(e.propertyID),this.commonService.setLatLong(e.geocode.Latitude,e.geocode.Longitude),this.showComponent.emit(!0)}}return i.\u0275fac=function(e){return new(e||i)(h.Y36(sa.yh),h.Y36(wy))},i.\u0275cmp=h.Xpm({type:i,selectors:[["app-properties"]],outputs:{showComponent:"showComponent"},decls:6,vars:6,consts:[[1,"properties"],["style","text-align: center; font-weight: 500; font-size: 26px; text-decoration: underline; margin-top: 2%; ",4,"ngFor","ngForOf"],[1,"list"],["class","property",3,"click",4,"ngFor","ngForOf"],[2,"text-align","center","font-weight","500","font-size","26px","text-decoration","underline","margin-top","2%"],[1,"property",3,"click"],[1,"p-name"],[1,"details"],["alt","property image",1,"p-image",3,"src"],[1,"p-city"]],template:function(e,n){1&e&&(h.TgZ(0,"div",0),h.YNc(1,WP,2,3,"h3",1),h.ALo(2,"async"),h.TgZ(3,"div",2),h.YNc(4,ZP,7,5,"div",3),h.ALo(5,"async"),h.qZA()()),2&e&&(h.xp6(1),h.Q6J("ngForOf",h.lcZ(2,2,n.agent)),h.xp6(3),h.Q6J("ngForOf",h.lcZ(5,4,n.list)))},directives:[Ae],pipes:[uc],styles:[".properties[_ngcontent-%COMP%]{border:#1f8ceb 3px solid;border-radius:10px;transition:all 2s ease;position:fixed;width:25%;z-index:1;box-shadow:.063rem 0 1.25rem #000}*[_ngcontent-%COMP%]{scrollbar-width:auto;scrollbar-color:#1f8ceb #ffffff}*[_ngcontent-%COMP%]::-webkit-scrollbar{width:16px}*[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#ffffff}*[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#1f8ceb;border-radius:10px;border:3px solid #ffffff}.list[_ngcontent-%COMP%]{margin:2% auto 0;background-color:#fff;height:87vh;width:100%;overflow:scroll;text-align:center}.property[_ngcontent-%COMP%]{margin:5% auto 0;width:80%;padding-left:2%;border-radius:10px}.property[_ngcontent-%COMP%]:hover{transition-duration:.5s;border-radius:10px;background:#ffffff;box-shadow:6px 6px 15px #666,-6px -6px 15px #fff}.details[_ngcontent-%COMP%]{width:100%}.p-name[_ngcontent-%COMP%]{text-align:center;font-size:18px;font-weight:500;padding-left:2%;padding-top:5%;text-decoration:underline}.p-image[_ngcontent-%COMP%]{width:80%}.p-city[_ngcontent-%COMP%]{margin-top:5%;font-size:18px;font-weight:500;padding-bottom:5%}.p-container[_ngcontent-%COMP%]{padding-top:5%;text-align:center}.p-amenity[_ngcontent-%COMP%]{list-style:none;text-align:left}"]}),i})();var EM=Y(1943);const XP=(0,sa.ZF)("map"),QP=(0,sa.P1)(XP,i=>i.geocode),JP=["map"];let eO=(()=>{class i{constructor(e,n){this.store=e,this.commonService=n,this.mapLngLat=[],this.coOrd=n.setLatLong(this.lat,this.long),this.commonService.coOrdinateObject.subscribe(l=>{this.zoomLatLong(l.long,l.lat)})}ngOnInit(){}ngAfterViewInit(){this.map=new EM.Map({container:this.mapContainer.nativeElement,style:"https://api.maptiler.com/maps/eef16200-c4cc-4285-9370-c71ca24bb42d/style.json?key=SoL71Zyf7SmLrVYWC7fQ",center:[parseFloat(this.long)||-97.420898,parseFloat(this.lat)||32.69929],zoom:12}),this.map.addControl(new EM.NavigationControl,"top-left"),this.store.select(QP).subscribe(e=>{e.forEach((n,l)=>{const f={lng:parseFloat(n.Longitude),lat:parseFloat(n.Latitude)};new EM.Marker({color:"#FF0000"}).setLngLat([f.lng,f.lat]).addTo(this.map)})})}ngOnDestroy(){var e;null===(e=this.map)||void 0===e||e.remove()}zoomLatLong(e,n){this.map.flyTo({center:[e,n],zoom:20,speed:1})}}return i.\u0275fac=function(e){return new(e||i)(h.Y36(sa.yh),h.Y36(wy))},i.\u0275cmp=h.Xpm({type:i,selectors:[["app-map"]],viewQuery:function(e,n){if(1&e&&h.Gf(JP,5),2&e){let l;h.iGM(l=h.CRH())&&(n.mapContainer=l.first)}},decls:5,vars:0,consts:[[1,"map-wrap"],["href","https://www.maptiler.com",1,"watermark"],["src","https://api.maptiler.com/resources/logo.svg","alt","MapTiler logo"],[1,"map"],["map",""]],template:function(e,n){1&e&&(h.TgZ(0,"div",0)(1,"a",1),h._UZ(2,"img",2),h.qZA(),h._UZ(3,"div",3,4),h.qZA())},styles:[".map-wrap[_ngcontent-%COMP%]{position:relative;width:100%;height:92vh;margin:0 auto;text-align:right}.map[_ngcontent-%COMP%]{text-align:right;position:absolute;width:100%;height:100%}.watermark[_ngcontent-%COMP%]{position:absolute;left:10px;bottom:10px;z-index:999}"]}),i})();function tO(i,t){if(1&i&&(h.TgZ(0,"div")(1,"h3",15),h._uU(2),h.qZA(),h._UZ(3,"hr"),h.qZA()),2&i){const e=t.$implicit;h.xp6(2),h.hij("",e.type,"rooms")}}function iO(i,t){if(1&i&&(h.TgZ(0,"div")(1,"h3",15),h._uU(2),h.qZA(),h._UZ(3,"hr"),h.qZA()),2&i){const e=t.$implicit;h.xp6(2),h.hij("$",e.price,"")}}function nO(i,t){if(1&i&&(h.TgZ(0,"div",16)(1,"h3",15),h._uU(2),h.qZA(),h._UZ(3,"hr"),h.qZA()),2&i){const e=t.$implicit;h.xp6(2),h.Oqu(e)}}let rO=(()=>{class i{constructor(e,n){this.store=e,this.commonService=n,this.specificDetail=[],this.showComponent=new h.vpe(!1)}ngOnInit(){this.commonService.data.subscribe(e=>{this.store.select(NS).subscribe(n=>{this.specificDetail=[],this.specificDetail=n.find(l=>l.propertyID==e)})})}closeSlide(){this.showComponent.emit(!1),this.commonService.isShowSlider=!1}}return i.\u0275fac=function(e){return new(e||i)(h.Y36(sa.yh),h.Y36(wy))},i.\u0275cmp=h.Xpm({type:i,selectors:[["app-property-details"]],outputs:{showComponent:"showComponent"},decls:25,vars:3,consts:[[1,"property-details"],[2,"margin-top","2%","text-align","center","display","inline"],[1,"toggle"],["src","/assets/images/next.png","alt","",1,"button",3,"click"],[1,"heading"],[1,"plan-cards"],[1,"row"],[1,"col-6"],[1,"head-container"],["src","/assets/images/bed.png","alt","",1,"icon"],[1,"spec-head"],[4,"ngFor","ngForOf"],["src","/assets/images/dollar.png","alt","",1,"icon"],[2,"margin-top","2%"],["class","amenities",4,"ngFor","ngForOf"],[2,"font-weight","500"],[1,"amenities"]],template:function(e,n){1&e&&(h.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"img",3),h.NdJ("click",function(){return n.closeSlide()}),h.qZA()(),h.TgZ(4,"h1",4),h._uU(5,"Floorplans"),h.qZA()(),h.TgZ(6,"div",5)(7,"div",6)(8,"div",7)(9,"div",8),h._UZ(10,"img",9),h.TgZ(11,"h1",10),h._uU(12,"Bedrooms"),h.qZA()(),h.YNc(13,tO,4,1,"div",11),h.qZA(),h.TgZ(14,"div",7)(15,"div",8),h._UZ(16,"img",12),h.TgZ(17,"h1",10),h._uU(18,"Price"),h.qZA()(),h.YNc(19,iO,4,1,"div",11),h.qZA()()(),h._UZ(20,"hr"),h.TgZ(21,"div",13)(22,"h1",4),h._uU(23,"Amenities"),h.qZA()(),h.YNc(24,nO,4,1,"div",14),h.qZA()),2&e&&(h.xp6(13),h.Q6J("ngForOf",null==n.specificDetail?null:n.specificDetail.floorplans),h.xp6(6),h.Q6J("ngForOf",null==n.specificDetail?null:n.specificDetail.floorplans),h.xp6(5),h.Q6J("ngForOf",null==n.specificDetail?null:n.specificDetail.highValueAmenities))},directives:[Ae],styles:["*[_ngcontent-%COMP%]{scrollbar-width:auto;scrollbar-color:#1f8ceb #ffffff}*[_ngcontent-%COMP%]::-webkit-scrollbar{width:16px}*[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#ffffff}*[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#1f8ceb;border-radius:10px;border:3px solid #ffffff}.property-details[_ngcontent-%COMP%]{height:92vh;border:#1f8ceb 3px solid;border-radius:10px;position:fixed;transition:cubic-bezier(.445,.05,.55,.95);transition-duration:1s;z-index:1;box-shadow:.063rem 0 1.25rem #000;overflow:scroll}.button[_ngcontent-%COMP%]{position:absolute;width:10%;left:5%;top:5px}.heading[_ngcontent-%COMP%]{font-size:32px;text-align:center;margin-top:3%;color:#1f8ceb;font-weight:500;text-decoration:underline}.head-container[_ngcontent-%COMP%]{text-align:center}.icon[_ngcontent-%COMP%]{width:16%}.spec-head[_ngcontent-%COMP%]{font-weight:500;font-size:26px;text-decoration:underline}.plan-cards[_ngcontent-%COMP%]{width:80%;margin:5% auto 0;padding:2%}.amenities[_ngcontent-%COMP%]{padding-top:2%;width:80%;margin:0 auto;padding-left:2%}"]}),i})();function oO(i,t){if(1&i&&(h.TgZ(0,"div",4),h._UZ(1,"app-property-details"),h.qZA()),2&i){const e=h.oxw();h.Q6J("ngClass",1==e.commonService.isShowSlider?"col-3":"col-0")}}const sO=[{path:"",component:(()=>{class i{constructor(e){this.commonService=e,this.parentData=[]}ngOnInit(){}showSliderComponent(e){this.commonService.isShowSlider=e}}return i.\u0275fac=function(e){return new(e||i)(h.Y36(wy))},i.\u0275cmp=h.Xpm({type:i,selectors:[["app-home"]],decls:7,vars:2,consts:[[1,"layout"],[1,"row","g-0"],[1,"col-3"],[3,"showComponent"],[3,"ngClass"],[3,"ngClass",4,"ngIf"]],template:function(e,n){1&e&&(h.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"app-properties",3),h.NdJ("showComponent",function(f){return n.showSliderComponent(f)}),h.qZA()(),h.TgZ(4,"div",4),h._UZ(5,"app-map"),h.qZA(),h.YNc(6,oO,2,1,"div",5),h.qZA()()),2&e&&(h.xp6(4),h.Q6J("ngClass",1==n.commonService.isShowSlider?"col-6":"col-9"),h.xp6(2),h.Q6J("ngIf",n.commonService.isShowSlider))},directives:[KP,Lr,eO,At,rO],styles:[""]}),i})()}];let aO=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[FS.forRoot(sO)],FS]}),i})(),lO=(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=h.Xpm({type:i,selectors:[["app-nav"]],decls:4,vars:0,consts:[[1,"navbar"],[1,"container-fluid"],["href","#",1,"navbar-brand"]],template:function(e,n){1&e&&(h.TgZ(0,"nav",0)(1,"div",1)(2,"a",2),h._uU(3,"SMART-APT"),h.qZA()()())},styles:[".navbar[_ngcontent-%COMP%]{background-color:#1f8ceb}.navbar-brand[_ngcontent-%COMP%]{color:#fff;font-size:32px;font-weight:800;padding-top:1%;padding-bottom:1%;padding-left:40px}"]}),i})(),cO=(()=>{class i{constructor(){this.title="SmartAssessment"}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=h.Xpm({type:i,selectors:[["app-root"]],decls:2,vars:0,template:function(e,n){1&e&&h._UZ(0,"app-nav")(1,"router-outlet")},directives:[lO,_M],styles:[""]}),i})();var uO=Y(9565);const hO=(0,sa.Lq)({records:[{listID:5363950,order:0,propertyID:74015,name:"Listing #74015",streetAddress:"Riveroad Ct",city:"Fort Worth",state:"TX",pets:!0,washerDry:"FULLSIZE_FURNISHED",photo:"https://d3d5tet3r0xd5y.cloudfront.net/photos/74015/micros/0b0ba.jpg",favorite:!0,highestSentCommissions:75,onsiteManager:null,management:null,proximity:0,section8:!1,seniorHousing:!1,studentHousting:!1,floorplans:[{bedrooms:1,type:"1 Bed",price:1138},{bedrooms:2,type:"2 Bed",price:1639}],highValueAmenities:["Black/Stainless Appliances","Granite Countertops","Dog/Walk Park","Jogging Trail","Fitness Center","ValletTrash"],paidUtilities:[],geocode:{Longitude:"-97.42201",Latitude:"32.700878",Percision:"ROOFTOP",IsValid:!0}},{listID:5363950,order:0,propertyID:76204,name:"Listing #76204",streetAddress:"Bryant Irvin",city:"Fort Worth",state:"TX",pets:!0,washerDry:"FULLSIZE_CONNECTIONS",photo:"https://d3d5tet3r0xd5y.cloudfront.net/photos/76204/micros/0a.jpg",favorite:!0,highestSentCommissions:50,onsiteManager:null,management:null,proximity:0,section8:!1,seniorHousing:!1,studentHousting:!1,floorplans:[{bedrooms:1,type:"1 Bed",price:1355},{bedrooms:2,type:"2 Bed",price:1425},{bedrooms:3,type:"3 Bed",price:1725}],highValueAmenities:["Black/Stainless Appliances","Wood Floors","Granite Countertops","Dog/Walk Park","Fitness Center","ValletTrash"],paidUtilities:[],geocode:{Longitude:"-97.419173",Latitude:"32.674341",Percision:"ROOFTOP",IsValid:!0}},{listID:5363950,order:0,propertyID:74007,name:"Listing #74007",streetAddress:"Bellaire",city:"Benbrook",state:"TX",pets:!0,washerDry:"FULLSIZE_CONNECTIONS",photo:"https://d3d5tet3r0xd5y.cloudfront.net/photos/74007/micros/a0.jpg",favorite:!1,highestSentCommissions:50,onsiteManager:null,management:null,proximity:0,section8:!1,seniorHousing:!1,studentHousting:!1,floorplans:[{bedrooms:1,type:"1 Bed",price:959},{bedrooms:2,type:"2 Bed",price:1219}],highValueAmenities:["Black/Stainless Appliances","Wood Floors","Dog/Walk Park","Jogging Trail","Tennis"],paidUtilities:[],geocode:{Longitude:"-97.420898",Latitude:"32.695078",Percision:"GEOMETRIC_CENTER",IsValid:!0}},{listID:5363950,order:0,propertyID:73933,name:"Listing #73933",streetAddress:"Oak Hill",city:"Fort Worth",state:"TX",pets:!0,washerDry:"FULLSIZE_CONNECTIONS",photo:"https://d3d5tet3r0xd5y.cloudfront.net/photos/73933/micros/1fe6b.jpg",favorite:!1,highestSentCommissions:50,onsiteManager:null,management:null,proximity:0,section8:!1,seniorHousing:!1,studentHousting:!1,floorplans:[{bedrooms:1,type:"1 Bed",price:1295},{bedrooms:2,type:"2 Bed",price:1610},{bedrooms:3,type:"3 Bed",price:2120}],highValueAmenities:["Black/Stainless Appliances","Wood Floors","Granite Countertops","Dog/Walk Park","Jogging Trail","Fitness Center","ValletTrash"],paidUtilities:[],geocode:{Longitude:"-97.383017",Latitude:"32.712804",Percision:"ROOFTOP",IsValid:!0}},{listID:5363950,order:0,propertyID:73316,name:"Listing #73316",streetAddress:"Chickering",city:"Fort Worth",state:"TX",pets:!0,washerDry:"FULLSIZE_FURNISHED",photo:"https://d3d5tet3r0xd5y.cloudfront.net/photos/73316/micros/1b.jpg",favorite:!1,highestSentCommissions:50,onsiteManager:null,management:null,proximity:0,section8:!1,seniorHousing:!1,studentHousting:!1,floorplans:[{bedrooms:1,type:"1 Bed",price:919},{bedrooms:2,type:"2 Bed",price:1079},{bedrooms:3,type:"3 Bed",price:1219}],highValueAmenities:["Wood Floors","Fitness Center","Tennis"],paidUtilities:[],geocode:{Longitude:"-97.430361",Latitude:"32.705048",Percision:"GEOMETRIC_CENTER",IsValid:!0}},{listID:5363950,order:0,propertyID:101618,name:"Listing #101618",streetAddress:"Hulen",city:"Fort Worth",state:"TX",pets:!0,washerDry:"FULLSIZE_FURNISHED",photo:"https://d3d5tet3r0xd5y.cloudfront.net/photos/101618/micros/1.jpg",favorite:!1,highestSentCommissions:50,onsiteManager:null,management:null,proximity:0,section8:!1,seniorHousing:!1,studentHousting:!1,floorplans:[{bedrooms:1,type:"1 Bed",price:1261},{bedrooms:2,type:"2 Bed",price:1402},{bedrooms:3,type:"3 Bed",price:1921}],highValueAmenities:["Black/Stainless Appliances","Wood Floors","Granite Countertops","Dog/Walk Park","Fitness Center","ValletTrash"],paidUtilities:[],geocode:{Longitude:"-97.387957",Latitude:"32.721068",Percision:"ROOFTOP",IsValid:!0}},{listID:5363950,order:0,propertyID:72333,name:"Listing #72333",streetAddress:"Wellesley",city:"Fort Worth",state:"TX",pets:!0,washerDry:"FULLSIZE_CONNECTIONS",photo:"https://d3d5tet3r0xd5y.cloudfront.net/photos/72333/micros/SlateApts-WEB-10.jpg",favorite:!1,highestSentCommissions:0,onsiteManager:null,management:null,proximity:0,section8:!1,seniorHousing:!1,studentHousting:!1,floorplans:[{bedrooms:1,type:"1 Bed",price:975},{bedrooms:2,type:"2 Bed",price:1125}],highValueAmenities:["Black/Stainless Appliances","Granite Countertops","Dog/Walk Park"],paidUtilities:[],geocode:{Longitude:"-97.39105",Latitude:"32.725568",Percision:"ROOFTOP",IsValid:!0}},{listID:5363950,order:0,propertyID:72117,name:"Listing #72117",streetAddress:"Bellaire",city:"Benbrook",state:"TX",pets:!0,washerDry:"FULLSIZE_CONNECTIONS",photo:"https://d3d5tet3r0xd5y.cloudfront.net/photos/72117/micros/a2.jpg",favorite:!1,highestSentCommissions:0,onsiteManager:null,management:null,proximity:0,section8:!1,seniorHousing:!1,studentHousting:!1,floorplans:[{bedrooms:1,type:"1 Bed",price:1177},{bedrooms:2,type:"2 Bed",price:1544}],highValueAmenities:["Black/Stainless Appliances","Dog/Walk Park","Jogging Trail","Fitness Center"],paidUtilities:[],geocode:{Longitude:"-97.4148",Latitude:"32.6954",Percision:"GEOMETRIC_CENTER",IsValid:!0}},{listID:5363950,order:0,propertyID:86603,name:"Listing #86603",streetAddress:"West Lancaster",city:"Fort Worth",state:"TX",pets:!0,washerDry:"FULLSIZE_FURNISHED",photo:"https://d3d5tet3r0xd5y.cloudfront.net/photos/86603/micros/BL10.jpg",favorite:!1,highestSentCommissions:0,onsiteManager:null,management:null,proximity:0,section8:!1,seniorHousing:!1,studentHousting:!1,floorplans:[{bedrooms:0,type:"Eff",price:1125},{bedrooms:1,type:"1 Bed",price:1380},{bedrooms:2,type:"2 Bed",price:1610}],highValueAmenities:["Black/Stainless Appliances","Granite Countertops","Stained Concerete Floors","Fitness Center","ValletTrash"],paidUtilities:[],geocode:{Longitude:"-97.359472",Latitude:"32.747698",Percision:"RANGE_INTERPOLATED",IsValid:!0}},{listID:5363950,order:0,propertyID:74017,name:"Listing #74017",streetAddress:"River Park",city:"Fort Worth",state:"TX",pets:!0,washerDry:"FULLSIZE_CONNECTIONS",photo:"https://d3d5tet3r0xd5y.cloudfront.net/photos/74017/micros/1126.jpg",favorite:!1,highestSentCommissions:0,onsiteManager:null,management:null,proximity:0,section8:!1,seniorHousing:!1,studentHousting:!1,floorplans:[{bedrooms:1,type:"1 Bed",price:1030},{bedrooms:2,type:"2 Bed",price:1220},{bedrooms:3,type:"3 Bed",price:2045}],highValueAmenities:["Black/Stainless Appliances","Jogging Trail","Fitness Center"],paidUtilities:["Trash","Water"],geocode:{Longitude:"-97.423602",Latitude:"32.69913",Percision:"GEOMETRIC_CENTER",IsValid:!0}},{listID:5363950,order:0,propertyID:74038,name:"Listing #74038",streetAddress:"River Park",city:"Fort Worth",state:"TX",pets:!0,washerDry:"FULLSIZE_FURNISHED",photo:"https://d3d5tet3r0xd5y.cloudfront.net/photos/74038/micros/a2.jpg",favorite:!0,highestSentCommissions:0,onsiteManager:null,management:null,proximity:0,section8:!1,seniorHousing:!1,studentHousting:!1,floorplans:[{bedrooms:1,type:"1 Bed",price:1095},{bedrooms:2,type:"2 Bed",price:1231},{bedrooms:3,type:"3 Bed",price:2002}],highValueAmenities:["Black/Stainless Appliances","Granite Countertops","Dog/Walk Park","Fitness Center","Basketball","Tennis","ValletTrash"],paidUtilities:[],geocode:{Longitude:"-97.42563",Latitude:"32.700414",Percision:"GEOMETRIC_CENTER",IsValid:!0}},{listID:5363950,order:0,propertyID:71680,name:"Listing #71680",streetAddress:"Overton Ridge",city:"Fort Worth",state:"TX",pets:!0,washerDry:"FULLSIZE_CONNECTIONS",photo:"https://d3d5tet3r0xd5y.cloudfront.net/photos/71680/micros/a2.jpg",favorite:!1,highestSentCommissions:0,onsiteManager:null,management:null,proximity:0,section8:!1,seniorHousing:!1,studentHousting:!1,floorplans:[{bedrooms:1,type:"1 Bed",price:768},{bedrooms:2,type:"2 Bed",price:1125},{bedrooms:3,type:"3 Bed",price:1400}],highValueAmenities:["Black/Stainless Appliances","Wood Floors","Granite Countertops","Fitness Center"],paidUtilities:[],geocode:{Longitude:"-97.410761",Latitude:"32.673911",Percision:"GEOMETRIC_CENTER",IsValid:!0}},{listID:5363950,order:0,propertyID:76519,name:"Listing #76519",streetAddress:"Westridge",city:"Fort Worth",state:"TX",pets:!0,washerDry:"FULLSIZE_FURNISHED",photo:"https://d3d5tet3r0xd5y.cloudfront.net/photos/76519/micros/76519-2_737.jpg",favorite:!1,highestSentCommissions:0,onsiteManager:null,management:null,proximity:0,section8:!1,seniorHousing:!1,studentHousting:!1,floorplans:[{bedrooms:1,type:"1 Bed",price:935},{bedrooms:2,type:"2 Bed",price:1273},{bedrooms:3,type:"3 Bed",price:1637}],highValueAmenities:["Black/Stainless Appliances","Wood Floors","Granite Countertops","Fitness Center"],paidUtilities:[],geocode:{Longitude:"-97.415196",Latitude:"32.726082",Percision:"ROOFTOP",IsValid:!0}},{listID:5363950,order:0,propertyID:76643,name:"Listing #76643",streetAddress:"Park Hill",city:"Fort Worth",state:"TX",pets:!0,washerDry:"FULLSIZE_CONNECTIONS",photo:"https://d3d5tet3r0xd5y.cloudfront.net/photos/76643/micros/10.jpg",favorite:!1,highestSentCommissions:0,onsiteManager:null,management:null,proximity:0,section8:!1,seniorHousing:!1,studentHousting:!1,floorplans:[{bedrooms:1,type:"1 Bed",price:1109},{bedrooms:2,type:"2 Bed",price:1401},{bedrooms:3,type:"3 Bed",price:1704}],highValueAmenities:["Black/Stainless Appliances","Wood Floors","Granite Countertops","Dog/Walk Park","Jogging Trail","Fitness Center","ValletTrash"],paidUtilities:[],geocode:{Longitude:"-97.349082",Latitude:"32.715501",Percision:"ROOFTOP",IsValid:!0}},{listID:5363950,order:0,propertyID:77439,name:"Listing #77439",streetAddress:"University",city:"Fort Worth",state:"TX",pets:!0,washerDry:"FULLSIZE_FURNISHED",photo:"https://d3d5tet3r0xd5y.cloudfront.net/photos/77439/micros/1a.jpg",favorite:!0,highestSentCommissions:0,onsiteManager:null,management:null,proximity:0,section8:!1,seniorHousing:!1,studentHousting:!1,floorplans:[{bedrooms:3,type:"3 Bed",price:799}],highValueAmenities:["Black/Stainless Appliances","Wood Floors","Granite Countertops","Dog/Walk Park","Fitness Center"],paidUtilities:["Cable","Gas","Trash","Water"],geocode:{Longitude:"-97.360138",Latitude:"32.697651",Percision:"ROOFTOP",IsValid:!0}},{listID:5363950,order:0,propertyID:72899,name:"Listing #72899",streetAddress:"Overton Ridge",city:"Fort Worth",state:"TX",pets:!0,washerDry:"FULLSIZE_FURNISHED",photo:"",favorite:!1,highestSentCommissions:0,onsiteManager:null,management:null,proximity:0,section8:!1,seniorHousing:!1,studentHousting:!1,floorplans:[{bedrooms:0,type:"Eff",price:999},{bedrooms:1,type:"1 Bed",price:850},{bedrooms:2,type:"2 Bed",price:1287}],highValueAmenities:["Black/Stainless Appliances","Wood Floors","Dog/Walk Park","Fitness Center"],paidUtilities:[],geocode:{Longitude:"-97.408734",Latitude:"32.674031",Percision:"GEOMETRIC_CENTER",IsValid:!0}},{listID:5363950,order:0,propertyID:71132,name:"Listing #71132",streetAddress:"Riverpark",city:"Fort Worth",state:"TX",pets:!0,washerDry:"FULLSIZE_CONNECTIONS",photo:"https://d3d5tet3r0xd5y.cloudfront.net/photos/71132/micros/COR1.jpg",favorite:!1,highestSentCommissions:0,onsiteManager:null,management:null,proximity:0,section8:!1,seniorHousing:!1,studentHousting:!1,floorplans:[{bedrooms:1,type:"1 Bed",price:1209},{bedrooms:2,type:"2 Bed",price:1564}],highValueAmenities:["Black/Stainless Appliances","Wood Floors","Dog/Walk Park","Jogging Trail","Fitness Center","ValletTrash"],paidUtilities:[],geocode:{Longitude:"-97.420898",Latitude:"32.69929",Percision:"GEOMETRIC_CENTER",IsValid:!0}}]}),mO=(0,sa.Lq)({planSpecificDetail:[]}),yO=(0,sa.Lq)({agentInfo:[{accountID:2360,firstname:"Cindy",lastname:"Little",company:"Apartment Agents",splashMessage:"",customHeader:""}]}),xO=(0,sa.Lq)({geocode:[{Longitude:"-97.42201",Latitude:"32.700878",Percision:"ROOFTOP",IsValid:!0},{Longitude:"-97.419173",Latitude:"32.674341",Percision:"ROOFTOP",IsValid:!0},{Longitude:"-97.420898",Latitude:"32.695078",Percision:"GEOMETRIC_CENTER",IsValid:!0},{Longitude:"-97.383017",Latitude:"32.712804",Percision:"ROOFTOP",IsValid:!0},{Longitude:"-97.430361",Latitude:"32.705048",Percision:"GEOMETRIC_CENTER",IsValid:!0},{Longitude:"-97.387957",Latitude:"32.721068",Percision:"ROOFTOP",IsValid:!0},{Longitude:"-97.39105",Latitude:"32.725568",Percision:"ROOFTOP",IsValid:!0},{Longitude:"-97.4148",Latitude:"32.6954",Percision:"GEOMETRIC_CENTER",IsValid:!0},{Longitude:"-97.359472",Latitude:"32.747698",Percision:"RANGE_INTERPOLATED",IsValid:!0},{Longitude:"-97.423602",Latitude:"32.69913",Percision:"GEOMETRIC_CENTER",IsValid:!0},{Longitude:"-97.42563",Latitude:"32.700414",Percision:"GEOMETRIC_CENTER",IsValid:!0},{Longitude:"-97.410761",Latitude:"32.673911",Percision:"GEOMETRIC_CENTER",IsValid:!0},{Longitude:"-97.415196",Latitude:"32.726082",Percision:"ROOFTOP",IsValid:!0},{Longitude:"-97.349082",Latitude:"32.715501",Percision:"ROOFTOP",IsValid:!0},{Longitude:"-97.360138",Latitude:"32.697651",Percision:"ROOFTOP",IsValid:!0},{Longitude:"-97.408734",Latitude:"32.674031",Percision:"GEOMETRIC_CENTER",IsValid:!0},{Longitude:"-97.420898",Latitude:"32.69929",Percision:"GEOMETRIC_CENTER",IsValid:!0}]}),CO={list:function pO(i,t){return hO(i,t)},agent:function vO(i,t){return yO(i,t)},map:function wO(i,t){return xO(i,t)},details:function gO(i,t){return mO(i,t)}};let MO=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=h.oAB({type:i,bootstrap:[cO]}),i.\u0275inj=h.cJS({providers:[wy],imports:[[Us,aO,ju,_m,gm,ef,Np,Bp,nm,Pk,sa.Aw.forRoot(CO),uO.FT.instrument({logOnly:true})]]}),i})();(0,h.G48)(),vc().bootstrapModule(MO).catch(i=>console.error(i))},1135:(Ie,_e,Y)=>{"use strict";Y.d(_e,{X:()=>Te});var h=Y(7579);class Te extends h.x{constructor(x){super(),this._value=x}get value(){return this.getValue()}_subscribe(x){const Me=super._subscribe(x);return!Me.closed&&x.next(this._value),Me}getValue(){const{hasError:x,thrownError:Me,_value:Pe}=this;if(x)throw Me;return this._throwIfClosed(),Pe}next(x){super.next(this._value=x)}}},8306:(Ie,_e,Y)=>{"use strict";Y.d(_e,{y:()=>Le});var h=Y(930),Te=Y(727),Ve=Y(8822),x=Y(4671);var ye=Y(2416),xe=Y(576),ne=Y(2806);let Le=(()=>{class gt{constructor(Tt){Tt&&(this._subscribe=Tt)}lift(Tt){const nt=new gt;return nt.source=this,nt.operator=Tt,nt}subscribe(Tt,nt,Dt){const Ht=function yt(gt){return gt&&gt instanceof h.Lv||function Be(gt){return gt&&(0,xe.m)(gt.next)&&(0,xe.m)(gt.error)&&(0,xe.m)(gt.complete)}(gt)&&(0,Te.Nn)(gt)}(Tt)?Tt:new h.Hp(Tt,nt,Dt);return(0,ne.x)(()=>{const{operator:$t,source:xt}=this;Ht.add($t?$t.call(Ht,xt):xt?this._subscribe(Ht):this._trySubscribe(Ht))}),Ht}_trySubscribe(Tt){try{return this._subscribe(Tt)}catch(nt){Tt.error(nt)}}forEach(Tt,nt){return new(nt=ke(nt))((Dt,Ht)=>{const $t=new h.Hp({next:xt=>{try{Tt(xt)}catch(ut){Ht(ut),$t.unsubscribe()}},error:Ht,complete:Dt});this.subscribe($t)})}_subscribe(Tt){var nt;return null===(nt=this.source)||void 0===nt?void 0:nt.subscribe(Tt)}[Ve.L](){return this}pipe(...Tt){return function Pe(gt){return 0===gt.length?x.y:1===gt.length?gt[0]:function(Tt){return gt.reduce((nt,Dt)=>Dt(nt),Tt)}}(Tt)(this)}toPromise(Tt){return new(Tt=ke(Tt))((nt,Dt)=>{let Ht;this.subscribe($t=>Ht=$t,$t=>Dt($t),()=>nt(Ht))})}}return gt.create=vt=>new gt(vt),gt})();function ke(gt){var vt;return null!==(vt=null!=gt?gt:ye.v.Promise)&&void 0!==vt?vt:Promise}},4707:(Ie,_e,Y)=>{"use strict";Y.d(_e,{t:()=>Ve});var h=Y(7579),Te=Y(6063);class Ve extends h.x{constructor(Me=1/0,Pe=1/0,ye=Te.l){super(),this._bufferSize=Me,this._windowTime=Pe,this._timestampProvider=ye,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=Pe===1/0,this._bufferSize=Math.max(1,Me),this._windowTime=Math.max(1,Pe)}next(Me){const{isStopped:Pe,_buffer:ye,_infiniteTimeWindow:xe,_timestampProvider:ne,_windowTime:Le}=this;Pe||(ye.push(Me),!xe&&ye.push(ne.now()+Le)),this._trimBuffer(),super.next(Me)}_subscribe(Me){this._throwIfClosed(),this._trimBuffer();const Pe=this._innerSubscribe(Me),{_infiniteTimeWindow:ye,_buffer:xe}=this,ne=xe.slice();for(let Le=0;Le<ne.length&&!Me.closed;Le+=ye?1:2)Me.next(ne[Le]);return this._checkFinalizedStatuses(Me),Pe}_trimBuffer(){const{_bufferSize:Me,_timestampProvider:Pe,_buffer:ye,_infiniteTimeWindow:xe}=this,ne=(xe?1:2)*Me;if(Me<1/0&&ne<ye.length&&ye.splice(0,ye.length-ne),!xe){const Le=Pe.now();let ke=0;for(let Be=1;Be<ye.length&&ye[Be]<=Le;Be+=2)ke=Be;ke&&ye.splice(0,ke+1)}}}},7579:(Ie,_e,Y)=>{"use strict";Y.d(_e,{x:()=>ye});var h=Y(8306),Te=Y(727);const x=(0,Y(3888).d)(ne=>function(){ne(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Me=Y(8737),Pe=Y(2806);let ye=(()=>{class ne extends h.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(ke){const Be=new xe(this,this);return Be.operator=ke,Be}_throwIfClosed(){if(this.closed)throw new x}next(ke){(0,Pe.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const Be of this.currentObservers)Be.next(ke)}})}error(ke){(0,Pe.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=ke;const{observers:Be}=this;for(;Be.length;)Be.shift().error(ke)}})}complete(){(0,Pe.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:ke}=this;for(;ke.length;)ke.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var ke;return(null===(ke=this.observers)||void 0===ke?void 0:ke.length)>0}_trySubscribe(ke){return this._throwIfClosed(),super._trySubscribe(ke)}_subscribe(ke){return this._throwIfClosed(),this._checkFinalizedStatuses(ke),this._innerSubscribe(ke)}_innerSubscribe(ke){const{hasError:Be,isStopped:yt,observers:gt}=this;return Be||yt?Te.Lc:(this.currentObservers=null,gt.push(ke),new Te.w0(()=>{this.currentObservers=null,(0,Me.P)(gt,ke)}))}_checkFinalizedStatuses(ke){const{hasError:Be,thrownError:yt,isStopped:gt}=this;Be?ke.error(yt):gt&&ke.complete()}asObservable(){const ke=new h.y;return ke.source=this,ke}}return ne.create=(Le,ke)=>new xe(Le,ke),ne})();class xe extends ye{constructor(Le,ke){super(),this.destination=Le,this.source=ke}next(Le){var ke,Be;null===(Be=null===(ke=this.destination)||void 0===ke?void 0:ke.next)||void 0===Be||Be.call(ke,Le)}error(Le){var ke,Be;null===(Be=null===(ke=this.destination)||void 0===ke?void 0:ke.error)||void 0===Be||Be.call(ke,Le)}complete(){var Le,ke;null===(ke=null===(Le=this.destination)||void 0===Le?void 0:Le.complete)||void 0===ke||ke.call(Le)}_subscribe(Le){var ke,Be;return null!==(Be=null===(ke=this.source)||void 0===ke?void 0:ke.subscribe(Le))&&void 0!==Be?Be:Te.Lc}}},930:(Ie,_e,Y)=>{"use strict";Y.d(_e,{Hp:()=>Tt,Lv:()=>Be});var h=Y(576),Te=Y(727),Ve=Y(2416),x=Y(7849),Me=Y(5032);const Pe=ne("C",void 0,void 0);function ne(xt,ut,kt){return{kind:xt,value:ut,error:kt}}var Le=Y(3410),ke=Y(2806);class Be extends Te.w0{constructor(ut){super(),this.isStopped=!1,ut?(this.destination=ut,(0,Te.Nn)(ut)&&ut.add(this)):this.destination=$t}static create(ut,kt,qt){return new Tt(ut,kt,qt)}next(ut){this.isStopped?Ht(function xe(xt){return ne("N",xt,void 0)}(ut),this):this._next(ut)}error(ut){this.isStopped?Ht(function ye(xt){return ne("E",void 0,xt)}(ut),this):(this.isStopped=!0,this._error(ut))}complete(){this.isStopped?Ht(Pe,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(ut){this.destination.next(ut)}_error(ut){try{this.destination.error(ut)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const yt=Function.prototype.bind;function gt(xt,ut){return yt.call(xt,ut)}class vt{constructor(ut){this.partialObserver=ut}next(ut){const{partialObserver:kt}=this;if(kt.next)try{kt.next(ut)}catch(qt){nt(qt)}}error(ut){const{partialObserver:kt}=this;if(kt.error)try{kt.error(ut)}catch(qt){nt(qt)}else nt(ut)}complete(){const{partialObserver:ut}=this;if(ut.complete)try{ut.complete()}catch(kt){nt(kt)}}}class Tt extends Be{constructor(ut,kt,qt){let ni;if(super(),(0,h.m)(ut)||!ut)ni={next:null!=ut?ut:void 0,error:null!=kt?kt:void 0,complete:null!=qt?qt:void 0};else{let xi;this&&Ve.v.useDeprecatedNextContext?(xi=Object.create(ut),xi.unsubscribe=()=>this.unsubscribe(),ni={next:ut.next&&gt(ut.next,xi),error:ut.error&&gt(ut.error,xi),complete:ut.complete&&gt(ut.complete,xi)}):ni=ut}this.destination=new vt(ni)}}function nt(xt){Ve.v.useDeprecatedSynchronousErrorHandling?(0,ke.O)(xt):(0,x.h)(xt)}function Ht(xt,ut){const{onStoppedNotification:kt}=Ve.v;kt&&Le.z.setTimeout(()=>kt(xt,ut))}const $t={closed:!0,next:Me.Z,error:function Dt(xt){throw xt},complete:Me.Z}},727:(Ie,_e,Y)=>{"use strict";Y.d(_e,{Lc:()=>Pe,w0:()=>Me,Nn:()=>ye});var h=Y(576);const Ve=(0,Y(3888).d)(ne=>function(ke){ne(this),this.message=ke?`${ke.length} errors occurred during unsubscription:\n${ke.map((Be,yt)=>`${yt+1}) ${Be.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=ke});var x=Y(8737);class Me{constructor(Le){this.initialTeardown=Le,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let Le;if(!this.closed){this.closed=!0;const{_parentage:ke}=this;if(ke)if(this._parentage=null,Array.isArray(ke))for(const gt of ke)gt.remove(this);else ke.remove(this);const{initialTeardown:Be}=this;if((0,h.m)(Be))try{Be()}catch(gt){Le=gt instanceof Ve?gt.errors:[gt]}const{_finalizers:yt}=this;if(yt){this._finalizers=null;for(const gt of yt)try{xe(gt)}catch(vt){Le=null!=Le?Le:[],vt instanceof Ve?Le=[...Le,...vt.errors]:Le.push(vt)}}if(Le)throw new Ve(Le)}}add(Le){var ke;if(Le&&Le!==this)if(this.closed)xe(Le);else{if(Le instanceof Me){if(Le.closed||Le._hasParent(this))return;Le._addParent(this)}(this._finalizers=null!==(ke=this._finalizers)&&void 0!==ke?ke:[]).push(Le)}}_hasParent(Le){const{_parentage:ke}=this;return ke===Le||Array.isArray(ke)&&ke.includes(Le)}_addParent(Le){const{_parentage:ke}=this;this._parentage=Array.isArray(ke)?(ke.push(Le),ke):ke?[ke,Le]:Le}_removeParent(Le){const{_parentage:ke}=this;ke===Le?this._parentage=null:Array.isArray(ke)&&(0,x.P)(ke,Le)}remove(Le){const{_finalizers:ke}=this;ke&&(0,x.P)(ke,Le),Le instanceof Me&&Le._removeParent(this)}}Me.EMPTY=(()=>{const ne=new Me;return ne.closed=!0,ne})();const Pe=Me.EMPTY;function ye(ne){return ne instanceof Me||ne&&"closed"in ne&&(0,h.m)(ne.remove)&&(0,h.m)(ne.add)&&(0,h.m)(ne.unsubscribe)}function xe(ne){(0,h.m)(ne)?ne():ne.unsubscribe()}},2416:(Ie,_e,Y)=>{"use strict";Y.d(_e,{v:()=>h});const h={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},515:(Ie,_e,Y)=>{"use strict";Y.d(_e,{E:()=>Te});const Te=new(Y(8306).y)(Me=>Me.complete())},457:(Ie,_e,Y)=>{"use strict";Y.d(_e,{D:()=>kt});var h=Y(8421),Te=Y(5363),Ve=Y(4482);function x(qt,ni=0){return(0,Ve.e)((xi,Ue)=>{Ue.add(qt.schedule(()=>xi.subscribe(Ue),ni))})}var ye=Y(8306),ne=Y(2202),Le=Y(576),ke=Y(9672);function yt(qt,ni){if(!qt)throw new Error("Iterable cannot be null");return new ye.y(xi=>{(0,ke.f)(xi,ni,()=>{const Ue=qt[Symbol.asyncIterator]();(0,ke.f)(xi,ni,()=>{Ue.next().then(et=>{et.done?xi.complete():xi.next(et.value)})},0,!0)})})}var gt=Y(3670),vt=Y(8239),Tt=Y(1144),nt=Y(6495),Dt=Y(2206),Ht=Y(4532),$t=Y(3260);function kt(qt,ni){return ni?function ut(qt,ni){if(null!=qt){if((0,gt.c)(qt))return function Me(qt,ni){return(0,h.Xf)(qt).pipe(x(ni),(0,Te.Q)(ni))}(qt,ni);if((0,Tt.z)(qt))return function xe(qt,ni){return new ye.y(xi=>{let Ue=0;return ni.schedule(function(){Ue===qt.length?xi.complete():(xi.next(qt[Ue++]),xi.closed||this.schedule())})})}(qt,ni);if((0,vt.t)(qt))return function Pe(qt,ni){return(0,h.Xf)(qt).pipe(x(ni),(0,Te.Q)(ni))}(qt,ni);if((0,Dt.D)(qt))return yt(qt,ni);if((0,nt.T)(qt))return function Be(qt,ni){return new ye.y(xi=>{let Ue;return(0,ke.f)(xi,ni,()=>{Ue=qt[ne.h](),(0,ke.f)(xi,ni,()=>{let et,Oe;try{({value:et,done:Oe}=Ue.next())}catch(Qe){return void xi.error(Qe)}Oe?xi.complete():xi.next(et)},0,!0)}),()=>(0,Le.m)(null==Ue?void 0:Ue.return)&&Ue.return()})}(qt,ni);if((0,$t.L)(qt))return function xt(qt,ni){return yt((0,$t.Q)(qt),ni)}(qt,ni)}throw(0,Ht.z)(qt)}(qt,ni):(0,h.Xf)(qt)}},8421:(Ie,_e,Y)=>{"use strict";Y.d(_e,{Xf:()=>yt});var h=Y(655),Te=Y(1144),Ve=Y(8239),x=Y(8306),Me=Y(3670),Pe=Y(2206),ye=Y(4532),xe=Y(6495),ne=Y(3260),Le=Y(576),ke=Y(7849),Be=Y(8822);function yt(xt){if(xt instanceof x.y)return xt;if(null!=xt){if((0,Me.c)(xt))return function gt(xt){return new x.y(ut=>{const kt=xt[Be.L]();if((0,Le.m)(kt.subscribe))return kt.subscribe(ut);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(xt);if((0,Te.z)(xt))return function vt(xt){return new x.y(ut=>{for(let kt=0;kt<xt.length&&!ut.closed;kt++)ut.next(xt[kt]);ut.complete()})}(xt);if((0,Ve.t)(xt))return function Tt(xt){return new x.y(ut=>{xt.then(kt=>{ut.closed||(ut.next(kt),ut.complete())},kt=>ut.error(kt)).then(null,ke.h)})}(xt);if((0,Pe.D)(xt))return Dt(xt);if((0,xe.T)(xt))return function nt(xt){return new x.y(ut=>{for(const kt of xt)if(ut.next(kt),ut.closed)return;ut.complete()})}(xt);if((0,ne.L)(xt))return function Ht(xt){return Dt((0,ne.Q)(xt))}(xt)}throw(0,ye.z)(xt)}function Dt(xt){return new x.y(ut=>{(function $t(xt,ut){var kt,qt,ni,xi;return(0,h.mG)(this,void 0,void 0,function*(){try{for(kt=(0,h.KL)(xt);!(qt=yield kt.next()).done;)if(ut.next(qt.value),ut.closed)return}catch(Ue){ni={error:Ue}}finally{try{qt&&!qt.done&&(xi=kt.return)&&(yield xi.call(kt))}finally{if(ni)throw ni.error}}ut.complete()})})(xt,ut).catch(kt=>ut.error(kt))})}},6451:(Ie,_e,Y)=>{"use strict";Y.d(_e,{T:()=>Pe});var h=Y(8189),Te=Y(8421),Ve=Y(515),x=Y(3269),Me=Y(457);function Pe(...ye){const xe=(0,x.yG)(ye),ne=(0,x._6)(ye,1/0),Le=ye;return Le.length?1===Le.length?(0,Te.Xf)(Le[0]):(0,h.J)(ne)((0,Me.D)(Le,xe)):Ve.E}},9646:(Ie,_e,Y)=>{"use strict";Y.d(_e,{of:()=>Ve});var h=Y(3269),Te=Y(457);function Ve(...x){const Me=(0,h.yG)(x);return(0,Te.D)(x,Me)}},5403:(Ie,_e,Y)=>{"use strict";Y.d(_e,{x:()=>Te});var h=Y(930);function Te(x,Me,Pe,ye,xe){return new Ve(x,Me,Pe,ye,xe)}class Ve extends h.Lv{constructor(Me,Pe,ye,xe,ne,Le){super(Me),this.onFinalize=ne,this.shouldUnsubscribe=Le,this._next=Pe?function(ke){try{Pe(ke)}catch(Be){Me.error(Be)}}:super._next,this._error=xe?function(ke){try{xe(ke)}catch(Be){Me.error(Be)}finally{this.unsubscribe()}}:super._error,this._complete=ye?function(){try{ye()}catch(ke){Me.error(ke)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var Me;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:Pe}=this;super.unsubscribe(),!Pe&&(null===(Me=this.onFinalize)||void 0===Me||Me.call(this))}}}},262:(Ie,_e,Y)=>{"use strict";Y.d(_e,{K:()=>x});var h=Y(8421),Te=Y(5403),Ve=Y(4482);function x(Me){return(0,Ve.e)((Pe,ye)=>{let Le,xe=null,ne=!1;xe=Pe.subscribe((0,Te.x)(ye,void 0,void 0,ke=>{Le=(0,h.Xf)(Me(ke,x(Me)(Pe))),xe?(xe.unsubscribe(),xe=null,Le.subscribe(ye)):ne=!0})),ne&&(xe.unsubscribe(),xe=null,Le.subscribe(ye))})}},4351:(Ie,_e,Y)=>{"use strict";Y.d(_e,{b:()=>Ve});var h=Y(5577),Te=Y(576);function Ve(x,Me){return(0,Te.m)(Me)?(0,h.z)(x,Me,1):(0,h.z)(x,1)}},8372:(Ie,_e,Y)=>{"use strict";Y.d(_e,{b:()=>x});var h=Y(4986),Te=Y(4482),Ve=Y(5403);function x(Me,Pe=h.z){return(0,Te.e)((ye,xe)=>{let ne=null,Le=null,ke=null;const Be=()=>{if(ne){ne.unsubscribe(),ne=null;const gt=Le;Le=null,xe.next(gt)}};function yt(){const gt=ke+Me,vt=Pe.now();if(vt<gt)return ne=this.schedule(void 0,gt-vt),void xe.add(ne);Be()}ye.subscribe((0,Ve.x)(xe,gt=>{Le=gt,ke=Pe.now(),ne||(ne=Pe.schedule(yt,Me),xe.add(ne))},()=>{Be(),xe.complete()},void 0,()=>{Le=ne=null}))})}},1884:(Ie,_e,Y)=>{"use strict";Y.d(_e,{x:()=>x});var h=Y(4671),Te=Y(4482),Ve=Y(5403);function x(Pe,ye=h.y){return Pe=null!=Pe?Pe:Me,(0,Te.e)((xe,ne)=>{let Le,ke=!0;xe.subscribe((0,Ve.x)(ne,Be=>{const yt=ye(Be);(ke||!Pe(Le,yt))&&(ke=!1,Le=yt,ne.next(Be))}))})}function Me(Pe,ye){return Pe===ye}},9300:(Ie,_e,Y)=>{"use strict";Y.d(_e,{h:()=>Ve});var h=Y(4482),Te=Y(5403);function Ve(x,Me){return(0,h.e)((Pe,ye)=>{let xe=0;Pe.subscribe((0,Te.x)(ye,ne=>x.call(Me,ne,xe++)&&ye.next(ne)))})}},4004:(Ie,_e,Y)=>{"use strict";Y.d(_e,{U:()=>Ve});var h=Y(4482),Te=Y(5403);function Ve(x,Me){return(0,h.e)((Pe,ye)=>{let xe=0;Pe.subscribe((0,Te.x)(ye,ne=>{ye.next(x.call(Me,ne,xe++))}))})}},8189:(Ie,_e,Y)=>{"use strict";Y.d(_e,{J:()=>Ve});var h=Y(5577),Te=Y(4671);function Ve(x=1/0){return(0,h.z)(Te.y,x)}},5577:(Ie,_e,Y)=>{"use strict";Y.d(_e,{z:()=>xe});var h=Y(4004),Te=Y(8421),Ve=Y(4482),x=Y(9672),Me=Y(5403),ye=Y(576);function xe(ne,Le,ke=1/0){return(0,ye.m)(Le)?xe((Be,yt)=>(0,h.U)((gt,vt)=>Le(Be,gt,yt,vt))((0,Te.Xf)(ne(Be,yt))),ke):("number"==typeof Le&&(ke=Le),(0,Ve.e)((Be,yt)=>function Pe(ne,Le,ke,Be,yt,gt,vt,Tt){const nt=[];let Dt=0,Ht=0,$t=!1;const xt=()=>{$t&&!nt.length&&!Dt&&Le.complete()},ut=qt=>Dt<Be?kt(qt):nt.push(qt),kt=qt=>{gt&&Le.next(qt),Dt++;let ni=!1;(0,Te.Xf)(ke(qt,Ht++)).subscribe((0,Me.x)(Le,xi=>{null==yt||yt(xi),gt?ut(xi):Le.next(xi)},()=>{ni=!0},void 0,()=>{if(ni)try{for(Dt--;nt.length&&Dt<Be;){const xi=nt.shift();vt?(0,x.f)(Le,vt,()=>kt(xi)):kt(xi)}xt()}catch(xi){Le.error(xi)}}))};return ne.subscribe((0,Me.x)(Le,ut,()=>{$t=!0,xt()})),()=>{null==Tt||Tt()}}(Be,yt,ne,ke)))}},5363:(Ie,_e,Y)=>{"use strict";Y.d(_e,{Q:()=>x});var h=Y(9672),Te=Y(4482),Ve=Y(5403);function x(Me,Pe=0){return(0,Te.e)((ye,xe)=>{ye.subscribe((0,Ve.x)(xe,ne=>(0,h.f)(xe,Me,()=>xe.next(ne),Pe),()=>(0,h.f)(xe,Me,()=>xe.complete(),Pe),ne=>(0,h.f)(xe,Me,()=>xe.error(ne),Pe)))})}},5026:(Ie,_e,Y)=>{"use strict";Y.d(_e,{R:()=>x});var h=Y(4482),Te=Y(5403);function Ve(Me,Pe,ye,xe,ne){return(Le,ke)=>{let Be=ye,yt=Pe,gt=0;Le.subscribe((0,Te.x)(ke,vt=>{const Tt=gt++;yt=Be?Me(yt,vt,Tt):(Be=!0,vt),xe&&ke.next(yt)},ne&&(()=>{Be&&ke.next(yt),ke.complete()})))}}function x(Me,Pe){return(0,h.e)(Ve(Me,Pe,arguments.length>=2,!0))}},3099:(Ie,_e,Y)=>{"use strict";Y.d(_e,{B:()=>Pe});var h=Y(457),Te=Y(5698),Ve=Y(7579),x=Y(930),Me=Y(4482);function Pe(xe={}){const{connector:ne=(()=>new Ve.x),resetOnError:Le=!0,resetOnComplete:ke=!0,resetOnRefCountZero:Be=!0}=xe;return yt=>{let gt=null,vt=null,Tt=null,nt=0,Dt=!1,Ht=!1;const $t=()=>{null==vt||vt.unsubscribe(),vt=null},xt=()=>{$t(),gt=Tt=null,Dt=Ht=!1},ut=()=>{const kt=gt;xt(),null==kt||kt.unsubscribe()};return(0,Me.e)((kt,qt)=>{nt++,!Ht&&!Dt&&$t();const ni=Tt=null!=Tt?Tt:ne();qt.add(()=>{nt--,0===nt&&!Ht&&!Dt&&(vt=ye(ut,Be))}),ni.subscribe(qt),gt||(gt=new x.Hp({next:xi=>ni.next(xi),error:xi=>{Ht=!0,$t(),vt=ye(xt,Le,xi),ni.error(xi)},complete:()=>{Dt=!0,$t(),vt=ye(xt,ke),ni.complete()}}),(0,h.D)(kt).subscribe(gt))})(yt)}}function ye(xe,ne,...Le){return!0===ne?(xe(),null):!1===ne?null:ne(...Le).pipe((0,Te.q)(1)).subscribe(()=>xe())}},5684:(Ie,_e,Y)=>{"use strict";Y.d(_e,{T:()=>Te});var h=Y(9300);function Te(Ve){return(0,h.h)((x,Me)=>Ve<=Me)}},3900:(Ie,_e,Y)=>{"use strict";Y.d(_e,{w:()=>x});var h=Y(8421),Te=Y(4482),Ve=Y(5403);function x(Me,Pe){return(0,Te.e)((ye,xe)=>{let ne=null,Le=0,ke=!1;const Be=()=>ke&&!ne&&xe.complete();ye.subscribe((0,Ve.x)(xe,yt=>{null==ne||ne.unsubscribe();let gt=0;const vt=Le++;(0,h.Xf)(Me(yt,vt)).subscribe(ne=(0,Ve.x)(xe,Tt=>xe.next(Pe?Pe(yt,Tt,vt,gt++):Tt),()=>{ne=null,Be()}))},()=>{ke=!0,Be()}))})}},5698:(Ie,_e,Y)=>{"use strict";Y.d(_e,{q:()=>x});var h=Y(515),Te=Y(4482),Ve=Y(5403);function x(Me){return Me<=0?()=>h.E:(0,Te.e)((Pe,ye)=>{let xe=0;Pe.subscribe((0,Ve.x)(ye,ne=>{++xe<=Me&&(ye.next(ne),Me<=xe&&ye.complete())}))})}},2722:(Ie,_e,Y)=>{"use strict";Y.d(_e,{R:()=>Me});var h=Y(4482),Te=Y(5403),Ve=Y(8421),x=Y(5032);function Me(Pe){return(0,h.e)((ye,xe)=>{(0,Ve.Xf)(Pe).subscribe((0,Te.x)(xe,()=>xe.complete(),x.Z)),!xe.closed&&ye.subscribe(xe)})}},7414:(Ie,_e,Y)=>{"use strict";Y.d(_e,{V:()=>ne});var h=Y(4986),Te=Y(1165),Ve=Y(4482),x=Y(8421),Me=Y(3888),Pe=Y(5403),ye=Y(9672);const xe=(0,Me.d)(ke=>function(yt=null){ke(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=yt});function ne(ke,Be){const{first:yt,each:gt,with:vt=Le,scheduler:Tt=(null!=Be?Be:h.z),meta:nt=null}=(0,Te.q)(ke)?{first:ke}:"number"==typeof ke?{each:ke}:ke;if(null==yt&&null==gt)throw new TypeError("No timeout provided.");return(0,Ve.e)((Dt,Ht)=>{let $t,xt,ut=null,kt=0;const qt=ni=>{xt=(0,ye.f)(Ht,Tt,()=>{try{$t.unsubscribe(),(0,x.Xf)(vt({meta:nt,lastValue:ut,seen:kt})).subscribe(Ht)}catch(xi){Ht.error(xi)}},ni)};$t=Dt.subscribe((0,Pe.x)(Ht,ni=>{null==xt||xt.unsubscribe(),kt++,Ht.next(ut=ni),gt>0&&qt(gt)},void 0,void 0,()=>{(null==xt?void 0:xt.closed)||null==xt||xt.unsubscribe(),ut=null})),!kt&&qt(null!=yt?"number"==typeof yt?yt:+yt-Tt.now():gt)})}function Le(ke){throw new xe(ke)}},1365:(Ie,_e,Y)=>{"use strict";Y.d(_e,{M:()=>ye});var h=Y(4482),Te=Y(5403),Ve=Y(8421),x=Y(4671),Me=Y(5032),Pe=Y(3269);function ye(...xe){const ne=(0,Pe.jO)(xe);return(0,h.e)((Le,ke)=>{const Be=xe.length,yt=new Array(Be);let gt=xe.map(()=>!1),vt=!1;for(let Tt=0;Tt<Be;Tt++)(0,Ve.Xf)(xe[Tt]).subscribe((0,Te.x)(ke,nt=>{yt[Tt]=nt,!vt&&!gt[Tt]&&(gt[Tt]=!0,(vt=gt.every(x.y))&&(gt=null))},Me.Z));Le.subscribe((0,Te.x)(ke,Tt=>{if(vt){const nt=[Tt,...yt];ke.next(ne?ne(...nt):nt)}}))})}},4408:(Ie,_e,Y)=>{"use strict";Y.d(_e,{o:()=>Me});var h=Y(727);class Te extends h.w0{constructor(ye,xe){super()}schedule(ye,xe=0){return this}}const Ve={setInterval(Pe,ye,...xe){const{delegate:ne}=Ve;return(null==ne?void 0:ne.setInterval)?ne.setInterval(Pe,ye,...xe):setInterval(Pe,ye,...xe)},clearInterval(Pe){const{delegate:ye}=Ve;return((null==ye?void 0:ye.clearInterval)||clearInterval)(Pe)},delegate:void 0};var x=Y(8737);class Me extends Te{constructor(ye,xe){super(ye,xe),this.scheduler=ye,this.work=xe,this.pending=!1}schedule(ye,xe=0){if(this.closed)return this;this.state=ye;const ne=this.id,Le=this.scheduler;return null!=ne&&(this.id=this.recycleAsyncId(Le,ne,xe)),this.pending=!0,this.delay=xe,this.id=this.id||this.requestAsyncId(Le,this.id,xe),this}requestAsyncId(ye,xe,ne=0){return Ve.setInterval(ye.flush.bind(ye,this),ne)}recycleAsyncId(ye,xe,ne=0){if(null!=ne&&this.delay===ne&&!1===this.pending)return xe;Ve.clearInterval(xe)}execute(ye,xe){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const ne=this._execute(ye,xe);if(ne)return ne;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(ye,xe){let Le,ne=!1;try{this.work(ye)}catch(ke){ne=!0,Le=ke||new Error("Scheduled action threw falsy error")}if(ne)return this.unsubscribe(),Le}unsubscribe(){if(!this.closed){const{id:ye,scheduler:xe}=this,{actions:ne}=xe;this.work=this.state=this.scheduler=null,this.pending=!1,(0,x.P)(ne,this),null!=ye&&(this.id=this.recycleAsyncId(xe,ye,null)),this.delay=null,super.unsubscribe()}}}},7565:(Ie,_e,Y)=>{"use strict";Y.d(_e,{v:()=>Ve});var h=Y(6063);class Te{constructor(Me,Pe=Te.now){this.schedulerActionCtor=Me,this.now=Pe}schedule(Me,Pe=0,ye){return new this.schedulerActionCtor(this,Me).schedule(ye,Pe)}}Te.now=h.l.now;class Ve extends Te{constructor(Me,Pe=Te.now){super(Me,Pe),this.actions=[],this._active=!1,this._scheduled=void 0}flush(Me){const{actions:Pe}=this;if(this._active)return void Pe.push(Me);let ye;this._active=!0;do{if(ye=Me.execute(Me.state,Me.delay))break}while(Me=Pe.shift());if(this._active=!1,ye){for(;Me=Pe.shift();)Me.unsubscribe();throw ye}}}},4986:(Ie,_e,Y)=>{"use strict";Y.d(_e,{P:()=>x,z:()=>Ve});var h=Y(4408);const Ve=new(Y(7565).v)(h.o),x=Ve},6063:(Ie,_e,Y)=>{"use strict";Y.d(_e,{l:()=>h});const h={now:()=>(h.delegate||Date).now(),delegate:void 0}},233:(Ie,_e,Y)=>{"use strict";Y.d(_e,{N:()=>Me});var h=Y(4408),Ve=Y(7565);const Me=new class x extends Ve.v{}(class Te extends h.o{constructor(xe,ne){super(xe,ne),this.scheduler=xe,this.work=ne}schedule(xe,ne=0){return ne>0?super.schedule(xe,ne):(this.delay=ne,this.state=xe,this.scheduler.flush(this),this)}execute(xe,ne){return ne>0||this.closed?super.execute(xe,ne):this._execute(xe,ne)}requestAsyncId(xe,ne,Le=0){return null!=Le&&Le>0||null==Le&&this.delay>0?super.requestAsyncId(xe,ne,Le):xe.flush(this)}})},3410:(Ie,_e,Y)=>{"use strict";Y.d(_e,{z:()=>h});const h={setTimeout(Te,Ve,...x){const{delegate:Me}=h;return(null==Me?void 0:Me.setTimeout)?Me.setTimeout(Te,Ve,...x):setTimeout(Te,Ve,...x)},clearTimeout(Te){const{delegate:Ve}=h;return((null==Ve?void 0:Ve.clearTimeout)||clearTimeout)(Te)},delegate:void 0}},2202:(Ie,_e,Y)=>{"use strict";Y.d(_e,{h:()=>Te});const Te=function h(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(Ie,_e,Y)=>{"use strict";Y.d(_e,{L:()=>h});const h="function"==typeof Symbol&&Symbol.observable||"@@observable"},3269:(Ie,_e,Y)=>{"use strict";Y.d(_e,{_6:()=>Pe,jO:()=>x,yG:()=>Me});var h=Y(576),Te=Y(3532);function Ve(ye){return ye[ye.length-1]}function x(ye){return(0,h.m)(Ve(ye))?ye.pop():void 0}function Me(ye){return(0,Te.K)(Ve(ye))?ye.pop():void 0}function Pe(ye,xe){return"number"==typeof Ve(ye)?ye.pop():xe}},8737:(Ie,_e,Y)=>{"use strict";function h(Te,Ve){if(Te){const x=Te.indexOf(Ve);0<=x&&Te.splice(x,1)}}Y.d(_e,{P:()=>h})},3888:(Ie,_e,Y)=>{"use strict";function h(Te){const x=Te(Me=>{Error.call(Me),Me.stack=(new Error).stack});return x.prototype=Object.create(Error.prototype),x.prototype.constructor=x,x}Y.d(_e,{d:()=>h})},2806:(Ie,_e,Y)=>{"use strict";Y.d(_e,{O:()=>x,x:()=>Ve});var h=Y(2416);let Te=null;function Ve(Me){if(h.v.useDeprecatedSynchronousErrorHandling){const Pe=!Te;if(Pe&&(Te={errorThrown:!1,error:null}),Me(),Pe){const{errorThrown:ye,error:xe}=Te;if(Te=null,ye)throw xe}}else Me()}function x(Me){h.v.useDeprecatedSynchronousErrorHandling&&Te&&(Te.errorThrown=!0,Te.error=Me)}},9672:(Ie,_e,Y)=>{"use strict";function h(Te,Ve,x,Me=0,Pe=!1){const ye=Ve.schedule(function(){x(),Pe?Te.add(this.schedule(null,Me)):this.unsubscribe()},Me);if(Te.add(ye),!Pe)return ye}Y.d(_e,{f:()=>h})},4671:(Ie,_e,Y)=>{"use strict";function h(Te){return Te}Y.d(_e,{y:()=>h})},1144:(Ie,_e,Y)=>{"use strict";Y.d(_e,{z:()=>h});const h=Te=>Te&&"number"==typeof Te.length&&"function"!=typeof Te},2206:(Ie,_e,Y)=>{"use strict";Y.d(_e,{D:()=>Te});var h=Y(576);function Te(Ve){return Symbol.asyncIterator&&(0,h.m)(null==Ve?void 0:Ve[Symbol.asyncIterator])}},1165:(Ie,_e,Y)=>{"use strict";function h(Te){return Te instanceof Date&&!isNaN(Te)}Y.d(_e,{q:()=>h})},576:(Ie,_e,Y)=>{"use strict";function h(Te){return"function"==typeof Te}Y.d(_e,{m:()=>h})},3670:(Ie,_e,Y)=>{"use strict";Y.d(_e,{c:()=>Ve});var h=Y(8822),Te=Y(576);function Ve(x){return(0,Te.m)(x[h.L])}},6495:(Ie,_e,Y)=>{"use strict";Y.d(_e,{T:()=>Ve});var h=Y(2202),Te=Y(576);function Ve(x){return(0,Te.m)(null==x?void 0:x[h.h])}},8239:(Ie,_e,Y)=>{"use strict";Y.d(_e,{t:()=>Te});var h=Y(576);function Te(Ve){return(0,h.m)(null==Ve?void 0:Ve.then)}},3260:(Ie,_e,Y)=>{"use strict";Y.d(_e,{L:()=>x,Q:()=>Ve});var h=Y(655),Te=Y(576);function Ve(Me){return(0,h.FC)(this,arguments,function*(){const ye=Me.getReader();try{for(;;){const{value:xe,done:ne}=yield(0,h.qq)(ye.read());if(ne)return yield(0,h.qq)(void 0);yield yield(0,h.qq)(xe)}}finally{ye.releaseLock()}})}function x(Me){return(0,Te.m)(null==Me?void 0:Me.getReader)}},3532:(Ie,_e,Y)=>{"use strict";Y.d(_e,{K:()=>Te});var h=Y(576);function Te(Ve){return Ve&&(0,h.m)(Ve.schedule)}},4482:(Ie,_e,Y)=>{"use strict";Y.d(_e,{A:()=>Te,e:()=>Ve});var h=Y(576);function Te(x){return(0,h.m)(null==x?void 0:x.lift)}function Ve(x){return Me=>{if(Te(Me))return Me.lift(function(Pe){try{return x(Pe,this)}catch(ye){this.error(ye)}});throw new TypeError("Unable to lift unknown Observable type")}}},5032:(Ie,_e,Y)=>{"use strict";function h(){}Y.d(_e,{Z:()=>h})},7849:(Ie,_e,Y)=>{"use strict";Y.d(_e,{h:()=>Ve});var h=Y(2416),Te=Y(3410);function Ve(x){Te.z.setTimeout(()=>{const{onUnhandledError:Me}=h.v;if(!Me)throw x;Me(x)})}},4532:(Ie,_e,Y)=>{"use strict";function h(Te){return new TypeError(`You provided ${null!==Te&&"object"==typeof Te?"an invalid object":`'${Te}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}Y.d(_e,{z:()=>h})},655:(Ie,_e,Y)=>{"use strict";function xe(Ue,et,Oe,Qe){return new(Oe||(Oe=Promise))(function(Ze,Ci){function tn(_i){try{si(Qe.next(_i))}catch(Pr){Ci(Pr)}}function br(_i){try{si(Qe.throw(_i))}catch(Pr){Ci(Pr)}}function si(_i){_i.done?Ze(_i.value):function Et(Ze){return Ze instanceof Oe?Ze:new Oe(function(Ci){Ci(Ze)})}(_i.value).then(tn,br)}si((Qe=Qe.apply(Ue,et||[])).next())})}function nt(Ue){return this instanceof nt?(this.v=Ue,this):new nt(Ue)}function Dt(Ue,et,Oe){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Et,Qe=Oe.apply(Ue,et||[]),Ze=[];return Et={},Ci("next"),Ci("throw"),Ci("return"),Et[Symbol.asyncIterator]=function(){return this},Et;function Ci(hn){Qe[hn]&&(Et[hn]=function(Gn){return new Promise(function(Qi,Mo){Ze.push([hn,Gn,Qi,Mo])>1||tn(hn,Gn)})})}function tn(hn,Gn){try{!function br(hn){hn.value instanceof nt?Promise.resolve(hn.value.v).then(si,_i):Pr(Ze[0][2],hn)}(Qe[hn](Gn))}catch(Qi){Pr(Ze[0][3],Qi)}}function si(hn){tn("next",hn)}function _i(hn){tn("throw",hn)}function Pr(hn,Gn){hn(Gn),Ze.shift(),Ze.length&&tn(Ze[0][0],Ze[0][1])}}function $t(Ue){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Oe,et=Ue[Symbol.asyncIterator];return et?et.call(Ue):(Ue=function Be(Ue){var et="function"==typeof Symbol&&Symbol.iterator,Oe=et&&Ue[et],Qe=0;if(Oe)return Oe.call(Ue);if(Ue&&"number"==typeof Ue.length)return{next:function(){return Ue&&Qe>=Ue.length&&(Ue=void 0),{value:Ue&&Ue[Qe++],done:!Ue}}};throw new TypeError(et?"Object is not iterable.":"Symbol.iterator is not defined.")}(Ue),Oe={},Qe("next"),Qe("throw"),Qe("return"),Oe[Symbol.asyncIterator]=function(){return this},Oe);function Qe(Ze){Oe[Ze]=Ue[Ze]&&function(Ci){return new Promise(function(tn,br){!function Et(Ze,Ci,tn,br){Promise.resolve(br).then(function(si){Ze({value:si,done:tn})},Ci)}(tn,br,(Ci=Ue[Ze](Ci)).done,Ci.value)})}}}Y.d(_e,{FC:()=>Dt,KL:()=>$t,mG:()=>xe,qq:()=>nt})},1943:function(Ie){Ie.exports=function(){"use strict";var _e,Y,h;function Te(x,Me){if(_e)if(Y){var Pe="var sharedChunk = {}; ("+_e+")(sharedChunk); ("+Y+")(sharedChunk);",ye={};_e(ye),h=Me(ye),"undefined"!=typeof window&&(h.workerUrl=window.URL.createObjectURL(new Blob([Pe],{type:"text/javascript"})))}else Y=Me;else _e=Me}return Te(0,function(x){var Me=Pe;function Pe(c,r,d,g){this.cx=3*c,this.bx=3*(d-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(g-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=r,this.p2x=d,this.p2y=g}function ye(c,r,d,g){const v=new Me(c,r,d,g);return function(M){return v.solve(M)}}Pe.prototype={sampleCurveX:function(c){return((this.ax*c+this.bx)*c+this.cx)*c},sampleCurveY:function(c){return((this.ay*c+this.by)*c+this.cy)*c},sampleCurveDerivativeX:function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},solveCurveX:function(c,r){if(void 0===r&&(r=1e-6),c<0)return 0;if(c>1)return 1;for(var d=c,g=0;g<8;g++){var v=this.sampleCurveX(d)-c;if(Math.abs(v)<r)return d;var M=this.sampleCurveDerivativeX(d);if(Math.abs(M)<1e-6)break;d-=v/M}var E=0,k=1;for(d=c,g=0;g<20&&(v=this.sampleCurveX(d),!(Math.abs(v-c)<r));g++)c>v?E=d:k=d,d=.5*(k-E)+E;return d},solve:function(c,r){return this.sampleCurveY(this.solveCurveX(c,r))}};const xe=ye(.25,.1,.25,1);function ne(c,r,d){return Math.min(d,Math.max(r,c))}function Le(c,r,d){const g=d-r,v=((c-r)%g+g)%g+r;return v===r?d:v}function ke(c,...r){for(const d of r)for(const g in d)c[g]=d[g];return c}let Be=1;function yt(c,r){c.forEach(d=>{r[d]&&(r[d]=r[d].bind(r))})}function gt(c,r,d){const g={};for(const v in c)g[v]=r.call(d||this,c[v],v,c);return g}function vt(c,r,d){const g={};for(const v in c)r.call(d||this,c[v],v,c)&&(g[v]=c[v]);return g}function Tt(c){return Array.isArray(c)?c.map(Tt):"object"==typeof c&&c?gt(c,Tt):c}const nt={};function Dt(c){nt[c]||("undefined"!=typeof console&&console.warn(c),nt[c]=!0)}function Ht(c,r,d){return(d.y-c.y)*(r.x-c.x)>(r.y-c.y)*(d.x-c.x)}function $t(c){let r=0;for(let d,g,v=0,M=c.length,E=M-1;v<M;E=v++)d=c[v],g=c[E],r+=(g.x-d.x)*(d.y+g.y);return r}function xt(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function ut(c){const r={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(d,g,v,M)=>{const E=v||M;return r[g]=!E||E.toLowerCase(),""}),r["max-age"]){const d=parseInt(r["max-age"],10);isNaN(d)?delete r["max-age"]:r["max-age"]=d}return r}let kt,qt,ni=null;function xi(c){if(null==ni){const r=c.navigator?c.navigator.userAgent:null;ni=!!c.safari||!(!r||!(/\b(iPad|iPhone|iPod)\b/.test(r)||r.match("Safari")&&!r.match("Chrome")))}return ni}function Ue(c){return"undefined"!=typeof ImageBitmap&&c instanceof ImageBitmap}const et={now:"undefined"!=typeof performance&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(c){const r=requestAnimationFrame(c);return{cancel:()=>cancelAnimationFrame(r)}},getImageData(c,r=0){const d=window.document.createElement("canvas"),g=d.getContext("2d");if(!g)throw new Error("failed to create canvas 2d context");return d.width=c.width,d.height=c.height,g.drawImage(c,0,0,c.width,c.height),g.getImageData(-r,-r,c.width+2*r,c.height+2*r)},resolveURL:c=>(kt||(kt=document.createElement("a")),kt.href=c,kt.href),hardwareConcurrency:"undefined"!=typeof navigator&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(null==qt&&(qt=matchMedia("(prefers-reduced-motion: reduce)")),qt.matches)}};var Oe=Qe;function Qe(c,r){this.x=c,this.y=r}Qe.prototype={clone:function(){return new Qe(this.x,this.y)},add:function(c){return this.clone()._add(c)},sub:function(c){return this.clone()._sub(c)},multByPoint:function(c){return this.clone()._multByPoint(c)},divByPoint:function(c){return this.clone()._divByPoint(c)},mult:function(c){return this.clone()._mult(c)},div:function(c){return this.clone()._div(c)},rotate:function(c){return this.clone()._rotate(c)},rotateAround:function(c,r){return this.clone()._rotateAround(c,r)},matMult:function(c){return this.clone()._matMult(c)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(c){return this.x===c.x&&this.y===c.y},dist:function(c){return Math.sqrt(this.distSqr(c))},distSqr:function(c){var r=c.x-this.x,d=c.y-this.y;return r*r+d*d},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith:function(c){return this.angleWithSep(c.x,c.y)},angleWithSep:function(c,r){return Math.atan2(this.x*r-this.y*c,this.x*c+this.y*r)},_matMult:function(c){var r=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=r,this},_add:function(c){return this.x+=c.x,this.y+=c.y,this},_sub:function(c){return this.x-=c.x,this.y-=c.y,this},_mult:function(c){return this.x*=c,this.y*=c,this},_div:function(c){return this.x/=c,this.y/=c,this},_multByPoint:function(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint:function(c){return this.x/=c.x,this.y/=c.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var c=this.y;return this.y=this.x,this.x=-c,this},_rotate:function(c){var r=Math.cos(c),d=Math.sin(c),g=d*this.x+r*this.y;return this.x=r*this.x-d*this.y,this.y=g,this},_rotateAround:function(c,r){var d=Math.cos(c),g=Math.sin(c),v=r.y+g*(this.x-r.x)+d*(this.y-r.y);return this.x=r.x+d*(this.x-r.x)-g*(this.y-r.y),this.y=v,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Qe.convert=function(c){return c instanceof Qe?c:Array.isArray(c)?new Qe(c[0],c[1]):c};const Et={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},Ze="mapbox-tiles";let Ci,br=500,si=50;function _i(){"undefined"==typeof caches||Ci||(Ci=caches.open(Ze))}let Pr=1/0;const hn={supported:!1,testSupport:function(c){!Mo&&Qi&&(Do?Wn(c):Gn=c)}};let Gn,Qi,Mo=!1,Do=!1;function Wn(c){const r=c.createTexture();c.bindTexture(c.TEXTURE_2D,r);try{if(c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,Qi),c.isContextLost())return;hn.supported=!0}catch(d){}c.deleteTexture(r),Mo=!0}"undefined"!=typeof document&&(Qi=document.createElement("img"),Qi.onload=function(){Gn&&Wn(Gn),Gn=null,Do=!0},Qi.onerror=function(){Mo=!0,Gn=null},Qi.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const is={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(is);class ns extends Error{constructor(r,d,g,v){super(`AJAXError: ${d} (${r}): ${g}`),this.status=r,this.statusText=d,this.url=g,this.body=v}}const Jn=xt()?()=>self.worker&&self.worker.referrer:()=>("blob:"===window.location.protocol?window.parent:window).location.href;function Cs(c,r){const d=new AbortController,g=new Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,referrer:Jn(),signal:d.signal});let v=!1,M=!1;return"json"===c.type&&g.headers.set("Accept","application/json"),((E,k,O)=>{if(M)return;const V=Date.now();fetch(g).then(H=>{return H.ok?($=H,null,V,void("arrayBuffer"===c.type?$.arrayBuffer():"json"===c.type?$.json():$.text()).then(ee=>{M||(v=!0,r(null,ee,$.headers.get("Cache-Control"),$.headers.get("Expires")))}).catch(ee=>{M||r(new Error(ee.message))})):H.blob().then($=>r(new ns(H.status,H.statusText,c.url,$)));var $}).catch(H=>{20!==H.code&&r(new Error(H.message))})})(),{cancel:()=>{M=!0,v||d.abort()}}}const Ro=function(c,r){if(/:\/\//.test(c.url)&&!/^https?:|^file:/.test(c.url)){if(xt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,r);if(!xt()){const g=c.url.substring(0,c.url.indexOf("://"));return(Et.REGISTERED_PROTOCOLS[g]||Cs)(c,r)}}if(!(/^file:/.test(d=c.url)||/^file:/.test(Jn())&&!/^\w+:/.test(d))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Cs(c,r);if(xt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,r,void 0,!0)}var d;return function(g,v){const M=new XMLHttpRequest;M.open(g.method||"GET",g.url,!0),"arrayBuffer"===g.type&&(M.responseType="arraybuffer");for(const E in g.headers)M.setRequestHeader(E,g.headers[E]);return"json"===g.type&&(M.responseType="text",M.setRequestHeader("Accept","application/json")),M.withCredentials="include"===g.credentials,M.onerror=()=>{v(new Error(M.statusText))},M.onload=()=>{if((M.status>=200&&M.status<300||0===M.status)&&null!==M.response){let E=M.response;if("json"===g.type)try{E=JSON.parse(M.response)}catch(k){return v(k)}v(null,E,M.getResponseHeader("Cache-Control"),M.getResponseHeader("Expires"))}else{const E=new Blob([M.response],{type:M.getResponseHeader("Content-Type")});v(new ns(M.status,M.statusText,g.url,E))}},M.send(g.body),{cancel:()=>M.abort()}}(c,r)},oo=function(c,r){return Ro(ke(c,{type:"arrayBuffer"}),r)};function Eo(c){const r=window.document.createElement("a");return r.href=c,r.protocol===window.document.location.protocol&&r.host===window.document.location.host}const rs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let pi,Or;pi=[],Or=0;const mr=function(c,r){if(hn.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),Or>=Et.MAX_PARALLEL_IMAGE_REQUESTS){const M={requestParameters:c,callback:r,cancelled:!1,cancel(){this.cancelled=!0}};return pi.push(M),M}Or++;let d=!1;const g=()=>{if(!d)for(d=!0,Or--;pi.length&&Or<Et.MAX_PARALLEL_IMAGE_REQUESTS;){const M=pi.shift(),{requestParameters:E,callback:k,cancelled:O}=M;O||(M.cancel=mr(E,k).cancel)}},v=oo(c,(M,E,k,O)=>{var V,H,$,K;g(),M?r(M):E&&(V=E,H=r,$=k,K=O,"function"==typeof createImageBitmap?function(Q,ee){const de=new Blob([new Uint8Array(Q)],{type:"image/png"});createImageBitmap(de).then(pe=>{ee(null,pe)}).catch(pe=>{ee(new Error(`Could not load image because of ${pe.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(V,H):function(Q,ee,de,pe){const Ee=new Image;Ee.onload=()=>{ee(null,Ee),URL.revokeObjectURL(Ee.src),Ee.onload=null,window.requestAnimationFrame(()=>{Ee.src=rs})},Ee.onerror=()=>ee(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const $e=new Blob([new Uint8Array(Q)],{type:"image/png"});Ee.cacheControl=de,Ee.expires=pe,Ee.src=Q.byteLength?URL.createObjectURL($e):rs}(V,H,$,K))});return{cancel:()=>{v.cancel(),g()}}};function er(c,r,d){d[c]&&-1!==d[c].indexOf(r)||(d[c]=d[c]||[],d[c].push(r))}function Hi(c,r,d){if(d&&d[c]){const g=d[c].indexOf(r);-1!==g&&d[c].splice(g,1)}}class Po{constructor(r,d={}){ke(this,d),this.type=r}}class xr extends Po{constructor(r,d={}){super("error",ke({error:r},d))}}class wr{on(r,d){return this._listeners=this._listeners||{},er(r,d,this._listeners),this}off(r,d){return Hi(r,d,this._listeners),Hi(r,d,this._oneTimeListeners),this}once(r,d){return this._oneTimeListeners=this._oneTimeListeners||{},er(r,d,this._oneTimeListeners),this}fire(r,d){"string"==typeof r&&(r=new Po(r,d||{}));const g=r.type;if(this.listens(g)){r.target=this;const v=this._listeners&&this._listeners[g]?this._listeners[g].slice():[];for(const k of v)k.call(this,r);const M=this._oneTimeListeners&&this._oneTimeListeners[g]?this._oneTimeListeners[g].slice():[];for(const k of M)Hi(g,k,this._oneTimeListeners),k.call(this,r);const E=this._eventedParent;E&&(ke(r,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),E.fire(r))}else r instanceof xr&&console.error(r.error);return this}listens(r){return this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r)}setEventedParent(r,d){return this._eventedParent=r,this._eventedParentData=d,this}}var Xe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class Pt{constructor(r,d,g,v){this.message=(r?`${r}: `:"")+g,v&&(this.identifier=v),null!=d&&d.__line__&&(this.line=d.__line__)}}function Yi(c){const r=c.value;return r?[new Pt(c.key,r,"constants have been deprecated as of v8")]:[]}function ai(c,...r){for(const d of r)for(const g in d)c[g]=d[g];return c}function Kt(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function Fr(c){if(Array.isArray(c))return c.map(Fr);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const r={};for(const d in c)r[d]=Fr(c[d]);return r}return Kt(c)}class gr extends Error{constructor(r,d){super(d),this.message=d,this.key=r}}class Vi{constructor(r,d=[]){this.parent=r,this.bindings={};for(const[g,v]of d)this.bindings[g]=v}concat(r){return new Vi(this,r)}get(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(`${r} not found in scope.`)}has(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)}}const Zn={kind:"null"},ft={kind:"number"},vi={kind:"string"},wt={kind:"boolean"},sr={kind:"color"},Li={kind:"object"},Mi={kind:"value"},Oo={kind:"collator"},ar={kind:"formatted"},Fn={kind:"resolvedImage"};function Cr(c,r){return{kind:"array",itemType:c,N:r}}function Wi(c){if("array"===c.kind){const r=Wi(c.itemType);return"number"==typeof c.N?`array<${r}, ${c.N}>`:"value"===c.itemType.kind?"array":`array<${r}>`}return c.kind}const os=[Zn,ft,vi,wt,sr,ar,Li,Cr(Mi),Fn];function Rn(c,r){if("error"===r.kind)return null;if("array"===c.kind){if("array"===r.kind&&(0===r.N&&"value"===r.itemType.kind||!Rn(c.itemType,r.itemType))&&("number"!=typeof c.N||c.N===r.N))return null}else{if(c.kind===r.kind)return null;if("value"===c.kind)for(const d of os)if(!Rn(d,r))return null}return`Expected ${Wi(c)} but found ${Wi(r)} instead.`}function Fo(c,r){return r.some(d=>d.kind===c.kind)}function Dn(c,r){return r.some(d=>"null"===d?null===c:"array"===d?Array.isArray(c):"object"===d?c&&!Array.isArray(c)&&"object"==typeof c:d===typeof c)}var so,Ms={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function ss(c){return(c=Math.round(c))<0?0:c>255?255:c}function Ds(c){return ss("%"===c[c.length-1]?parseFloat(c)/100*255:parseInt(c))}function re(c){return(r="%"===c[c.length-1]?parseFloat(c)/100:parseFloat(c))<0?0:r>1?1:r;var r}function z(c,r,d){return d<0?d+=1:d>1&&(d-=1),6*d<1?c+(r-c)*d*6:2*d<1?r:3*d<2?c+(r-c)*(2/3-d)*6:c}try{so={}.parseCSSColor=function(c){var r,d=c.replace(/ /g,"").toLowerCase();if(d in Ms)return Ms[d].slice();if("#"===d[0])return 4===d.length?(r=parseInt(d.substr(1),16))>=0&&r<=4095?[(3840&r)>>4|(3840&r)>>8,240&r|(240&r)>>4,15&r|(15&r)<<4,1]:null:7===d.length&&(r=parseInt(d.substr(1),16))>=0&&r<=16777215?[(16711680&r)>>16,(65280&r)>>8,255&r,1]:null;var g=d.indexOf("("),v=d.indexOf(")");if(-1!==g&&v+1===d.length){var M=d.substr(0,g),E=d.substr(g+1,v-(g+1)).split(","),k=1;switch(M){case"rgba":if(4!==E.length)return null;k=re(E.pop());case"rgb":return 3!==E.length?null:[Ds(E[0]),Ds(E[1]),Ds(E[2]),k];case"hsla":if(4!==E.length)return null;k=re(E.pop());case"hsl":if(3!==E.length)return null;var O=(parseFloat(E[0])%360+360)%360/360,V=re(E[1]),H=re(E[2]),$=H<=.5?H*(V+1):H+V-H*V,K=2*H-$;return[ss(255*z(K,$,O+1/3)),ss(255*z(K,$,O)),ss(255*z(K,$,O-1/3)),k];default:return null}}return null}}catch(c){}class U{constructor(r,d,g,v=1){this.r=r,this.g=d,this.b=g,this.a=v}static parse(r){if(!r)return;if(r instanceof U)return r;if("string"!=typeof r)return;const d=so(r);return d?new U(d[0]/255*d[3],d[1]/255*d[3],d[2]/255*d[3],d[3]):void 0}toString(){const[r,d,g,v]=this.toArray();return`rgba(${Math.round(r)},${Math.round(d)},${Math.round(g)},${v})`}toArray(){const{r,g:d,b:g,a:v}=this;return 0===v?[0,0,0,0]:[255*r/v,255*d/v,255*g/v,v]}}U.black=new U(0,0,0,1),U.white=new U(1,1,1,1),U.transparent=new U(0,0,0,0),U.red=new U(1,0,0,1);class J{constructor(r,d,g){this.sensitivity=r?d?"variant":"case":d?"accent":"base",this.locale=g,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(r,d){return this.collator.compare(r,d)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ie{constructor(r,d,g,v,M){this.text=r,this.image=d,this.scale=g,this.fontStack=v,this.textColor=M}}class le{constructor(r){this.sections=r}static fromString(r){return new le([new ie(r,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(r=>0!==r.text.length||r.image&&0!==r.image.name.length)}static factory(r){return r instanceof le?r:le.fromString(r)}toString(){return 0===this.sections.length?"":this.sections.map(r=>r.text).join("")}serialize(){const r=["format"];for(const d of this.sections){if(d.image){r.push(["image",d.image.name]);continue}r.push(d.text);const g={};d.fontStack&&(g["text-font"]=["literal",d.fontStack.split(",")]),d.scale&&(g["font-scale"]=d.scale),d.textColor&&(g["text-color"]=["rgba"].concat(d.textColor.toArray())),r.push(g)}return r}}class we{constructor(r){this.name=r.name,this.available=r.available}toString(){return this.name}static fromString(r){return r?new we({name:r,available:!1}):null}serialize(){return["image",this.name]}}function fe(c,r,d,g){return"number"==typeof c&&c>=0&&c<=255&&"number"==typeof r&&r>=0&&r<=255&&"number"==typeof d&&d>=0&&d<=255?void 0===g||"number"==typeof g&&g>=0&&g<=1?null:`Invalid rgba value [${[c,r,d,g].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof g?[c,r,d,g]:[c,r,d]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function me(c){if(null===c||"string"==typeof c||"boolean"==typeof c||"number"==typeof c||c instanceof U||c instanceof J||c instanceof le||c instanceof we)return!0;if(Array.isArray(c)){for(const r of c)if(!me(r))return!1;return!0}if("object"==typeof c){for(const r in c)if(!me(c[r]))return!1;return!0}return!1}function be(c){if(null===c)return Zn;if("string"==typeof c)return vi;if("boolean"==typeof c)return wt;if("number"==typeof c)return ft;if(c instanceof U)return sr;if(c instanceof J)return Oo;if(c instanceof le)return ar;if(c instanceof we)return Fn;if(Array.isArray(c)){const r=c.length;let d;for(const g of c){const v=be(g);if(d){if(d===v)continue;d=Mi;break}d=v}return Cr(d||Mi,r)}return Li}function He(c){const r=typeof c;return null===c?"":"string"===r||"number"===r||"boolean"===r?String(c):c instanceof U||c instanceof le||c instanceof we?c.toString():JSON.stringify(c)}class at{constructor(r,d){this.type=r,this.value=d}static parse(r,d){if(2!==r.length)return d.error(`'literal' expression requires exactly one argument, but found ${r.length-1} instead.`);if(!me(r[1]))return d.error("invalid value");const g=r[1];let v=be(g);const M=d.expectedType;return"array"!==v.kind||0!==v.N||!M||"array"!==M.kind||"number"==typeof M.N&&0!==M.N||(v=M),new at(v,g)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof U?["rgba"].concat(this.value.toArray()):this.value instanceof le?this.value.serialize():this.value}}class je{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}}const We={string:vi,number:ft,boolean:wt,object:Li};class lt{constructor(r,d){this.type=r,this.args=d}static parse(r,d){if(r.length<2)return d.error("Expected at least one argument.");let g,v=1;const M=r[0];if("array"===M){let k,O;if(r.length>2){const V=r[1];if("string"!=typeof V||!(V in We)||"object"===V)return d.error('The item type argument of "array" must be one of string, number, boolean',1);k=We[V],v++}else k=Mi;if(r.length>3){if(null!==r[2]&&("number"!=typeof r[2]||r[2]<0||r[2]!==Math.floor(r[2])))return d.error('The length argument to "array" must be a positive integer literal',2);O=r[2],v++}g=Cr(k,O)}else g=We[M];const E=[];for(;v<r.length;v++){const k=d.parse(r[v],v,Mi);if(!k)return null;E.push(k)}return new lt(g,E)}evaluate(r){for(let d=0;d<this.args.length;d++){const g=this.args[d].evaluate(r);if(!Rn(this.type,be(g)))return g;if(d===this.args.length-1)throw new je(`Expected value to be of type ${Wi(this.type)}, but found ${Wi(be(g))} instead.`)}return null}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){const r=this.type,d=[r.kind];if("array"===r.kind){const g=r.itemType;if("string"===g.kind||"number"===g.kind||"boolean"===g.kind){d.push(g.kind);const v=r.N;("number"==typeof v||this.args.length>1)&&d.push(v)}}return d.concat(this.args.map(g=>g.serialize()))}}class Ct{constructor(r){this.type=ar,this.sections=r}static parse(r,d){if(r.length<2)return d.error("Expected at least one argument.");const g=r[1];if(!Array.isArray(g)&&"object"==typeof g)return d.error("First argument must be an image or text section.");const v=[];let M=!1;for(let E=1;E<=r.length-1;++E){const k=r[E];if(M&&"object"==typeof k&&!Array.isArray(k)){M=!1;let O=null;if(k["font-scale"]&&(O=d.parse(k["font-scale"],1,ft),!O))return null;let V=null;if(k["text-font"]&&(V=d.parse(k["text-font"],1,Cr(vi)),!V))return null;let H=null;if(k["text-color"]&&(H=d.parse(k["text-color"],1,sr),!H))return null;const $=v[v.length-1];$.scale=O,$.font=V,$.textColor=H}else{const O=d.parse(r[E],1,Mi);if(!O)return null;const V=O.type.kind;if("string"!==V&&"value"!==V&&"null"!==V&&"resolvedImage"!==V)return d.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");M=!0,v.push({content:O,scale:null,font:null,textColor:null})}}return new Ct(v)}evaluate(r){return new le(this.sections.map(d=>{const g=d.content.evaluate(r);return be(g)===Fn?new ie("",g,null,null,null):new ie(He(g),null,d.scale?d.scale.evaluate(r):null,d.font?d.font.evaluate(r).join(","):null,d.textColor?d.textColor.evaluate(r):null)}))}eachChild(r){for(const d of this.sections)r(d.content),d.scale&&r(d.scale),d.font&&r(d.font),d.textColor&&r(d.textColor)}outputDefined(){return!1}serialize(){const r=["format"];for(const d of this.sections){r.push(d.content.serialize());const g={};d.scale&&(g["font-scale"]=d.scale.serialize()),d.font&&(g["text-font"]=d.font.serialize()),d.textColor&&(g["text-color"]=d.textColor.serialize()),r.push(g)}return r}}class Yt{constructor(r){this.type=Fn,this.input=r}static parse(r,d){if(2!==r.length)return d.error("Expected two arguments.");const g=d.parse(r[1],1,vi);return g?new Yt(g):d.error("No image name provided.")}evaluate(r){const d=this.input.evaluate(r),g=we.fromString(d);return g&&r.availableImages&&(g.available=r.availableImages.indexOf(d)>-1),g}eachChild(r){r(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Ri={"to-boolean":wt,"to-color":sr,"to-number":ft,"to-string":vi};class fi{constructor(r,d){this.type=r,this.args=d}static parse(r,d){if(r.length<2)return d.error("Expected at least one argument.");const g=r[0];if(("to-boolean"===g||"to-string"===g)&&2!==r.length)return d.error("Expected one argument.");const v=Ri[g],M=[];for(let E=1;E<r.length;E++){const k=d.parse(r[E],E,Mi);if(!k)return null;M.push(k)}return new fi(v,M)}evaluate(r){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(r));if("color"===this.type.kind){let d,g;for(const v of this.args){if(d=v.evaluate(r),g=null,d instanceof U)return d;if("string"==typeof d){const M=r.parseColor(d);if(M)return M}else if(Array.isArray(d)&&(g=d.length<3||d.length>4?`Invalid rbga value ${JSON.stringify(d)}: expected an array containing either three or four numeric values.`:fe(d[0],d[1],d[2],d[3]),!g))return new U(d[0]/255,d[1]/255,d[2]/255,d[3])}throw new je(g||`Could not parse color from value '${"string"==typeof d?d:String(JSON.stringify(d))}'`)}if("number"===this.type.kind){let d=null;for(const g of this.args){if(d=g.evaluate(r),null===d)return 0;const v=Number(d);if(!isNaN(v))return v}throw new je(`Could not convert ${JSON.stringify(d)} to number.`)}return"formatted"===this.type.kind?le.fromString(He(this.args[0].evaluate(r))):"resolvedImage"===this.type.kind?we.fromString(He(this.args[0].evaluate(r))):He(this.args[0].evaluate(r))}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){if("formatted"===this.type.kind)return new Ct([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Yt(this.args[0]).serialize();const r=[`to-${this.type.kind}`];return this.eachChild(d=>{r.push(d.serialize())}),r}}const wi=["Unknown","Point","LineString","Polygon"];class Xt{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?wi[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(r){let d=this._parseColorCache[r];return d||(d=this._parseColorCache[r]=U.parse(r)),d}}class bi{constructor(r,d,g,v){this.name=r,this.type=d,this._evaluate=g,this.args=v}evaluate(r){return this._evaluate(r,this.args)}eachChild(r){this.args.forEach(r)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(r=>r.serialize()))}static parse(r,d){const g=r[0],v=bi.definitions[g];if(!v)return d.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0);const M=Array.isArray(v)?v[0]:v.type,E=Array.isArray(v)?[[v[1],v[2]]]:v.overloads,k=E.filter(([V])=>!Array.isArray(V)||V.length===r.length-1);let O=null;for(const[V,H]of k){O=new lo(d.registry,d.path,null,d.scope);const $=[];let K=!1;for(let Q=1;Q<r.length;Q++){const ee=r[Q],de=Array.isArray(V)?V[Q-1]:V.type,pe=O.parse(ee,1+$.length,de);if(!pe){K=!0;break}$.push(pe)}if(!K)if(Array.isArray(V)&&V.length!==$.length)O.error(`Expected ${V.length} arguments, but found ${$.length} instead.`);else{for(let Q=0;Q<$.length;Q++){const ee=Array.isArray(V)?V[Q]:V.type,de=$[Q];O.concat(Q+1).checkSubtype(ee,de.type)}if(0===O.errors.length)return new bi(g,M,H,$)}}if(1===k.length)d.errors.push(...O.errors);else{const V=(k.length?k:E).map(([$])=>{return K=$,Array.isArray(K)?`(${K.map(Wi).join(", ")})`:`(${Wi(K.type)}...)`;var K}).join(" | "),H=[];for(let $=1;$<r.length;$++){const K=d.parse(r[$],1+H.length);if(!K)return null;H.push(Wi(K.type))}d.error(`Expected arguments of type ${V}, but found (${H.join(", ")}) instead.`)}return null}static register(r,d){bi.definitions=d;for(const g in d)r[g]=bi}}class on{constructor(r,d,g){this.type=Oo,this.locale=g,this.caseSensitive=r,this.diacriticSensitive=d}static parse(r,d){if(2!==r.length)return d.error("Expected one argument.");const g=r[1];if("object"!=typeof g||Array.isArray(g))return d.error("Collator options argument must be an object.");const v=d.parse(void 0!==g["case-sensitive"]&&g["case-sensitive"],1,wt);if(!v)return null;const M=d.parse(void 0!==g["diacritic-sensitive"]&&g["diacritic-sensitive"],1,wt);if(!M)return null;let E=null;return g.locale&&(E=d.parse(g.locale,1,vi),!E)?null:new on(v,M,E)}evaluate(r){return new J(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)}eachChild(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)}outputDefined(){return!1}serialize(){const r={};return r["case-sensitive"]=this.caseSensitive.serialize(),r["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(r.locale=this.locale.serialize()),["collator",r]}}const ri=8192;function $n(c,r){c[0]=Math.min(c[0],r[0]),c[1]=Math.min(c[1],r[1]),c[2]=Math.max(c[2],r[0]),c[3]=Math.max(c[3],r[1])}function Lr(c,r){return!(c[0]<=r[0]||c[2]>=r[2]||c[1]<=r[1]||c[3]>=r[3])}function ue(c,r){const d=(180+c[0])/360,g=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,v=Math.pow(2,r.z);return[Math.round(d*v*ri),Math.round(g*v*ri)]}function tt(c,r,d){const g=c[0]-r[0],v=c[1]-r[1],M=c[0]-d[0],E=c[1]-d[1];return g*E-M*v==0&&g*M<=0&&v*E<=0}function Ae(c,r){let d=!1;for(let E=0,k=r.length;E<k;E++){const O=r[E];for(let V=0,H=O.length;V<H-1;V++){if(tt(c,O[V],O[V+1]))return!1;(v=O[V])[1]>(g=c)[1]!=(M=O[V+1])[1]>g[1]&&g[0]<(M[0]-v[0])*(g[1]-v[1])/(M[1]-v[1])+v[0]&&(d=!d)}}var g,v,M;return d}function Fe(c,r){for(let d=0;d<r.length;d++)if(Ae(c,r[d]))return!0;return!1}function Ot(c,r,d,g){const v=g[0]-d[0],M=g[1]-d[1],E=(c[0]-d[0])*M-v*(c[1]-d[1]),k=(r[0]-d[0])*M-v*(r[1]-d[1]);return E>0&&k<0||E<0&&k>0}function At(c,r,d){for(const V of d)for(let H=0;H<V.length-1;++H)if((k=[(E=V[H+1])[0]-(M=V[H])[0],E[1]-M[1]])[0]*(O=[(v=r)[0]-(g=c)[0],v[1]-g[1]])[1]-k[1]*O[0]!=0&&Ot(g,v,M,E)&&Ot(M,E,g,v))return!0;var g,v,M,E,k,O;return!1}function ui(c,r){for(let d=0;d<c.length;++d)if(!Ae(c[d],r))return!1;for(let d=0;d<c.length-1;++d)if(At(c[d],c[d+1],r))return!1;return!0}function Kn(c,r){for(let d=0;d<r.length;d++)if(ui(c,r[d]))return!0;return!1}function pn(c,r,d){const g=[];for(let v=0;v<c.length;v++){const M=[];for(let E=0;E<c[v].length;E++){const k=ue(c[v][E],d);$n(r,k),M.push(k)}g.push(M)}return g}function mn(c,r,d){const g=[];for(let v=0;v<c.length;v++){const M=pn(c[v],r,d);g.push(M)}return g}function Bi(c,r,d,g){if(c[0]<d[0]||c[0]>d[2]){const v=.5*g;let M=c[0]-d[0]>v?-g:d[0]-c[0]>v?g:0;0===M&&(M=c[0]-d[2]>v?-g:d[2]-c[0]>v?g:0),c[0]+=M}$n(r,c)}function Mr(c,r,d,g){const v=Math.pow(2,g.z)*ri,M=[g.x*ri,g.y*ri],E=[];for(const k of c)for(const O of k){const V=[O.x+M[0],O.y+M[1]];Bi(V,r,d,v),E.push(V)}return E}function Ra(c,r,d,g){const v=Math.pow(2,g.z)*ri,M=[g.x*ri,g.y*ri],E=[];for(const O of c){const V=[];for(const H of O){const $=[H.x+M[0],H.y+M[1]];$n(r,$),V.push($)}E.push(V)}if(r[2]-r[0]<=v/2){(k=r)[0]=k[1]=1/0,k[2]=k[3]=-1/0;for(const O of E)for(const V of O)Bi(V,r,d,v)}var k;return E}class ao{constructor(r,d){this.type=wt,this.geojson=r,this.geometries=d}static parse(r,d){if(2!==r.length)return d.error(`'within' expression requires exactly one argument, but found ${r.length-1} instead.`);if(me(r[1])){const g=r[1];if("FeatureCollection"===g.type)for(let v=0;v<g.features.length;++v){const M=g.features[v].geometry.type;if("Polygon"===M||"MultiPolygon"===M)return new ao(g,g.features[v].geometry)}else if("Feature"===g.type){const v=g.geometry.type;if("Polygon"===v||"MultiPolygon"===v)return new ao(g,g.geometry)}else if("Polygon"===g.type||"MultiPolygon"===g.type)return new ao(g,g)}return d.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(null!=r.geometry()&&null!=r.canonicalID()){if("Point"===r.geometryType())return function(d,g){const v=[1/0,1/0,-1/0,-1/0],M=[1/0,1/0,-1/0,-1/0],E=d.canonicalID();if("Polygon"===g.type){const k=pn(g.coordinates,M,E),O=Mr(d.geometry(),v,M,E);if(!Lr(v,M))return!1;for(const V of O)if(!Ae(V,k))return!1}if("MultiPolygon"===g.type){const k=mn(g.coordinates,M,E),O=Mr(d.geometry(),v,M,E);if(!Lr(v,M))return!1;for(const V of O)if(!Fe(V,k))return!1}return!0}(r,this.geometries);if("LineString"===r.geometryType())return function(d,g){const v=[1/0,1/0,-1/0,-1/0],M=[1/0,1/0,-1/0,-1/0],E=d.canonicalID();if("Polygon"===g.type){const k=pn(g.coordinates,M,E),O=Ra(d.geometry(),v,M,E);if(!Lr(v,M))return!1;for(const V of O)if(!ui(V,k))return!1}if("MultiPolygon"===g.type){const k=mn(g.coordinates,M,E),O=Ra(d.geometry(),v,M,E);if(!Lr(v,M))return!1;for(const V of O)if(!Kn(V,k))return!1}return!0}(r,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}function Dr(c){if(c instanceof bi&&("get"===c.name&&1===c.args.length||"feature-state"===c.name||"has"===c.name&&1===c.args.length||"properties"===c.name||"geometry-type"===c.name||"id"===c.name||/^filter-/.test(c.name))||c instanceof ao)return!1;let r=!0;return c.eachChild(d=>{r&&!Dr(d)&&(r=!1)}),r}function Pa(c){if(c instanceof bi&&"feature-state"===c.name)return!1;let r=!0;return c.eachChild(d=>{r&&!Pa(d)&&(r=!1)}),r}function ac(c,r){if(c instanceof bi&&r.indexOf(c.name)>=0)return!1;let d=!0;return c.eachChild(g=>{d&&!ac(g,r)&&(d=!1)}),d}class lc{constructor(r,d){this.type=d.type,this.name=r,this.boundExpression=d}static parse(r,d){if(2!==r.length||"string"!=typeof r[1])return d.error("'var' expression requires exactly one string literal argument.");const g=r[1];return d.scope.has(g)?new lc(g,d.scope.get(g)):d.error(`Unknown variable "${g}". Make sure "${g}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(r){return this.boundExpression.evaluate(r)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class lo{constructor(r,d=[],g,v=new Vi,M=[]){this.registry=r,this.path=d,this.key=d.map(E=>`[${E}]`).join(""),this.scope=v,this.errors=M,this.expectedType=g}parse(r,d,g,v,M={}){return d?this.concat(d,g,v)._parse(r,M):this._parse(r,M)}_parse(r,d){function g(v,M,E){return"assert"===E?new lt(M,[v]):"coerce"===E?new fi(M,[v]):v}if(null!==r&&"string"!=typeof r&&"boolean"!=typeof r&&"number"!=typeof r||(r=["literal",r]),Array.isArray(r)){if(0===r.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const v=r[0];if("string"!=typeof v)return this.error(`Expression name must be a string, but found ${typeof v} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const M=this.registry[v];if(M){let E=M.parse(r,this);if(!E)return null;if(this.expectedType){const k=this.expectedType,O=E.type;if("string"!==k.kind&&"number"!==k.kind&&"boolean"!==k.kind&&"object"!==k.kind&&"array"!==k.kind||"value"!==O.kind)if("color"!==k.kind&&"formatted"!==k.kind&&"resolvedImage"!==k.kind||"value"!==O.kind&&"string"!==O.kind){if(this.checkSubtype(k,O))return null}else E=g(E,k,d.typeAnnotation||"coerce");else E=g(E,k,d.typeAnnotation||"assert")}if(!(E instanceof at)&&"resolvedImage"!==E.type.kind&&Id(E)){const k=new Xt;try{E=new at(E.type,E.evaluate(k))}catch(O){return this.error(O.message),null}}return E}return this.error(`Unknown expression "${v}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===r?"'undefined' value invalid. Use null instead.":"object"==typeof r?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof r} instead.`)}concat(r,d,g){const v="number"==typeof r?this.path.concat(r):this.path,M=g?this.scope.concat(g):this.scope;return new lo(this.registry,v,d||null,M,this.errors)}error(r,...d){const g=`${this.key}${d.map(v=>`[${v}]`).join("")}`;this.errors.push(new gr(g,r))}checkSubtype(r,d){const g=Rn(r,d);return g&&this.error(g),g}}function Id(c){if(c instanceof lc)return Id(c.boundExpression);if(c instanceof bi&&"error"===c.name||c instanceof on||c instanceof ao)return!1;const r=c instanceof fi||c instanceof lt;let d=!0;return c.eachChild(g=>{d=r?d&&Id(g):d&&g instanceof at}),!!d&&Dr(c)&&ac(c,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function bl(c,r){const d=c.length-1;let g,v,M=0,E=d,k=0;for(;M<=E;)if(k=Math.floor((M+E)/2),g=c[k],v=c[k+1],g<=r){if(k===d||r<v)return k;M=k+1}else{if(!(g>r))throw new je("Input is not a number.");E=k-1}return 0}class cc{constructor(r,d,g){this.type=r,this.input=d,this.labels=[],this.outputs=[];for(const[v,M]of g)this.labels.push(v),this.outputs.push(M)}static parse(r,d){if(r.length-1<4)return d.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return d.error("Expected an even number of arguments.");const g=d.parse(r[1],1,ft);if(!g)return null;const v=[];let M=null;d.expectedType&&"value"!==d.expectedType.kind&&(M=d.expectedType);for(let E=1;E<r.length;E+=2){const k=1===E?-1/0:r[E],O=r[E+1],V=E,H=E+1;if("number"!=typeof k)return d.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',V);if(v.length&&v[v.length-1][0]>=k)return d.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',V);const $=d.parse(O,H,M);if(!$)return null;M=M||$.type,v.push([k,$])}return new cc(M,g,v)}evaluate(r){const d=this.labels,g=this.outputs;if(1===d.length)return g[0].evaluate(r);const v=this.input.evaluate(r);if(v<=d[0])return g[0].evaluate(r);const M=d.length;return v>=d[M-1]?g[M-1].evaluate(r):g[bl(d,v)].evaluate(r)}eachChild(r){r(this.input);for(const d of this.outputs)r(d)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}serialize(){const r=["step",this.input.serialize()];for(let d=0;d<this.labels.length;d++)d>0&&r.push(this.labels[d]),r.push(this.outputs[d].serialize());return r}}function lr(c,r,d){return c*(1-d)+r*d}var uc=Object.freeze({__proto__:null,number:lr,color:function(c,r,d){return new U(lr(c.r,r.r,d),lr(c.g,r.g,d),lr(c.b,r.b,d),lr(c.a,r.a,d))},array:function(c,r,d){return c.map((g,v)=>lr(g,r[v],d))}});const Vh=4/29,Pd=6/29,Od=3*Pd*Pd,zh=Math.PI/180,hf=180/Math.PI;function Fd(c){return c>.008856451679035631?Math.pow(c,1/3):c/Od+Vh}function Ld(c){return c>Pd?c*c*c:Od*(c-Vh)}function dc(c){return 255*(c<=.0031308?12.92*c:1.055*Math.pow(c,1/2.4)-.055)}function xl(c){return(c/=255)<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function jh(c){const r=xl(c.r),d=xl(c.g),g=xl(c.b),v=Fd((.4124564*r+.3575761*d+.1804375*g)/.95047),M=Fd((.2126729*r+.7151522*d+.072175*g)/1);return{l:116*M-16,a:500*(v-M),b:200*(M-Fd((.0193339*r+.119192*d+.9503041*g)/1.08883)),alpha:c.a}}function Bd(c){let r=(c.l+16)/116,d=isNaN(c.a)?r:r+c.a/500,g=isNaN(c.b)?r:r-c.b/200;return r=1*Ld(r),d=.95047*Ld(d),g=1.08883*Ld(g),new U(dc(3.2404542*d-1.5371385*r-.4985314*g),dc(-.969266*d+1.8760108*r+.041556*g),dc(.0556434*d-.2040259*r+1.0572252*g),c.alpha)}function sn(c,r,d){const g=r-c;return c+d*(g>180||g<-180?g-360*Math.round(g/360):g)}const qo={forward:jh,reverse:Bd,interpolate:function(c,r,d){return{l:lr(c.l,r.l,d),a:lr(c.a,r.a,d),b:lr(c.b,r.b,d),alpha:lr(c.alpha,r.alpha,d)}}},wl={forward:function(c){const{l:r,a:d,b:g}=jh(c),v=Math.atan2(g,d)*hf;return{h:v<0?v+360:v,c:Math.sqrt(d*d+g*g),l:r,alpha:c.a}},reverse:function(c){const r=c.h*zh,d=c.c;return Bd({l:c.l,a:Math.cos(r)*d,b:Math.sin(r)*d,alpha:c.alpha})},interpolate:function(c,r,d){return{h:sn(c.h,r.h,d),c:lr(c.c,r.c,d),l:lr(c.l,r.l,d),alpha:lr(c.alpha,r.alpha,d)}}};var Oa=Object.freeze({__proto__:null,lab:qo,hcl:wl});class Br{constructor(r,d,g,v,M){this.type=r,this.operator=d,this.interpolation=g,this.input=v,this.labels=[],this.outputs=[];for(const[E,k]of M)this.labels.push(E),this.outputs.push(k)}static interpolationFactor(r,d,g,v){let M=0;if("exponential"===r.name)M=au(d,r.base,g,v);else if("linear"===r.name)M=au(d,1,g,v);else if("cubic-bezier"===r.name){const E=r.controlPoints;M=new Me(E[0],E[1],E[2],E[3]).solve(au(d,1,g,v))}return M}static parse(r,d){let[g,v,M,...E]=r;if(!Array.isArray(v)||0===v.length)return d.error("Expected an interpolation type expression.",1);if("linear"===v[0])v={name:"linear"};else if("exponential"===v[0]){const V=v[1];if("number"!=typeof V)return d.error("Exponential interpolation requires a numeric base.",1,1);v={name:"exponential",base:V}}else{if("cubic-bezier"!==v[0])return d.error(`Unknown interpolation type ${String(v[0])}`,1,0);{const V=v.slice(1);if(4!==V.length||V.some(H=>"number"!=typeof H||H<0||H>1))return d.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);v={name:"cubic-bezier",controlPoints:V}}}if(r.length-1<4)return d.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return d.error("Expected an even number of arguments.");if(M=d.parse(M,2,ft),!M)return null;const k=[];let O=null;"interpolate-hcl"===g||"interpolate-lab"===g?O=sr:d.expectedType&&"value"!==d.expectedType.kind&&(O=d.expectedType);for(let V=0;V<E.length;V+=2){const H=E[V],$=E[V+1],K=V+3,Q=V+4;if("number"!=typeof H)return d.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',K);if(k.length&&k[k.length-1][0]>=H)return d.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',K);const ee=d.parse($,Q,O);if(!ee)return null;O=O||ee.type,k.push([H,ee])}return"number"===O.kind||"color"===O.kind||"array"===O.kind&&"number"===O.itemType.kind&&"number"==typeof O.N?new Br(O,g,v,M,k):d.error(`Type ${Wi(O)} is not interpolatable.`)}evaluate(r){const d=this.labels,g=this.outputs;if(1===d.length)return g[0].evaluate(r);const v=this.input.evaluate(r);if(v<=d[0])return g[0].evaluate(r);const M=d.length;if(v>=d[M-1])return g[M-1].evaluate(r);const E=bl(d,v),k=Br.interpolationFactor(this.interpolation,v,d[E],d[E+1]),O=g[E].evaluate(r),V=g[E+1].evaluate(r);return"interpolate"===this.operator?uc[this.type.kind.toLowerCase()](O,V,k):"interpolate-hcl"===this.operator?wl.reverse(wl.interpolate(wl.forward(O),wl.forward(V),k)):qo.reverse(qo.interpolate(qo.forward(O),qo.forward(V),k))}eachChild(r){r(this.input);for(const d of this.outputs)r(d)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}serialize(){let r;r="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const d=[this.operator,r,this.input.serialize()];for(let g=0;g<this.labels.length;g++)d.push(this.labels[g],this.outputs[g].serialize());return d}}function au(c,r,d,g){const v=g-d,M=c-d;return 0===v?0:1===r?M/v:(Math.pow(r,M)-1)/(Math.pow(r,v)-1)}class lu{constructor(r,d){this.type=r,this.args=d}static parse(r,d){if(r.length<2)return d.error("Expectected at least one argument.");let g=null;const v=d.expectedType;v&&"value"!==v.kind&&(g=v);const M=[];for(const k of r.slice(1)){const O=d.parse(k,1+M.length,g,void 0,{typeAnnotation:"omit"});if(!O)return null;g=g||O.type,M.push(O)}const E=v&&M.some(k=>Rn(v,k.type));return new lu(E?Mi:g,M)}evaluate(r){let d,g=null,v=0;for(const M of this.args)if(v++,g=M.evaluate(r),g&&g instanceof we&&!g.available&&(d||(d=g.name),g=null,v===this.args.length&&(g=d)),null!==g)break;return g}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){const r=["coalesce"];return this.eachChild(d=>{r.push(d.serialize())}),r}}class Pn{constructor(r,d){this.type=d.type,this.bindings=[].concat(r),this.result=d}evaluate(r){return this.result.evaluate(r)}eachChild(r){for(const d of this.bindings)r(d[1]);r(this.result)}static parse(r,d){if(r.length<4)return d.error(`Expected at least 3 arguments, but found ${r.length-1} instead.`);const g=[];for(let M=1;M<r.length-1;M+=2){const E=r[M];if("string"!=typeof E)return d.error(`Expected string, but found ${typeof E} instead.`,M);if(/[^a-zA-Z0-9_]/.test(E))return d.error("Variable names must contain only alphanumeric characters or '_'.",M);const k=d.parse(r[M+1],M+1);if(!k)return null;g.push([E,k])}const v=d.parse(r[r.length-1],r.length-1,d.expectedType,g);return v?new Pn(g,v):null}outputDefined(){return this.result.outputDefined()}serialize(){const r=["let"];for(const[d,g]of this.bindings)r.push(d,g.serialize());return r.push(this.result.serialize()),r}}class Cl{constructor(r,d,g){this.type=r,this.index=d,this.input=g}static parse(r,d){if(3!==r.length)return d.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const g=d.parse(r[1],1,ft),v=d.parse(r[2],2,Cr(d.expectedType||Mi));return g&&v?new Cl(v.type.itemType,g,v):null}evaluate(r){const d=this.index.evaluate(r),g=this.input.evaluate(r);if(d<0)throw new je(`Array index out of bounds: ${d} < 0.`);if(d>=g.length)throw new je(`Array index out of bounds: ${d} > ${g.length-1}.`);if(d!==Math.floor(d))throw new je(`Array index must be an integer, but found ${d} instead.`);return g[d]}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class cu{constructor(r,d){this.type=wt,this.needle=r,this.haystack=d}static parse(r,d){if(3!==r.length)return d.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const g=d.parse(r[1],1,Mi),v=d.parse(r[2],2,Mi);return g&&v?Fo(g.type,[wt,vi,ft,Zn,Mi])?new cu(g,v):d.error(`Expected first argument to be of type boolean, string, number or null, but found ${Wi(g.type)} instead`):null}evaluate(r){const d=this.needle.evaluate(r),g=this.haystack.evaluate(r);if(!g)return!1;if(!Dn(d,["boolean","string","number","null"]))throw new je(`Expected first argument to be of type boolean, string, number or null, but found ${Wi(be(d))} instead.`);if(!Dn(g,["string","array"]))throw new je(`Expected second argument to be of type array or string, but found ${Wi(be(g))} instead.`);return g.indexOf(d)>=0}eachChild(r){r(this.needle),r(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Fa{constructor(r,d,g){this.type=ft,this.needle=r,this.haystack=d,this.fromIndex=g}static parse(r,d){if(r.length<=2||r.length>=5)return d.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const g=d.parse(r[1],1,Mi),v=d.parse(r[2],2,Mi);if(!g||!v)return null;if(!Fo(g.type,[wt,vi,ft,Zn,Mi]))return d.error(`Expected first argument to be of type boolean, string, number or null, but found ${Wi(g.type)} instead`);if(4===r.length){const M=d.parse(r[3],3,ft);return M?new Fa(g,v,M):null}return new Fa(g,v)}evaluate(r){const d=this.needle.evaluate(r),g=this.haystack.evaluate(r);if(!Dn(d,["boolean","string","number","null"]))throw new je(`Expected first argument to be of type boolean, string, number or null, but found ${Wi(be(d))} instead.`);if(!Dn(g,["string","array"]))throw new je(`Expected second argument to be of type array or string, but found ${Wi(be(g))} instead.`);if(this.fromIndex){const v=this.fromIndex.evaluate(r);return g.indexOf(d,v)}return g.indexOf(d)}eachChild(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const r=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),r]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class uu{constructor(r,d,g,v,M,E){this.inputType=r,this.type=d,this.input=g,this.cases=v,this.outputs=M,this.otherwise=E}static parse(r,d){if(r.length<5)return d.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length%2!=1)return d.error("Expected an even number of arguments.");let g,v;d.expectedType&&"value"!==d.expectedType.kind&&(v=d.expectedType);const M={},E=[];for(let V=2;V<r.length-1;V+=2){let H=r[V];const $=r[V+1];Array.isArray(H)||(H=[H]);const K=d.concat(V);if(0===H.length)return K.error("Expected at least one branch label.");for(const ee of H){if("number"!=typeof ee&&"string"!=typeof ee)return K.error("Branch labels must be numbers or strings.");if("number"==typeof ee&&Math.abs(ee)>Number.MAX_SAFE_INTEGER)return K.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof ee&&Math.floor(ee)!==ee)return K.error("Numeric branch labels must be integer values.");if(g){if(K.checkSubtype(g,be(ee)))return null}else g=be(ee);if(void 0!==M[String(ee)])return K.error("Branch labels must be unique.");M[String(ee)]=E.length}const Q=d.parse($,V,v);if(!Q)return null;v=v||Q.type,E.push(Q)}const k=d.parse(r[1],1,Mi);if(!k)return null;const O=d.parse(r[r.length-1],r.length-1,v);return O?"value"!==k.type.kind&&d.concat(1).checkSubtype(g,k.type)?null:new uu(g,v,k,M,E,O):null}evaluate(r){const d=this.input.evaluate(r);return(be(d)===this.inputType&&this.outputs[this.cases[d]]||this.otherwise).evaluate(r)}eachChild(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)}outputDefined(){return this.outputs.every(r=>r.outputDefined())&&this.otherwise.outputDefined()}serialize(){const r=["match",this.input.serialize()],d=Object.keys(this.cases).sort(),g=[],v={};for(const E of d){const k=v[this.cases[E]];void 0===k?(v[this.cases[E]]=g.length,g.push([this.cases[E],[E]])):g[k][1].push(E)}const M=E=>"number"===this.inputType.kind?Number(E):E;for(const[E,k]of g)r.push(1===k.length?M(k[0]):k.map(M)),r.push(this.outputs[E].serialize());return r.push(this.otherwise.serialize()),r}}class co{constructor(r,d,g){this.type=r,this.branches=d,this.otherwise=g}static parse(r,d){if(r.length<4)return d.error(`Expected at least 3 arguments, but found only ${r.length-1}.`);if(r.length%2!=0)return d.error("Expected an odd number of arguments.");let g;d.expectedType&&"value"!==d.expectedType.kind&&(g=d.expectedType);const v=[];for(let E=1;E<r.length-1;E+=2){const k=d.parse(r[E],E,wt);if(!k)return null;const O=d.parse(r[E+1],E+1,g);if(!O)return null;v.push([k,O]),g=g||O.type}const M=d.parse(r[r.length-1],r.length-1,g);return M?new co(g,v,M):null}evaluate(r){for(const[d,g]of this.branches)if(d.evaluate(r))return g.evaluate(r);return this.otherwise.evaluate(r)}eachChild(r){for(const[d,g]of this.branches)r(d),r(g);r(this.otherwise)}outputDefined(){return this.branches.every(([r,d])=>d.outputDefined())&&this.otherwise.outputDefined()}serialize(){const r=["case"];return this.eachChild(d=>{r.push(d.serialize())}),r}}class Ml{constructor(r,d,g,v){this.type=r,this.input=d,this.beginIndex=g,this.endIndex=v}static parse(r,d){if(r.length<=2||r.length>=5)return d.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const g=d.parse(r[1],1,Mi),v=d.parse(r[2],2,ft);if(!g||!v)return null;if(!Fo(g.type,[Cr(Mi),vi,Mi]))return d.error(`Expected first argument to be of type array or string, but found ${Wi(g.type)} instead`);if(4===r.length){const M=d.parse(r[3],3,ft);return M?new Ml(g.type,g,v,M):null}return new Ml(g.type,g,v)}evaluate(r){const d=this.input.evaluate(r),g=this.beginIndex.evaluate(r);if(!Dn(d,["string","array"]))throw new je(`Expected first argument to be of type array or string, but found ${Wi(be(d))} instead.`);if(this.endIndex){const v=this.endIndex.evaluate(r);return d.slice(g,v)}return d.slice(g)}eachChild(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const r=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),r]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Uh(c,r){return"=="===c||"!="===c?"boolean"===r.kind||"string"===r.kind||"number"===r.kind||"null"===r.kind||"value"===r.kind:"string"===r.kind||"number"===r.kind||"value"===r.kind}function du(c,r,d,g){return 0===g.compare(r,d)}function Dl(c,r,d){const g="=="!==c&&"!="!==c;return class HS{constructor(M,E,k){this.type=wt,this.lhs=M,this.rhs=E,this.collator=k,this.hasUntypedArgument="value"===M.type.kind||"value"===E.type.kind}static parse(M,E){if(3!==M.length&&4!==M.length)return E.error("Expected two or three arguments.");const k=M[0];let O=E.parse(M[1],1,Mi);if(!O)return null;if(!Uh(k,O.type))return E.concat(1).error(`"${k}" comparisons are not supported for type '${Wi(O.type)}'.`);let V=E.parse(M[2],2,Mi);if(!V)return null;if(!Uh(k,V.type))return E.concat(2).error(`"${k}" comparisons are not supported for type '${Wi(V.type)}'.`);if(O.type.kind!==V.type.kind&&"value"!==O.type.kind&&"value"!==V.type.kind)return E.error(`Cannot compare types '${Wi(O.type)}' and '${Wi(V.type)}'.`);g&&("value"===O.type.kind&&"value"!==V.type.kind?O=new lt(V.type,[O]):"value"!==O.type.kind&&"value"===V.type.kind&&(V=new lt(O.type,[V])));let H=null;if(4===M.length){if("string"!==O.type.kind&&"string"!==V.type.kind&&"value"!==O.type.kind&&"value"!==V.type.kind)return E.error("Cannot use collator to compare non-string types.");if(H=E.parse(M[3],3,Oo),!H)return null}return new HS(O,V,H)}evaluate(M){const E=this.lhs.evaluate(M),k=this.rhs.evaluate(M);if(g&&this.hasUntypedArgument){const O=be(E),V=be(k);if(O.kind!==V.kind||"string"!==O.kind&&"number"!==O.kind)throw new je(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${O.kind}, ${V.kind}) instead.`)}if(this.collator&&!g&&this.hasUntypedArgument){const O=be(E),V=be(k);if("string"!==O.kind||"string"!==V.kind)return r(M,E,k)}return this.collator?d(M,E,k,this.collator.evaluate(M)):r(M,E,k)}eachChild(M){M(this.lhs),M(this.rhs),this.collator&&M(this.collator)}outputDefined(){return!0}serialize(){const M=[c];return this.eachChild(E=>{M.push(E.serialize())}),M}}}const Hh=Dl("==",function(c,r,d){return r===d},du),hu=Dl("!=",function(c,r,d){return r!==d},function(c,r,d,g){return!du(0,r,d,g)}),Nd=Dl("<",function(c,r,d){return r<d},function(c,r,d,g){return g.compare(r,d)<0}),pu=Dl(">",function(c,r,d){return r>d},function(c,r,d,g){return g.compare(r,d)>0}),Km=Dl("<=",function(c,r,d){return r<=d},function(c,r,d,g){return g.compare(r,d)<=0}),qn=Dl(">=",function(c,r,d){return r>=d},function(c,r,d,g){return g.compare(r,d)>=0});class hc{constructor(r,d,g,v,M){this.type=vi,this.number=r,this.locale=d,this.currency=g,this.minFractionDigits=v,this.maxFractionDigits=M}static parse(r,d){if(3!==r.length)return d.error("Expected two arguments.");const g=d.parse(r[1],1,ft);if(!g)return null;const v=r[2];if("object"!=typeof v||Array.isArray(v))return d.error("NumberFormat options argument must be an object.");let M=null;if(v.locale&&(M=d.parse(v.locale,1,vi),!M))return null;let E=null;if(v.currency&&(E=d.parse(v.currency,1,vi),!E))return null;let k=null;if(v["min-fraction-digits"]&&(k=d.parse(v["min-fraction-digits"],1,ft),!k))return null;let O=null;return v["max-fraction-digits"]&&(O=d.parse(v["max-fraction-digits"],1,ft),!O)?null:new hc(g,M,E,k,O)}evaluate(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))}eachChild(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const r={};return this.locale&&(r.locale=this.locale.serialize()),this.currency&&(r.currency=this.currency.serialize()),this.minFractionDigits&&(r["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(r["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),r]}}class El{constructor(r){this.type=ft,this.input=r}static parse(r,d){if(2!==r.length)return d.error(`Expected 1 argument, but found ${r.length-1} instead.`);const g=d.parse(r[1],1);return g?"array"!==g.type.kind&&"string"!==g.type.kind&&"value"!==g.type.kind?d.error(`Expected argument of type string or array, but found ${Wi(g.type)} instead.`):new El(g):null}evaluate(r){const d=this.input.evaluate(r);if("string"==typeof d||Array.isArray(d))return d.length;throw new je(`Expected value to be of type string or array, but found ${Wi(be(d))} instead.`)}eachChild(r){r(this.input)}outputDefined(){return!1}serialize(){const r=["length"];return this.eachChild(d=>{r.push(d.serialize())}),r}}const dn={"==":Hh,"!=":hu,">":pu,"<":Nd,">=":qn,"<=":Km,array:lt,at:Cl,boolean:lt,case:co,coalesce:lu,collator:on,format:Ct,image:Yt,in:cu,"index-of":Fa,interpolate:Br,"interpolate-hcl":Br,"interpolate-lab":Br,length:El,let:Pn,literal:at,match:uu,number:lt,"number-format":hc,object:lt,slice:Ml,step:cc,string:lt,"to-boolean":fi,"to-color":fi,"to-number":fi,"to-string":fi,var:lc,within:ao};function Vd(c,[r,d,g,v]){r=r.evaluate(c),d=d.evaluate(c),g=g.evaluate(c);const M=v?v.evaluate(c):1,E=fe(r,d,g,M);if(E)throw new je(E);return new U(r/255*M,d/255*M,g/255*M,M)}function pc(c,r){return c in r}function La(c,r){const d=r[c];return void 0===d?null:d}function cr(c){return{type:c}}function zd(c){return{result:"success",value:c}}function zs(c){return{result:"error",value:c}}function uo(c){return"data-driven"===c["property-type"]||"cross-faded-data-driven"===c["property-type"]}function ho(c){return!!c.expression&&c.expression.parameters.indexOf("zoom")>-1}function aa(c){return!!c.expression&&c.expression.interpolated}function Ji(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":null===c?"null":typeof c}function Ln(c){return"object"==typeof c&&null!==c&&!Array.isArray(c)}function Es(c){return c}function $i(c,r){const d="color"===r.type,g=c.stops&&"object"==typeof c.stops[0][0],v=g||!(g||void 0!==c.property),M=c.type||(aa(r)?"exponential":"interval");if(d&&((c=ai({},c)).stops&&(c.stops=c.stops.map(V=>[V[0],U.parse(V[1])])),c.default=U.parse(c.default?c.default:r.default)),c.colorSpace&&"rgb"!==c.colorSpace&&!Oa[c.colorSpace])throw new Error(`Unknown color space: ${c.colorSpace}`);let E,k,O;if("exponential"===M)E=Ba;else if("interval"===M)E=Bn;else if("categorical"===M){E=Qt,k=Object.create(null);for(const V of c.stops)k[V[0]]=V[1];O=typeof c.stops[0][0]}else{if("identity"!==M)throw new Error(`Unknown function type "${M}"`);E=fu}if(g){const V={},H=[];for(let Q=0;Q<c.stops.length;Q++){const ee=c.stops[Q],de=ee[0].zoom;void 0===V[de]&&(V[de]={zoom:de,type:c.type,property:c.property,default:c.default,stops:[]},H.push(de)),V[de].stops.push([ee[0].value,ee[1]])}const $=[];for(const Q of H)$.push([V[Q].zoom,$i(V[Q],r)]);const K={name:"linear"};return{kind:"composite",interpolationType:K,interpolationFactor:Br.interpolationFactor.bind(void 0,K),zoomStops:$.map(Q=>Q[0]),evaluate:({zoom:Q},ee)=>Ba({stops:$,base:c.base},r,Q).evaluate(Q,ee)}}if(v){const V="exponential"===M?{name:"exponential",base:void 0!==c.base?c.base:1}:null;return{kind:"camera",interpolationType:V,interpolationFactor:Br.interpolationFactor.bind(void 0,V),zoomStops:c.stops.map(H=>H[0]),evaluate:({zoom:H})=>E(c,r,H,k,O)}}return{kind:"source",evaluate(V,H){const $=H&&H.properties?H.properties[c.property]:void 0;return void 0===$?as(c.default,r.default):E(c,r,$,k,O)}}}function as(c,r,d){return void 0!==c?c:void 0!==r?r:void 0!==d?d:void 0}function Qt(c,r,d,g,v){return as(typeof d===v?g[d]:void 0,c.default,r.default)}function Bn(c,r,d){if("number"!==Ji(d))return as(c.default,r.default);const g=c.stops.length;if(1===g||d<=c.stops[0][0])return c.stops[0][1];if(d>=c.stops[g-1][0])return c.stops[g-1][1];const v=bl(c.stops.map(M=>M[0]),d);return c.stops[v][1]}function Ba(c,r,d){const g=void 0!==c.base?c.base:1;if("number"!==Ji(d))return as(c.default,r.default);const v=c.stops.length;if(1===v||d<=c.stops[0][0])return c.stops[0][1];if(d>=c.stops[v-1][0])return c.stops[v-1][1];const M=bl(c.stops.map(H=>H[0]),d),E=function(H,$,K,Q){const ee=Q-K,de=H-K;return 0===ee?0:1===$?de/ee:(Math.pow($,de)-1)/(Math.pow($,ee)-1)}(d,g,c.stops[M][0],c.stops[M+1][0]),k=c.stops[M][1],O=c.stops[M+1][1];let V=uc[r.type]||Es;if(c.colorSpace&&"rgb"!==c.colorSpace){const H=Oa[c.colorSpace];V=($,K)=>H.reverse(H.interpolate(H.forward($),H.forward(K),E))}return"function"==typeof k.evaluate?{evaluate(...H){const $=k.evaluate.apply(void 0,H),K=O.evaluate.apply(void 0,H);if(void 0!==$&&void 0!==K)return V($,K,E)}}:V(k,O,E)}function fu(c,r,d){return"color"===r.type?d=U.parse(d):"formatted"===r.type?d=le.fromString(d.toString()):"resolvedImage"===r.type?d=we.fromString(d.toString()):Ji(d)===r.type||"enum"===r.type&&r.values[d]||(d=void 0),as(d,c.default,r.default)}bi.register(dn,{error:[{kind:"error"},[vi],(c,[r])=>{throw new je(r.evaluate(c))}],typeof:[vi,[Mi],(c,[r])=>Wi(be(r.evaluate(c)))],"to-rgba":[Cr(ft,4),[sr],(c,[r])=>r.evaluate(c).toArray()],rgb:[sr,[ft,ft,ft],Vd],rgba:[sr,[ft,ft,ft,ft],Vd],has:{type:wt,overloads:[[[vi],(c,[r])=>pc(r.evaluate(c),c.properties())],[[vi,Li],(c,[r,d])=>pc(r.evaluate(c),d.evaluate(c))]]},get:{type:Mi,overloads:[[[vi],(c,[r])=>La(r.evaluate(c),c.properties())],[[vi,Li],(c,[r,d])=>La(r.evaluate(c),d.evaluate(c))]]},"feature-state":[Mi,[vi],(c,[r])=>La(r.evaluate(c),c.featureState||{})],properties:[Li,[],c=>c.properties()],"geometry-type":[vi,[],c=>c.geometryType()],id:[Mi,[],c=>c.id()],zoom:[ft,[],c=>c.globals.zoom],"heatmap-density":[ft,[],c=>c.globals.heatmapDensity||0],"line-progress":[ft,[],c=>c.globals.lineProgress||0],accumulated:[Mi,[],c=>void 0===c.globals.accumulated?null:c.globals.accumulated],"+":[ft,cr(ft),(c,r)=>{let d=0;for(const g of r)d+=g.evaluate(c);return d}],"*":[ft,cr(ft),(c,r)=>{let d=1;for(const g of r)d*=g.evaluate(c);return d}],"-":{type:ft,overloads:[[[ft,ft],(c,[r,d])=>r.evaluate(c)-d.evaluate(c)],[[ft],(c,[r])=>-r.evaluate(c)]]},"/":[ft,[ft,ft],(c,[r,d])=>r.evaluate(c)/d.evaluate(c)],"%":[ft,[ft,ft],(c,[r,d])=>r.evaluate(c)%d.evaluate(c)],ln2:[ft,[],()=>Math.LN2],pi:[ft,[],()=>Math.PI],e:[ft,[],()=>Math.E],"^":[ft,[ft,ft],(c,[r,d])=>Math.pow(r.evaluate(c),d.evaluate(c))],sqrt:[ft,[ft],(c,[r])=>Math.sqrt(r.evaluate(c))],log10:[ft,[ft],(c,[r])=>Math.log(r.evaluate(c))/Math.LN10],ln:[ft,[ft],(c,[r])=>Math.log(r.evaluate(c))],log2:[ft,[ft],(c,[r])=>Math.log(r.evaluate(c))/Math.LN2],sin:[ft,[ft],(c,[r])=>Math.sin(r.evaluate(c))],cos:[ft,[ft],(c,[r])=>Math.cos(r.evaluate(c))],tan:[ft,[ft],(c,[r])=>Math.tan(r.evaluate(c))],asin:[ft,[ft],(c,[r])=>Math.asin(r.evaluate(c))],acos:[ft,[ft],(c,[r])=>Math.acos(r.evaluate(c))],atan:[ft,[ft],(c,[r])=>Math.atan(r.evaluate(c))],min:[ft,cr(ft),(c,r)=>Math.min(...r.map(d=>d.evaluate(c)))],max:[ft,cr(ft),(c,r)=>Math.max(...r.map(d=>d.evaluate(c)))],abs:[ft,[ft],(c,[r])=>Math.abs(r.evaluate(c))],round:[ft,[ft],(c,[r])=>{const d=r.evaluate(c);return d<0?-Math.round(-d):Math.round(d)}],floor:[ft,[ft],(c,[r])=>Math.floor(r.evaluate(c))],ceil:[ft,[ft],(c,[r])=>Math.ceil(r.evaluate(c))],"filter-==":[wt,[vi,Mi],(c,[r,d])=>c.properties()[r.value]===d.value],"filter-id-==":[wt,[Mi],(c,[r])=>c.id()===r.value],"filter-type-==":[wt,[vi],(c,[r])=>c.geometryType()===r.value],"filter-<":[wt,[vi,Mi],(c,[r,d])=>{const g=c.properties()[r.value],v=d.value;return typeof g==typeof v&&g<v}],"filter-id-<":[wt,[Mi],(c,[r])=>{const d=c.id(),g=r.value;return typeof d==typeof g&&d<g}],"filter->":[wt,[vi,Mi],(c,[r,d])=>{const g=c.properties()[r.value],v=d.value;return typeof g==typeof v&&g>v}],"filter-id->":[wt,[Mi],(c,[r])=>{const d=c.id(),g=r.value;return typeof d==typeof g&&d>g}],"filter-<=":[wt,[vi,Mi],(c,[r,d])=>{const g=c.properties()[r.value],v=d.value;return typeof g==typeof v&&g<=v}],"filter-id-<=":[wt,[Mi],(c,[r])=>{const d=c.id(),g=r.value;return typeof d==typeof g&&d<=g}],"filter->=":[wt,[vi,Mi],(c,[r,d])=>{const g=c.properties()[r.value],v=d.value;return typeof g==typeof v&&g>=v}],"filter-id->=":[wt,[Mi],(c,[r])=>{const d=c.id(),g=r.value;return typeof d==typeof g&&d>=g}],"filter-has":[wt,[Mi],(c,[r])=>r.value in c.properties()],"filter-has-id":[wt,[],c=>null!==c.id()&&void 0!==c.id()],"filter-type-in":[wt,[Cr(vi)],(c,[r])=>r.value.indexOf(c.geometryType())>=0],"filter-id-in":[wt,[Cr(Mi)],(c,[r])=>r.value.indexOf(c.id())>=0],"filter-in-small":[wt,[vi,Cr(Mi)],(c,[r,d])=>d.value.indexOf(c.properties()[r.value])>=0],"filter-in-large":[wt,[vi,Cr(Mi)],(c,[r,d])=>function(g,v,M,E){for(;M<=E;){const k=M+E>>1;if(v[k]===g)return!0;v[k]>g?E=k-1:M=k+1}return!1}(c.properties()[r.value],d.value,0,d.value.length-1)],all:{type:wt,overloads:[[[wt,wt],(c,[r,d])=>r.evaluate(c)&&d.evaluate(c)],[cr(wt),(c,r)=>{for(const d of r)if(!d.evaluate(c))return!1;return!0}]]},any:{type:wt,overloads:[[[wt,wt],(c,[r,d])=>r.evaluate(c)||d.evaluate(c)],[cr(wt),(c,r)=>{for(const d of r)if(d.evaluate(c))return!0;return!1}]]},"!":[wt,[wt],(c,[r])=>!r.evaluate(c)],"is-supported-script":[wt,[vi],(c,[r])=>{const d=c.globals&&c.globals.isSupportedScript;return!d||d(r.evaluate(c))}],upcase:[vi,[vi],(c,[r])=>r.evaluate(c).toUpperCase()],downcase:[vi,[vi],(c,[r])=>r.evaluate(c).toLowerCase()],concat:[vi,cr(Mi),(c,r)=>r.map(d=>He(d.evaluate(c))).join("")],"resolved-locale":[vi,[Oo],(c,[r])=>r.evaluate(c).resolvedLocale()]});class mu{constructor(r,d){var g;this.expression=r,this._warningHistory={},this._evaluator=new Xt,this._defaultValue=d?"color"===(g=d).type&&Ln(g.default)?new U(0,0,0,0):"color"===g.type?U.parse(g.default)||null:void 0===g.default?null:g.default:null,this._enumValues=d&&"enum"===d.type?d.values:null}evaluateWithoutErrorHandling(r,d,g,v,M,E){return this._evaluator.globals=r,this._evaluator.feature=d,this._evaluator.featureState=g,this._evaluator.canonical=v,this._evaluator.availableImages=M||null,this._evaluator.formattedSection=E,this.expression.evaluate(this._evaluator)}evaluate(r,d,g,v,M,E){this._evaluator.globals=r,this._evaluator.feature=d||null,this._evaluator.featureState=g||null,this._evaluator.canonical=v,this._evaluator.availableImages=M||null,this._evaluator.formattedSection=E||null;try{const k=this.expression.evaluate(this._evaluator);if(null==k||"number"==typeof k&&k!=k)return this._defaultValue;if(this._enumValues&&!(k in this._enumValues))throw new je(`Expected value to be one of ${Object.keys(this._enumValues).map(O=>JSON.stringify(O)).join(", ")}, but found ${JSON.stringify(k)} instead.`);return k}catch(k){return this._warningHistory[k.message]||(this._warningHistory[k.message]=!0,"undefined"!=typeof console&&console.warn(k.message)),this._defaultValue}}}function Sl(c){return Array.isArray(c)&&c.length>0&&"string"==typeof c[0]&&c[0]in dn}function fc(c,r){const d=new lo(dn,[],r?function(v){const M={color:sr,string:vi,number:ft,enum:vi,boolean:wt,formatted:ar,resolvedImage:Fn};return"array"===v.type?Cr(M[v.value]||Mi,v.length):M[v.type]}(r):void 0),g=d.parse(c,void 0,void 0,void 0,r&&"string"===r.type?{typeAnnotation:"coerce"}:void 0);return g?zd(new mu(g,r)):zs(d.errors)}class gu{constructor(r,d){this.kind=r,this._styleExpression=d,this.isStateDependent="constant"!==r&&!Pa(d.expression)}evaluateWithoutErrorHandling(r,d,g,v,M,E){return this._styleExpression.evaluateWithoutErrorHandling(r,d,g,v,M,E)}evaluate(r,d,g,v,M,E){return this._styleExpression.evaluate(r,d,g,v,M,E)}}class dt{constructor(r,d,g,v){this.kind=r,this.zoomStops=g,this._styleExpression=d,this.isStateDependent="camera"!==r&&!Pa(d.expression),this.interpolationType=v}evaluateWithoutErrorHandling(r,d,g,v,M,E){return this._styleExpression.evaluateWithoutErrorHandling(r,d,g,v,M,E)}evaluate(r,d,g,v,M,E){return this._styleExpression.evaluate(r,d,g,v,M,E)}interpolationFactor(r,d,g){return this.interpolationType?Br.interpolationFactor(this.interpolationType,r,d,g):0}}function qi(c,r){const d=fc(c,r);if("error"===d.result)return d;const g=d.value.expression,v=Dr(g);if(!v&&!uo(r))return zs([new gr("","data expressions not supported")]);const M=ac(g,["zoom"]);if(!M&&!ho(r))return zs([new gr("","zoom expressions not supported")]);const E=gn(g);return E||M?E instanceof gr?zs([E]):E instanceof Br&&!aa(r)?zs([new gr("",'"interpolate" expressions cannot be used with this property')]):zd(E?new dt(v?"camera":"composite",d.value,E.labels,E instanceof Br?E.interpolation:void 0):new gu(v?"constant":"source",d.value)):zs([new gr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Tl{constructor(r,d){this._parameters=r,this._specification=d,ai(this,$i(this._parameters,this._specification))}static deserialize(r){return new Tl(r._parameters,r._specification)}static serialize(r){return{_parameters:r._parameters,_specification:r._specification}}}function gn(c){let r=null;if(c instanceof Pn)r=gn(c.result);else if(c instanceof lu){for(const d of c.args)if(r=gn(d),r)break}else(c instanceof cc||c instanceof Br)&&c.input instanceof bi&&"zoom"===c.input.name&&(r=c);return r instanceof gr||c.eachChild(d=>{const g=gn(d);g instanceof gr?r=g:!r&&g?r=new gr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&g&&r!==g&&(r=new gr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r}function po(c){const r=c.key,d=c.value,g=c.valueSpec||{},v=c.objectElementValidators||{},M=c.style,E=c.styleSpec;let k=[];const O=Ji(d);if("object"!==O)return[new Pt(r,d,`object expected, ${O} found`)];for(const V in d){const H=V.split(".")[0],$=g[H]||g["*"];let K;if(v[H])K=v[H];else if(g[H])K=Yn;else if(v["*"])K=v["*"];else{if(!g["*"]){k.push(new Pt(r,d[V],`unknown property "${V}"`));continue}K=Yn}k=k.concat(K({key:(r&&`${r}.`)+V,value:d[V],valueSpec:$,style:M,styleSpec:E,object:d,objectKey:V},d))}for(const V in g)v[V]||g[V].required&&void 0===g[V].default&&void 0===d[V]&&k.push(new Pt(r,d,`missing required property "${V}"`));return k}function Na(c){const r=c.value,d=c.valueSpec,g=c.style,v=c.styleSpec,M=c.key,E=c.arrayElementValidator||Yn;if("array"!==Ji(r))return[new Pt(M,r,`array expected, ${Ji(r)} found`)];if(d.length&&r.length!==d.length)return[new Pt(M,r,`array length ${d.length} expected, length ${r.length} found`)];if(d["min-length"]&&r.length<d["min-length"])return[new Pt(M,r,`array length at least ${d["min-length"]} expected, length ${r.length} found`)];let k={type:d.value,values:d.values};v.$version<7&&(k.function=d.function),"object"===Ji(d.value)&&(k=d.value);let O=[];for(let V=0;V<r.length;V++)O=O.concat(E({array:r,arrayIndex:V,value:r[V],valueSpec:k,style:g,styleSpec:v,key:`${M}[${V}]`}));return O}function Lo(c){const r=c.key,d=c.value,g=c.valueSpec;let v=Ji(d);return"number"===v&&d!=d&&(v="NaN"),"number"!==v?[new Pt(r,d,`number expected, ${v} found`)]:"minimum"in g&&d<g.minimum?[new Pt(r,d,`${d} is less than the minimum value ${g.minimum}`)]:"maximum"in g&&d>g.maximum?[new Pt(r,d,`${d} is greater than the maximum value ${g.maximum}`)]:[]}function mc(c){const r=c.valueSpec,d=Kt(c.value.type);let g,v,M,E={};const k="categorical"!==d&&void 0===c.value.property,O=!k,V="array"===Ji(c.value.stops)&&"array"===Ji(c.value.stops[0])&&"object"===Ji(c.value.stops[0][0]),H=po({key:c.key,value:c.value,valueSpec:c.styleSpec.function,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{stops:function(Q){if("identity"===d)return[new Pt(Q.key,Q.value,'identity function may not have a "stops" property')];let ee=[];const de=Q.value;return ee=ee.concat(Na({key:Q.key,value:de,valueSpec:Q.valueSpec,style:Q.style,styleSpec:Q.styleSpec,arrayElementValidator:$})),"array"===Ji(de)&&0===de.length&&ee.push(new Pt(Q.key,de,"array must have at least one stop")),ee},default:function(Q){return Yn({key:Q.key,value:Q.value,valueSpec:r,style:Q.style,styleSpec:Q.styleSpec})}}});return"identity"===d&&k&&H.push(new Pt(c.key,c.value,'missing required property "property"')),"identity"===d||c.value.stops||H.push(new Pt(c.key,c.value,'missing required property "stops"')),"exponential"===d&&c.valueSpec.expression&&!aa(c.valueSpec)&&H.push(new Pt(c.key,c.value,"exponential functions not supported")),c.styleSpec.$version>=8&&(O&&!uo(c.valueSpec)?H.push(new Pt(c.key,c.value,"property functions not supported")):k&&!ho(c.valueSpec)&&H.push(new Pt(c.key,c.value,"zoom functions not supported"))),"categorical"!==d&&!V||void 0!==c.value.property||H.push(new Pt(c.key,c.value,'"property" property is required')),H;function $(Q){let ee=[];const de=Q.value,pe=Q.key;if("array"!==Ji(de))return[new Pt(pe,de,`array expected, ${Ji(de)} found`)];if(2!==de.length)return[new Pt(pe,de,`array length 2 expected, length ${de.length} found`)];if(V){if("object"!==Ji(de[0]))return[new Pt(pe,de,`object expected, ${Ji(de[0])} found`)];if(void 0===de[0].zoom)return[new Pt(pe,de,"object stop key must have zoom")];if(void 0===de[0].value)return[new Pt(pe,de,"object stop key must have value")];if(M&&M>Kt(de[0].zoom))return[new Pt(pe,de[0].zoom,"stop zoom values must appear in ascending order")];Kt(de[0].zoom)!==M&&(M=Kt(de[0].zoom),v=void 0,E={}),ee=ee.concat(po({key:`${pe}[0]`,value:de[0],valueSpec:{zoom:{}},style:Q.style,styleSpec:Q.styleSpec,objectElementValidators:{zoom:Lo,value:K}}))}else ee=ee.concat(K({key:`${pe}[0]`,value:de[0],valueSpec:{},style:Q.style,styleSpec:Q.styleSpec},de));return Sl(Fr(de[1]))?ee.concat([new Pt(`${pe}[1]`,de[1],"expressions are not allowed in function stops.")]):ee.concat(Yn({key:`${pe}[1]`,value:de[1],valueSpec:r,style:Q.style,styleSpec:Q.styleSpec}))}function K(Q,ee){const de=Ji(Q.value),pe=Kt(Q.value),Ee=null!==Q.value?Q.value:ee;if(g){if(de!==g)return[new Pt(Q.key,Ee,`${de} stop domain type must match previous stop domain type ${g}`)]}else g=de;if("number"!==de&&"string"!==de&&"boolean"!==de)return[new Pt(Q.key,Ee,"stop domain value must be a number, string, or boolean")];if("number"!==de&&"categorical"!==d){let $e=`number expected, ${de} found`;return uo(r)&&void 0===d&&($e+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Pt(Q.key,Ee,$e)]}return"categorical"!==d||"number"!==de||isFinite(pe)&&Math.floor(pe)===pe?"categorical"!==d&&"number"===de&&void 0!==v&&pe<v?[new Pt(Q.key,Ee,"stop domain values must appear in ascending order")]:(v=pe,"categorical"===d&&pe in E?[new Pt(Q.key,Ee,"stop domain values must be unique")]:(E[pe]=!0,[])):[new Pt(Q.key,Ee,`integer expected, found ${pe}`)]}}function js(c){const r=("property"===c.expressionContext?qi:fc)(Fr(c.value),c.valueSpec);if("error"===r.result)return r.value.map(g=>new Pt(`${c.key}${g.key}`,c.value,g.message));const d=r.value.expression||r.value._styleExpression.expression;if("property"===c.expressionContext&&"text-font"===c.propertyKey&&!d.outputDefined())return[new Pt(c.key,c.value,`Invalid data expression for "${c.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===c.expressionContext&&"layout"===c.propertyType&&!Pa(d))return[new Pt(c.key,c.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===c.expressionContext&&!Pa(d))return[new Pt(c.key,c.value,'"feature-state" data expressions are not supported with filters.')];if(c.expressionContext&&0===c.expressionContext.indexOf("cluster")){if(!ac(d,["zoom","feature-state"]))return[new Pt(c.key,c.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===c.expressionContext&&!Dr(d))return[new Pt(c.key,c.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function _u(c){const r=c.key,d=c.value,g=c.valueSpec,v=[];return Array.isArray(g.values)?-1===g.values.indexOf(Kt(d))&&v.push(new Pt(r,d,`expected one of [${g.values.join(", ")}], ${JSON.stringify(d)} found`)):-1===Object.keys(g.values).indexOf(Kt(d))&&v.push(new Pt(r,d,`expected one of [${Object.keys(g.values).join(", ")}], ${JSON.stringify(d)} found`)),v}function gc(c){if(!0===c||!1===c)return!0;if(!Array.isArray(c)||0===c.length)return!1;switch(c[0]){case"has":return c.length>=2&&"$id"!==c[1]&&"$type"!==c[1];case"in":return c.length>=3&&("string"!=typeof c[1]||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==c.length||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const r of c.slice(1))if(!gc(r)&&"boolean"!=typeof r)return!1;return!0;default:return!0}}const _c={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function la(c){if(null==c)return{filter:()=>!0,needGeometry:!1};gc(c)||(c=Al(c));const r=fc(c,_c);if("error"===r.result)throw new Error(r.value.map(d=>`${d.key}: ${d.message}`).join(", "));return{filter:(d,g,v)=>r.value.evaluate(d,g,{},v),needGeometry:So(c)}}function Er(c,r){return c<r?-1:c>r?1:0}function So(c){if(!Array.isArray(c))return!1;if("within"===c[0])return!0;for(let r=1;r<c.length;r++)if(So(c[r]))return!0;return!1}function Al(c){if(!c)return!0;const r=c[0];return c.length<=1?"any"!==r:"=="===r?Ss(c[1],c[2],"=="):"!="===r?ca(Ss(c[1],c[2],"==")):"<"===r||">"===r||"<="===r||">="===r?Ss(c[1],c[2],r):"any"===r?(d=c.slice(1),["any"].concat(d.map(Al))):"all"===r?["all"].concat(c.slice(1).map(Al)):"none"===r?["all"].concat(c.slice(1).map(Al).map(ca)):"in"===r?ls(c[1],c.slice(2)):"!in"===r?ca(ls(c[1],c.slice(2))):"has"===r?yc(c[1]):"!has"===r?ca(yc(c[1])):"within"!==r||c;var d}function Ss(c,r,d){switch(c){case"$type":return[`filter-type-${d}`,r];case"$id":return[`filter-id-${d}`,r];default:return[`filter-${d}`,c,r]}}function ls(c,r){if(0===r.length)return!1;switch(c){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some(d=>typeof d!=typeof r[0])?["filter-in-large",c,["literal",r.sort(Er)]]:["filter-in-small",c,["literal",r]]}}function yc(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function ca(c){return["!",c]}function Il(c){return gc(Fr(c.value))?js(ai({},c,{expressionContext:"filter",valueSpec:{value:"boolean"}})):vc(c)}function vc(c){const r=c.value,d=c.key;if("array"!==Ji(r))return[new Pt(d,r,`array expected, ${Ji(r)} found`)];const g=c.styleSpec;let v,M=[];if(r.length<1)return[new Pt(d,r,"filter array must have at least 1 element")];switch(M=M.concat(_u({key:`${d}[0]`,value:r[0],valueSpec:g.filter_operator,style:c.style,styleSpec:c.styleSpec})),Kt(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&"$type"===Kt(r[1])&&M.push(new Pt(d,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":3!==r.length&&M.push(new Pt(d,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(v=Ji(r[1]),"string"!==v&&M.push(new Pt(`${d}[1]`,r[1],`string expected, ${v} found`)));for(let E=2;E<r.length;E++)v=Ji(r[E]),"$type"===Kt(r[1])?M=M.concat(_u({key:`${d}[${E}]`,value:r[E],valueSpec:g.geometry_type,style:c.style,styleSpec:c.styleSpec})):"string"!==v&&"number"!==v&&"boolean"!==v&&M.push(new Pt(`${d}[${E}]`,r[E],`string, number, or boolean expected, ${v} found`));break;case"any":case"all":case"none":for(let E=1;E<r.length;E++)M=M.concat(vc({key:`${d}[${E}]`,value:r[E],style:c.style,styleSpec:c.styleSpec}));break;case"has":case"!has":v=Ji(r[1]),2!==r.length?M.push(new Pt(d,r,`filter array for "${r[0]}" operator must have 2 elements`)):"string"!==v&&M.push(new Pt(`${d}[1]`,r[1],`string expected, ${v} found`));break;case"within":v=Ji(r[1]),2!==r.length?M.push(new Pt(d,r,`filter array for "${r[0]}" operator must have 2 elements`)):"object"!==v&&M.push(new Pt(`${d}[1]`,r[1],`object expected, ${v} found`))}return M}function bc(c,r){const d=c.key,g=c.style,v=c.styleSpec,M=c.value,E=c.objectKey,k=v[`${r}_${c.layerType}`];if(!k)return[];const O=E.match(/^(.*)-transition$/);if("paint"===r&&O&&k[O[1]]&&k[O[1]].transition)return Yn({key:d,value:M,valueSpec:v.transition,style:g,styleSpec:v});const V=c.valueSpec||k[E];if(!V)return[new Pt(d,M,`unknown property "${E}"`)];let H;if("string"===Ji(M)&&uo(V)&&!V.tokens&&(H=/^{([^}]+)}$/.exec(M)))return[new Pt(d,M,`"${E}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(H[1])} }\`.`)];const $=[];return"symbol"===c.layerType&&("text-field"===E&&g&&!g.glyphs&&$.push(new Pt(d,M,'use of "text-field" requires a style "glyphs" property')),"text-font"===E&&Ln(Fr(M))&&"identity"===Kt(M.type)&&$.push(new Pt(d,M,'"text-font" does not support identity functions'))),$.concat(Yn({key:c.key,value:M,valueSpec:V,style:g,styleSpec:v,expressionContext:"property",propertyType:r,propertyKey:E}))}function Us(c){return bc(c,"paint")}function jd(c){return bc(c,"layout")}function xc(c){let r=[];const d=c.value,g=c.key,v=c.style,M=c.styleSpec;d.type||d.ref||r.push(new Pt(g,d,'either "type" or "ref" is required'));let E=Kt(d.type);const k=Kt(d.ref);if(d.id){const O=Kt(d.id);for(let V=0;V<c.arrayIndex;V++){const H=v.layers[V];Kt(H.id)===O&&r.push(new Pt(g,d.id,`duplicate layer id "${d.id}", previously used at line ${H.id.__line__}`))}}if("ref"in d){let O;["type","source","source-layer","filter","layout"].forEach(V=>{V in d&&r.push(new Pt(g,d[V],`"${V}" is prohibited for ref layers`))}),v.layers.forEach(V=>{Kt(V.id)===k&&(O=V)}),O?O.ref?r.push(new Pt(g,d.ref,"ref cannot reference another ref layer")):E=Kt(O.type):r.push(new Pt(g,d.ref,`ref layer "${k}" not found`))}else if("background"!==E)if(d.source){const O=v.sources&&v.sources[d.source],V=O&&Kt(O.type);O?"vector"===V&&"raster"===E?r.push(new Pt(g,d.source,`layer "${d.id}" requires a raster source`)):"raster"===V&&"raster"!==E?r.push(new Pt(g,d.source,`layer "${d.id}" requires a vector source`)):"vector"!==V||d["source-layer"]?"raster-dem"===V&&"hillshade"!==E?r.push(new Pt(g,d.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==E||!d.paint||!d.paint["line-gradient"]||"geojson"===V&&O.lineMetrics||r.push(new Pt(g,d,`layer "${d.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new Pt(g,d,`layer "${d.id}" must specify a "source-layer"`)):r.push(new Pt(g,d.source,`source "${d.source}" not found`))}else r.push(new Pt(g,d,'missing required property "source"'));return r=r.concat(po({key:g,value:d,valueSpec:M.layer,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Yn({key:`${g}.type`,value:d.type,valueSpec:M.layer.type,style:c.style,styleSpec:c.styleSpec,object:d,objectKey:"type"}),filter:Il,layout:O=>po({layer:d,key:O.key,value:O.value,style:O.style,styleSpec:O.styleSpec,objectElementValidators:{"*":V=>jd(ai({layerType:E},V))}}),paint:O=>po({layer:d,key:O.key,value:O.value,style:O.style,styleSpec:O.styleSpec,objectElementValidators:{"*":V=>Us(ai({layerType:E},V))}})}})),r}function kl(c){const r=c.value,d=c.key,g=Ji(r);return"string"!==g?[new Pt(d,r,`string expected, ${g} found`)]:[]}const Ud={promoteId:function({key:c,value:r}){if("string"===Ji(r))return kl({key:c,value:r});{const d=[];for(const g in r)d.push(...kl({key:`${c}.${g}`,value:r[g]}));return d}}};function Rl(c){const r=c.value,d=c.key,g=c.styleSpec,v=c.style;if(!r.type)return[new Pt(d,r,'"type" is required')];const M=Kt(r.type);let E;switch(M){case"vector":case"raster":case"raster-dem":return E=po({key:d,value:r,valueSpec:g[`source_${M.replace("-","_")}`],style:c.style,styleSpec:g,objectElementValidators:Ud}),E;case"geojson":if(E=po({key:d,value:r,valueSpec:g.source_geojson,style:v,styleSpec:g,objectElementValidators:Ud}),r.cluster)for(const k in r.clusterProperties){const[O,V]=r.clusterProperties[k],H="string"==typeof O?[O,["accumulated"],["get",k]]:O;E.push(...js({key:`${d}.${k}.map`,value:V,expressionContext:"cluster-map"})),E.push(...js({key:`${d}.${k}.reduce`,value:H,expressionContext:"cluster-reduce"}))}return E;case"video":return po({key:d,value:r,valueSpec:g.source_video,style:v,styleSpec:g});case"image":return po({key:d,value:r,valueSpec:g.source_image,style:v,styleSpec:g});case"canvas":return[new Pt(d,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return _u({key:`${d}.type`,value:r.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:v,styleSpec:g})}}function Va(c){const r=c.value,d=c.styleSpec,g=d.light,v=c.style;let M=[];const E=Ji(r);if(void 0===r)return M;if("object"!==E)return M=M.concat([new Pt("light",r,`object expected, ${E} found`)]),M;for(const k in r){const O=k.match(/^(.*)-transition$/);M=M.concat(O&&g[O[1]]&&g[O[1]].transition?Yn({key:k,value:r[k],valueSpec:d.transition,style:v,styleSpec:d}):g[k]?Yn({key:k,value:r[k],valueSpec:g[k],style:v,styleSpec:d}):[new Pt(k,r[k],`unknown property "${k}"`)])}return M}const za={"*":()=>[],array:Na,boolean:function(c){const r=c.value,d=c.key,g=Ji(r);return"boolean"!==g?[new Pt(d,r,`boolean expected, ${g} found`)]:[]},number:Lo,color:function(c){const r=c.key,d=c.value,g=Ji(d);return"string"!==g?[new Pt(r,d,`color expected, ${g} found`)]:null===so(d)?[new Pt(r,d,`color expected, "${d}" found`)]:[]},constants:Yi,enum:_u,filter:Il,function:mc,layer:xc,object:po,source:Rl,light:Va,string:kl,formatted:function(c){return 0===kl(c).length?[]:js(c)},resolvedImage:function(c){return 0===kl(c).length?[]:js(c)}};function Yn(c){const r=c.value,d=c.valueSpec,g=c.styleSpec;return d.expression&&Ln(Kt(r))?mc(c):d.expression&&Sl(Fr(r))?js(c):d.type&&za[d.type]?za[d.type](c):po(ai({},c,{valueSpec:d.type?g[d.type]:d}))}function wc(c){const r=c.value,d=c.key,g=kl(c);return g.length||(-1===r.indexOf("{fontstack}")&&g.push(new Pt(d,r,'"glyphs" url must include a "{fontstack}" token')),-1===r.indexOf("{range}")&&g.push(new Pt(d,r,'"glyphs" url must include a "{range}" token'))),g}function Yo(c,r=Xe){let d=[];return d=d.concat(Yn({key:"",value:c,valueSpec:r.$root,styleSpec:r,style:c,objectElementValidators:{glyphs:wc,"*":()=>[]}})),c.constants&&(d=d.concat(Yi({key:"constants",value:c.constants,style:c,styleSpec:r}))),Ts(d)}function Ts(c){return[].concat(c).sort((r,d)=>r.line-d.line)}function ja(c){return function(...r){return Ts(c.apply(this,r))}}Yo.source=ja(Rl),Yo.light=ja(Va),Yo.layer=ja(xc),Yo.filter=ja(Il),Yo.paintProperty=ja(Us),Yo.layoutProperty=ja(jd);const ur=Yo,Bo=ur.light,Nn=ur.paintProperty,yu=ur.layoutProperty;function Gh(c,r){let d=!1;if(r&&r.length)for(const g of r)c.fire(new xr(new Error(g.message))),d=!0;return d}class Pl{constructor(r,d,g){const v=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;const E=new Int32Array(this.arrayBuffer);r=E[0],this.d=(d=E[1])+2*(g=E[2]);for(let O=0;O<this.d*this.d;O++){const V=E[3+O],H=E[3+O+1];v.push(V===H?null:E.subarray(V,H))}const k=E[3+v.length+1];this.keys=E.subarray(E[3+v.length],k),this.bboxes=E.subarray(k),this.insert=this._insertReadonly}else{this.d=d+2*g;for(let E=0;E<this.d*this.d;E++)v.push([]);this.keys=[],this.bboxes=[]}this.n=d,this.extent=r,this.padding=g,this.scale=d/r,this.uid=0;const M=g/d*r;this.min=-M,this.max=r+M}insert(r,d,g,v,M){this._forEachCell(d,g,v,M,this._insertCell,this.uid++,void 0,void 0),this.keys.push(r),this.bboxes.push(d),this.bboxes.push(g),this.bboxes.push(v),this.bboxes.push(M)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(r,d,g,v,M,E){this.cells[M].push(E)}query(r,d,g,v,M){const E=this.min,k=this.max;if(r<=E&&d<=E&&k<=g&&k<=v&&!M)return Array.prototype.slice.call(this.keys);{const O=[];return this._forEachCell(r,d,g,v,this._queryCell,O,{},M),O}}_queryCell(r,d,g,v,M,E,k,O){const V=this.cells[M];if(null!==V){const H=this.keys,$=this.bboxes;for(let K=0;K<V.length;K++){const Q=V[K];if(void 0===k[Q]){const ee=4*Q;(O?O($[ee+0],$[ee+1],$[ee+2],$[ee+3]):r<=$[ee+2]&&d<=$[ee+3]&&g>=$[ee+0]&&v>=$[ee+1])?(k[Q]=!0,E.push(H[Q])):k[Q]=!1}}}}_forEachCell(r,d,g,v,M,E,k,O){const V=this._convertToCellCoord(r),H=this._convertToCellCoord(d),$=this._convertToCellCoord(g),K=this._convertToCellCoord(v);for(let Q=V;Q<=$;Q++)for(let ee=H;ee<=K;ee++){const de=this.d*ee+Q;if((!O||O(this._convertFromCellCoord(Q),this._convertFromCellCoord(ee),this._convertFromCellCoord(Q+1),this._convertFromCellCoord(ee+1)))&&M.call(this,r,d,g,v,de,E,k,O))return}}_convertFromCellCoord(r){return(r-this.padding)/this.scale}_convertToCellCoord(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const r=this.cells,d=3+this.cells.length+1+1;let g=0;for(let E=0;E<this.cells.length;E++)g+=this.cells[E].length;const v=new Int32Array(d+g+this.keys.length+this.bboxes.length);v[0]=this.extent,v[1]=this.n,v[2]=this.padding;let M=d;for(let E=0;E<r.length;E++){const k=r[E];v[3+E]=M,v.set(k,M),M+=k.length}return v[3+r.length]=M,v.set(this.keys,M),M+=this.keys.length,v[3+r.length+1]=M,v.set(this.bboxes,M),M+=this.bboxes.length,v.buffer}static serialize(r,d){const g=r.toArrayBuffer();return d&&d.push(g),{buffer:g}}static deserialize(r){return new Pl(r.buffer)}}const Hs={};function Gt(c,r,d={}){Object.defineProperty(r,"_classRegistryKey",{value:c,writeable:!1}),Hs[c]={klass:r,omit:d.omit||[],shallow:d.shallow||[]}}Gt("Object",Object),Gt("TransferableGridIndex",Pl),Gt("Color",U),Gt("Error",Error),Gt("AJAXError",ns),Gt("ResolvedImage",we),Gt("StylePropertyFunction",Tl),Gt("StyleExpression",mu,{omit:["_evaluator"]}),Gt("ZoomDependentExpression",dt),Gt("ZoomConstantExpression",gu),Gt("CompoundExpression",bi,{omit:["_evaluate"]});for(const c in dn)dn[c]._classRegistryKey||Gt(`Expression_${c}`,dn[c]);function vu(c){return c&&"undefined"!=typeof ArrayBuffer&&(c instanceof ArrayBuffer||c.constructor&&"ArrayBuffer"===c.constructor.name)}function Gs(c,r){if(null==c||"boolean"==typeof c||"number"==typeof c||"string"==typeof c||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||c instanceof Blob)return c;if(vu(c)||Ue(c))return r&&r.push(c),c;if(ArrayBuffer.isView(c)){const d=c;return r&&r.push(d.buffer),d}if(c instanceof ImageData)return r&&r.push(c.data.buffer),c;if(Array.isArray(c)){const d=[];for(const g of c)d.push(Gs(g,r));return d}if("object"==typeof c){const d=c.constructor,g=d._classRegistryKey;if(!g)throw new Error("can't serialize object of unregistered class");const v=d.serialize?d.serialize(c,r):{};if(!d.serialize){for(const M in c){if(!c.hasOwnProperty(M)||Hs[g].omit.indexOf(M)>=0)continue;const E=c[M];v[M]=Hs[g].shallow.indexOf(M)>=0?E:Gs(E,r)}c instanceof Error&&(v.message=c.message)}if(v.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==g&&(v.$name=g),v}throw new Error("can't serialize object of type "+typeof c)}function ua(c){if(null==c||"boolean"==typeof c||"number"==typeof c||"string"==typeof c||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||c instanceof Blob||vu(c)||Ue(c)||ArrayBuffer.isView(c)||c instanceof ImageData)return c;if(Array.isArray(c))return c.map(ua);if("object"==typeof c){const r=c.$name||"Object";if(!Hs[r])throw new Error(`can't deserialize unregistered class ${r}`);const{klass:d}=Hs[r];if(!d)throw new Error(`can't deserialize unregistered class ${r}`);if(d.deserialize)return d.deserialize(c);const g=Object.create(d.prototype);for(const v of Object.keys(c)){if("$name"===v)continue;const M=c[v];g[v]=Hs[r].shallow.indexOf(v)>=0?M:ua(M)}return g}throw new Error("can't deserialize object of type "+typeof c)}class Ua{constructor(){this.first=!0}update(r,d){const g=Math.floor(r);return this.first?(this.first=!1,this.lastIntegerZoom=g,this.lastIntegerZoomTime=0,this.lastZoom=r,this.lastFloorZoom=g,!0):(this.lastFloorZoom>g?(this.lastIntegerZoom=g+1,this.lastIntegerZoomTime=d):this.lastFloorZoom<g&&(this.lastIntegerZoom=g,this.lastIntegerZoomTime=d),r!==this.lastZoom&&(this.lastZoom=r,this.lastFloorZoom=g,!0))}}const Ft={"Latin-1 Supplement":c=>c>=128&&c<=255,Arabic:c=>c>=1536&&c<=1791,"Arabic Supplement":c=>c>=1872&&c<=1919,"Arabic Extended-A":c=>c>=2208&&c<=2303,"Hangul Jamo":c=>c>=4352&&c<=4607,"Unified Canadian Aboriginal Syllabics":c=>c>=5120&&c<=5759,Khmer:c=>c>=6016&&c<=6143,"Unified Canadian Aboriginal Syllabics Extended":c=>c>=6320&&c<=6399,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"CJK Radicals Supplement":c=>c>=11904&&c<=12031,"Kangxi Radicals":c=>c>=12032&&c<=12255,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Bopomofo:c=>c>=12544&&c<=12591,"Hangul Compatibility Jamo":c=>c>=12592&&c<=12687,Kanbun:c=>c>=12688&&c<=12703,"Bopomofo Extended":c=>c>=12704&&c<=12735,"CJK Strokes":c=>c>=12736&&c<=12783,"Katakana Phonetic Extensions":c=>c>=12784&&c<=12799,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"CJK Unified Ideographs Extension A":c=>c>=13312&&c<=19903,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Yi Syllables":c=>c>=40960&&c<=42127,"Yi Radicals":c=>c>=42128&&c<=42191,"Hangul Jamo Extended-A":c=>c>=43360&&c<=43391,"Hangul Syllables":c=>c>=44032&&c<=55215,"Hangul Jamo Extended-B":c=>c>=55216&&c<=55295,"Private Use Area":c=>c>=57344&&c<=63743,"CJK Compatibility Ideographs":c=>c>=63744&&c<=64255,"Arabic Presentation Forms-A":c=>c>=64336&&c<=65023,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Arabic Presentation Forms-B":c=>c>=65136&&c<=65279,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519};function Cc(c){for(const r of c)if(Ha(r.charCodeAt(0)))return!0;return!1}function pf(c){for(const r of c)if(!$s(r.charCodeAt(0)))return!1;return!0}function $s(c){return!(Ft.Arabic(c)||Ft["Arabic Supplement"](c)||Ft["Arabic Extended-A"](c)||Ft["Arabic Presentation Forms-A"](c)||Ft["Arabic Presentation Forms-B"](c))}function Ha(c){return!(746!==c&&747!==c&&(c<4352||!(Ft["Bopomofo Extended"](c)||Ft.Bopomofo(c)||Ft["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||Ft["CJK Compatibility Ideographs"](c)||Ft["CJK Compatibility"](c)||Ft["CJK Radicals Supplement"](c)||Ft["CJK Strokes"](c)||!(!Ft["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||12336===c)||Ft["CJK Unified Ideographs Extension A"](c)||Ft["CJK Unified Ideographs"](c)||Ft["Enclosed CJK Letters and Months"](c)||Ft["Hangul Compatibility Jamo"](c)||Ft["Hangul Jamo Extended-A"](c)||Ft["Hangul Jamo Extended-B"](c)||Ft["Hangul Jamo"](c)||Ft["Hangul Syllables"](c)||Ft.Hiragana(c)||Ft["Ideographic Description Characters"](c)||Ft.Kanbun(c)||Ft["Kangxi Radicals"](c)||Ft["Katakana Phonetic Extensions"](c)||Ft.Katakana(c)&&12540!==c||!(!Ft["Halfwidth and Fullwidth Forms"](c)||65288===c||65289===c||65293===c||c>=65306&&c<=65310||65339===c||65341===c||65343===c||c>=65371&&c<=65503||65507===c||c>=65512&&c<=65519)||!(!Ft["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||Ft["Unified Canadian Aboriginal Syllabics"](c)||Ft["Unified Canadian Aboriginal Syllabics Extended"](c)||Ft["Vertical Forms"](c)||Ft["Yijing Hexagram Symbols"](c)||Ft["Yi Syllables"](c)||Ft["Yi Radicals"](c))))}function bu(c){return!(Ha(c)||(r=c,Ft["Latin-1 Supplement"](r)&&(167===r||169===r||174===r||177===r||188===r||189===r||190===r||215===r||247===r)||Ft["General Punctuation"](r)&&(8214===r||8224===r||8225===r||8240===r||8241===r||8251===r||8252===r||8258===r||8263===r||8264===r||8265===r||8273===r)||Ft["Letterlike Symbols"](r)||Ft["Number Forms"](r)||Ft["Miscellaneous Technical"](r)&&(r>=8960&&r<=8967||r>=8972&&r<=8991||r>=8996&&r<=9e3||9003===r||r>=9085&&r<=9114||r>=9150&&r<=9165||9167===r||r>=9169&&r<=9179||r>=9186&&r<=9215)||Ft["Control Pictures"](r)&&9251!==r||Ft["Optical Character Recognition"](r)||Ft["Enclosed Alphanumerics"](r)||Ft["Geometric Shapes"](r)||Ft["Miscellaneous Symbols"](r)&&!(r>=9754&&r<=9759)||Ft["Miscellaneous Symbols and Arrows"](r)&&(r>=11026&&r<=11055||r>=11088&&r<=11097||r>=11192&&r<=11243)||Ft["CJK Symbols and Punctuation"](r)||Ft.Katakana(r)||Ft["Private Use Area"](r)||Ft["CJK Compatibility Forms"](r)||Ft["Small Form Variants"](r)||Ft["Halfwidth and Fullwidth Forms"](r)||8734===r||8756===r||8757===r||r>=9984&&r<=10087||r>=10102&&r<=10131||65532===r||65533===r));var r}function $h(c){return c>=1424&&c<=2303||Ft["Arabic Presentation Forms-A"](c)||Ft["Arabic Presentation Forms-B"](c)}function da(c,r){return!(!r&&$h(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||Ft.Khmer(c))}function xu(c){for(const r of c)if($h(r.charCodeAt(0)))return!0;return!1}const Mc="deferred",wu="loading",Cu="loaded";let Hd=null,En="unavailable",an=null;const zi=function(c){c&&"string"==typeof c&&c.indexOf("NetworkError")>-1&&(En="error"),Hd&&Hd(c)};function As(){Ol.fire(new Po("pluginStateChange",{pluginStatus:En,pluginURL:an}))}const Ol=new wr,zt=function(){return En},Ei=function(){if(En!==Mc||!an)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");En=wu,As(),an&&oo({url:an},c=>{c?zi(c):(En=Cu,As())})},tr={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>En===Cu||null!=tr.applyArabicShaping,isLoading:()=>En===wu,setState(c){En=c.pluginStatus,an=c.pluginURL},isParsed:()=>null!=tr.applyArabicShaping&&null!=tr.processBidirectionalText&&null!=tr.processStyledBidirectionalText,getPluginURL:()=>an};class Jt{constructor(r,d){this.zoom=r,d?(this.now=d.now,this.fadeDuration=d.fadeDuration,this.zoomHistory=d.zoomHistory,this.transition=d.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ua,this.transition={})}isSupportedScript(r){return function(d,g){for(const v of d)if(!da(v.charCodeAt(0),g))return!1;return!0}(r,tr.isLoaded())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const r=this.zoom,d=r-Math.floor(r),g=this.crossFadingFactor();return r>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:d+(1-d)*g}:{fromScale:.5,toScale:1,t:1-(1-g)*d}}}class Fl{constructor(r,d){this.property=r,this.value=d,this.expression=function(g,v){if(Ln(g))return new Tl(g,v);if(Sl(g)){const M=qi(g,v);if("error"===M.result)throw new Error(M.value.map(E=>`${E.key}: ${E.message}`).join(", "));return M.value}{let M=g;return"string"==typeof g&&"color"===v.type&&(M=U.parse(g)),{kind:"constant",evaluate:()=>M}}}(void 0===d?r.specification.default:d,r.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(r,d,g){return this.property.possiblyEvaluate(this,r,d,g)}}class Wo{constructor(r){this.property=r,this.value=new Fl(r,void 0)}transitioned(r,d){return new qs(this.property,this.value,d,ke({},r.transition,this.transition),r.now)}untransitioned(){return new qs(this.property,this.value,null,{},0)}}class qh{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues)}getValue(r){return Tt(this._values[r].value.value)}setValue(r,d){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new Wo(this._values[r].property)),this._values[r].value=new Fl(this._values[r].property,null===d?void 0:Tt(d))}getTransition(r){return Tt(this._values[r].transition)}setTransition(r,d){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new Wo(this._values[r].property)),this._values[r].transition=Tt(d)||void 0}serialize(){const r={};for(const d of Object.keys(this._values)){const g=this.getValue(d);void 0!==g&&(r[d]=g);const v=this.getTransition(d);void 0!==v&&(r[`${d}-transition`]=v)}return r}transitioned(r,d){const g=new Gd(this._properties);for(const v of Object.keys(this._values))g._values[v]=this._values[v].transitioned(r,d._values[v]);return g}untransitioned(){const r=new Gd(this._properties);for(const d of Object.keys(this._values))r._values[d]=this._values[d].untransitioned();return r}}class qs{constructor(r,d,g,v,M){this.property=r,this.value=d,this.begin=M+v.delay||0,this.end=this.begin+v.duration||0,r.specification.transition&&(v.delay||v.duration)&&(this.prior=g)}possiblyEvaluate(r,d,g){const v=r.now||0,M=this.value.possiblyEvaluate(r,d,g),E=this.prior;if(E){if(v>this.end)return this.prior=null,M;if(this.value.isDataDriven())return this.prior=null,M;if(v<this.begin)return E.possiblyEvaluate(r,d,g);{const k=(v-this.begin)/(this.end-this.begin);return this.property.interpolate(E.possiblyEvaluate(r,d,g),M,function(O){if(O<=0)return 0;if(O>=1)return 1;const V=O*O,H=V*O;return 4*(O<.5?H:3*(O-V)+H-.75)}(k))}}return M}}class Gd{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)}possiblyEvaluate(r,d,g){const v=new Is(this._properties);for(const M of Object.keys(this._values))v._values[M]=this._values[M].possiblyEvaluate(r,d,g);return v}hasTransition(){for(const r of Object.keys(this._values))if(this._values[r].prior)return!0;return!1}}class $d{constructor(r){this._properties=r,this._values=Object.create(r.defaultPropertyValues)}getValue(r){return Tt(this._values[r].value)}setValue(r,d){this._values[r]=new Fl(this._values[r].property,null===d?void 0:Tt(d))}serialize(){const r={};for(const d of Object.keys(this._values)){const g=this.getValue(d);void 0!==g&&(r[d]=g)}return r}possiblyEvaluate(r,d,g){const v=new Is(this._properties);for(const M of Object.keys(this._values))v._values[M]=this._values[M].possiblyEvaluate(r,d,g);return v}}class fo{constructor(r,d,g){this.property=r,this.value=d,this.parameters=g}isConstant(){return"constant"===this.value.kind}constantOr(r){return"constant"===this.value.kind?this.value.value:r}evaluate(r,d,g,v){return this.property.evaluate(this.value,this.parameters,r,d,g,v)}}class Is{constructor(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)}get(r){return this._values[r]}}class Wt{constructor(r){this.specification=r}possiblyEvaluate(r,d){return r.expression.evaluate(d)}interpolate(r,d,g){const v=uc[this.specification.type];return v?v(r,d,g):r}}class Mt{constructor(r,d){this.specification=r,this.overrides=d}possiblyEvaluate(r,d,g,v){return new fo(this,"constant"===r.expression.kind||"camera"===r.expression.kind?{kind:"constant",value:r.expression.evaluate(d,null,{},g,v)}:r.expression,d)}interpolate(r,d,g){if("constant"!==r.value.kind||"constant"!==d.value.kind)return r;if(void 0===r.value.value||void 0===d.value.value)return new fo(this,{kind:"constant",value:void 0},r.parameters);const v=uc[this.specification.type];return v?new fo(this,{kind:"constant",value:v(r.value.value,d.value.value,g)},r.parameters):r}evaluate(r,d,g,v,M,E){return"constant"===r.kind?r.value:r.evaluate(d,g,v,M,E)}}class No extends Mt{possiblyEvaluate(r,d,g,v){if(void 0===r.value)return new fo(this,{kind:"constant",value:void 0},d);if("constant"===r.expression.kind){const M=r.expression.evaluate(d,null,{},g,v),E="resolvedImage"===r.property.specification.type&&"string"!=typeof M?M.name:M,k=this._calculate(E,E,E,d);return new fo(this,{kind:"constant",value:k},d)}if("camera"===r.expression.kind){const M=this._calculate(r.expression.evaluate({zoom:d.zoom-1}),r.expression.evaluate({zoom:d.zoom}),r.expression.evaluate({zoom:d.zoom+1}),d);return new fo(this,{kind:"constant",value:M},d)}return new fo(this,r.expression,d)}evaluate(r,d,g,v,M,E){if("source"===r.kind){const k=r.evaluate(d,g,v,M,E);return this._calculate(k,k,k,d)}return"composite"===r.kind?this._calculate(r.evaluate({zoom:Math.floor(d.zoom)-1},g,v),r.evaluate({zoom:Math.floor(d.zoom)},g,v),r.evaluate({zoom:Math.floor(d.zoom)+1},g,v),d):r.value}_calculate(r,d,g,v){return v.zoom>v.zoomHistory.lastIntegerZoom?{from:r,to:d}:{from:g,to:d}}interpolate(r){return r}}class Ys{constructor(r){this.specification=r}possiblyEvaluate(r,d,g,v){if(void 0!==r.value){if("constant"===r.expression.kind){const M=r.expression.evaluate(d,null,{},g,v);return this._calculate(M,M,M,d)}return this._calculate(r.expression.evaluate(new Jt(Math.floor(d.zoom-1),d)),r.expression.evaluate(new Jt(Math.floor(d.zoom),d)),r.expression.evaluate(new Jt(Math.floor(d.zoom+1),d)),d)}}_calculate(r,d,g,v){return v.zoom>v.zoomHistory.lastIntegerZoom?{from:r,to:d}:{from:g,to:d}}interpolate(r){return r}}class Ll{constructor(r){this.specification=r}possiblyEvaluate(r,d,g,v){return!!r.expression.evaluate(d,null,{},g,v)}interpolate(){return!1}}class qr{constructor(r){this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const d in r){const g=r[d];g.specification.overridable&&this.overridableProperties.push(d);const v=this.defaultPropertyValues[d]=new Fl(g,void 0),M=this.defaultTransitionablePropertyValues[d]=new Wo(g);this.defaultTransitioningPropertyValues[d]=M.untransitioned(),this.defaultPossiblyEvaluatedValues[d]=v.possiblyEvaluate({})}}}Gt("DataDrivenProperty",Mt),Gt("DataConstantProperty",Wt),Gt("CrossFadedDataDrivenProperty",No),Gt("CrossFadedProperty",Ys),Gt("ColorRampProperty",Ll);const cs="-transition";class mo extends wr{constructor(r,d){if(super(),this.id=r.id,this.type=r.type,this._featureFilter={filter:()=>!0,needGeometry:!1},"custom"!==r.type&&(this.metadata=(r=r).metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,"background"!==r.type&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),d.layout&&(this._unevaluatedLayout=new $d(d.layout)),d.paint)){this._transitionablePaint=new qh(d.paint);for(const g in r.paint)this.setPaintProperty(g,r.paint[g],{validate:!1});for(const g in r.layout)this.setLayoutProperty(g,r.layout[g],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Is(d.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(r){return"visibility"===r?this.visibility:this._unevaluatedLayout.getValue(r)}setLayoutProperty(r,d,g={}){null!=d&&this._validate(yu,`layers.${this.id}.layout.${r}`,r,d,g)||("visibility"!==r?this._unevaluatedLayout.setValue(r,d):this.visibility=d)}getPaintProperty(r){return r.endsWith(cs)?this._transitionablePaint.getTransition(r.slice(0,-cs.length)):this._transitionablePaint.getValue(r)}setPaintProperty(r,d,g={}){if(null!=d&&this._validate(Nn,`layers.${this.id}.paint.${r}`,r,d,g))return!1;if(r.endsWith(cs))return this._transitionablePaint.setTransition(r.slice(0,-cs.length),d||void 0),!1;{const v=this._transitionablePaint._values[r],M="cross-faded-data-driven"===v.property.specification["property-type"],E=v.value.isDataDriven(),k=v.value;this._transitionablePaint.setValue(r,d),this._handleSpecialPaintPropertyUpdate(r);const O=this._transitionablePaint._values[r].value;return O.isDataDriven()||E||M||this._handleOverridablePaintPropertyUpdate(r,k,O)}}_handleSpecialPaintPropertyUpdate(r){}_handleOverridablePaintPropertyUpdate(r,d,g){return!1}isHidden(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||"none"===this.visibility}updateTransitions(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(r,d){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,d)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,d)}serialize(){const r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),vt(r,(d,g)=>!(void 0===d||"layout"===g&&!Object.keys(d).length||"paint"===g&&!Object.keys(d).length))}_validate(r,d,g,v,M={}){return(!M||!1!==M.validate)&&Gh(this,r.call(ur,{key:d,layerType:this.type,objectKey:g,value:v,styleSpec:Xe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const r in this.paint._values){const d=this.paint.get(r);if(d instanceof fo&&uo(d.property.specification)&&("source"===d.value.kind||"composite"===d.value.kind)&&d.value.isStateDependent)return!0}return!1}}const Ga={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Dc{constructor(r,d){this._structArray=r,this._pos1=d*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Vn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(r,d){return r._trim(),d&&(r.isTransferred=!0,d.push(r.arrayBuffer)),{length:r.length,arrayBuffer:r.arrayBuffer}}static deserialize(r){const d=Object.create(this.prototype);return d.arrayBuffer=r.arrayBuffer,d.length=r.length,d.capacity=r.arrayBuffer.byteLength/d.bytesPerElement,d._refreshViews(),d}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(r){this.reserve(r),this.length=r}reserve(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const d=this.uint8;this._refreshViews(),d&&this.uint8.set(d)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function xn(c,r=1){let d=0,g=0;return{members:c.map(v=>{const M=Ga[v.type].BYTES_PER_ELEMENT,E=d=$a(d,Math.max(r,M)),k=v.components||1;return g=Math.max(g,M),d+=M*k,{name:v.name,type:v.type,components:k,offset:E}}),size:$a(d,Math.max(g,r)),alignment:r}}function $a(c,r){return Math.ceil(c/r)*r}class Bl extends Vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,d){const g=this.length;return this.resize(g+1),this.emplace(g,r,d)}emplace(r,d,g){const v=2*r;return this.int16[v+0]=d,this.int16[v+1]=g,r}}Bl.prototype.bytesPerElement=4,Gt("StructArrayLayout2i4",Bl);class Ec extends Vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,d,g,v){const M=this.length;return this.resize(M+1),this.emplace(M,r,d,g,v)}emplace(r,d,g,v,M){const E=4*r;return this.int16[E+0]=d,this.int16[E+1]=g,this.int16[E+2]=v,this.int16[E+3]=M,r}}Ec.prototype.bytesPerElement=8,Gt("StructArrayLayout4i8",Ec);class qa extends Vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,d,g,v,M,E){const k=this.length;return this.resize(k+1),this.emplace(k,r,d,g,v,M,E)}emplace(r,d,g,v,M,E,k){const O=6*r;return this.int16[O+0]=d,this.int16[O+1]=g,this.int16[O+2]=v,this.int16[O+3]=M,this.int16[O+4]=E,this.int16[O+5]=k,r}}qa.prototype.bytesPerElement=12,Gt("StructArrayLayout2i4i12",qa);class b extends Vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,d,g,v,M,E){const k=this.length;return this.resize(k+1),this.emplace(k,r,d,g,v,M,E)}emplace(r,d,g,v,M,E,k){const O=4*r,V=8*r;return this.int16[O+0]=d,this.int16[O+1]=g,this.uint8[V+4]=v,this.uint8[V+5]=M,this.uint8[V+6]=E,this.uint8[V+7]=k,r}}b.prototype.bytesPerElement=8,Gt("StructArrayLayout2i4ub8",b);class a extends Vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,d){const g=this.length;return this.resize(g+1),this.emplace(g,r,d)}emplace(r,d,g){const v=2*r;return this.float32[v+0]=d,this.float32[v+1]=g,r}}a.prototype.bytesPerElement=8,Gt("StructArrayLayout2f8",a);class p extends Vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,d,g,v,M,E,k,O,V,H){const $=this.length;return this.resize($+1),this.emplace($,r,d,g,v,M,E,k,O,V,H)}emplace(r,d,g,v,M,E,k,O,V,H,$){const K=10*r;return this.uint16[K+0]=d,this.uint16[K+1]=g,this.uint16[K+2]=v,this.uint16[K+3]=M,this.uint16[K+4]=E,this.uint16[K+5]=k,this.uint16[K+6]=O,this.uint16[K+7]=V,this.uint16[K+8]=H,this.uint16[K+9]=$,r}}p.prototype.bytesPerElement=20,Gt("StructArrayLayout10ui20",p);class y extends Vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,d,g,v,M,E,k,O,V,H,$,K){const Q=this.length;return this.resize(Q+1),this.emplace(Q,r,d,g,v,M,E,k,O,V,H,$,K)}emplace(r,d,g,v,M,E,k,O,V,H,$,K,Q){const ee=12*r;return this.int16[ee+0]=d,this.int16[ee+1]=g,this.int16[ee+2]=v,this.int16[ee+3]=M,this.uint16[ee+4]=E,this.uint16[ee+5]=k,this.uint16[ee+6]=O,this.uint16[ee+7]=V,this.int16[ee+8]=H,this.int16[ee+9]=$,this.int16[ee+10]=K,this.int16[ee+11]=Q,r}}y.prototype.bytesPerElement=24,Gt("StructArrayLayout4i4ui4i24",y);class w extends Vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,d,g){const v=this.length;return this.resize(v+1),this.emplace(v,r,d,g)}emplace(r,d,g,v){const M=3*r;return this.float32[M+0]=d,this.float32[M+1]=g,this.float32[M+2]=v,r}}w.prototype.bytesPerElement=12,Gt("StructArrayLayout3f12",w);class S extends Vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r){const d=this.length;return this.resize(d+1),this.emplace(d,r)}emplace(r,d){return this.uint32[1*r+0]=d,r}}S.prototype.bytesPerElement=4,Gt("StructArrayLayout1ul4",S);class R extends Vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,d,g,v,M,E,k,O,V){const H=this.length;return this.resize(H+1),this.emplace(H,r,d,g,v,M,E,k,O,V)}emplace(r,d,g,v,M,E,k,O,V,H){const $=10*r,K=5*r;return this.int16[$+0]=d,this.int16[$+1]=g,this.int16[$+2]=v,this.int16[$+3]=M,this.int16[$+4]=E,this.int16[$+5]=k,this.uint32[K+3]=O,this.uint16[$+8]=V,this.uint16[$+9]=H,r}}R.prototype.bytesPerElement=20,Gt("StructArrayLayout6i1ul2ui20",R);class F extends Vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,d,g,v,M,E){const k=this.length;return this.resize(k+1),this.emplace(k,r,d,g,v,M,E)}emplace(r,d,g,v,M,E,k){const O=6*r;return this.int16[O+0]=d,this.int16[O+1]=g,this.int16[O+2]=v,this.int16[O+3]=M,this.int16[O+4]=E,this.int16[O+5]=k,r}}F.prototype.bytesPerElement=12,Gt("StructArrayLayout2i2i2i12",F);class N extends Vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,d,g,v,M){const E=this.length;return this.resize(E+1),this.emplace(E,r,d,g,v,M)}emplace(r,d,g,v,M,E){const k=4*r,O=8*r;return this.float32[k+0]=d,this.float32[k+1]=g,this.float32[k+2]=v,this.int16[O+6]=M,this.int16[O+7]=E,r}}N.prototype.bytesPerElement=16,Gt("StructArrayLayout2f1f2i16",N);class j extends Vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,d,g,v){const M=this.length;return this.resize(M+1),this.emplace(M,r,d,g,v)}emplace(r,d,g,v,M){const E=12*r,k=3*r;return this.uint8[E+0]=d,this.uint8[E+1]=g,this.float32[k+1]=v,this.float32[k+2]=M,r}}j.prototype.bytesPerElement=12,Gt("StructArrayLayout2ub2f12",j);class q extends Vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,d,g){const v=this.length;return this.resize(v+1),this.emplace(v,r,d,g)}emplace(r,d,g,v){const M=3*r;return this.uint16[M+0]=d,this.uint16[M+1]=g,this.uint16[M+2]=v,r}}q.prototype.bytesPerElement=6,Gt("StructArrayLayout3ui6",q);class X extends Vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,d,g,v,M,E,k,O,V,H,$,K,Q,ee,de,pe,Ee){const $e=this.length;return this.resize($e+1),this.emplace($e,r,d,g,v,M,E,k,O,V,H,$,K,Q,ee,de,pe,Ee)}emplace(r,d,g,v,M,E,k,O,V,H,$,K,Q,ee,de,pe,Ee,$e){const ze=24*r,Ke=12*r,ct=48*r;return this.int16[ze+0]=d,this.int16[ze+1]=g,this.uint16[ze+2]=v,this.uint16[ze+3]=M,this.uint32[Ke+2]=E,this.uint32[Ke+3]=k,this.uint32[Ke+4]=O,this.uint16[ze+10]=V,this.uint16[ze+11]=H,this.uint16[ze+12]=$,this.float32[Ke+7]=K,this.float32[Ke+8]=Q,this.uint8[ct+36]=ee,this.uint8[ct+37]=de,this.uint8[ct+38]=pe,this.uint32[Ke+10]=Ee,this.int16[ze+22]=$e,r}}X.prototype.bytesPerElement=48,Gt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",X);class te extends Vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,d,g,v,M,E,k,O,V,H,$,K,Q,ee,de,pe,Ee,$e,ze,Ke,ct,rt,Nt,ei,Vt,Bt,It,jt){const Lt=this.length;return this.resize(Lt+1),this.emplace(Lt,r,d,g,v,M,E,k,O,V,H,$,K,Q,ee,de,pe,Ee,$e,ze,Ke,ct,rt,Nt,ei,Vt,Bt,It,jt)}emplace(r,d,g,v,M,E,k,O,V,H,$,K,Q,ee,de,pe,Ee,$e,ze,Ke,ct,rt,Nt,ei,Vt,Bt,It,jt,Lt){const _t=34*r,hi=17*r;return this.int16[_t+0]=d,this.int16[_t+1]=g,this.int16[_t+2]=v,this.int16[_t+3]=M,this.int16[_t+4]=E,this.int16[_t+5]=k,this.int16[_t+6]=O,this.int16[_t+7]=V,this.uint16[_t+8]=H,this.uint16[_t+9]=$,this.uint16[_t+10]=K,this.uint16[_t+11]=Q,this.uint16[_t+12]=ee,this.uint16[_t+13]=de,this.uint16[_t+14]=pe,this.uint16[_t+15]=Ee,this.uint16[_t+16]=$e,this.uint16[_t+17]=ze,this.uint16[_t+18]=Ke,this.uint16[_t+19]=ct,this.uint16[_t+20]=rt,this.uint16[_t+21]=Nt,this.uint16[_t+22]=ei,this.uint32[hi+12]=Vt,this.float32[hi+13]=Bt,this.float32[hi+14]=It,this.float32[hi+15]=jt,this.float32[hi+16]=Lt,r}}te.prototype.bytesPerElement=68,Gt("StructArrayLayout8i15ui1ul4f68",te);class ce extends Vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r){const d=this.length;return this.resize(d+1),this.emplace(d,r)}emplace(r,d){return this.float32[1*r+0]=d,r}}ce.prototype.bytesPerElement=4,Gt("StructArrayLayout1f4",ce);class oe extends Vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,d,g){const v=this.length;return this.resize(v+1),this.emplace(v,r,d,g)}emplace(r,d,g,v){const M=3*r;return this.int16[M+0]=d,this.int16[M+1]=g,this.int16[M+2]=v,r}}oe.prototype.bytesPerElement=6,Gt("StructArrayLayout3i6",oe);class he extends Vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,d,g){const v=this.length;return this.resize(v+1),this.emplace(v,r,d,g)}emplace(r,d,g,v){const M=4*r;return this.uint32[2*r+0]=d,this.uint16[M+2]=g,this.uint16[M+3]=v,r}}he.prototype.bytesPerElement=8,Gt("StructArrayLayout1ul2ui8",he);class Ce extends Vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,d){const g=this.length;return this.resize(g+1),this.emplace(g,r,d)}emplace(r,d,g){const v=2*r;return this.uint16[v+0]=d,this.uint16[v+1]=g,r}}Ce.prototype.bytesPerElement=4,Gt("StructArrayLayout2ui4",Ce);class De extends Vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r){const d=this.length;return this.resize(d+1),this.emplace(d,r)}emplace(r,d){return this.uint16[1*r+0]=d,r}}De.prototype.bytesPerElement=2,Gt("StructArrayLayout1ui2",De);class Ne extends Vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,d,g,v){const M=this.length;return this.resize(M+1),this.emplace(M,r,d,g,v)}emplace(r,d,g,v,M){const E=4*r;return this.float32[E+0]=d,this.float32[E+1]=g,this.float32[E+2]=v,this.float32[E+3]=M,r}}Ne.prototype.bytesPerElement=16,Gt("StructArrayLayout4f16",Ne);class Se extends Dc{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Oe(this.anchorPointX,this.anchorPointY)}}Se.prototype.size=20;class Je extends R{get(r){return new Se(this,r)}}Gt("CollisionBoxArray",Je);class Ye extends Dc{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(r){this._structArray.uint8[this._pos1+37]=r}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(r){this._structArray.uint8[this._pos1+38]=r}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(r){this._structArray.uint32[this._pos4+10]=r}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Ye.prototype.size=48;class Ge extends X{get(r){return new Ye(this,r)}}Gt("PlacedSymbolArray",Ge);class ht extends Dc{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(r){this._structArray.uint32[this._pos4+12]=r}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}ht.prototype.size=68;class mt extends te{get(r){return new ht(this,r)}}Gt("SymbolInstanceArray",mt);class ot extends ce{getoffsetX(r){return this.float32[1*r+0]}}Gt("GlyphOffsetArray",ot);class Zt extends oe{getx(r){return this.int16[3*r+0]}gety(r){return this.int16[3*r+1]}gettileUnitDistanceFromAnchor(r){return this.int16[3*r+2]}}Gt("SymbolLineVertexArray",Zt);class St extends Dc{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}St.prototype.size=8;class oi extends he{get(r){return new St(this,r)}}Gt("FeatureIndexArray",oi);class Zi extends Bl{}class mi extends Bl{}class Ii extends qa{}class wn extends b{}class Si extends a{}class Ni extends p{}class Sn extends y{}class Yr extends w{}class go extends S{}class ln extends F{}class _o extends j{}class dr extends q{}class us extends Ce{}const ds=xn([{name:"a_pos",components:2,type:"Int16"}],4),{members:Ws}=ds;class fn{constructor(r=[]){this.segments=r}prepareSegment(r,d,g,v){let M=this.segments[this.segments.length-1];return r>fn.MAX_VERTEX_ARRAY_LENGTH&&Dt(`Max vertices per segment is ${fn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${r}`),(!M||M.vertexLength+r>fn.MAX_VERTEX_ARRAY_LENGTH||M.sortKey!==v)&&(M={vertexOffset:d.length,primitiveOffset:g.length,vertexLength:0,primitiveLength:0},void 0!==v&&(M.sortKey=v),this.segments.push(M)),M}get(){return this.segments}destroy(){for(const r of this.segments)for(const d in r.vaos)r.vaos[d].destroy()}static simpleSegment(r,d,g,v){return new fn([{vertexOffset:r,primitiveOffset:d,vertexLength:g,primitiveLength:v,vaos:{},sortKey:0}])}}function ir(c,r){return 256*(c=ne(Math.floor(c),0,255))+ne(Math.floor(r),0,255)}fn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Gt("SegmentVector",fn);const Ki=xn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var nr={exports:{}},Vo=function(c,r){var d,g,v,M,E,k,O,V;for(g=c.length-(d=3&c.length),v=r,E=3432918353,k=461845907,V=0;V<g;)O=255&c.charCodeAt(V)|(255&c.charCodeAt(++V))<<8|(255&c.charCodeAt(++V))<<16|(255&c.charCodeAt(++V))<<24,++V,v=27492+(65535&(M=5*(65535&(v=(v^=O=(65535&(O=(O=(65535&O)*E+(((O>>>16)*E&65535)<<16)&4294967295)<<15|O>>>17))*k+(((O>>>16)*k&65535)<<16)&4294967295)<<13|v>>>19))+((5*(v>>>16)&65535)<<16)&4294967295))+((58964+(M>>>16)&65535)<<16);switch(O=0,d){case 3:O^=(255&c.charCodeAt(V+2))<<16;case 2:O^=(255&c.charCodeAt(V+1))<<8;case 1:v^=O=(65535&(O=(O=(65535&(O^=255&c.charCodeAt(V)))*E+(((O>>>16)*E&65535)<<16)&4294967295)<<15|O>>>17))*k+(((O>>>16)*k&65535)<<16)&4294967295}return v^=c.length,v=2246822507*(65535&(v^=v>>>16))+((2246822507*(v>>>16)&65535)<<16)&4294967295,v=3266489909*(65535&(v^=v>>>13))+((3266489909*(v>>>16)&65535)<<16)&4294967295,(v^=v>>>16)>>>0},ks=function(c,r){for(var d,g=c.length,v=r^g,M=0;g>=4;)d=1540483477*(65535&(d=255&c.charCodeAt(M)|(255&c.charCodeAt(++M))<<8|(255&c.charCodeAt(++M))<<16|(255&c.charCodeAt(++M))<<24))+((1540483477*(d>>>16)&65535)<<16),v=1540483477*(65535&v)+((1540483477*(v>>>16)&65535)<<16)^(d=1540483477*(65535&(d^=d>>>24))+((1540483477*(d>>>16)&65535)<<16)),g-=4,++M;switch(g){case 3:v^=(255&c.charCodeAt(M+2))<<16;case 2:v^=(255&c.charCodeAt(M+1))<<8;case 1:v=1540483477*(65535&(v^=255&c.charCodeAt(M)))+((1540483477*(v>>>16)&65535)<<16)}return v=1540483477*(65535&(v^=v>>>13))+((1540483477*(v>>>16)&65535)<<16),(v^=v>>>15)>>>0};nr.exports=Vo,nr.exports.murmur3=Vo,nr.exports.murmur2=ks;var To=nr.exports;class Rs{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(r,d,g,v){this.ids.push(Ya(r)),this.positions.push(d,g,v)}getPositions(r){const d=Ya(r);let g=0,v=this.ids.length-1;for(;g<v;){const E=g+v>>1;this.ids[E]>=d?v=E:g=E+1}const M=[];for(;this.ids[g]===d;)M.push({index:this.positions[3*g],start:this.positions[3*g+1],end:this.positions[3*g+2]}),g++;return M}static serialize(r,d){const g=new Float64Array(r.ids),v=new Uint32Array(r.positions);return Nl(g,v,0,g.length-1),d&&d.push(g.buffer,v.buffer),{ids:g,positions:v}}static deserialize(r){const d=new Rs;return d.ids=r.ids,d.positions=r.positions,d.indexed=!0,d}}function Ya(c){const r=+c;return!isNaN(r)&&r<=Number.MAX_SAFE_INTEGER?r:To(String(c))}function Nl(c,r,d,g){for(;d<g;){const v=c[d+g>>1];let M=d-1,E=g+1;for(;;){do{M++}while(c[M]<v);do{E--}while(c[E]>v);if(M>=E)break;yo(c,M,E),yo(r,3*M,3*E),yo(r,3*M+1,3*E+1),yo(r,3*M+2,3*E+2)}E-d<g-E?(Nl(c,r,d,E),d=E+1):(Nl(c,r,E+1,g),g=E)}}function yo(c,r,d){const g=c[r];c[r]=c[d],c[d]=g}Gt("FeaturePositionMap",Rs);class Ps{constructor(r,d){this.gl=r.gl,this.location=d}}class Zo extends Ps{constructor(r,d){super(r,d),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))}}class Sc extends Ps{constructor(r,d){super(r,d),this.current=[0,0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))}}class Os extends Ps{constructor(r,d){super(r,d),this.current=U.transparent}set(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))}}const Yh=new Float32Array(16);function Zs(c){return[ir(255*c.r,255*c.g),ir(255*c.b,255*c.a)]}class Xn{constructor(r,d,g){this.value=r,this.uniformNames=d.map(v=>`u_${v}`),this.type=g}setUniform(r,d,g){r.set(g.constantOr(this.value))}getBinding(r,d,g){return"color"===this.type?new Os(r,d):new Zo(r,d)}}class Wa{constructor(r,d){this.uniformNames=d.map(g=>`u_${g}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(r,d){this.pixelRatioFrom=d.pixelRatio,this.pixelRatioTo=r.pixelRatio,this.patternFrom=d.tlbr,this.patternTo=r.tlbr}setUniform(r,d,g,v){const M="u_pattern_to"===v?this.patternTo:"u_pattern_from"===v?this.patternFrom:"u_pixel_ratio_to"===v?this.pixelRatioTo:"u_pixel_ratio_from"===v?this.pixelRatioFrom:null;M&&r.set(M)}getBinding(r,d,g){return"u_pattern"===g.substr(0,9)?new Sc(r,d):new Zo(r,d)}}class Sr{constructor(r,d,g,v){this.expression=r,this.type=g,this.maxValue=0,this.paintVertexAttributes=d.map(M=>({name:`a_${M}`,type:"Float32",components:"color"===g?2:1,offset:0})),this.paintVertexArray=new v}populatePaintArray(r,d,g,v,M){const E=this.paintVertexArray.length,k=this.expression.evaluate(new Jt(0),d,{},v,[],M);this.paintVertexArray.resize(r),this._setPaintValue(E,r,k)}updatePaintArray(r,d,g,v){const M=this.expression.evaluate({zoom:0},g,v);this._setPaintValue(r,d,M)}_setPaintValue(r,d,g){if("color"===this.type){const v=Zs(g);for(let M=r;M<d;M++)this.paintVertexArray.emplace(M,v[0],v[1])}else{for(let v=r;v<d;v++)this.paintVertexArray.emplace(v,g);this.maxValue=Math.max(this.maxValue,Math.abs(g))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Tr{constructor(r,d,g,v,M,E){this.expression=r,this.uniformNames=d.map(k=>`u_${k}_t`),this.type=g,this.useIntegerZoom=v,this.zoom=M,this.maxValue=0,this.paintVertexAttributes=d.map(k=>({name:`a_${k}`,type:"Float32",components:"color"===g?4:2,offset:0})),this.paintVertexArray=new E}populatePaintArray(r,d,g,v,M){const E=this.expression.evaluate(new Jt(this.zoom),d,{},v,[],M),k=this.expression.evaluate(new Jt(this.zoom+1),d,{},v,[],M),O=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(O,r,E,k)}updatePaintArray(r,d,g,v){const M=this.expression.evaluate({zoom:this.zoom},g,v),E=this.expression.evaluate({zoom:this.zoom+1},g,v);this._setPaintValue(r,d,M,E)}_setPaintValue(r,d,g,v){if("color"===this.type){const M=Zs(g),E=Zs(v);for(let k=r;k<d;k++)this.paintVertexArray.emplace(k,M[0],M[1],E[0],E[1])}else{for(let M=r;M<d;M++)this.paintVertexArray.emplace(M,g,v);this.maxValue=Math.max(this.maxValue,Math.abs(g),Math.abs(v))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(r,d){const g=this.useIntegerZoom?Math.floor(d.zoom):d.zoom,v=ne(this.expression.interpolationFactor(g,this.zoom,this.zoom+1),0,1);r.set(v)}getBinding(r,d,g){return new Zo(r,d)}}class vo{constructor(r,d,g,v,M,E){this.expression=r,this.type=d,this.useIntegerZoom=g,this.zoom=v,this.layerId=E,this.zoomInPaintVertexArray=new M,this.zoomOutPaintVertexArray=new M}populatePaintArray(r,d,g){const v=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(r),this.zoomOutPaintVertexArray.resize(r),this._setPaintValues(v,r,d.patterns&&d.patterns[this.layerId],g)}updatePaintArray(r,d,g,v,M){this._setPaintValues(r,d,g.patterns&&g.patterns[this.layerId],M)}_setPaintValues(r,d,g,v){if(!v||!g)return;const{min:M,mid:E,max:k}=g,O=v[M],V=v[E],H=v[k];if(O&&V&&H)for(let $=r;$<d;$++)this.zoomInPaintVertexArray.emplace($,V.tl[0],V.tl[1],V.br[0],V.br[1],O.tl[0],O.tl[1],O.br[0],O.br[1],V.pixelRatio,O.pixelRatio),this.zoomOutPaintVertexArray.emplace($,V.tl[0],V.tl[1],V.br[0],V.br[1],H.tl[0],H.tl[1],H.br[0],H.br[1],V.pixelRatio,H.pixelRatio)}upload(r){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=r.createVertexBuffer(this.zoomInPaintVertexArray,Ki.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=r.createVertexBuffer(this.zoomOutPaintVertexArray,Ki.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class ff{constructor(r,d,g){this.binders={},this._buffers=[];const v=[];for(const M in r.paint._values){if(!g(M))continue;const E=r.paint.get(M);if(!(E instanceof fo&&uo(E.property.specification)))continue;const k=mf(M,r.type),O=E.value,V=E.property.specification.type,H=E.property.useIntegerZoom,$=E.property.specification["property-type"],K="cross-faded"===$||"cross-faded-data-driven"===$;if("constant"===O.kind)this.binders[M]=K?new Wa(O.value,k):new Xn(O.value,k,V),v.push(`/u_${M}`);else if("source"===O.kind||K){const Q=Za(M,V,"source");this.binders[M]=K?new vo(O,V,H,d,Q,r.id):new Sr(O,k,V,Q),v.push(`/a_${M}`)}else{const Q=Za(M,V,"composite");this.binders[M]=new Tr(O,k,V,H,d,Q),v.push(`/z_${M}`)}}this.cacheKey=v.sort().join("")}getMaxValue(r){const d=this.binders[r];return d instanceof Sr||d instanceof Tr?d.maxValue:0}populatePaintArrays(r,d,g,v,M){for(const E in this.binders){const k=this.binders[E];(k instanceof Sr||k instanceof Tr||k instanceof vo)&&k.populatePaintArray(r,d,g,v,M)}}setConstantPatternPositions(r,d){for(const g in this.binders){const v=this.binders[g];v instanceof Wa&&v.setConstantPatternPositions(r,d)}}updatePaintArrays(r,d,g,v,M){let E=!1;for(const k in r){const O=d.getPositions(k);for(const V of O){const H=g.feature(V.index);for(const $ in this.binders){const K=this.binders[$];if((K instanceof Sr||K instanceof Tr||K instanceof vo)&&!0===K.expression.isStateDependent){const Q=v.paint.get($);K.expression=Q.value,K.updatePaintArray(V.start,V.end,H,r[k],M),E=!0}}}}return E}defines(){const r=[];for(const d in this.binders){const g=this.binders[d];(g instanceof Xn||g instanceof Wa)&&r.push(...g.uniformNames.map(v=>`#define HAS_UNIFORM_${v}`))}return r}getBinderAttributes(){const r=[];for(const d in this.binders){const g=this.binders[d];if(g instanceof Sr||g instanceof Tr)for(let v=0;v<g.paintVertexAttributes.length;v++)r.push(g.paintVertexAttributes[v].name);else if(g instanceof vo)for(let v=0;v<Ki.members.length;v++)r.push(Ki.members[v].name)}return r}getBinderUniforms(){const r=[];for(const d in this.binders){const g=this.binders[d];if(g instanceof Xn||g instanceof Wa||g instanceof Tr)for(const v of g.uniformNames)r.push(v)}return r}getPaintVertexBuffers(){return this._buffers}getUniforms(r,d){const g=[];for(const v in this.binders){const M=this.binders[v];if(M instanceof Xn||M instanceof Wa||M instanceof Tr)for(const E of M.uniformNames)if(d[E]){const k=M.getBinding(r,d[E],E);g.push({name:E,property:v,binding:k})}}return g}setUniforms(r,d,g,v){for(const{name:M,property:E,binding:k}of d)this.binders[E].setUniform(k,v,g.get(E),M)}updatePaintBuffers(r){this._buffers=[];for(const d in this.binders){const g=this.binders[d];if(r&&g instanceof vo){const v=2===r.fromScale?g.zoomInPaintVertexBuffer:g.zoomOutPaintVertexBuffer;v&&this._buffers.push(v)}else(g instanceof Sr||g instanceof Tr)&&g.paintVertexBuffer&&this._buffers.push(g.paintVertexBuffer)}}upload(r){for(const d in this.binders){const g=this.binders[d];(g instanceof Sr||g instanceof Tr||g instanceof vo)&&g.upload(r)}this.updatePaintBuffers()}destroy(){for(const r in this.binders){const d=this.binders[r];(d instanceof Sr||d instanceof Tr||d instanceof vo)&&d.destroy()}}}class ha{constructor(r,d,g=(()=>!0)){this.programConfigurations={};for(const v of r)this.programConfigurations[v.id]=new ff(v,d,g);this.needsUpload=!1,this._featureMap=new Rs,this._bufferOffset=0}populatePaintArrays(r,d,g,v,M,E){for(const k in this.programConfigurations)this.programConfigurations[k].populatePaintArrays(r,d,v,M,E);void 0!==d.id&&this._featureMap.add(d.id,g,this._bufferOffset,r),this._bufferOffset=r,this.needsUpload=!0}updatePaintArrays(r,d,g,v){for(const M of g)this.needsUpload=this.programConfigurations[M.id].updatePaintArrays(r,this._featureMap,d,M,v)||this.needsUpload}get(r){return this.programConfigurations[r]}upload(r){if(this.needsUpload){for(const d in this.programConfigurations)this.programConfigurations[d].upload(r);this.needsUpload=!1}}destroy(){for(const r in this.programConfigurations)this.programConfigurations[r].destroy()}}function mf(c,r){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[c]||[c.replace(`${r}-`,"").replace(/-/g,"_")]}function Za(c,r,d){const v={"line-pattern":{source:Ni,composite:Ni},"fill-pattern":{source:Ni,composite:Ni},"fill-extrusion-pattern":{source:Ni,composite:Ni}}[c];return v&&v[d]||{color:{source:a,composite:Ne},number:{source:ce,composite:a}}[r][d]}Gt("ConstantBinder",Xn),Gt("CrossFadedConstantBinder",Wa),Gt("SourceExpressionBinder",Sr),Gt("CrossFadedCompositeBinder",vo),Gt("CompositeExpressionBinder",Tr),Gt("ProgramConfiguration",ff,{omit:["_buffers"]}),Gt("ProgramConfigurationSet",ha);var Cn=8192;const qd=Math.pow(2,14)-1,Ka=-qd-1;function Vl(c){const r=Cn/c.extent,d=c.loadGeometry();for(let g=0;g<d.length;g++){const v=d[g];for(let M=0;M<v.length;M++){const E=v[M],k=Math.round(E.x*r),O=Math.round(E.y*r);E.x=ne(k,Ka,qd),E.y=ne(O,Ka,qd),(k<E.x||k>E.x+1||O<E.y||O>E.y+1)&&Dt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return d}function Xa(c,r){return{type:c.type,id:c.id,properties:c.properties,geometry:r?Vl(c):[]}}function Tc(c,r,d,g,v){c.emplaceBack(2*r+(g+1)/2,2*d+(v+1)/2)}class Nr{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(d=>d.id),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new Zi,this.indexArray=new dr,this.segments=new fn,this.programConfigurations=new ha(r.layers,r.zoom),this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id)}populate(r,d,g){const v=this.layers[0],M=[];let E=null,k=!1;"circle"===v.type&&(E=v.layout.get("circle-sort-key"),k=!E.isConstant());for(const{feature:O,id:V,index:H,sourceLayerIndex:$}of r){const K=this.layers[0]._featureFilter.needGeometry,Q=Xa(O,K);if(!this.layers[0]._featureFilter.filter(new Jt(this.zoom),Q,g))continue;const ee=k?E.evaluate(Q,{},g):void 0,de={id:V,properties:O.properties,type:O.type,sourceLayerIndex:$,index:H,geometry:K?Q.geometry:Vl(O),patterns:{},sortKey:ee};M.push(de)}k&&M.sort((O,V)=>O.sortKey-V.sortKey);for(const O of M){const{geometry:V,index:H,sourceLayerIndex:$}=O,K=r[H].feature;this.addFeature(O,V,H,g),d.featureIndex.insert(K,V,H,$,this.index)}}update(r,d,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,d,this.stateDependentLayers,g)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,Ws),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(r,d,g,v){for(const M of d)for(const E of M){const k=E.x,O=E.y;if(k<0||k>=Cn||O<0||O>=Cn)continue;const V=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,r.sortKey),H=V.vertexLength;Tc(this.layoutVertexArray,k,O,-1,-1),Tc(this.layoutVertexArray,k,O,1,-1),Tc(this.layoutVertexArray,k,O,1,1),Tc(this.layoutVertexArray,k,O,-1,1),this.indexArray.emplaceBack(H,H+1,H+2),this.indexArray.emplaceBack(H,H+3,H+2),V.vertexLength+=4,V.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,g,{},v)}}function Yd(c,r){for(let d=0;d<c.length;d++)if(Eu(r,c[d]))return!0;for(let d=0;d<r.length;d++)if(Eu(c,r[d]))return!0;return!!zl(c,r)}function Wd(c,r,d){return!!Eu(c,r)||!!Qm(r,c,d)}function Mu(c,r){if(1===c.length)return Du(r,c[0]);for(let d=0;d<r.length;d++){const g=r[d];for(let v=0;v<g.length;v++)if(Eu(c,g[v]))return!0}for(let d=0;d<c.length;d++)if(Du(r,c[d]))return!0;for(let d=0;d<r.length;d++)if(zl(c,r[d]))return!0;return!1}function Ac(c,r,d){if(c.length>1){if(zl(c,r))return!0;for(let g=0;g<r.length;g++)if(Qm(r[g],c,d))return!0}for(let g=0;g<c.length;g++)if(Qm(c[g],r,d))return!0;return!1}function zl(c,r){if(0===c.length||0===r.length)return!1;for(let d=0;d<c.length-1;d++){const g=c[d],v=c[d+1];for(let M=0;M<r.length-1;M++)if(Xm(g,v,r[M],r[M+1]))return!0}return!1}function Xm(c,r,d,g){return Ht(c,d,g)!==Ht(r,d,g)&&Ht(c,r,d)!==Ht(c,r,g)}function Qm(c,r,d){const g=d*d;if(1===r.length)return c.distSqr(r[0])<g;for(let v=1;v<r.length;v++)if(gf(c,r[v-1],r[v])<g)return!0;return!1}function gf(c,r,d){const g=r.distSqr(d);if(0===g)return c.distSqr(r);const v=((c.x-r.x)*(d.x-r.x)+(c.y-r.y)*(d.y-r.y))/g;return c.distSqr(v<0?r:v>1?d:d.sub(r)._mult(v)._add(r))}function Du(c,r){let d,g,v,M=!1;for(let E=0;E<c.length;E++){d=c[E];for(let k=0,O=d.length-1;k<d.length;O=k++)g=d[k],v=d[O],g.y>r.y!=v.y>r.y&&r.x<(v.x-g.x)*(r.y-g.y)/(v.y-g.y)+g.x&&(M=!M)}return M}function Eu(c,r){let d=!1;for(let g=0,v=c.length-1;g<c.length;v=g++){const M=c[g],E=c[v];M.y>r.y!=E.y>r.y&&r.x<(E.x-M.x)*(r.y-M.y)/(E.y-M.y)+M.x&&(d=!d)}return d}function Jm(c,r,d){const g=d[0],v=d[2];if(c.x<g.x&&r.x<g.x||c.x>v.x&&r.x>v.x||c.y<g.y&&r.y<g.y||c.y>v.y&&r.y>v.y)return!1;const M=Ht(c,r,d[0]);return M!==Ht(c,r,d[1])||M!==Ht(c,r,d[2])||M!==Ht(c,r,d[3])}function Su(c,r,d){const g=r.paint.get(c).value;return"constant"===g.kind?g.value:d.programConfigurations.get(r.id).getMaxValue(c)}function jl(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function Ks(c,r,d,g,v){if(!r[0]&&!r[1])return c;const M=Oe.convert(r)._mult(v);"viewport"===d&&M._rotate(-g);const E=[];for(let k=0;k<c.length;k++)E.push(c[k].sub(M));return E}Gt("CircleBucket",Nr,{omit:["layers"]});const Zd=new qr({"circle-sort-key":new Mt(Xe.layout_circle["circle-sort-key"])});var Ul={paint:new qr({"circle-radius":new Mt(Xe.paint_circle["circle-radius"]),"circle-color":new Mt(Xe.paint_circle["circle-color"]),"circle-blur":new Mt(Xe.paint_circle["circle-blur"]),"circle-opacity":new Mt(Xe.paint_circle["circle-opacity"]),"circle-translate":new Wt(Xe.paint_circle["circle-translate"]),"circle-translate-anchor":new Wt(Xe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Wt(Xe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Wt(Xe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Mt(Xe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Mt(Xe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Mt(Xe.paint_circle["circle-stroke-opacity"])}),layout:Zd},Hl="undefined"!=typeof Float32Array?Float32Array:Array;function Tu(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function _f(c,r,d){var g=r[0],v=r[1],M=r[2],E=r[3],k=r[4],O=r[5],V=r[6],H=r[7],$=r[8],K=r[9],Q=r[10],ee=r[11],de=r[12],pe=r[13],Ee=r[14],$e=r[15],ze=d[0],Ke=d[1],ct=d[2],rt=d[3];return c[0]=ze*g+Ke*k+ct*$+rt*de,c[1]=ze*v+Ke*O+ct*K+rt*pe,c[2]=ze*M+Ke*V+ct*Q+rt*Ee,c[3]=ze*E+Ke*H+ct*ee+rt*$e,c[4]=(ze=d[4])*g+(Ke=d[5])*k+(ct=d[6])*$+(rt=d[7])*de,c[5]=ze*v+Ke*O+ct*K+rt*pe,c[6]=ze*M+Ke*V+ct*Q+rt*Ee,c[7]=ze*E+Ke*H+ct*ee+rt*$e,c[8]=(ze=d[8])*g+(Ke=d[9])*k+(ct=d[10])*$+(rt=d[11])*de,c[9]=ze*v+Ke*O+ct*K+rt*pe,c[10]=ze*M+Ke*V+ct*Q+rt*Ee,c[11]=ze*E+Ke*H+ct*ee+rt*$e,c[12]=(ze=d[12])*g+(Ke=d[13])*k+(ct=d[14])*$+(rt=d[15])*de,c[13]=ze*v+Ke*O+ct*K+rt*pe,c[14]=ze*M+Ke*V+ct*Q+rt*Ee,c[15]=ze*E+Ke*H+ct*ee+rt*$e,c}Math.hypot||(Math.hypot=function(){for(var c=0,r=arguments.length;r--;)c+=arguments[r]*arguments[r];return Math.sqrt(c)});var Kd=_f;function Au(){var c=new Hl(4);return Hl!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0,c[3]=0),c}function Iu(c,r,d,g){var v=new Hl(4);return v[0]=c,v[1]=r,v[2]=d,v[3]=g,v}function ku(c,r,d){var g=r[0],v=r[1],M=r[2],E=r[3];return c[0]=d[0]*g+d[4]*v+d[8]*M+d[12]*E,c[1]=d[1]*g+d[5]*v+d[9]*M+d[13]*E,c[2]=d[2]*g+d[6]*v+d[10]*M+d[14]*E,c[3]=d[3]*g+d[7]*v+d[11]*M+d[15]*E,c}function Wh(c,r){const d=ku(Au(),Iu(c.x,c.y,0,1),r);return new Oe(d[0]/d[3],d[1]/d[3])}Au();class Fs extends Nr{}Gt("HeatmapBucket",Fs,{omit:["layers"]});var eg={paint:new qr({"heatmap-radius":new Mt(Xe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Mt(Xe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Wt(Xe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ll(Xe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Wt(Xe.paint_heatmap["heatmap-opacity"])})};function pa(c,{width:r,height:d},g,v){if(v){if(v instanceof Uint8ClampedArray)v=new Uint8Array(v.buffer);else if(v.length!==r*d*g)throw new RangeError(`mismatched image size. expected: ${v.length} but got: ${r*d*g}`)}else v=new Uint8Array(r*d*g);return c.width=r,c.height=d,c.data=v,c}function Xd(c,{width:r,height:d},g){if(r===c.width&&d===c.height)return;const v=pa({},{width:r,height:d},g);Ru(c,v,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,r),height:Math.min(c.height,d)},g),c.width=r,c.height=d,c.data=v.data}function Ru(c,r,d,g,v,M){if(0===v.width||0===v.height)return r;if(v.width>c.width||v.height>c.height||d.x>c.width-v.width||d.y>c.height-v.height)throw new RangeError("out of range source coordinates for image copy");if(v.width>r.width||v.height>r.height||g.x>r.width-v.width||g.y>r.height-v.height)throw new RangeError("out of range destination coordinates for image copy");const E=c.data,k=r.data;for(let O=0;O<v.height;O++){const V=((d.y+O)*c.width+d.x)*M,H=((g.y+O)*r.width+g.x)*M;for(let $=0;$<v.width*M;$++)k[H+$]=E[V+$]}return r}class Qa{constructor(r,d){pa(this,r,1,d)}resize(r){Xd(this,r,1)}clone(){return new Qa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,d,g,v,M){Ru(r,d,g,v,M,1)}}class hr{constructor(r,d){pa(this,r,4,d)}resize(r){Xd(this,r,4)}replace(r,d){d?this.data.set(r):this.data=r instanceof Uint8ClampedArray?new Uint8Array(r.buffer):r}clone(){return new hr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,d,g,v,M){Ru(r,d,g,v,M,4)}}function Gl(c){const r={},d=c.resolution||256,g=c.clips?c.clips.length:1,v=c.image||new hr({width:d,height:g}),M=(E,k,O)=>{r[c.evaluationKey]=O;const V=c.expression.evaluate(r);v.data[E+k+0]=Math.floor(255*V.r/V.a),v.data[E+k+1]=Math.floor(255*V.g/V.a),v.data[E+k+2]=Math.floor(255*V.b/V.a),v.data[E+k+3]=Math.floor(255*V.a)};if(c.clips)for(let E=0,k=0;E<g;++E,k+=4*d)for(let O=0,V=0;O<d;O++,V+=4){const H=O/(d-1),{start:$,end:K}=c.clips[E];M(k,V,$*(1-H)+K*H)}else for(let E=0,k=0;E<d;E++,k+=4)M(0,k,E/(d-1));return v}Gt("AlphaImage",Qa),Gt("RGBAImage",hr);var yf={paint:new qr({"hillshade-illumination-direction":new Wt(Xe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Wt(Xe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Wt(Xe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Wt(Xe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Wt(Xe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Wt(Xe.paint_hillshade["hillshade-accent-color"])})};const tg=xn([{name:"a_pos",components:2,type:"Int16"}],4),{members:ig}=tg;var Pu={exports:{}};function Qd(c,r,d){d=d||2;var g,v,M,E,k,O,V,H=r&&r.length,$=H?r[0]*d:c.length,K=Ou(c,0,$,d,!0),Q=[];if(!K||K.next===K.prev)return Q;if(H&&(K=function(de,pe,Ee,$e){var ze,Ke,ct,rt=[];for(ze=0,Ke=pe.length;ze<Ke;ze++)(ct=Ou(de,pe[ze]*$e,ze<Ke-1?pe[ze+1]*$e:de.length,$e,!1))===ct.next&&(ct.steiner=!0),rt.push(Fu(ct));for(rt.sort(Zh),ze=0;ze<rt.length;ze++)Ee=Ls(Ee=Jd(rt[ze],Ee),Ee.next);return Ee}(c,r,K,d)),c.length>80*d){g=M=c[0],v=E=c[1];for(var ee=d;ee<$;ee+=d)(k=c[ee])<g&&(g=k),(O=c[ee+1])<v&&(v=O),k>M&&(M=k),O>E&&(E=O);V=0!==(V=Math.max(M-g,E-v))?1/V:0}return Ja(K,Q,d,g,v,V),Q}function Ou(c,r,d,g,v){var M,E;if(v===Qh(c,r,d,g)>0)for(M=r;M<d;M+=g)E=sg(M,c[M],c[M+1],E);else for(M=d-g;M>=r;M-=g)E=sg(M,c[M],c[M+1],E);return E&&Kh(E,E.next)&&(th(E),E=E.next),E}function Ls(c,r){if(!c)return c;r||(r=c);var d,g=c;do{if(d=!1,g.steiner||!Kh(g,g.next)&&0!==zn(g.prev,g,g.next))g=g.next;else{if(th(g),(g=r=g.prev)===g.next)break;d=!0}}while(d||g!==r);return r}function Ja(c,r,d,g,v,M,E){if(c){!E&&M&&function(H,$,K,Q){var ee=H;do{null===ee.z&&(ee.z=hs(ee.x,ee.y,$,K,Q)),ee.prevZ=ee.prev,ee.nextZ=ee.next,ee=ee.next}while(ee!==H);ee.prevZ.nextZ=null,ee.prevZ=null,function(de){var pe,Ee,$e,ze,Ke,ct,rt,Nt,ei=1;do{for(Ee=de,de=null,Ke=null,ct=0;Ee;){for(ct++,$e=Ee,rt=0,pe=0;pe<ei&&(rt++,$e=$e.nextZ);pe++);for(Nt=ei;rt>0||Nt>0&&$e;)0!==rt&&(0===Nt||!$e||Ee.z<=$e.z)?(ze=Ee,Ee=Ee.nextZ,rt--):(ze=$e,$e=$e.nextZ,Nt--),Ke?Ke.nextZ=ze:de=ze,ze.prevZ=Ke,Ke=ze;Ee=$e}Ke.nextZ=null,ei*=2}while(ct>1)}(ee)}(c,g,v,M);for(var k,O,V=c;c.prev!==c.next;)if(k=c.prev,O=c.next,M?vf(c,g,v,M):ng(c))r.push(k.i/d),r.push(c.i/d),r.push(O.i/d),th(c),c=O.next,V=O.next;else if((c=O)===V){E?1===E?Ja(c=rg(Ls(c),r,d),r,d,g,v,M,2):2===E&&A0(c,r,d,g,v,M):Ja(Ls(c),r,d,g,v,M,1);break}}}function ng(c){var r=c.prev,d=c,g=c.next;if(zn(r,d,g)>=0)return!1;for(var v=c.next.next;v!==c.prev;){if(el(r.x,r.y,d.x,d.y,g.x,g.y,v.x,v.y)&&zn(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function vf(c,r,d,g){var v=c.prev,M=c,E=c.next;if(zn(v,M,E)>=0)return!1;for(var k=v.x>M.x?v.x>E.x?v.x:E.x:M.x>E.x?M.x:E.x,O=v.y>M.y?v.y>E.y?v.y:E.y:M.y>E.y?M.y:E.y,V=hs(v.x<M.x?v.x<E.x?v.x:E.x:M.x<E.x?M.x:E.x,v.y<M.y?v.y<E.y?v.y:E.y:M.y<E.y?M.y:E.y,r,d,g),H=hs(k,O,r,d,g),$=c.prevZ,K=c.nextZ;$&&$.z>=V&&K&&K.z<=H;){if($!==c.prev&&$!==c.next&&el(v.x,v.y,M.x,M.y,E.x,E.y,$.x,$.y)&&zn($.prev,$,$.next)>=0||($=$.prevZ,K!==c.prev&&K!==c.next&&el(v.x,v.y,M.x,M.y,E.x,E.y,K.x,K.y)&&zn(K.prev,K,K.next)>=0))return!1;K=K.nextZ}for(;$&&$.z>=V;){if($!==c.prev&&$!==c.next&&el(v.x,v.y,M.x,M.y,E.x,E.y,$.x,$.y)&&zn($.prev,$,$.next)>=0)return!1;$=$.prevZ}for(;K&&K.z<=H;){if(K!==c.prev&&K!==c.next&&el(v.x,v.y,M.x,M.y,E.x,E.y,K.x,K.y)&&zn(K.prev,K,K.next)>=0)return!1;K=K.nextZ}return!0}function rg(c,r,d){var g=c;do{var v=g.prev,M=g.next.next;!Kh(v,M)&&og(v,g,g.next,M)&&$l(v,M)&&$l(M,v)&&(r.push(v.i/d),r.push(g.i/d),r.push(M.i/d),th(g),th(g.next),g=c=M),g=g.next}while(g!==c);return Ls(g)}function A0(c,r,d,g,v,M){var E=c;do{for(var k=E.next.next;k!==E.prev;){if(E.i!==k.i&&eh(E,k)){var O=Lu(E,k);return E=Ls(E,E.next),O=Ls(O,O.next),Ja(E,r,d,g,v,M),void Ja(O,r,d,g,v,M)}k=k.next}E=E.next}while(E!==c)}function Zh(c,r){return c.x-r.x}function Jd(c,r){var d=function(M,E){var k,O=E,V=M.x,H=M.y,$=-1/0;do{if(H<=O.y&&H>=O.next.y&&O.next.y!==O.y){var K=O.x+(H-O.y)*(O.next.x-O.x)/(O.next.y-O.y);if(K<=V&&K>$){if($=K,K===V){if(H===O.y)return O;if(H===O.next.y)return O.next}k=O.x<O.next.x?O:O.next}}O=O.next}while(O!==E);if(!k)return null;if(V===$)return k;var Q,ee=k,de=k.x,pe=k.y,Ee=1/0;O=k;do{V>=O.x&&O.x>=de&&V!==O.x&&el(H<pe?V:$,H,de,pe,H<pe?$:V,H,O.x,O.y)&&(Q=Math.abs(H-O.y)/(V-O.x),$l(O,M)&&(Q<Ee||Q===Ee&&(O.x>k.x||O.x===k.x&&bf(k,O)))&&(k=O,Ee=Q)),O=O.next}while(O!==ee);return k}(c,r);if(!d)return r;var g=Lu(d,c),v=Ls(d,d.next);return Ls(g,g.next),r===d?v:r}function bf(c,r){return zn(c.prev,c,r.prev)<0&&zn(r.next,c,c.next)<0}function hs(c,r,d,g,v){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=32767*(c-d)*v)|c<<8))|c<<4))|c<<2))|c<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=32767*(r-g)*v)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function Fu(c){var r=c,d=c;do{(r.x<d.x||r.x===d.x&&r.y<d.y)&&(d=r),r=r.next}while(r!==c);return d}function el(c,r,d,g,v,M,E,k){return(v-E)*(r-k)-(c-E)*(M-k)>=0&&(c-E)*(g-k)-(d-E)*(r-k)>=0&&(d-E)*(M-k)-(v-E)*(g-k)>=0}function eh(c,r){return c.next.i!==r.i&&c.prev.i!==r.i&&!function(d,g){var v=d;do{if(v.i!==d.i&&v.next.i!==d.i&&v.i!==g.i&&v.next.i!==g.i&&og(v,v.next,d,g))return!0;v=v.next}while(v!==d);return!1}(c,r)&&($l(c,r)&&$l(r,c)&&function(d,g){var v=d,M=!1,E=(d.x+g.x)/2,k=(d.y+g.y)/2;do{v.y>k!=v.next.y>k&&v.next.y!==v.y&&E<(v.next.x-v.x)*(k-v.y)/(v.next.y-v.y)+v.x&&(M=!M),v=v.next}while(v!==d);return M}(c,r)&&(zn(c.prev,c,r.prev)||zn(c,r.prev,r))||Kh(c,r)&&zn(c.prev,c,c.next)>0&&zn(r.prev,r,r.next)>0)}function zn(c,r,d){return(r.y-c.y)*(d.x-r.x)-(r.x-c.x)*(d.y-r.y)}function Kh(c,r){return c.x===r.x&&c.y===r.y}function og(c,r,d,g){var v=Ic(zn(c,r,d)),M=Ic(zn(c,r,g)),E=Ic(zn(d,g,c)),k=Ic(zn(d,g,r));return v!==M&&E!==k||!(0!==v||!Xh(c,d,r))||!(0!==M||!Xh(c,g,r))||!(0!==E||!Xh(d,c,g))||!(0!==k||!Xh(d,r,g))}function Xh(c,r,d){return r.x<=Math.max(c.x,d.x)&&r.x>=Math.min(c.x,d.x)&&r.y<=Math.max(c.y,d.y)&&r.y>=Math.min(c.y,d.y)}function Ic(c){return c>0?1:c<0?-1:0}function $l(c,r){return zn(c.prev,c,c.next)<0?zn(c,r,c.next)>=0&&zn(c,c.prev,r)>=0:zn(c,r,c.prev)<0||zn(c,c.next,r)<0}function Lu(c,r){var d=new Bu(c.i,c.x,c.y),g=new Bu(r.i,r.x,r.y),v=c.next,M=r.prev;return c.next=r,r.prev=c,d.next=v,v.prev=d,g.next=d,d.prev=g,M.next=g,g.prev=M,g}function sg(c,r,d,g){var v=new Bu(c,r,d);return g?(v.next=g.next,v.prev=g,g.next.prev=v,g.next=v):(v.prev=v,v.next=v),v}function th(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function Bu(c,r,d){this.i=c,this.x=r,this.y=d,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Qh(c,r,d,g){for(var v=0,M=r,E=d-g;M<d;M+=g)v+=(c[E]-c[M])*(c[M+1]+c[E+1]),E=M;return v}Pu.exports=Qd,Pu.exports.default=Qd,Qd.deviation=function(c,r,d,g){var v=r&&r.length,M=Math.abs(Qh(c,0,v?r[0]*d:c.length,d));if(v)for(var E=0,k=r.length;E<k;E++)M-=Math.abs(Qh(c,r[E]*d,E<k-1?r[E+1]*d:c.length,d));var O=0;for(E=0;E<g.length;E+=3){var V=g[E]*d,H=g[E+1]*d,$=g[E+2]*d;O+=Math.abs((c[V]-c[$])*(c[H+1]-c[V+1])-(c[V]-c[H])*(c[$+1]-c[V+1]))}return 0===M&&0===O?0:Math.abs((O-M)/M)},Qd.flatten=function(c){for(var r=c[0][0].length,d={vertices:[],holes:[],dimensions:r},g=0,v=0;v<c.length;v++){for(var M=0;M<c[v].length;M++)for(var E=0;E<r;E++)d.vertices.push(c[v][M][E]);v>0&&d.holes.push(g+=c[v-1].length)}return d};var ih=Pu.exports;function ag(c,r,d,g,v){xf(c,r,d||0,g||c.length-1,v||nh)}function xf(c,r,d,g,v){for(;g>d;){if(g-d>600){var M=g-d+1,E=r-d+1,k=Math.log(M),O=.5*Math.exp(2*k/3),V=.5*Math.sqrt(k*O*(M-O)/M)*(E-M/2<0?-1:1);xf(c,r,Math.max(d,Math.floor(r-E*O/M+V)),Math.min(g,Math.floor(r+(M-E)*O/M+V)),v)}var H=c[r],$=d,K=g;for(kc(c,d,r),v(c[g],H)>0&&kc(c,d,g);$<K;){for(kc(c,$,K),$++,K--;v(c[$],H)<0;)$++;for(;v(c[K],H)>0;)K--}0===v(c[d],H)?kc(c,d,K):kc(c,++K,g),K<=r&&(d=K+1),r<=K&&(g=K-1)}}function kc(c,r,d){var g=c[r];c[r]=c[d],c[d]=g}function nh(c,r){return c<r?-1:c>r?1:0}function Nu(c,r){const d=c.length;if(d<=1)return[c];const g=[];let v,M;for(let E=0;E<d;E++){const k=$t(c[E]);0!==k&&(c[E].area=Math.abs(k),void 0===M&&(M=k<0),M===k<0?(v&&g.push(v),v=[c[E]]):v.push(c[E]))}if(v&&g.push(v),r>1)for(let E=0;E<g.length;E++)g[E].length<=r||(ag(g[E],r,1,g[E].length-1,Jh),g[E]=g[E].slice(0,r));return g}function Jh(c,r){return r.area-c.area}function zo(c,r,d){const g=d.patternDependencies;let v=!1;for(const M of r){const E=M.paint.get(`${c}-pattern`);E.isConstant()||(v=!0);const k=E.constantOr(null);k&&(v=!0,g[k.to]=!0,g[k.from]=!0)}return v}function jn(c,r,d,g,v){const M=v.patternDependencies;for(const E of r){const k=E.paint.get(`${c}-pattern`).value;if("constant"!==k.kind){let O=k.evaluate({zoom:g-1},d,{},v.availableImages),V=k.evaluate({zoom:g},d,{},v.availableImages),H=k.evaluate({zoom:g+1},d,{},v.availableImages);O=O&&O.name?O.name:O,V=V&&V.name?V.name:V,H=H&&H.name?H.name:H,M[O]=!0,M[V]=!0,M[H]=!0,d.patterns[E.id]={min:O,mid:V,max:H}}}return d}class ql{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(d=>d.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new mi,this.indexArray=new dr,this.indexArray2=new us,this.programConfigurations=new ha(r.layers,r.zoom),this.segments=new fn,this.segments2=new fn,this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id)}populate(r,d,g){this.hasPattern=zo("fill",this.layers,d);const v=this.layers[0].layout.get("fill-sort-key"),M=!v.isConstant(),E=[];for(const{feature:k,id:O,index:V,sourceLayerIndex:H}of r){const $=this.layers[0]._featureFilter.needGeometry,K=Xa(k,$);if(!this.layers[0]._featureFilter.filter(new Jt(this.zoom),K,g))continue;const Q=M?v.evaluate(K,{},g,d.availableImages):void 0,ee={id:O,properties:k.properties,type:k.type,sourceLayerIndex:H,index:V,geometry:$?K.geometry:Vl(k),patterns:{},sortKey:Q};E.push(ee)}M&&E.sort((k,O)=>k.sortKey-O.sortKey);for(const k of E){const{geometry:O,index:V,sourceLayerIndex:H}=k;if(this.hasPattern){const $=jn("fill",this.layers,k,this.zoom,d);this.patternFeatures.push($)}else this.addFeature(k,O,V,g,{});d.featureIndex.insert(r[V].feature,O,V,H,this.index)}}update(r,d,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,d,this.stateDependentLayers,g)}addFeatures(r,d,g){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,d,g)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,ig),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.indexBuffer2=r.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(r,d,g,v,M){for(const E of Nu(d,500)){let k=0;for(const Q of E)k+=Q.length;const O=this.segments.prepareSegment(k,this.layoutVertexArray,this.indexArray),V=O.vertexLength,H=[],$=[];for(const Q of E){if(0===Q.length)continue;Q!==E[0]&&$.push(H.length/2);const ee=this.segments2.prepareSegment(Q.length,this.layoutVertexArray,this.indexArray2),de=ee.vertexLength;this.layoutVertexArray.emplaceBack(Q[0].x,Q[0].y),this.indexArray2.emplaceBack(de+Q.length-1,de),H.push(Q[0].x),H.push(Q[0].y);for(let pe=1;pe<Q.length;pe++)this.layoutVertexArray.emplaceBack(Q[pe].x,Q[pe].y),this.indexArray2.emplaceBack(de+pe-1,de+pe),H.push(Q[pe].x),H.push(Q[pe].y);ee.vertexLength+=Q.length,ee.primitiveLength+=Q.length}const K=ih(H,$);for(let Q=0;Q<K.length;Q+=3)this.indexArray.emplaceBack(V+K[Q],V+K[Q+1],V+K[Q+2]);O.vertexLength+=k,O.primitiveLength+=K.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,g,M,v)}}Gt("FillBucket",ql,{omit:["layers","patternFeatures"]});const ep=new qr({"fill-sort-key":new Mt(Xe.layout_fill["fill-sort-key"])});var tp={paint:new qr({"fill-antialias":new Wt(Xe.paint_fill["fill-antialias"]),"fill-opacity":new Mt(Xe.paint_fill["fill-opacity"]),"fill-color":new Mt(Xe.paint_fill["fill-color"]),"fill-outline-color":new Mt(Xe.paint_fill["fill-outline-color"]),"fill-translate":new Wt(Xe.paint_fill["fill-translate"]),"fill-translate-anchor":new Wt(Xe.paint_fill["fill-translate-anchor"]),"fill-pattern":new No(Xe.paint_fill["fill-pattern"])}),layout:ep};const wf=xn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),{members:ip}=wf;var tl={},lg=Oe,Vu=Rc;function Rc(c,r,d,g,v){this.properties={},this.extent=d,this.type=0,this._pbf=c,this._geometry=-1,this._keys=g,this._values=v,c.readFields(cg,this,r)}function cg(c,r,d){1==c?r.id=d.readVarint():2==c?function(g,v){for(var M=g.readVarint()+g.pos;g.pos<M;){var E=v._keys[g.readVarint()],k=v._values[g.readVarint()];v.properties[E]=k}}(d,r):3==c?r.type=d.readVarint():4==c&&(r._geometry=d.pos)}function ug(c){for(var r,d,g=0,v=0,M=c.length,E=M-1;v<M;E=v++)g+=((d=c[E]).x-(r=c[v]).x)*(r.y+d.y);return g}Rc.types=["Unknown","Point","LineString","Polygon"],Rc.prototype.loadGeometry=function(){var c=this._pbf;c.pos=this._geometry;for(var r,d=c.readVarint()+c.pos,g=1,v=0,M=0,E=0,k=[];c.pos<d;){if(v<=0){var O=c.readVarint();g=7&O,v=O>>3}if(v--,1===g||2===g)M+=c.readSVarint(),E+=c.readSVarint(),1===g&&(r&&k.push(r),r=[]),r.push(new lg(M,E));else{if(7!==g)throw new Error("unknown command "+g);r&&r.push(r[0].clone())}}return r&&k.push(r),k},Rc.prototype.bbox=function(){var c=this._pbf;c.pos=this._geometry;for(var r=c.readVarint()+c.pos,d=1,g=0,v=0,M=0,E=1/0,k=-1/0,O=1/0,V=-1/0;c.pos<r;){if(g<=0){var H=c.readVarint();d=7&H,g=H>>3}if(g--,1===d||2===d)(v+=c.readSVarint())<E&&(E=v),v>k&&(k=v),(M+=c.readSVarint())<O&&(O=M),M>V&&(V=M);else if(7!==d)throw new Error("unknown command "+d)}return[E,O,k,V]},Rc.prototype.toGeoJSON=function(c,r,d){var g,v,M=this.extent*Math.pow(2,d),E=this.extent*c,k=this.extent*r,O=this.loadGeometry(),V=Rc.types[this.type];function H(Q){for(var ee=0;ee<Q.length;ee++){var de=Q[ee];Q[ee]=[360*(de.x+E)/M-180,360/Math.PI*Math.atan(Math.exp((180-360*(de.y+k)/M)*Math.PI/180))-90]}}switch(this.type){case 1:var $=[];for(g=0;g<O.length;g++)$[g]=O[g][0];H(O=$);break;case 2:for(g=0;g<O.length;g++)H(O[g]);break;case 3:for(O=function(Q){var ee=Q.length;if(ee<=1)return[Q];for(var de,pe,Ee=[],$e=0;$e<ee;$e++){var ze=ug(Q[$e]);0!==ze&&(void 0===pe&&(pe=ze<0),pe===ze<0?(de&&Ee.push(de),de=[Q[$e]]):de.push(Q[$e]))}return de&&Ee.push(de),Ee}(O),g=0;g<O.length;g++)for(v=0;v<O[g].length;v++)H(O[g][v])}1===O.length?O=O[0]:V="Multi"+V;var K={type:"Feature",geometry:{type:V,coordinates:O},properties:this.properties};return"id"in this&&(K.id=this.id),K};var Pc=Vu,Tn=fa;function fa(c,r){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(Cf,this,r),this.length=this._features.length}function Cf(c,r,d){15===c?r.version=d.readVarint():1===c?r.name=d.readString():5===c?r.extent=d.readVarint():2===c?r._features.push(d.pos):3===c?r._keys.push(d.readString()):4===c&&r._values.push(function(g){for(var v=null,M=g.readVarint()+g.pos;g.pos<M;){var E=g.readVarint()>>3;v=1===E?g.readString():2===E?g.readFloat():3===E?g.readDouble():4===E?g.readVarint64():5===E?g.readVarint():6===E?g.readSVarint():7===E?g.readBoolean():null}return v}(d))}fa.prototype.feature=function(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];var r=this._pbf.readVarint()+this._pbf.pos;return new Pc(this._pbf,r,this.extent,this._keys,this._values)};var Mf=Tn;function Zr(c,r,d){if(3===c){var g=new Mf(d,d.readVarint()+d.pos);g.length&&(r[g.name]=g)}}tl.VectorTile=function(c,r){this.layers=c.readFields(Zr,{},r)},tl.VectorTileFeature=Vu,tl.VectorTileLayer=Tn;const zu=tl.VectorTileFeature.types,Oc=Math.pow(2,13);function il(c,r,d,g,v,M,E,k){c.emplaceBack(r,d,2*Math.floor(g*Oc)+E,v*Oc*2,M*Oc*2,Math.round(k))}class np{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(d=>d.id),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new Ii,this.indexArray=new dr,this.programConfigurations=new ha(r.layers,r.zoom),this.segments=new fn,this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id)}populate(r,d,g){this.features=[],this.hasPattern=zo("fill-extrusion",this.layers,d);for(const{feature:v,id:M,index:E,sourceLayerIndex:k}of r){const O=this.layers[0]._featureFilter.needGeometry,V=Xa(v,O);if(!this.layers[0]._featureFilter.filter(new Jt(this.zoom),V,g))continue;const H={id:M,sourceLayerIndex:k,index:E,geometry:O?V.geometry:Vl(v),properties:v.properties,type:v.type,patterns:{}};this.hasPattern?this.features.push(jn("fill-extrusion",this.layers,H,this.zoom,d)):this.addFeature(H,H.geometry,E,g,{}),d.featureIndex.insert(v,H.geometry,E,k,this.index,!0)}}addFeatures(r,d,g){for(const v of this.features){const{geometry:M}=v;this.addFeature(v,M,v.index,d,g)}}update(r,d,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,d,this.stateDependentLayers,g)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,ip),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(r,d,g,v,M){for(const E of Nu(d,500)){let k=0;for(const Q of E)k+=Q.length;let O=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const Q of E){if(0===Q.length||((c=Q).every(r=>r.x<0)||c.every(r=>r.x>Cn)||c.every(r=>r.y<0)||c.every(r=>r.y>Cn)))continue;let ee=0;for(let de=0;de<Q.length;de++){const pe=Q[de];if(de>=1){const Ee=Q[de-1];if(!Df(pe,Ee)){O.vertexLength+4>fn.MAX_VERTEX_ARRAY_LENGTH&&(O=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const $e=pe.sub(Ee)._perp()._unit(),ze=Ee.dist(pe);ee+ze>32768&&(ee=0),il(this.layoutVertexArray,pe.x,pe.y,$e.x,$e.y,0,0,ee),il(this.layoutVertexArray,pe.x,pe.y,$e.x,$e.y,0,1,ee),ee+=ze,il(this.layoutVertexArray,Ee.x,Ee.y,$e.x,$e.y,0,0,ee),il(this.layoutVertexArray,Ee.x,Ee.y,$e.x,$e.y,0,1,ee);const Ke=O.vertexLength;this.indexArray.emplaceBack(Ke,Ke+2,Ke+1),this.indexArray.emplaceBack(Ke+1,Ke+2,Ke+3),O.vertexLength+=4,O.primitiveLength+=2}}}}if(O.vertexLength+k>fn.MAX_VERTEX_ARRAY_LENGTH&&(O=this.segments.prepareSegment(k,this.layoutVertexArray,this.indexArray)),"Polygon"!==zu[r.type])continue;const V=[],H=[],$=O.vertexLength;for(const Q of E)if(0!==Q.length){Q!==E[0]&&H.push(V.length/2);for(let ee=0;ee<Q.length;ee++){const de=Q[ee];il(this.layoutVertexArray,de.x,de.y,0,0,1,1,0),V.push(de.x),V.push(de.y)}}const K=ih(V,H);for(let Q=0;Q<K.length;Q+=3)this.indexArray.emplaceBack($+K[Q],$+K[Q+2],$+K[Q+1]);O.primitiveLength+=K.length/3,O.vertexLength+=k}var c;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,g,M,v)}}function Df(c,r){return c.x===r.x&&(c.x<0||c.x>Cn)||c.y===r.y&&(c.y<0||c.y>Cn)}Gt("FillExtrusionBucket",np,{omit:["layers","features"]});var Ef={paint:new qr({"fill-extrusion-opacity":new Wt(Xe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Mt(Xe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Wt(Xe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Wt(Xe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new No(Xe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Mt(Xe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Mt(Xe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Wt(Xe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function Fc(c,r){return c.x*r.x+c.y*r.y}function op(c,r){if(1===c.length){let d=0;const g=r[d++];let v;for(;!v||g.equals(v);)if(v=r[d++],!v)return 1/0;for(;d<r.length;d++){const M=r[d],E=c[0],k=v.sub(g),O=M.sub(g),V=E.sub(g),H=Fc(k,k),$=Fc(k,O),K=Fc(O,O),Q=Fc(V,k),ee=Fc(V,O),de=H*K-$*$,pe=(K*Q-$*ee)/de,Ee=(H*ee-$*Q)/de,$e=g.z*(1-pe-Ee)+v.z*pe+M.z*Ee;if(isFinite($e))return $e}return 1/0}{let d=1/0;for(const g of r)d=Math.min(d,g.z);return d}}const dg=xn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:hg}=dg,sp=xn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Sf}=sp,rh=tl.VectorTileFeature.types,oh=Math.cos(Math.PI/180*37.5),Tf=Math.pow(2,14)/.5;class sh{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(d=>d.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(d=>{this.gradients[d.id]={}}),this.layoutVertexArray=new wn,this.layoutVertexArray2=new Si,this.indexArray=new dr,this.programConfigurations=new ha(r.layers,r.zoom),this.segments=new fn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id)}populate(r,d,g){this.hasPattern=zo("line",this.layers,d);const v=this.layers[0].layout.get("line-sort-key"),M=!v.isConstant(),E=[];for(const{feature:k,id:O,index:V,sourceLayerIndex:H}of r){const $=this.layers[0]._featureFilter.needGeometry,K=Xa(k,$);if(!this.layers[0]._featureFilter.filter(new Jt(this.zoom),K,g))continue;const Q=M?v.evaluate(K,{},g):void 0,ee={id:O,properties:k.properties,type:k.type,sourceLayerIndex:H,index:V,geometry:$?K.geometry:Vl(k),patterns:{},sortKey:Q};E.push(ee)}M&&E.sort((k,O)=>k.sortKey-O.sortKey);for(const k of E){const{geometry:O,index:V,sourceLayerIndex:H}=k;if(this.hasPattern){const $=jn("line",this.layers,k,this.zoom,d);this.patternFeatures.push($)}else this.addFeature(k,O,V,g,{});d.featureIndex.insert(r[V].feature,O,V,H,this.index)}}update(r,d,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,d,this.stateDependentLayers,g)}addFeatures(r,d,g){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,d,g)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=r.createVertexBuffer(this.layoutVertexArray2,Sf)),this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,hg),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(r){if(r.properties&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_end"))return{start:+r.properties.mapbox_clip_start,end:+r.properties.mapbox_clip_end}}addFeature(r,d,g,v,M){const E=this.layers[0].layout,k=E.get("line-join").evaluate(r,{}),O=E.get("line-cap"),V=E.get("line-miter-limit"),H=E.get("line-round-limit");this.lineClips=this.lineFeatureClips(r);for(const $ of d)this.addLine($,r,k,O,V,H);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,g,M,v)}addLine(r,d,g,v,M,E){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Ee=0;Ee<r.length-1;Ee++)this.totalDistance+=r[Ee].dist(r[Ee+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const k="Polygon"===rh[d.type];let O=r.length;for(;O>=2&&r[O-1].equals(r[O-2]);)O--;let V=0;for(;V<O-1&&r[V].equals(r[V+1]);)V++;if(O<(k?3:2))return;"bevel"===g&&(M=1.05);const H=this.overscaling<=16?122880/(512*this.overscaling):0,$=this.segments.prepareSegment(10*O,this.layoutVertexArray,this.indexArray);let K,Q,ee,de,pe;this.e1=this.e2=-1,k&&(K=r[O-2],pe=r[V].sub(K)._unit()._perp());for(let Ee=V;Ee<O;Ee++){if(ee=Ee===O-1?k?r[V+1]:void 0:r[Ee+1],ee&&r[Ee].equals(ee))continue;pe&&(de=pe),K&&(Q=K),K=r[Ee],pe=ee?ee.sub(K)._unit()._perp():de,de=de||pe;let $e=de.add(pe);0===$e.x&&0===$e.y||$e._unit();const ze=de.x*pe.x+de.y*pe.y,Ke=$e.x*pe.x+$e.y*pe.y,ct=0!==Ke?1/Ke:1/0,rt=2*Math.sqrt(2-2*Ke),Nt=Ke<oh&&Q&&ee,ei=de.x*pe.y-de.y*pe.x>0;if(Nt&&Ee>V){const It=K.dist(Q);if(It>2*H){const jt=K.sub(K.sub(Q)._mult(H/It)._round());this.updateDistance(Q,jt),this.addCurrentVertex(jt,de,0,0,$),Q=jt}}const Vt=Q&&ee;let Bt=Vt?g:k?"butt":v;if(Vt&&"round"===Bt&&(ct<E?Bt="miter":ct<=2&&(Bt="fakeround")),"miter"===Bt&&ct>M&&(Bt="bevel"),"bevel"===Bt&&(ct>2&&(Bt="flipbevel"),ct<M&&(Bt="miter")),Q&&this.updateDistance(Q,K),"miter"===Bt)$e._mult(ct),this.addCurrentVertex(K,$e,0,0,$);else if("flipbevel"===Bt){if(ct>100)$e=pe.mult(-1);else{const It=ct*de.add(pe).mag()/de.sub(pe).mag();$e._perp()._mult(It*(ei?-1:1))}this.addCurrentVertex(K,$e,0,0,$),this.addCurrentVertex(K,$e.mult(-1),0,0,$)}else if("bevel"===Bt||"fakeround"===Bt){const It=-Math.sqrt(ct*ct-1),jt=ei?It:0,Lt=ei?0:It;if(Q&&this.addCurrentVertex(K,de,jt,Lt,$),"fakeround"===Bt){const _t=Math.round(180*rt/Math.PI/20);for(let hi=1;hi<_t;hi++){let li=hi/_t;if(.5!==li){const cn=li-.5;li+=li*cn*(li-1)*((1.0904+ze*(ze*(3.55645-1.43519*ze)-3.2452))*cn*cn+(.848013+ze*(.215638*ze-1.06021)))}const Gi=pe.sub(de)._mult(li)._add(de)._unit()._mult(ei?-1:1);this.addHalfVertex(K,Gi.x,Gi.y,!1,ei,0,$)}}ee&&this.addCurrentVertex(K,pe,-jt,-Lt,$)}else if("butt"===Bt)this.addCurrentVertex(K,$e,0,0,$);else if("square"===Bt){const It=Q?1:-1;this.addCurrentVertex(K,$e,It,It,$)}else"round"===Bt&&(Q&&(this.addCurrentVertex(K,de,0,0,$),this.addCurrentVertex(K,de,1,1,$,!0)),ee&&(this.addCurrentVertex(K,pe,-1,-1,$,!0),this.addCurrentVertex(K,pe,0,0,$)));if(Nt&&Ee<O-1){const It=K.dist(ee);if(It>2*H){const jt=K.add(ee.sub(K)._mult(H/It)._round());this.updateDistance(K,jt),this.addCurrentVertex(jt,pe,0,0,$),K=jt}}}}addCurrentVertex(r,d,g,v,M,E=!1){const k=d.y*v-d.x,O=-d.y-d.x*v;this.addHalfVertex(r,d.x+d.y*g,d.y-d.x*g,E,!1,g,M),this.addHalfVertex(r,k,O,E,!0,-v,M),this.distance>Tf/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(r,d,g,v,M,E))}addHalfVertex({x:r,y:d},g,v,M,E,k,O){const V=.5*(this.lineClips?this.scaledDistance*(Tf-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((r<<1)+(M?1:0),(d<<1)+(E?1:0),Math.round(63*g)+128,Math.round(63*v)+128,1+(0===k?0:k<0?-1:1)|(63&V)<<2,V>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const H=O.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,H),O.primitiveLength++),E?this.e2=H:this.e1=H}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(r,d){this.distance+=r.dist(d),this.updateScaledDistance()}}Gt("LineBucket",sh,{omit:["layers","patternFeatures"]});const ah=new qr({"line-cap":new Wt(Xe.layout_line["line-cap"]),"line-join":new Mt(Xe.layout_line["line-join"]),"line-miter-limit":new Wt(Xe.layout_line["line-miter-limit"]),"line-round-limit":new Wt(Xe.layout_line["line-round-limit"]),"line-sort-key":new Mt(Xe.layout_line["line-sort-key"])});var Af={paint:new qr({"line-opacity":new Mt(Xe.paint_line["line-opacity"]),"line-color":new Mt(Xe.paint_line["line-color"]),"line-translate":new Wt(Xe.paint_line["line-translate"]),"line-translate-anchor":new Wt(Xe.paint_line["line-translate-anchor"]),"line-width":new Mt(Xe.paint_line["line-width"]),"line-gap-width":new Mt(Xe.paint_line["line-gap-width"]),"line-offset":new Mt(Xe.paint_line["line-offset"]),"line-blur":new Mt(Xe.paint_line["line-blur"]),"line-dasharray":new Ys(Xe.paint_line["line-dasharray"]),"line-pattern":new No(Xe.paint_line["line-pattern"]),"line-gradient":new Ll(Xe.paint_line["line-gradient"])}),layout:ah};const If=new class extends Mt{possiblyEvaluate(c,r){return r=new Jt(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),super.possiblyEvaluate(c,r)}evaluate(c,r,d,g){return r=ke({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(c,r,d,g)}}(Af.paint.properties["line-width"].specification);function kf(c,r){return r>0?r+2*c:c}If.useIntegerZoom=!0;const pg=xn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),fg=xn([{name:"a_projected_pos",components:3,type:"Float32"}],4);xn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const ps=xn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);xn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const ap=xn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Rf=xn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function mg(c,r,d){return c.sections.forEach(g=>{g.text=function(v,M,E){const k=M.layout.get("text-transform").evaluate(E,{});return"uppercase"===k?v=v.toLocaleUpperCase():"lowercase"===k&&(v=v.toLocaleLowerCase()),tr.applyArabicShaping&&(v=tr.applyArabicShaping(v)),v}(g.text,r,d)}),c}xn([{name:"triangle",components:3,type:"Uint16"}]),xn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),xn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),xn([{type:"Float32",name:"offsetX"}]),xn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const ju={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};var Pi=Xi,Ao=function(c,r,d,g,v){var M,E,k=8*v-g-1,O=(1<<k)-1,V=O>>1,H=-7,$=d?v-1:0,K=d?-1:1,Q=c[r+$];for($+=K,M=Q&(1<<-H)-1,Q>>=-H,H+=k;H>0;M=256*M+c[r+$],$+=K,H-=8);for(E=M&(1<<-H)-1,M>>=-H,H+=g;H>0;E=256*E+c[r+$],$+=K,H-=8);if(0===M)M=1-V;else{if(M===O)return E?NaN:1/0*(Q?-1:1);E+=Math.pow(2,g),M-=V}return(Q?-1:1)*E*Math.pow(2,M-g)},Pf=function(c,r,d,g,v,M){var E,k,O,V=8*M-v-1,H=(1<<V)-1,$=H>>1,K=23===v?Math.pow(2,-24)-Math.pow(2,-77):0,Q=g?0:M-1,ee=g?1:-1,de=r<0||0===r&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(k=isNaN(r)?1:0,E=H):(E=Math.floor(Math.log(r)/Math.LN2),r*(O=Math.pow(2,-E))<1&&(E--,O*=2),(r+=E+$>=1?K/O:K*Math.pow(2,1-$))*O>=2&&(E++,O/=2),E+$>=H?(k=0,E=H):E+$>=1?(k=(r*O-1)*Math.pow(2,v),E+=$):(k=r*Math.pow(2,$-1)*Math.pow(2,v),E=0));v>=8;c[d+Q]=255&k,Q+=ee,k/=256,v-=8);for(E=E<<v|k,V+=v;V>0;c[d+Q]=255&E,Q+=ee,E/=256,V-=8);c[d+Q-ee]|=128*de};function Xi(c){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(c)?c:new Uint8Array(c||0),this.pos=0,this.type=0,this.length=this.buf.length}Xi.Varint=0,Xi.Fixed64=1,Xi.Bytes=2,Xi.Fixed32=5;var en,nl=4294967296,My=1/nl,ki="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function di(c){return c.type===Xi.Bytes?c.readVarint()+c.pos:c.pos+1}function Yl(c,r,d){var g=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));d.realloc(g);for(var v=d.pos-1;v>=c;v--)d.buf[v+g]=d.buf[v]}function zr(c,r){for(var d=0;d<c.length;d++)r.writeVarint(c[d])}function gg(c,r){for(var d=0;d<c.length;d++)r.writeSVarint(c[d])}function fs(c,r){for(var d=0;d<c.length;d++)r.writeFloat(c[d])}function ji(c,r){for(var d=0;d<c.length;d++)r.writeDouble(c[d])}function Of(c,r){for(var d=0;d<c.length;d++)r.writeBoolean(c[d])}function Ff(c,r){for(var d=0;d<c.length;d++)r.writeFixed32(c[d])}function Uu(c,r){for(var d=0;d<c.length;d++)r.writeSFixed32(c[d])}function lp(c,r){for(var d=0;d<c.length;d++)r.writeFixed64(c[d])}function Lf(c,r){for(var d=0;d<c.length;d++)r.writeSFixed64(c[d])}function cp(c,r){return(c[r]|c[r+1]<<8|c[r+2]<<16)+16777216*c[r+3]}function bo(c,r,d){c[d]=r,c[d+1]=r>>>8,c[d+2]=r>>>16,c[d+3]=r>>>24}function Hu(c,r){return(c[r]|c[r+1]<<8|c[r+2]<<16)+(c[r+3]<<24)}function Bf(c,r,d){1===c&&d.readMessage(_g,r)}function _g(c,r,d){if(3===c){const{id:g,bitmap:v,width:M,height:E,left:k,top:O,advance:V}=d.readMessage(up,{});r.push({id:g,bitmap:new Qa({width:M+6,height:E+6},v),metrics:{width:M,height:E,left:k,top:O,advance:V}})}}function up(c,r,d){1===c?r.id=d.readVarint():2===c?r.bitmap=d.readBytes():3===c?r.width=d.readVarint():4===c?r.height=d.readVarint():5===c?r.left=d.readSVarint():6===c?r.top=d.readSVarint():7===c&&(r.advance=d.readVarint())}function dp(c){let r=0,d=0;for(const E of c)r+=E.w*E.h,d=Math.max(d,E.w);c.sort((E,k)=>k.h-E.h);const g=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),d),h:1/0}];let v=0,M=0;for(const E of c)for(let k=g.length-1;k>=0;k--){const O=g[k];if(!(E.w>O.w||E.h>O.h)){if(E.x=O.x,E.y=O.y,M=Math.max(M,E.y+E.h),v=Math.max(v,E.x+E.w),E.w===O.w&&E.h===O.h){const V=g.pop();k<g.length&&(g[k]=V)}else E.h===O.h?(O.x+=E.w,O.w-=E.w):E.w===O.w?(O.y+=E.h,O.h-=E.h):(g.push({x:O.x+E.w,y:O.y,w:O.w-E.w,h:E.h}),O.y+=E.h,O.h-=E.h);break}}return{w:v,h:M,fill:r/(v*M)||0}}Xi.prototype={destroy:function(){this.buf=null},readFields:function(c,r,d){for(d=d||this.length;this.pos<d;){var g=this.readVarint(),v=g>>3,M=this.pos;this.type=7&g,c(v,r,this),this.pos===M&&this.skip(g)}return r},readMessage:function(c,r){return this.readFields(c,r,this.readVarint()+this.pos)},readFixed32:function(){var c=cp(this.buf,this.pos);return this.pos+=4,c},readSFixed32:function(){var c=Hu(this.buf,this.pos);return this.pos+=4,c},readFixed64:function(){var c=cp(this.buf,this.pos)+cp(this.buf,this.pos+4)*nl;return this.pos+=8,c},readSFixed64:function(){var c=cp(this.buf,this.pos)+Hu(this.buf,this.pos+4)*nl;return this.pos+=8,c},readFloat:function(){var c=Ao(this.buf,this.pos,!0,23,4);return this.pos+=4,c},readDouble:function(){var c=Ao(this.buf,this.pos,!0,52,8);return this.pos+=8,c},readVarint:function(c){var r,d,g=this.buf;return r=127&(d=g[this.pos++]),d<128?r:(r|=(127&(d=g[this.pos++]))<<7,d<128?r:(r|=(127&(d=g[this.pos++]))<<14,d<128?r:(r|=(127&(d=g[this.pos++]))<<21,d<128?r:function(v,M,E){var k,O,V=E.buf;if(k=(112&(O=V[E.pos++]))>>4,O<128||(k|=(127&(O=V[E.pos++]))<<3,O<128)||(k|=(127&(O=V[E.pos++]))<<10,O<128)||(k|=(127&(O=V[E.pos++]))<<17,O<128)||(k|=(127&(O=V[E.pos++]))<<24,O<128)||(k|=(1&(O=V[E.pos++]))<<31,O<128))return function Un(c,r,d){return d?4294967296*r+(c>>>0):4294967296*(r>>>0)+(c>>>0)}(v,k,M);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(d=g[this.pos]))<<28,c,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var c=this.readVarint();return c%2==1?(c+1)/-2:c/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var c=this.readVarint()+this.pos,r=this.pos;return this.pos=c,c-r>=12&&ki?ki.decode(this.buf.subarray(r,c)):function(d,g,v){for(var M="",E=g;E<v;){var k,O,V,H=d[E],$=null,K=H>239?4:H>223?3:H>191?2:1;if(E+K>v)break;1===K?H<128&&($=H):2===K?128==(192&(k=d[E+1]))&&($=(31&H)<<6|63&k)<=127&&($=null):3===K?(O=d[E+2],128==(192&(k=d[E+1]))&&128==(192&O)&&(($=(15&H)<<12|(63&k)<<6|63&O)<=2047||$>=55296&&$<=57343)&&($=null)):4===K&&(O=d[E+2],V=d[E+3],128==(192&(k=d[E+1]))&&128==(192&O)&&128==(192&V)&&(($=(15&H)<<18|(63&k)<<12|(63&O)<<6|63&V)<=65535||$>=1114112)&&($=null)),null===$?($=65533,K=1):$>65535&&($-=65536,M+=String.fromCharCode($>>>10&1023|55296),$=56320|1023&$),M+=String.fromCharCode($),E+=K}return M}(this.buf,r,c)},readBytes:function(){var c=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,c);return this.pos=c,r},readPackedVarint:function(c,r){if(this.type!==Xi.Bytes)return c.push(this.readVarint(r));var d=di(this);for(c=c||[];this.pos<d;)c.push(this.readVarint(r));return c},readPackedSVarint:function(c){if(this.type!==Xi.Bytes)return c.push(this.readSVarint());var r=di(this);for(c=c||[];this.pos<r;)c.push(this.readSVarint());return c},readPackedBoolean:function(c){if(this.type!==Xi.Bytes)return c.push(this.readBoolean());var r=di(this);for(c=c||[];this.pos<r;)c.push(this.readBoolean());return c},readPackedFloat:function(c){if(this.type!==Xi.Bytes)return c.push(this.readFloat());var r=di(this);for(c=c||[];this.pos<r;)c.push(this.readFloat());return c},readPackedDouble:function(c){if(this.type!==Xi.Bytes)return c.push(this.readDouble());var r=di(this);for(c=c||[];this.pos<r;)c.push(this.readDouble());return c},readPackedFixed32:function(c){if(this.type!==Xi.Bytes)return c.push(this.readFixed32());var r=di(this);for(c=c||[];this.pos<r;)c.push(this.readFixed32());return c},readPackedSFixed32:function(c){if(this.type!==Xi.Bytes)return c.push(this.readSFixed32());var r=di(this);for(c=c||[];this.pos<r;)c.push(this.readSFixed32());return c},readPackedFixed64:function(c){if(this.type!==Xi.Bytes)return c.push(this.readFixed64());var r=di(this);for(c=c||[];this.pos<r;)c.push(this.readFixed64());return c},readPackedSFixed64:function(c){if(this.type!==Xi.Bytes)return c.push(this.readSFixed64());var r=di(this);for(c=c||[];this.pos<r;)c.push(this.readSFixed64());return c},skip:function(c){var r=7&c;if(r===Xi.Varint)for(;this.buf[this.pos++]>127;);else if(r===Xi.Bytes)this.pos=this.readVarint()+this.pos;else if(r===Xi.Fixed32)this.pos+=4;else{if(r!==Xi.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(c,r){this.writeVarint(c<<3|r)},realloc:function(c){for(var r=this.length||16;r<this.pos+c;)r*=2;if(r!==this.length){var d=new Uint8Array(r);d.set(this.buf),this.buf=d,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(c){this.realloc(4),bo(this.buf,c,this.pos),this.pos+=4},writeSFixed32:function(c){this.realloc(4),bo(this.buf,c,this.pos),this.pos+=4},writeFixed64:function(c){this.realloc(8),bo(this.buf,-1&c,this.pos),bo(this.buf,Math.floor(c*My),this.pos+4),this.pos+=8},writeSFixed64:function(c){this.realloc(8),bo(this.buf,-1&c,this.pos),bo(this.buf,Math.floor(c*My),this.pos+4),this.pos+=8},writeVarint:function(c){(c=+c||0)>268435455||c<0?function(r,d){var g,v,M,k;if(r>=0?(g=r%4294967296|0,v=r/4294967296|0):(v=~(-r/4294967296),4294967295^(g=~(-r%4294967296))?g=g+1|0:(g=0,v=v+1|0)),r>=0x10000000000000000||r<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");d.realloc(10),M=g,(k=d).buf[k.pos++]=127&M|128,M>>>=7,k.buf[k.pos++]=127&M|128,M>>>=7,k.buf[k.pos++]=127&M|128,M>>>=7,k.buf[k.pos++]=127&M|128,k.buf[k.pos]=127&(M>>>=7),function(M,E){var k=(7&M)<<4;E.buf[E.pos++]|=k|((M>>>=3)?128:0),M&&(E.buf[E.pos++]=127&M|((M>>>=7)?128:0),M&&(E.buf[E.pos++]=127&M|((M>>>=7)?128:0),M&&(E.buf[E.pos++]=127&M|((M>>>=7)?128:0),M&&(E.buf[E.pos++]=127&M|((M>>>=7)?128:0),M&&(E.buf[E.pos++]=127&M)))))}(v,d)}(c,this):(this.realloc(4),this.buf[this.pos++]=127&c|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=c>>>7&127))))},writeSVarint:function(c){this.writeVarint(c<0?2*-c-1:2*c)},writeBoolean:function(c){this.writeVarint(Boolean(c))},writeString:function(c){c=String(c),this.realloc(4*c.length),this.pos++;var r=this.pos;this.pos=function(g,v,M){for(var E,k,O=0;O<v.length;O++){if((E=v.charCodeAt(O))>55295&&E<57344){if(!k){E>56319||O+1===v.length?(g[M++]=239,g[M++]=191,g[M++]=189):k=E;continue}if(E<56320){g[M++]=239,g[M++]=191,g[M++]=189,k=E;continue}E=k-55296<<10|E-56320|65536,k=null}else k&&(g[M++]=239,g[M++]=191,g[M++]=189,k=null);E<128?g[M++]=E:(E<2048?g[M++]=E>>6|192:(E<65536?g[M++]=E>>12|224:(g[M++]=E>>18|240,g[M++]=E>>12&63|128),g[M++]=E>>6&63|128),g[M++]=63&E|128)}return M}(this.buf,c,this.pos);var d=this.pos-r;d>=128&&Yl(r,d,this),this.pos=r-1,this.writeVarint(d),this.pos+=d},writeFloat:function(c){this.realloc(4),Pf(this.buf,c,this.pos,!0,23,4),this.pos+=4},writeDouble:function(c){this.realloc(8),Pf(this.buf,c,this.pos,!0,52,8),this.pos+=8},writeBytes:function(c){var r=c.length;this.writeVarint(r),this.realloc(r);for(var d=0;d<r;d++)this.buf[this.pos++]=c[d]},writeRawMessage:function(c,r){this.pos++;var d=this.pos;c(r,this);var g=this.pos-d;g>=128&&Yl(d,g,this),this.pos=d-1,this.writeVarint(g),this.pos+=g},writeMessage:function(c,r,d){this.writeTag(c,Xi.Bytes),this.writeRawMessage(r,d)},writePackedVarint:function(c,r){r.length&&this.writeMessage(c,zr,r)},writePackedSVarint:function(c,r){r.length&&this.writeMessage(c,gg,r)},writePackedBoolean:function(c,r){r.length&&this.writeMessage(c,Of,r)},writePackedFloat:function(c,r){r.length&&this.writeMessage(c,fs,r)},writePackedDouble:function(c,r){r.length&&this.writeMessage(c,ji,r)},writePackedFixed32:function(c,r){r.length&&this.writeMessage(c,Ff,r)},writePackedSFixed32:function(c,r){r.length&&this.writeMessage(c,Uu,r)},writePackedFixed64:function(c,r){r.length&&this.writeMessage(c,lp,r)},writePackedSFixed64:function(c,r){r.length&&this.writeMessage(c,Lf,r)},writeBytesField:function(c,r){this.writeTag(c,Xi.Bytes),this.writeBytes(r)},writeFixed32Field:function(c,r){this.writeTag(c,Xi.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(c,r){this.writeTag(c,Xi.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(c,r){this.writeTag(c,Xi.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(c,r){this.writeTag(c,Xi.Fixed64),this.writeSFixed64(r)},writeVarintField:function(c,r){this.writeTag(c,Xi.Varint),this.writeVarint(r)},writeSVarintField:function(c,r){this.writeTag(c,Xi.Varint),this.writeSVarint(r)},writeStringField:function(c,r){this.writeTag(c,Xi.Bytes),this.writeString(r)},writeFloatField:function(c,r){this.writeTag(c,Xi.Fixed32),this.writeFloat(r)},writeDoubleField:function(c,r){this.writeTag(c,Xi.Fixed64),this.writeDouble(r)},writeBooleanField:function(c,r){this.writeVarintField(c,Boolean(r))}};class jo{constructor(r,{pixelRatio:d,version:g,stretchX:v,stretchY:M,content:E}){this.paddedRect=r,this.pixelRatio=d,this.stretchX=v,this.stretchY=M,this.content=E,this.version=g}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Lc{constructor(r,d){const g={},v={};this.haveRenderCallbacks=[];const M=[];this.addImages(r,g,M),this.addImages(d,v,M);const{w:E,h:k}=dp(M),O=new hr({width:E||1,height:k||1});for(const V in r){const H=r[V],$=g[V].paddedRect;hr.copy(H.data,O,{x:0,y:0},{x:$.x+1,y:$.y+1},H.data)}for(const V in d){const H=d[V],$=v[V].paddedRect,K=$.x+1,Q=$.y+1,ee=H.data.width,de=H.data.height;hr.copy(H.data,O,{x:0,y:0},{x:K,y:Q},H.data),hr.copy(H.data,O,{x:0,y:de-1},{x:K,y:Q-1},{width:ee,height:1}),hr.copy(H.data,O,{x:0,y:0},{x:K,y:Q+de},{width:ee,height:1}),hr.copy(H.data,O,{x:ee-1,y:0},{x:K-1,y:Q},{width:1,height:de}),hr.copy(H.data,O,{x:0,y:0},{x:K+ee,y:Q},{width:1,height:de})}this.image=O,this.iconPositions=g,this.patternPositions=v}addImages(r,d,g){for(const v in r){const M=r[v],E={x:0,y:0,w:M.data.width+2,h:M.data.height+2};g.push(E),d[v]=new jo(E,M),M.hasRenderCallback&&this.haveRenderCallbacks.push(v)}}patchUpdatedImages(r,d){r.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const g in r.updatedImages)this.patchUpdatedImage(this.iconPositions[g],r.getImage(g),d),this.patchUpdatedImage(this.patternPositions[g],r.getImage(g),d)}patchUpdatedImage(r,d,g){if(!r||!d||r.version===d.version)return;r.version=d.version;const[v,M]=r.tl;g.update(d.data,void 0,{x:v,y:M})}}Gt("ImagePosition",jo),Gt("ImageAtlas",Lc),x.WritingMode=void 0,(en=x.WritingMode||(x.WritingMode={}))[en.none=0]="none",en[en.horizontal=1]="horizontal",en[en.vertical=2]="vertical",en[en.horizontalOnly=3]="horizontalOnly";class Bc{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(r,d){const g=new Bc;return g.scale=r||1,g.fontStack=d,g}static forImage(r){const d=new Bc;return d.imageName=r,d}}class Nc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(r,d){const g=new Nc;for(let v=0;v<r.sections.length;v++){const M=r.sections[v];M.image?g.addImageSection(M):g.addTextSection(M,d)}return g}length(){return this.text.length}getSection(r){return this.sections[this.sectionIndex[r]]}getSectionIndex(r){return this.sectionIndex[r]}getCharCode(r){return this.text.charCodeAt(r)}verticalizePunctuation(){this.text=function(r){let d="";for(let g=0;g<r.length;g++){const v=r.charCodeAt(g+1)||null,M=r.charCodeAt(g-1)||null;d+=v&&bu(v)&&!ju[r[g+1]]||M&&bu(M)&&!ju[r[g-1]]||!ju[r[g]]?r[g]:ju[r[g]]}return d}(this.text)}trim(){let r=0;for(let g=0;g<this.text.length&&$u[this.text.charCodeAt(g)];g++)r++;let d=this.text.length;for(let g=this.text.length-1;g>=0&&g>=r&&$u[this.text.charCodeAt(g)];g--)d--;this.text=this.text.substring(r,d),this.sectionIndex=this.sectionIndex.slice(r,d)}substring(r,d){const g=new Nc;return g.text=this.text.substring(r,d),g.sectionIndex=this.sectionIndex.slice(r,d),g.sections=this.sections,g}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((r,d)=>Math.max(r,this.sections[d].scale),0)}addTextSection(r,d){this.text+=r.text,this.sections.push(Bc.forText(r.scale,r.fontStack||d));const g=this.sections.length-1;for(let v=0;v<r.text.length;++v)this.sectionIndex.push(g)}addImageSection(r){const d=r.image?r.image.name:"";if(0===d.length)return void Dt("Can't add FormattedSection with an empty image.");const g=this.getNextImageSectionCharCode();g?(this.text+=String.fromCharCode(g),this.sections.push(Bc.forImage(d)),this.sectionIndex.push(this.sections.length-1)):Dt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Gu(c,r,d,g,v,M,E,k,O,V,H,$,K,Q,ee,de){const pe=Nc.fromFeature(c,v);let Ee;$===x.WritingMode.vertical&&pe.verticalizePunctuation();const{processBidirectionalText:$e,processStyledBidirectionalText:ze}=tr;if($e&&1===pe.sections.length){Ee=[];const rt=$e(pe.toString(),ma(pe,V,M,r,g,Q,ee));for(const Nt of rt){const ei=new Nc;ei.text=Nt,ei.sections=pe.sections;for(let Vt=0;Vt<Nt.length;Vt++)ei.sectionIndex.push(0);Ee.push(ei)}}else if(ze){Ee=[];const rt=ze(pe.text,pe.sectionIndex,ma(pe,V,M,r,g,Q,ee));for(const Nt of rt){const ei=new Nc;ei.text=Nt[0],ei.sectionIndex=Nt[1],ei.sections=pe.sections,Ee.push(ei)}}else Ee=function(rt,Nt){const ei=[],Vt=rt.text;let Bt=0;for(const It of Nt)ei.push(rt.substring(Bt,It)),Bt=It;return Bt<Vt.length&&ei.push(rt.substring(Bt,Vt.length)),ei}(pe,ma(pe,V,M,r,g,Q,ee));const Ke=[],ct={positionedLines:Ke,text:pe.toString(),top:H[1],bottom:H[1],left:H[0],right:H[0],writingMode:$,iconsInText:!1,verticalizable:!1};return function(rt,Nt,ei,Vt,Bt,It,jt,Lt,_t,hi,li,Gi){let cn=0,An=-17,In=0,Qr=0;const or="right"===Lt?1:"left"===Lt?0:.5;let pr=0;for(const _r of Bt){_r.trim();const xo=_r.getMaxScale(),eo=24*(xo-1),Uo={positionedGlyphs:[],lineOffset:0};rt.positionedLines[pr]=Uo;const Ho=Uo.positionedGlyphs;let wo=0;if(!_r.length()){An+=It,++pr;continue}for(let Ir=0;Ir<_r.length();Ir++){const Ui=_r.getSection(Ir),Qo=_r.getSectionIndex(Ir),Hr=_r.getCharCode(Ir);let Co=0,ys=null,Js=null,ea=null,ba=24;const vs=!(_t===x.WritingMode.horizontal||!li&&!Ha(Hr)||li&&($u[Hr]||(Ar=Hr,Ft.Arabic(Ar)||Ft["Arabic Supplement"](Ar)||Ft["Arabic Extended-A"](Ar)||Ft["Arabic Presentation Forms-A"](Ar)||Ft["Arabic Presentation Forms-B"](Ar))));if(Ui.imageName){const bs=Vt[Ui.imageName];if(!bs)continue;ea=Ui.imageName,rt.iconsInText=rt.iconsInText||!0,Js=bs.paddedRect;const Qn=bs.displaySize;Ui.scale=24*Ui.scale/Gi,ys={width:Qn[0],height:Qn[1],left:1,top:-3,advance:vs?Qn[1]:Qn[0]},Co=eo+(24-Qn[1]*Ui.scale),ba=ys.advance;const ta=vs?Qn[0]*Ui.scale-24*xo:Qn[1]*Ui.scale-24*xo;ta>0&&ta>wo&&(wo=ta)}else{const bs=ei[Ui.fontStack],Qn=bs&&bs[Hr];if(Qn&&Qn.rect)Js=Qn.rect,ys=Qn.metrics;else{const ta=Nt[Ui.fontStack],_h=ta&&ta[Hr];if(!_h)continue;ys=_h.metrics}Co=24*(xo-Ui.scale)}vs?(rt.verticalizable=!0,Ho.push({glyph:Hr,imageName:ea,x:cn,y:An+Co,vertical:vs,scale:Ui.scale,fontStack:Ui.fontStack,sectionIndex:Qo,metrics:ys,rect:Js}),cn+=ba*Ui.scale+hi):(Ho.push({glyph:Hr,imageName:ea,x:cn,y:An+Co,vertical:vs,scale:Ui.scale,fontStack:Ui.fontStack,sectionIndex:Qo,metrics:ys,rect:Js}),cn+=ys.advance*Ui.scale+hi)}0!==Ho.length&&(In=Math.max(cn-hi,In),Yu(Ho,0,Ho.length-1,or,wo)),cn=0;const On=It*xo+wo;Uo.lineOffset=Math.max(wo,eo),An+=On,Qr=Math.max(On,Qr),++pr}var Ar;const yn=An- -17,{horizontalAlign:Jr,verticalAlign:Io}=ch(jt);(function(_r,xo,eo,Uo,Ho,wo,On,Ir,Ui){const Qo=(xo-eo)*Ho;let Hr=0;Hr=wo!==On?-Ir*Uo- -17:(-Uo*Ui+.5)*On;for(const Co of _r)for(const ys of Co.positionedGlyphs)ys.x+=Qo,ys.y+=Hr})(rt.positionedLines,or,Jr,Io,In,Qr,It,yn,Bt.length),rt.top+=-Io*yn,rt.bottom=rt.top+yn,rt.left+=-Jr*In,rt.right=rt.left+In}(ct,r,d,g,Ee,E,k,O,$,V,K,de),!function(rt){for(const Nt of rt)if(0!==Nt.positionedGlyphs.length)return!1;return!0}(Ke)&&ct}const $u={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Nf={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Vc(c,r,d,g,v,M){if(r.imageName){const E=g[r.imageName];return E?E.displaySize[0]*r.scale*24/M+v:0}{const E=d[r.fontStack],k=E&&E[c];return k?k.metrics.advance*r.scale+v:0}}function qu(c,r,d,g){const v=Math.pow(c-r,2);return g?c<r?v/2:2*v:v+Math.abs(d)*d}function Vf(c,r,d){let g=0;return 10===c&&(g-=1e4),d&&(g+=150),40!==c&&65288!==c||(g+=50),41!==r&&65289!==r||(g+=50),g}function hp(c,r,d,g,v,M){let E=null,k=qu(r,d,v,M);for(const O of g){const V=qu(r-O.x,d,v,M)+O.badness;V<=k&&(E=O,k=V)}return{index:c,x:r,priorBreak:E,badness:k}}function zf(c){return c?zf(c.priorBreak).concat(c.index):[]}function ma(c,r,d,g,v,M,E){if("point"!==M)return[];if(!c)return[];const k=[],O=function(K,Q,ee,de,pe,Ee){let $e=0;for(let ze=0;ze<K.length();ze++){const Ke=K.getSection(ze);$e+=Vc(K.getCharCode(ze),Ke,de,pe,Q,Ee)}return $e/Math.max(1,Math.ceil($e/ee))}(c,r,d,g,v,E),V=c.text.indexOf("\u200b")>=0;let H=0;for(let K=0;K<c.length();K++){const Q=c.getSection(K),ee=c.getCharCode(K);if($u[ee]||(H+=Vc(ee,Q,g,v,r,E)),K<c.length()-1){const de=!(($=ee)<11904||!(Ft["Bopomofo Extended"]($)||Ft.Bopomofo($)||Ft["CJK Compatibility Forms"]($)||Ft["CJK Compatibility Ideographs"]($)||Ft["CJK Compatibility"]($)||Ft["CJK Radicals Supplement"]($)||Ft["CJK Strokes"]($)||Ft["CJK Symbols and Punctuation"]($)||Ft["CJK Unified Ideographs Extension A"]($)||Ft["CJK Unified Ideographs"]($)||Ft["Enclosed CJK Letters and Months"]($)||Ft["Halfwidth and Fullwidth Forms"]($)||Ft.Hiragana($)||Ft["Ideographic Description Characters"]($)||Ft["Kangxi Radicals"]($)||Ft["Katakana Phonetic Extensions"]($)||Ft.Katakana($)||Ft["Vertical Forms"]($)||Ft["Yi Radicals"]($)||Ft["Yi Syllables"]($)));(Nf[ee]||de||Q.imageName)&&k.push(hp(K+1,H,O,k,Vf(ee,c.getCharCode(K+1),de&&V),!1))}}var $;return zf(hp(c.length(),H,O,k,0,!0))}function ch(c){let r=.5,d=.5;switch(c){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":d=1;break;case"top":case"top-right":case"top-left":d=0}return{horizontalAlign:r,verticalAlign:d}}function Yu(c,r,d,g,v){if(!g&&!v)return;const M=c[d],E=(c[d].x+M.metrics.advance*M.scale)*g;for(let k=r;k<=d;k++)c[k].x-=E,c[k].y+=v}function yg(c,r,d){const{horizontalAlign:g,verticalAlign:v}=ch(d),M=r[0]-c.displaySize[0]*g,E=r[1]-c.displaySize[1]*v;return{image:c,top:E,bottom:E+c.displaySize[1],left:M,right:M+c.displaySize[0]}}function Wu(c,r,d,g,v,M){const E=c.image;let k;if(E.content){const pe=E.content,Ee=E.pixelRatio||1;k=[pe[0]/Ee,pe[1]/Ee,E.displaySize[0]-pe[2]/Ee,E.displaySize[1]-pe[3]/Ee]}const O=r.left*M,V=r.right*M;let H,$,K,Q;"width"===d||"both"===d?(Q=v[0]+O-g[3],$=v[0]+V+g[1]):(Q=v[0]+(O+V-E.displaySize[0])/2,$=Q+E.displaySize[0]);const ee=r.top*M,de=r.bottom*M;return"height"===d||"both"===d?(H=v[1]+ee-g[0],K=v[1]+de+g[2]):(H=v[1]+(ee+de-E.displaySize[1])/2,K=H+E.displaySize[1]),{image:E,top:H,right:$,bottom:K,left:Q,collisionPadding:k}}const Xs=128;function pp(c,r){const{expression:d}=r;if("constant"===d.kind)return{kind:"constant",layoutSize:d.evaluate(new Jt(c+1))};if("source"===d.kind)return{kind:"source"};{const{zoomStops:g,interpolationType:v}=d;let M=0;for(;M<g.length&&g[M]<=c;)M++;M=Math.max(0,M-1);let E=M;for(;E<g.length&&g[E]<c+1;)E++;E=Math.min(g.length-1,E);const k=g[M],O=g[E];return"composite"===d.kind?{kind:"composite",minZoom:k,maxZoom:O,interpolationType:v}:{kind:"camera",minZoom:k,maxZoom:O,minSize:d.evaluate(new Jt(k)),maxSize:d.evaluate(new Jt(O)),interpolationType:v}}}function Zu(c,{uSize:r,uSizeT:d},{lowerSize:g,upperSize:v}){return"source"===c.kind?g/Xs:"composite"===c.kind?lr(g/Xs,v/Xs,d):r}function ms(c,r){let d=0,g=0;if("constant"===c.kind)g=c.layoutSize;else if("source"!==c.kind){const{interpolationType:v,minZoom:M,maxZoom:E}=c,k=v?ne(Br.interpolationFactor(v,r,M,E),0,1):0;"camera"===c.kind?g=lr(c.minSize,c.maxSize,k):d=k}return{uSizeT:d,uSize:g}}var Ko=Object.freeze({__proto__:null,getSizeData:pp,evaluateSizeForFeature:Zu,evaluateSizeForZoom:ms,SIZE_PACK_FACTOR:Xs});class ga extends Oe{constructor(r,d,g,v){super(r,d),this.angle=g,void 0!==v&&(this.segment=v)}clone(){return new ga(this.x,this.y,this.angle,this.segment)}}function Ku(c,r,d,g,v){if(void 0===r.segment)return!0;let M=r,E=r.segment+1,k=0;for(;k>-d/2;){if(E--,E<0)return!1;k-=c[E].dist(M),M=c[E]}k+=c[E].dist(c[E+1]),E++;const O=[];let V=0;for(;k<d/2;){const H=c[E],$=c[E+1];if(!$)return!1;let K=c[E-1].angleTo(H)-H.angleTo($);for(K=Math.abs((K+3*Math.PI)%(2*Math.PI)-Math.PI),O.push({distance:k,angleDelta:K}),V+=K;k-O[0].distance>g;)V-=O.shift().angleDelta;if(V>v)return!1;E++,k+=H.dist($)}return!0}function Xu(c){let r=0;for(let d=0;d<c.length-1;d++)r+=c[d].dist(c[d+1]);return r}function uh(c,r,d){return c?.6*r*d:0}function Qu(c,r){return Math.max(c?c.right-c.left:0,r?r.right-r.left:0)}function Kr(c,r,d,g,v,M){const E=uh(d,v,M),k=Qu(d,g)*M;let O=0;const V=Xu(c)/2;for(let H=0;H<c.length-1;H++){const $=c[H],K=c[H+1],Q=$.dist(K);if(O+Q>V){const ee=(V-O)/Q,de=lr($.x,K.x,ee),pe=lr($.y,K.y,ee),Ee=new ga(de,pe,K.angleTo($),H);return Ee._round(),!E||Ku(c,Ee,k,E,r)?Ee:void 0}O+=Q}}function Ju(c,r,d,g,v,M,E,k,O){const V=uh(g,M,E),H=Qu(g,v),$=H*E,K=0===c[0].x||c[0].x===O||0===c[0].y||c[0].y===O;return r-$<r/4&&(r=$+r/4),jr(c,K?r/2*k%r:(H/2+2*M)*E*k%r,r,V,d,$,K,!1,O)}function jr(c,r,d,g,v,M,E,k,O){const V=M/2,H=Xu(c);let $=0,K=r-d,Q=[];for(let ee=0;ee<c.length-1;ee++){const de=c[ee],pe=c[ee+1],Ee=de.dist(pe),$e=pe.angleTo(de);for(;K+d<$+Ee;){K+=d;const ze=(K-$)/Ee,Ke=lr(de.x,pe.x,ze),ct=lr(de.y,pe.y,ze);if(Ke>=0&&Ke<O&&ct>=0&&ct<O&&K-V>=0&&K+V<=H){const rt=new ga(Ke,ct,$e,ee);rt._round(),g&&!Ku(c,rt,M,g,v)||Q.push(rt)}}$+=Ee}return k||Q.length||E||(Q=jr(c,$/2,d,g,v,M,E,!0,O)),Q}function vg(c,r,d,g,v){const M=[];for(let E=0;E<c.length;E++){const k=c[E];let O;for(let V=0;V<k.length-1;V++){let H=k[V],$=k[V+1];H.x<r&&$.x<r||(H.x<r?H=new Oe(r,H.y+(r-H.x)/($.x-H.x)*($.y-H.y))._round():$.x<r&&($=new Oe(r,H.y+(r-H.x)/($.x-H.x)*($.y-H.y))._round()),H.y<d&&$.y<d||(H.y<d?H=new Oe(H.x+(d-H.y)/($.y-H.y)*($.x-H.x),d)._round():$.y<d&&($=new Oe(H.x+(d-H.y)/($.y-H.y)*($.x-H.x),d)._round()),H.x>=g&&$.x>=g||(H.x>=g?H=new Oe(g,H.y+(g-H.x)/($.x-H.x)*($.y-H.y))._round():$.x>=g&&($=new Oe(g,H.y+(g-H.x)/($.x-H.x)*($.y-H.y))._round()),H.y>=v&&$.y>=v||(H.y>=v?H=new Oe(H.x+(v-H.y)/($.y-H.y)*($.x-H.x),v)._round():$.y>=v&&($=new Oe(H.x+(v-H.y)/($.y-H.y)*($.x-H.x),v)._round()),O&&H.equals(O[O.length-1])||(O=[H],M.push(O)),O.push($)))))}}return M}function rl(c,r,d,g){const v=[],M=c.image,E=M.pixelRatio,k=M.paddedRect.w-2,O=M.paddedRect.h-2,V=c.right-c.left,H=c.bottom-c.top,$=M.stretchX||[[0,k]],K=M.stretchY||[[0,O]],Q=(It,jt)=>It+jt[1]-jt[0],ee=$.reduce(Q,0),de=K.reduce(Q,0),pe=k-ee,Ee=O-de;let $e=0,ze=ee,Ke=0,ct=de,rt=0,Nt=pe,ei=0,Vt=Ee;if(M.content&&g){const It=M.content;$e=ed($,0,It[0]),Ke=ed(K,0,It[1]),ze=ed($,It[0],It[2]),ct=ed(K,It[1],It[3]),rt=It[0]-$e,ei=It[1]-Ke,Nt=It[2]-It[0]-ze,Vt=It[3]-It[1]-ct}const Bt=(It,jt,Lt,_t)=>{const hi=_a(It.stretch-$e,ze,V,c.left),li=zc(It.fixed-rt,Nt,It.stretch,ee),Gi=_a(jt.stretch-Ke,ct,H,c.top),cn=zc(jt.fixed-ei,Vt,jt.stretch,de),An=_a(Lt.stretch-$e,ze,V,c.left),In=zc(Lt.fixed-rt,Nt,Lt.stretch,ee),Qr=_a(_t.stretch-Ke,ct,H,c.top),or=zc(_t.fixed-ei,Vt,_t.stretch,de),pr=new Oe(hi,Gi),Ar=new Oe(An,Gi),yn=new Oe(An,Qr),Jr=new Oe(hi,Qr),Io=new Oe(li/E,cn/E),_r=new Oe(In/E,or/E),xo=r*Math.PI/180;if(xo){const Ho=Math.sin(xo),wo=Math.cos(xo),On=[wo,-Ho,Ho,wo];pr._matMult(On),Ar._matMult(On),Jr._matMult(On),yn._matMult(On)}const eo=It.stretch+It.fixed,Uo=jt.stretch+jt.fixed;return{tl:pr,tr:Ar,bl:Jr,br:yn,tex:{x:M.paddedRect.x+1+eo,y:M.paddedRect.y+1+Uo,w:Lt.stretch+Lt.fixed-eo,h:_t.stretch+_t.fixed-Uo},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Io,pixelOffsetBR:_r,minFontScaleX:Nt/E/V,minFontScaleY:Vt/E/H,isSDF:d}};if(g&&(M.stretchX||M.stretchY)){const It=bg($,pe,ee),jt=bg(K,Ee,de);for(let Lt=0;Lt<It.length-1;Lt++){const _t=It[Lt],hi=It[Lt+1];for(let li=0;li<jt.length-1;li++)v.push(Bt(_t,jt[li],hi,jt[li+1]))}}else v.push(Bt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:k+1},{fixed:0,stretch:O+1}));return v}function ed(c,r,d){let g=0;for(const v of c)g+=Math.max(r,Math.min(d,v[1]))-Math.max(r,Math.min(d,v[0]));return g}function bg(c,r,d){const g=[{fixed:-1,stretch:0}];for(const[v,M]of c){const E=g[g.length-1];g.push({fixed:v-E.stretch,stretch:E.stretch}),g.push({fixed:v-E.stretch,stretch:E.stretch+(M-v)})}return g.push({fixed:r+1,stretch:d}),g}function _a(c,r,d,g){return c/r*d+g}function zc(c,r,d,g){return c-r*d/g}Gt("Anchor",ga);class gs{constructor(r,d,g,v,M,E,k,O,V,H){if(this.boxStartIndex=r.length,V){let $=E.top,K=E.bottom;const Q=E.collisionPadding;Q&&($-=Q[1],K+=Q[3]);let ee=K-$;ee>0&&(ee=Math.max(10,ee),this.circleDiameter=ee)}else{let $=E.top*k-O,K=E.bottom*k+O,Q=E.left*k-O,ee=E.right*k+O;const de=E.collisionPadding;if(de&&(Q-=de[0]*k,$-=de[1]*k,ee+=de[2]*k,K+=de[3]*k),H){const pe=new Oe(Q,$),Ee=new Oe(ee,$),$e=new Oe(Q,K),ze=new Oe(ee,K),Ke=H*Math.PI/180;pe._rotate(Ke),Ee._rotate(Ke),$e._rotate(Ke),ze._rotate(Ke),Q=Math.min(pe.x,Ee.x,$e.x,ze.x),ee=Math.max(pe.x,Ee.x,$e.x,ze.x),$=Math.min(pe.y,Ee.y,$e.y,ze.y),K=Math.max(pe.y,Ee.y,$e.y,ze.y)}r.emplaceBack(d.x,d.y,Q,$,ee,K,g,v,M)}this.boxEndIndex=r.length}}class fp{constructor(r=[],d=ol){if(this.data=r,this.length=this.data.length,this.compare=d,this.length>0)for(let g=(this.length>>1)-1;g>=0;g--)this._down(g)}push(r){this.data.push(r),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const r=this.data[0],d=this.data.pop();return this.length--,this.length>0&&(this.data[0]=d,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:d,compare:g}=this,v=d[r];for(;r>0;){const M=r-1>>1,E=d[M];if(g(v,E)>=0)break;d[r]=E,r=M}d[r]=v}_down(r){const{data:d,compare:g}=this,v=this.length>>1,M=d[r];for(;r<v;){let E=1+(r<<1),k=d[E];const O=E+1;if(O<this.length&&g(d[O],k)<0&&(E=O,k=d[O]),g(k,M)>=0)break;d[r]=k,r=E}d[r]=M}}function ol(c,r){return c<r?-1:c>r?1:0}function xg(c,r=1,d=!1){let g=1/0,v=1/0,M=-1/0,E=-1/0;const k=c[0];for(let Q=0;Q<k.length;Q++){const ee=k[Q];(!Q||ee.x<g)&&(g=ee.x),(!Q||ee.y<v)&&(v=ee.y),(!Q||ee.x>M)&&(M=ee.x),(!Q||ee.y>E)&&(E=ee.y)}const O=Math.min(M-g,E-v);let V=O/2;const H=new fp([],wg);if(0===O)return new Oe(g,v);for(let Q=g;Q<M;Q+=O)for(let ee=v;ee<E;ee+=O)H.push(new sl(Q+V,ee+V,V,c));let $=function(Q){let ee=0,de=0,pe=0;const Ee=Q[0];for(let $e=0,ze=Ee.length,Ke=ze-1;$e<ze;Ke=$e++){const ct=Ee[$e],rt=Ee[Ke],Nt=ct.x*rt.y-rt.x*ct.y;de+=(ct.x+rt.x)*Nt,pe+=(ct.y+rt.y)*Nt,ee+=3*Nt}return new sl(de/ee,pe/ee,0,Q)}(c),K=H.length;for(;H.length;){const Q=H.pop();(Q.d>$.d||!$.d)&&($=Q,d&&console.log("found best %d after %d probes",Math.round(1e4*Q.d)/1e4,K)),Q.max-$.d<=r||(V=Q.h/2,H.push(new sl(Q.p.x-V,Q.p.y-V,V,c)),H.push(new sl(Q.p.x+V,Q.p.y-V,V,c)),H.push(new sl(Q.p.x-V,Q.p.y+V,V,c)),H.push(new sl(Q.p.x+V,Q.p.y+V,V,c)),K+=4)}return d&&(console.log(`num probes: ${K}`),console.log(`best distance: ${$.d}`)),$.p}function wg(c,r){return r.max-c.max}function sl(c,r,d,g){this.p=new Oe(c,r),this.h=d,this.d=function(v,M){let E=!1,k=1/0;for(let O=0;O<M.length;O++){const V=M[O];for(let H=0,$=V.length,K=$-1;H<$;K=H++){const Q=V[H],ee=V[K];Q.y>v.y!=ee.y>v.y&&v.x<(ee.x-Q.x)*(v.y-Q.y)/(ee.y-Q.y)+Q.x&&(E=!E),k=Math.min(k,gf(v,Q,ee))}}return(E?1:-1)*Math.sqrt(k)}(this.p,g),this.max=this.d+this.h*Math.SQRT2}const mp=Number.POSITIVE_INFINITY;function Xo(c,r){return r[1]!==mp?function(d,g,v){let M=0,E=0;switch(g=Math.abs(g),v=Math.abs(v),d){case"top-right":case"top-left":case"top":E=v-7;break;case"bottom-right":case"bottom-left":case"bottom":E=7-v}switch(d){case"top-right":case"bottom-right":case"right":M=-g;break;case"top-left":case"bottom-left":case"left":M=g}return[M,E]}(c,r[0],r[1]):function(d,g){let v=0,M=0;g<0&&(g=0);const E=g/Math.sqrt(2);switch(d){case"top-right":case"top-left":M=E-7;break;case"bottom-right":case"bottom-left":M=7-E;break;case"bottom":M=7-g;break;case"top":M=g-7}switch(d){case"top-right":case"bottom-right":v=-E;break;case"top-left":case"bottom-left":v=E;break;case"left":v=g;break;case"right":v=-g}return[v,M]}(c,r[0])}function td(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function ya(c,r,d,g,v,M,E,k,O,V,H){let $=M.textMaxSize.evaluate(r,{});void 0===$&&($=E);const K=c.layers[0].layout,Q=K.get("icon-offset").evaluate(r,{},H),ee=Uf(d.horizontal),de=E/24,pe=c.tilePixelRatio*de,Ee=c.tilePixelRatio*$/24,$e=c.tilePixelRatio*k,ze=c.tilePixelRatio*K.get("symbol-spacing"),Ke=K.get("text-padding")*c.tilePixelRatio,ct=K.get("icon-padding")*c.tilePixelRatio,rt=K.get("text-max-angle")/180*Math.PI,Nt="map"===K.get("text-rotation-alignment")&&"point"!==K.get("symbol-placement"),ei="map"===K.get("icon-rotation-alignment")&&"point"!==K.get("symbol-placement"),Vt=K.get("symbol-placement"),Bt=ze/2,It=K.get("icon-text-fit");let jt;g&&"none"!==It&&(c.allowVerticalPlacement&&d.vertical&&(jt=Wu(g,d.vertical,It,K.get("icon-text-fit-padding"),Q,de)),ee&&(g=Wu(g,ee,It,K.get("icon-text-fit-padding"),Q,de)));const Lt=(_t,hi)=>{hi.x<0||hi.x>=Cn||hi.y<0||hi.y>=Cn||function(li,Gi,cn,An,In,Qr,or,pr,Ar,yn,Jr,Io,_r,xo,eo,Uo,Ho,wo,On,Ir,Ui,Qo,Hr,Co,ys){const Js=li.addToLineVertexArray(Gi,cn);let ea,ba,vs,bs,Qn=0,ta=0,_h=0,Eg=0,Sg=-1,Sp=-1;const cl={};let Tg=To(""),Wf=0,yh=0;if(void 0===pr._unevaluatedLayout.getValue("text-radial-offset")?[Wf,yh]=pr.layout.get("text-offset").evaluate(Ui,{},Co).map(Go=>24*Go):(Wf=24*pr.layout.get("text-radial-offset").evaluate(Ui,{},Co),yh=mp),li.allowVerticalPlacement&&An.vertical){const Go=pr.layout.get("text-rotate").evaluate(Ui,{},Co)+90;vs=new gs(Ar,Gi,yn,Jr,Io,An.vertical,_r,xo,eo,Go),or&&(bs=new gs(Ar,Gi,yn,Jr,Io,or,Ho,wo,eo,Go))}if(In){const Go=pr.layout.get("icon-rotate").evaluate(Ui,{}),na="none"!==pr.layout.get("icon-text-fit"),ad=rl(In,Go,Hr,na),ld=or?rl(or,Go,Hr,na):void 0;ba=new gs(Ar,Gi,yn,Jr,Io,In,Ho,wo,!1,Go),Qn=4*ad.length;const Qf=li.iconSizeData;let Xl=null;"source"===Qf.kind?(Xl=[Xs*pr.layout.get("icon-size").evaluate(Ui,{})],Xl[0]>Qs&&Dt(`${li.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===Qf.kind&&(Xl=[Xs*Qo.compositeIconSizes[0].evaluate(Ui,{},Co),Xs*Qo.compositeIconSizes[1].evaluate(Ui,{},Co)],(Xl[0]>Qs||Xl[1]>Qs)&&Dt(`${li.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),li.addSymbols(li.icon,ad,Xl,Ir,On,Ui,x.WritingMode.none,Gi,Js.lineStartIndex,Js.lineLength,-1,Co),Sg=li.icon.placedSymbolArray.length-1,ld&&(ta=4*ld.length,li.addSymbols(li.icon,ld,Xl,Ir,On,Ui,x.WritingMode.vertical,Gi,Js.lineStartIndex,Js.lineLength,-1,Co),Sp=li.icon.placedSymbolArray.length-1)}const Ag=Object.keys(An.horizontal);for(const Go of Ag){const na=An.horizontal[Go];if(!ea){Tg=To(na.text);const ld=pr.layout.get("text-rotate").evaluate(Ui,{},Co);ea=new gs(Ar,Gi,yn,Jr,Io,na,_r,xo,eo,ld)}const ad=1===na.positionedLines.length;if(_h+=jf(li,Gi,na,Qr,pr,eo,Ui,Uo,Js,An.vertical?x.WritingMode.horizontal:x.WritingMode.horizontalOnly,ad?Ag:[Go],cl,Sg,Qo,Co),ad)break}An.vertical&&(Eg+=jf(li,Gi,An.vertical,Qr,pr,eo,Ui,Uo,Js,x.WritingMode.vertical,["vertical"],cl,Sp,Qo,Co));const Ey=ea?ea.boxStartIndex:li.collisionBoxArray.length,Tp=ea?ea.boxEndIndex:li.collisionBoxArray.length,Zf=vs?vs.boxStartIndex:li.collisionBoxArray.length,Sy=vs?vs.boxEndIndex:li.collisionBoxArray.length,Kf=ba?ba.boxStartIndex:li.collisionBoxArray.length,Xf=ba?ba.boxEndIndex:li.collisionBoxArray.length,Ig=bs?bs.boxStartIndex:li.collisionBoxArray.length,Ty=bs?bs.boxEndIndex:li.collisionBoxArray.length;let ia=-1;const sd=(Go,na)=>Go&&Go.circleDiameter?Math.max(Go.circleDiameter,na):na;ia=sd(ea,ia),ia=sd(vs,ia),ia=sd(ba,ia),ia=sd(bs,ia);const Ay=ia>-1?1:0;Ay&&(ia*=ys/24),li.glyphOffsetArray.length>=jc.MAX_GLYPHS&&Dt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Ui.sortKey&&li.addToSortKeyRanges(li.symbolInstances.length,Ui.sortKey),li.symbolInstances.emplaceBack(Gi.x,Gi.y,cl.right>=0?cl.right:-1,cl.center>=0?cl.center:-1,cl.left>=0?cl.left:-1,cl.vertical||-1,Sg,Sp,Tg,Ey,Tp,Zf,Sy,Kf,Xf,Ig,Ty,yn,_h,Eg,Qn,ta,Ay,0,_r,Wf,yh,ia)}(c,hi,_t,d,g,v,jt,c.layers[0],c.collisionBoxArray,r.index,r.sourceLayerIndex,c.index,pe,Ke,Nt,O,$e,ct,ei,Q,r,M,V,H,E)};if("line"===Vt)for(const _t of vg(r.geometry,0,0,Cn,Cn)){const hi=Ju(_t,ze,rt,d.vertical||ee,g,24,Ee,c.overscaling,Cn);for(const li of hi){const Gi=ee;Gi&&Cg(c,Gi.text,Bt,li)||Lt(_t,li)}}else if("line-center"===Vt){for(const _t of r.geometry)if(_t.length>1){const hi=Kr(_t,rt,d.vertical||ee,g,24,Ee);hi&&Lt(_t,hi)}}else if("Polygon"===r.type)for(const _t of Nu(r.geometry,0)){const hi=xg(_t,16);Lt(_t[0],new ga(hi.x,hi.y,0))}else if("LineString"===r.type)for(const _t of r.geometry)Lt(_t,new ga(_t[0].x,_t[0].y,0));else if("Point"===r.type)for(const _t of r.geometry)for(const hi of _t)Lt([hi],new ga(hi.x,hi.y,0))}const Qs=32640;function jf(c,r,d,g,v,M,E,k,O,V,H,$,K,Q,ee){const de=function($e,ze,Ke,ct,rt,Nt,ei,Vt){const Bt=ct.layout.get("text-rotate").evaluate(Nt,{})*Math.PI/180,It=[];for(const jt of ze.positionedLines)for(const Lt of jt.positionedGlyphs){if(!Lt.rect)continue;const _t=Lt.rect||{};let hi=4,li=!0,Gi=1,cn=0;const An=(rt||Vt)&&Lt.vertical,In=Lt.metrics.advance*Lt.scale/2;if(Vt&&ze.verticalizable){const On=24*(Lt.scale-1),Ir=(24-Lt.metrics.width*Lt.scale)/2;cn=jt.lineOffset/2-(Lt.imageName?-Ir:On)}if(Lt.imageName){const On=ei[Lt.imageName];li=On.sdf,Gi=On.pixelRatio,hi=1/Gi}const Qr=rt?[Lt.x+In,Lt.y]:[0,0];let or=rt?[0,0]:[Lt.x+In+Ke[0],Lt.y+Ke[1]-cn],pr=[0,0];An&&(pr=or,or=[0,0]);const Ar=(Lt.metrics.left-hi)*Lt.scale-In+or[0],yn=(-Lt.metrics.top-hi)*Lt.scale+or[1],Jr=Ar+_t.w*Lt.scale/Gi,Io=yn+_t.h*Lt.scale/Gi,_r=new Oe(Ar,yn),xo=new Oe(Jr,yn),eo=new Oe(Ar,Io),Uo=new Oe(Jr,Io);if(An){const On=new Oe(-In,In- -17),Ir=-Math.PI/2,Ui=12-In,Qo=new Oe(22-Ui,-(Lt.imageName?Ui:0)),Hr=new Oe(...pr);_r._rotateAround(Ir,On)._add(Qo)._add(Hr),xo._rotateAround(Ir,On)._add(Qo)._add(Hr),eo._rotateAround(Ir,On)._add(Qo)._add(Hr),Uo._rotateAround(Ir,On)._add(Qo)._add(Hr)}if(Bt){const On=Math.sin(Bt),Ir=Math.cos(Bt),Ui=[Ir,-On,On,Ir];_r._matMult(Ui),xo._matMult(Ui),eo._matMult(Ui),Uo._matMult(Ui)}const Ho=new Oe(0,0),wo=new Oe(0,0);It.push({tl:_r,tr:xo,bl:eo,br:Uo,tex:_t,writingMode:ze.writingMode,glyphOffset:Qr,sectionIndex:Lt.sectionIndex,isSDF:li,pixelOffsetTL:Ho,pixelOffsetBR:wo,minFontScaleX:0,minFontScaleY:0})}return It}(0,d,k,v,M,E,g,c.allowVerticalPlacement),pe=c.textSizeData;let Ee=null;"source"===pe.kind?(Ee=[Xs*v.layout.get("text-size").evaluate(E,{})],Ee[0]>Qs&&Dt(`${c.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===pe.kind&&(Ee=[Xs*Q.compositeTextSizes[0].evaluate(E,{},ee),Xs*Q.compositeTextSizes[1].evaluate(E,{},ee)],(Ee[0]>Qs||Ee[1]>Qs)&&Dt(`${c.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),c.addSymbols(c.text,de,Ee,k,M,E,V,r,O.lineStartIndex,O.lineLength,K,ee);for(const $e of H)$[$e]=c.text.placedSymbolArray.length-1;return 4*de.length}function Uf(c){for(const r in c)return c[r];return null}function Cg(c,r,d,g){const v=c.compareText;if(r in v){const M=v[r];for(let E=M.length-1;E>=0;E--)if(g.dist(M[E])<d)return!0}else v[r]=[];return v[r].push(g),!1}const Hf=tl.VectorTileFeature.types,al=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function gp(c,r,d,g,v,M,E,k,O,V,H,$,K){const Q=k?Math.min(Qs,Math.round(k[0])):0,ee=k?Math.min(Qs,Math.round(k[1])):0;c.emplaceBack(r,d,Math.round(32*g),Math.round(32*v),M,E,(Q<<1)+(O?1:0),ee,16*V,16*H,256*$,256*K)}function ll(c,r,d){c.emplaceBack(r.x,r.y,d),c.emplaceBack(r.x,r.y,d),c.emplaceBack(r.x,r.y,d),c.emplaceBack(r.x,r.y,d)}function Fi(c){for(const r of c.sections)if(xu(r.text))return!0;return!1}class _p{constructor(r){this.layoutVertexArray=new Sn,this.indexArray=new dr,this.programConfigurations=r,this.segments=new fn,this.dynamicLayoutVertexArray=new Yr,this.opacityVertexArray=new go,this.placedSymbolArray=new Ge}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(r,d,g,v){this.isEmpty()||(g&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,pg.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,d),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,fg.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,al,!0),this.opacityVertexBuffer.itemSize=1),(g||v)&&this.programConfigurations.upload(r))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Gt("SymbolBuffers",_p);class yp{constructor(r,d,g){this.layoutVertexArray=new r,this.layoutAttributes=d,this.indexArray=new g,this.segments=new fn,this.collisionVertexArray=new _o}upload(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,ps.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Gt("CollisionBuffers",yp);class jc{constructor(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(E=>E.id),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Tu([]),this.placementViewportMatrix=Tu([]);const d=this.layers[0]._unevaluatedLayout._values;this.textSizeData=pp(this.zoom,d["text-size"]),this.iconSizeData=pp(this.zoom,d["icon-size"]);const g=this.layers[0].layout,v=g.get("symbol-sort-key"),M=g.get("symbol-z-order");this.canOverlap="never"!==hh(g,"text-overlap","text-allow-overlap")||"never"!==hh(g,"icon-overlap","icon-allow-overlap")||g.get("text-ignore-placement")||g.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==M&&!v.isConstant(),this.sortFeaturesByY=("viewport-y"===M||"auto"===M&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===g.get("symbol-placement")&&(this.writingModes=g.get("text-writing-mode").map(E=>x.WritingMode[E])),this.stateDependentLayerIds=this.layers.filter(E=>E.isStateDependent()).map(E=>E.id),this.sourceID=r.sourceID}createArrays(){this.text=new _p(new ha(this.layers,this.zoom,r=>/^text/.test(r))),this.icon=new _p(new ha(this.layers,this.zoom,r=>/^icon/.test(r))),this.glyphOffsetArray=new ot,this.lineVertexArray=new Zt,this.symbolInstances=new mt}calculateGlyphDependencies(r,d,g,v,M){for(let E=0;E<r.length;E++)if(d[r.charCodeAt(E)]=!0,(g||v)&&M){const k=ju[r.charAt(E)];k&&(d[k.charCodeAt(0)]=!0)}}populate(r,d,g){const v=this.layers[0],M=v.layout,E=M.get("text-font"),k=M.get("text-field"),O=M.get("icon-image"),V=("constant"!==k.value.kind||k.value.value instanceof le&&!k.value.value.isEmpty()||k.value.value.toString().length>0)&&("constant"!==E.value.kind||E.value.value.length>0),H="constant"!==O.value.kind||!!O.value.value||Object.keys(O.parameters).length>0,$=M.get("symbol-sort-key");if(this.features=[],!V&&!H)return;const K=d.iconDependencies,Q=d.glyphDependencies,ee=d.availableImages,de=new Jt(this.zoom);for(const{feature:pe,id:Ee,index:$e,sourceLayerIndex:ze}of r){const Ke=v._featureFilter.needGeometry,ct=Xa(pe,Ke);if(!v._featureFilter.filter(de,ct,g))continue;let rt,Nt;if(Ke||(ct.geometry=Vl(pe)),V){const Vt=v.getValueAndResolveTokens("text-field",ct,g,ee),Bt=le.factory(Vt);Fi(Bt)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===zt()||this.hasRTLText&&tr.isParsed())&&(rt=mg(Bt,v,ct))}if(H){const Vt=v.getValueAndResolveTokens("icon-image",ct,g,ee);Nt=Vt instanceof we?Vt:we.fromString(Vt)}if(!rt&&!Nt)continue;const ei=this.sortFeaturesByKey?$.evaluate(ct,{},g):void 0;if(this.features.push({id:Ee,text:rt,icon:Nt,index:$e,sourceLayerIndex:ze,geometry:ct.geometry,properties:pe.properties,type:Hf[pe.type],sortKey:ei}),Nt&&(K[Nt.name]=!0),rt){const Vt=E.evaluate(ct,{},g).join(","),Bt="map"===M.get("text-rotation-alignment")&&"point"!==M.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(x.WritingMode.vertical)>=0;for(const It of rt.sections)if(It.image)K[It.image.name]=!0;else{const jt=Cc(rt.toString()),Lt=It.fontStack||Vt,_t=Q[Lt]=Q[Lt]||{};this.calculateGlyphDependencies(It.text,_t,Bt,this.allowVerticalPlacement,jt)}}}"line"===M.get("symbol-placement")&&(this.features=function(pe){const Ee={},$e={},ze=[];let Ke=0;function ct(Vt){ze.push(pe[Vt]),Ke++}function rt(Vt,Bt,It){const jt=$e[Vt];return delete $e[Vt],$e[Bt]=jt,ze[jt].geometry[0].pop(),ze[jt].geometry[0]=ze[jt].geometry[0].concat(It[0]),jt}function Nt(Vt,Bt,It){const jt=Ee[Bt];return delete Ee[Bt],Ee[Vt]=jt,ze[jt].geometry[0].shift(),ze[jt].geometry[0]=It[0].concat(ze[jt].geometry[0]),jt}function ei(Vt,Bt,It){const jt=It?Bt[0][Bt[0].length-1]:Bt[0][0];return`${Vt}:${jt.x}:${jt.y}`}for(let Vt=0;Vt<pe.length;Vt++){const Bt=pe[Vt],It=Bt.geometry,jt=Bt.text?Bt.text.toString():null;if(!jt){ct(Vt);continue}const Lt=ei(jt,It),_t=ei(jt,It,!0);if(Lt in $e&&_t in Ee&&$e[Lt]!==Ee[_t]){const hi=Nt(Lt,_t,It),li=rt(Lt,_t,ze[hi].geometry);delete Ee[Lt],delete $e[_t],$e[ei(jt,ze[li].geometry,!0)]=li,ze[hi].geometry=null}else Lt in $e?rt(Lt,_t,It):_t in Ee?Nt(Lt,_t,It):(ct(Vt),Ee[Lt]=Ke-1,$e[_t]=Ke-1)}return ze.filter(Vt=>Vt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((pe,Ee)=>pe.sortKey-Ee.sortKey)}update(r,d,g){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(r,d,this.layers,g),this.icon.programConfigurations.updatePaintArrays(r,d,this.layers,g))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(r){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(r,d){const g=this.lineVertexArray.length;if(void 0!==r.segment){let v=r.dist(d[r.segment+1]),M=r.dist(d[r.segment]);const E={};for(let k=r.segment+1;k<d.length;k++)E[k]={x:d[k].x,y:d[k].y,tileUnitDistanceFromAnchor:v},k<d.length-1&&(v+=d[k+1].dist(d[k]));for(let k=r.segment||0;k>=0;k--)E[k]={x:d[k].x,y:d[k].y,tileUnitDistanceFromAnchor:M},k>0&&(M+=d[k-1].dist(d[k]));for(let k=0;k<d.length;k++){const O=E[k];this.lineVertexArray.emplaceBack(O.x,O.y,O.tileUnitDistanceFromAnchor)}}return{lineStartIndex:g,lineLength:this.lineVertexArray.length-g}}addSymbols(r,d,g,v,M,E,k,O,V,H,$,K){const Q=r.indexArray,ee=r.layoutVertexArray,de=r.segments.prepareSegment(4*d.length,ee,Q,this.canOverlap?E.sortKey:void 0),pe=this.glyphOffsetArray.length,Ee=de.vertexLength,$e=this.allowVerticalPlacement&&k===x.WritingMode.vertical?Math.PI/2:0,ze=E.text&&E.text.sections;for(let Ke=0;Ke<d.length;Ke++){const{tl:ct,tr:rt,bl:Nt,br:ei,tex:Vt,pixelOffsetTL:Bt,pixelOffsetBR:It,minFontScaleX:jt,minFontScaleY:Lt,glyphOffset:_t,isSDF:hi,sectionIndex:li}=d[Ke],Gi=de.vertexLength,cn=_t[1];gp(ee,O.x,O.y,ct.x,cn+ct.y,Vt.x,Vt.y,g,hi,Bt.x,Bt.y,jt,Lt),gp(ee,O.x,O.y,rt.x,cn+rt.y,Vt.x+Vt.w,Vt.y,g,hi,It.x,Bt.y,jt,Lt),gp(ee,O.x,O.y,Nt.x,cn+Nt.y,Vt.x,Vt.y+Vt.h,g,hi,Bt.x,It.y,jt,Lt),gp(ee,O.x,O.y,ei.x,cn+ei.y,Vt.x+Vt.w,Vt.y+Vt.h,g,hi,It.x,It.y,jt,Lt),ll(r.dynamicLayoutVertexArray,O,$e),Q.emplaceBack(Gi,Gi+1,Gi+2),Q.emplaceBack(Gi+1,Gi+2,Gi+3),de.vertexLength+=4,de.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(_t[0]),Ke!==d.length-1&&li===d[Ke+1].sectionIndex||r.programConfigurations.populatePaintArrays(ee.length,E,E.index,{},K,ze&&ze[li])}r.placedSymbolArray.emplaceBack(O.x,O.y,pe,this.glyphOffsetArray.length-pe,Ee,V,H,O.segment,g?g[0]:0,g?g[1]:0,v[0],v[1],k,0,!1,0,$)}_addCollisionDebugVertex(r,d,g,v,M,E){return d.emplaceBack(0,0),r.emplaceBack(g.x,g.y,v,M,Math.round(E.x),Math.round(E.y))}addCollisionDebugVertices(r,d,g,v,M,E,k){const O=M.segments.prepareSegment(4,M.layoutVertexArray,M.indexArray),V=O.vertexLength,H=M.layoutVertexArray,$=M.collisionVertexArray,K=k.anchorX,Q=k.anchorY;this._addCollisionDebugVertex(H,$,E,K,Q,new Oe(r,d)),this._addCollisionDebugVertex(H,$,E,K,Q,new Oe(g,d)),this._addCollisionDebugVertex(H,$,E,K,Q,new Oe(g,v)),this._addCollisionDebugVertex(H,$,E,K,Q,new Oe(r,v)),O.vertexLength+=4;const ee=M.indexArray;ee.emplaceBack(V,V+1),ee.emplaceBack(V+1,V+2),ee.emplaceBack(V+2,V+3),ee.emplaceBack(V+3,V),O.primitiveLength+=4}addDebugCollisionBoxes(r,d,g,v){for(let M=r;M<d;M++){const E=this.collisionBoxArray.get(M);this.addCollisionDebugVertices(E.x1,E.y1,E.x2,E.y2,v?this.textCollisionBox:this.iconCollisionBox,E.anchorPoint,g)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new yp(ln,ap.members,us),this.iconCollisionBox=new yp(ln,ap.members,us);for(let r=0;r<this.symbolInstances.length;r++){const d=this.symbolInstances.get(r);this.addDebugCollisionBoxes(d.textBoxStartIndex,d.textBoxEndIndex,d,!0),this.addDebugCollisionBoxes(d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d,!0),this.addDebugCollisionBoxes(d.iconBoxStartIndex,d.iconBoxEndIndex,d,!1),this.addDebugCollisionBoxes(d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex,d,!1)}}_deserializeCollisionBoxesForSymbol(r,d,g,v,M,E,k,O,V){const H={};for(let $=d;$<g;$++){const K=r.get($);H.textBox={x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,anchorPointX:K.anchorPointX,anchorPointY:K.anchorPointY},H.textFeatureIndex=K.featureIndex;break}for(let $=v;$<M;$++){const K=r.get($);H.verticalTextBox={x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,anchorPointX:K.anchorPointX,anchorPointY:K.anchorPointY},H.verticalTextFeatureIndex=K.featureIndex;break}for(let $=E;$<k;$++){const K=r.get($);H.iconBox={x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,anchorPointX:K.anchorPointX,anchorPointY:K.anchorPointY},H.iconFeatureIndex=K.featureIndex;break}for(let $=O;$<V;$++){const K=r.get($);H.verticalIconBox={x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,anchorPointX:K.anchorPointX,anchorPointY:K.anchorPointY},H.verticalIconFeatureIndex=K.featureIndex;break}return H}deserializeCollisionBoxes(r){this.collisionArrays=[];for(let d=0;d<this.symbolInstances.length;d++){const g=this.symbolInstances.get(d);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,g.textBoxStartIndex,g.textBoxEndIndex,g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g.iconBoxStartIndex,g.iconBoxEndIndex,g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(r,d){const g=r.placedSymbolArray.get(d),v=g.vertexStartIndex+4*g.numGlyphs;for(let M=g.vertexStartIndex;M<v;M+=4)r.indexArray.emplaceBack(M,M+1,M+2),r.indexArray.emplaceBack(M+1,M+2,M+3)}getSortedSymbolIndexes(r){if(this.sortedAngle===r&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const d=Math.sin(r),g=Math.cos(r),v=[],M=[],E=[];for(let k=0;k<this.symbolInstances.length;++k){E.push(k);const O=this.symbolInstances.get(k);v.push(0|Math.round(d*O.anchorX+g*O.anchorY)),M.push(O.featureIndex)}return E.sort((k,O)=>v[k]-v[O]||M[O]-M[k]),E}addToSortKeyRanges(r,d){const g=this.sortKeyRanges[this.sortKeyRanges.length-1];g&&g.sortKey===d?g.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:d,symbolInstanceStart:r,symbolInstanceEnd:r+1})}sortFeatures(r){if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const d of this.symbolInstanceIndexes){const g=this.symbolInstances.get(d);this.featureSortOrder.push(g.featureIndex),[g.rightJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.leftJustifiedTextSymbolIndex].forEach((v,M,E)=>{v>=0&&E.indexOf(v)===M&&this.addIndicesForPlacedSymbol(this.text,v)}),g.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,g.verticalPlacedTextSymbolIndex),g.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,g.placedIconSymbolIndex),g.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,g.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Gt("SymbolBucket",jc,{omit:["layers","collisionBoxArray","features","compareText"]}),jc.MAX_GLYPHS=65535,jc.addDynamicAttributes=ll;const vp=new qr({"symbol-placement":new Wt(Xe.layout_symbol["symbol-placement"]),"symbol-spacing":new Wt(Xe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Wt(Xe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Mt(Xe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Wt(Xe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Wt(Xe.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Wt(Xe.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Wt(Xe.layout_symbol["icon-ignore-placement"]),"icon-optional":new Wt(Xe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Wt(Xe.layout_symbol["icon-rotation-alignment"]),"icon-size":new Mt(Xe.layout_symbol["icon-size"]),"icon-text-fit":new Wt(Xe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Wt(Xe.layout_symbol["icon-text-fit-padding"]),"icon-image":new Mt(Xe.layout_symbol["icon-image"]),"icon-rotate":new Mt(Xe.layout_symbol["icon-rotate"]),"icon-padding":new Wt(Xe.layout_symbol["icon-padding"]),"icon-keep-upright":new Wt(Xe.layout_symbol["icon-keep-upright"]),"icon-offset":new Mt(Xe.layout_symbol["icon-offset"]),"icon-anchor":new Mt(Xe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Wt(Xe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Wt(Xe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Wt(Xe.layout_symbol["text-rotation-alignment"]),"text-field":new Mt(Xe.layout_symbol["text-field"]),"text-font":new Mt(Xe.layout_symbol["text-font"]),"text-size":new Mt(Xe.layout_symbol["text-size"]),"text-max-width":new Mt(Xe.layout_symbol["text-max-width"]),"text-line-height":new Wt(Xe.layout_symbol["text-line-height"]),"text-letter-spacing":new Mt(Xe.layout_symbol["text-letter-spacing"]),"text-justify":new Mt(Xe.layout_symbol["text-justify"]),"text-radial-offset":new Mt(Xe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Wt(Xe.layout_symbol["text-variable-anchor"]),"text-anchor":new Mt(Xe.layout_symbol["text-anchor"]),"text-max-angle":new Wt(Xe.layout_symbol["text-max-angle"]),"text-writing-mode":new Wt(Xe.layout_symbol["text-writing-mode"]),"text-rotate":new Mt(Xe.layout_symbol["text-rotate"]),"text-padding":new Wt(Xe.layout_symbol["text-padding"]),"text-keep-upright":new Wt(Xe.layout_symbol["text-keep-upright"]),"text-transform":new Mt(Xe.layout_symbol["text-transform"]),"text-offset":new Mt(Xe.layout_symbol["text-offset"]),"text-allow-overlap":new Wt(Xe.layout_symbol["text-allow-overlap"]),"text-overlap":new Wt(Xe.layout_symbol["text-overlap"]),"text-ignore-placement":new Wt(Xe.layout_symbol["text-ignore-placement"]),"text-optional":new Wt(Xe.layout_symbol["text-optional"])});var _s={paint:new qr({"icon-opacity":new Mt(Xe.paint_symbol["icon-opacity"]),"icon-color":new Mt(Xe.paint_symbol["icon-color"]),"icon-halo-color":new Mt(Xe.paint_symbol["icon-halo-color"]),"icon-halo-width":new Mt(Xe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Mt(Xe.paint_symbol["icon-halo-blur"]),"icon-translate":new Wt(Xe.paint_symbol["icon-translate"]),"icon-translate-anchor":new Wt(Xe.paint_symbol["icon-translate-anchor"]),"text-opacity":new Mt(Xe.paint_symbol["text-opacity"]),"text-color":new Mt(Xe.paint_symbol["text-color"],{runtimeType:sr,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new Mt(Xe.paint_symbol["text-halo-color"]),"text-halo-width":new Mt(Xe.paint_symbol["text-halo-width"]),"text-halo-blur":new Mt(Xe.paint_symbol["text-halo-blur"]),"text-translate":new Wt(Xe.paint_symbol["text-translate"]),"text-translate-anchor":new Wt(Xe.paint_symbol["text-translate-anchor"])}),layout:vp};class bp{constructor(r){this.type=r.property.overrides?r.property.overrides.runtimeType:Zn,this.defaultValue=r}evaluate(r){if(r.formattedSection){const d=this.defaultValue.property.overrides;if(d&&d.hasOverride(r.formattedSection))return d.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default}eachChild(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Gt("FormatSectionOverride",bp,{omit:["defaultValue"]});class dh extends mo{constructor(r){super(r,_s)}recalculate(r,d){if(super.recalculate(r,d),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){const g=this.layout.get("text-writing-mode");if(g){const v=[];for(const M of g)v.indexOf(M)<0&&v.push(M);this.layout._values["text-writing-mode"]=v}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(r,d,g,v){const M=this.layout.get(r).evaluate(d,{},g,v),E=this._unevaluatedLayout._values[r];return E.isDataDriven()||Sl(E.value)||!M?M:(k=d.properties,M.replace(/{([^{}]+)}/g,(V,H)=>H in k?String(k[H]):""));var k}createBucket(r){return new jc(r)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const r of _s.paint.overridableProperties){if(!dh.hasPaintOverride(this.layout,r))continue;const d=this.paint.get(r),g=new bp(d),v=new mu(g,d.property.specification);let M=null;M="constant"===d.value.kind||"source"===d.value.kind?new gu("source",v):new dt("composite",v,d.value.zoomStops,d.value._interpolationType),this.paint._values[r]=new fo(d.property,M,d.parameters)}}_handleOverridablePaintPropertyUpdate(r,d,g){return!(!this.layout||d.isDataDriven()||g.isDataDriven())&&dh.hasPaintOverride(this.layout,r)}static hasPaintOverride(r,d){const g=r.get("text-field"),v=_s.paint.properties[d];let M=!1;const E=k=>{for(const O of k)if(v.overrides&&v.overrides.hasOverride(O))return void(M=!0)};if("constant"===g.value.kind&&g.value.value instanceof le)E(g.value.value.sections);else if("source"===g.value.kind){const k=V=>{M||(V instanceof at&&be(V.value)===ar?E(V.value.sections):V instanceof Ct?E(V.sections):V.eachChild(k))},O=g.value;O._styleExpression&&k(O._styleExpression.expression)}return M}}function hh(c,r,d){let g="never";const v=c.get(r);return v?g=v:c.get(d)&&(g="always"),g}var va={paint:new qr({"background-color":new Wt(Xe.paint_background["background-color"]),"background-pattern":new Ys(Xe.paint_background["background-pattern"]),"background-opacity":new Wt(Xe.paint_background["background-opacity"])})},Wl={paint:new qr({"raster-opacity":new Wt(Xe.paint_raster["raster-opacity"]),"raster-hue-rotate":new Wt(Xe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Wt(Xe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Wt(Xe.paint_raster["raster-brightness-max"]),"raster-saturation":new Wt(Xe.paint_raster["raster-saturation"]),"raster-contrast":new Wt(Xe.paint_raster["raster-contrast"]),"raster-resampling":new Wt(Xe.paint_raster["raster-resampling"]),"raster-fade-duration":new Wt(Xe.paint_raster["raster-fade-duration"])})};class Mg extends mo{constructor(r){super(r,{}),this.onAdd=d=>{this.implementation.onAdd&&this.implementation.onAdd(d,d.painter.context.gl)},this.onRemove=d=>{this.implementation.onRemove&&this.implementation.onRemove(d,d.painter.context.gl)},this.implementation=r}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}}const Gf={circle:class extends mo{constructor(c){super(c,Ul)}createBucket(c){return new Nr(c)}queryRadius(c){const r=c;return Su("circle-radius",this,r)+Su("circle-stroke-width",this,r)+jl(this.paint.get("circle-translate"))}queryIntersectsFeature(c,r,d,g,v,M,E,k){const O=Ks(c,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),M.angle,E),V=this.paint.get("circle-radius").evaluate(r,d)+this.paint.get("circle-stroke-width").evaluate(r,d),H="map"===this.paint.get("circle-pitch-alignment"),$=H?O:(ee=k,O.map(de=>Wh(de,ee))),K=H?V*E:V;var ee;for(const Q of g)for(const ee of Q){const de=H?ee:Wh(ee,k);let pe=K;const Ee=ku(Au(),Iu(ee.x,ee.y,0,1),k);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?pe*=Ee[3]/M.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(pe*=M.cameraToCenterDistance/Ee[3]),Wd($,de,pe))return!0}return!1}},heatmap:class extends mo{constructor(c){super(c,eg),this._updateColorRamp()}createBucket(c){return new Fs(c)}_handleSpecialPaintPropertyUpdate(c){"heatmap-color"===c&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Gl({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}},hillshade:class extends mo{constructor(c){super(c,yf)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}},fill:class extends mo{constructor(c){super(c,tp)}recalculate(c,r){super.recalculate(c,r);const d=this.paint._values["fill-outline-color"];"constant"===d.value.kind&&void 0===d.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new ql(c)}queryRadius(){return jl(this.paint.get("fill-translate"))}queryIntersectsFeature(c,r,d,g,v,M,E){return Mu(Ks(c,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),M.angle,E),g)}isTileClipped(){return!0}},"fill-extrusion":class extends mo{constructor(c){super(c,Ef)}createBucket(c){return new np(c)}queryRadius(){return jl(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(c,r,d,g,v,M,E,k){const O=Ks(c,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),M.angle,E),V=this.paint.get("fill-extrusion-height").evaluate(r,d),H=this.paint.get("fill-extrusion-base").evaluate(r,d),$=function(Q,ee,de,pe){const Ee=[];for(const $e of Q){const ze=Iu($e.x,$e.y,0,1);ku(ze,ze,ee),Ee.push(new Oe(ze[0]/ze[3],ze[1]/ze[3]))}return Ee}(O,k),K=function(Q,ee,de,pe){const Ee=[],$e=[],ze=pe[8]*ee,Ke=pe[9]*ee,ct=pe[10]*ee,rt=pe[11]*ee,Nt=pe[8]*de,ei=pe[9]*de,Vt=pe[10]*de,Bt=pe[11]*de;for(const It of Q){const jt=[],Lt=[];for(const _t of It){const hi=_t.x,li=_t.y,Gi=pe[0]*hi+pe[4]*li+pe[12],cn=pe[1]*hi+pe[5]*li+pe[13],An=pe[2]*hi+pe[6]*li+pe[14],In=pe[3]*hi+pe[7]*li+pe[15],Qr=An+ct,or=In+rt,pr=Gi+Nt,Ar=cn+ei,yn=An+Vt,Jr=In+Bt,Io=new Oe((Gi+ze)/or,(cn+Ke)/or);Io.z=Qr/or,jt.push(Io);const _r=new Oe(pr/Jr,Ar/Jr);_r.z=yn/Jr,Lt.push(_r)}Ee.push(jt),$e.push(Lt)}return[Ee,$e]}(g,H,V,k);return function(Q,ee,de){let pe=1/0;Mu(de,ee)&&(pe=op(de,ee[0]));for(let Ee=0;Ee<ee.length;Ee++){const $e=ee[Ee],ze=Q[Ee];for(let Ke=0;Ke<$e.length-1;Ke++){const ct=$e[Ke],rt=[ct,$e[Ke+1],ze[Ke+1],ze[Ke],ct];Yd(de,rt)&&(pe=Math.min(pe,op(de,rt)))}}return pe!==1/0&&pe}(K[0],K[1],$)}},line:class extends mo{constructor(c){super(c,Af),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(c){"line-gradient"===c&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof cc,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(c,r){super.recalculate(c,r),this.paint._values["line-floorwidth"]=If.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new sh(c)}queryRadius(c){const r=c,d=kf(Su("line-width",this,r),Su("line-gap-width",this,r)),g=Su("line-offset",this,r);return d/2+Math.abs(g)+jl(this.paint.get("line-translate"))}queryIntersectsFeature(c,r,d,g,v,M,E){const k=Ks(c,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),M.angle,E),O=E/2*kf(this.paint.get("line-width").evaluate(r,d),this.paint.get("line-gap-width").evaluate(r,d)),V=this.paint.get("line-offset").evaluate(r,d);return V&&(g=function(H,$){const K=[],Q=new Oe(0,0);for(let ee=0;ee<H.length;ee++){const de=H[ee],pe=[];for(let Ee=0;Ee<de.length;Ee++){const $e=de[Ee-1],ze=de[Ee],Ke=de[Ee+1],ct=0===Ee?Q:ze.sub($e)._unit()._perp(),rt=Ee===de.length-1?Q:Ke.sub(ze)._unit()._perp(),Nt=ct._add(rt)._unit();Nt._mult(1/(Nt.x*rt.x+Nt.y*rt.y)),pe.push(Nt._mult($)._add(ze))}K.push(pe)}return K}(g,V*E)),function(H,$,K){for(let Q=0;Q<$.length;Q++){const ee=$[Q];if(H.length>=3)for(let de=0;de<ee.length;de++)if(Eu(H,ee[de]))return!0;if(Ac(H,ee,K))return!0}return!1}(k,g,O)}isTileClipped(){return!0}},symbol:dh,background:class extends mo{constructor(c){super(c,va)}},raster:class extends mo{constructor(c){super(c,Wl)}}};class I0{constructor(r){this._callback=r,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const $f=6371008.8;class rr{constructor(r,d){if(isNaN(r)||isNaN(d))throw new Error(`Invalid LngLat object: (${r}, ${d})`);if(this.lng=+r,this.lat=+d,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new rr(Le(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(r){const d=Math.PI/180,g=this.lat*d,v=r.lat*d,M=Math.sin(g)*Math.sin(v)+Math.cos(g)*Math.cos(v)*Math.cos((r.lng-this.lng)*d);return $f*Math.acos(Math.min(M,1))}toBounds(r=0){const d=360*r/40075017,g=d/Math.cos(Math.PI/180*this.lat);return new Ur(new rr(this.lng-g,this.lat-d),new rr(this.lng+g,this.lat+d))}static convert(r){if(r instanceof rr)return r;if(Array.isArray(r)&&(2===r.length||3===r.length))return new rr(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&"object"==typeof r&&null!==r)return new rr(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Ur{constructor(r,d){r&&(d?this.setSouthWest(r).setNorthEast(d):4===r.length?this.setSouthWest([r[0],r[1]]).setNorthEast([r[2],r[3]]):this.setSouthWest(r[0]).setNorthEast(r[1]))}setNorthEast(r){return this._ne=r instanceof rr?new rr(r.lng,r.lat):rr.convert(r),this}setSouthWest(r){return this._sw=r instanceof rr?new rr(r.lng,r.lat):rr.convert(r),this}extend(r){const d=this._sw,g=this._ne;let v,M;if(r instanceof rr)v=r,M=r;else{if(!(r instanceof Ur))return Array.isArray(r)?4===r.length||r.every(Array.isArray)?this.extend(Ur.convert(r)):this.extend(rr.convert(r)):this;if(v=r._sw,M=r._ne,!v||!M)return this}return d||g?(d.lng=Math.min(v.lng,d.lng),d.lat=Math.min(v.lat,d.lat),g.lng=Math.max(M.lng,g.lng),g.lat=Math.max(M.lat,g.lat)):(this._sw=new rr(v.lng,v.lat),this._ne=new rr(M.lng,M.lat)),this}getCenter(){return new rr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new rr(this.getWest(),this.getNorth())}getSouthEast(){return new rr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(r){const{lng:d,lat:g}=rr.convert(r);let v=this._sw.lng<=d&&d<=this._ne.lng;return this._sw.lng>this._ne.lng&&(v=this._sw.lng>=d&&d>=this._ne.lng),this._sw.lat<=g&&g<=this._ne.lat&&v}static convert(r){return r instanceof Ur?r:r&&new Ur(r)}}const Zl=2*Math.PI*$f;function id(c){return Zl*Math.cos(c*Math.PI/180)}function Xr(c){return(180+c)/360}function xp(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function wp(c,r){return c/id(r)}function nd(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}class Cp{constructor(r,d,g=0){this.x=+r,this.y=+d,this.z=+g}static fromLngLat(r,d=0){const g=rr.convert(r);return new Cp(Xr(g.lng),xp(g.lat),wp(d,g.lat))}toLngLat(){return new rr(360*this.x-180,nd(this.y))}toAltitude(){return this.z*id(nd(this.y))}meterInMercatorCoordinateUnits(){return 1/Zl*(r=nd(this.y),1/Math.cos(r*Math.PI/180));var r}}function ph(c,r,d){var g=2*Math.PI*6378137/256/Math.pow(2,d);return[c*g-2*Math.PI*6378137/2,r*g-2*Math.PI*6378137/2]}class Mp{constructor(r,d,g){this.z=r,this.x=d,this.y=g,this.key=fh(0,r,r,d,g)}equals(r){return this.z===r.z&&this.x===r.x&&this.y===r.y}url(r,d,g){const v=(E=this.y,k=this.z,O=ph(256*(M=this.x),256*(E=Math.pow(2,k)-E-1),k),V=ph(256*(M+1),256*(E+1),k),O[0]+","+O[1]+","+V[0]+","+V[1]);var M,E,k,O,V;const H=function($,K,Q){let ee,de="";for(let pe=$;pe>0;pe--)ee=1<<pe-1,de+=(K&ee?1:0)+(Q&ee?2:0);return de}(this.z,this.x,this.y);return r[(this.x+this.y)%r.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===g?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,d>1?"@2x":"").replace(/{quadkey}/g,H).replace(/{bbox-epsg-3857}/g,v)}getTilePoint(r){const d=Math.pow(2,this.z);return new Oe((r.x*d-this.x)*Cn,(r.y*d-this.y)*Cn)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Dp{constructor(r,d){this.wrap=r,this.canonical=d,this.key=fh(r,d.z,d.z,d.x,d.y)}}class Bs{constructor(r,d,g,v,M){this.overscaledZ=r,this.wrap=d,this.canonical=new Mp(g,+v,+M),this.key=fh(d,r,g,v,M)}equals(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)}scaledTo(r){const d=this.canonical.z-r;return r>this.canonical.z?new Bs(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Bs(r,this.wrap,r,this.canonical.x>>d,this.canonical.y>>d)}calculateScaledKey(r,d){const g=this.canonical.z-r;return r>this.canonical.z?fh(this.wrap*+d,r,this.canonical.z,this.canonical.x,this.canonical.y):fh(this.wrap*+d,r,r,this.canonical.x>>g,this.canonical.y>>g)}isChildOf(r){if(r.wrap!==this.wrap)return!1;const d=this.canonical.z-r.canonical.z;return 0===r.overscaledZ||r.overscaledZ<this.overscaledZ&&r.canonical.x===this.canonical.x>>d&&r.canonical.y===this.canonical.y>>d}children(r){if(this.overscaledZ>=r)return[new Bs(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const d=this.canonical.z+1,g=2*this.canonical.x,v=2*this.canonical.y;return[new Bs(d,this.wrap,d,g,v),new Bs(d,this.wrap,d,g+1,v),new Bs(d,this.wrap,d,g,v+1),new Bs(d,this.wrap,d,g+1,v+1)]}isLessThan(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))}wrapped(){return new Bs(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(r){return new Bs(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Dp(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(r){return this.canonical.getTilePoint(new Cp(r.x-this.wrap,r.y))}}function fh(c,r,d,g,v){(c*=2)<0&&(c=-1*c-1);const M=1<<d;return(M*M*c+M*v+g).toString(36)+d.toString(36)+r.toString(36)}Gt("CanonicalTileID",Mp),Gt("OverscaledTileID",Bs,{omit:["posMatrix"]});class Dy{constructor(r,d,g){if(this.uid=r,d.height!==d.width)throw new RangeError("DEM tiles must be square");if(g&&"mapbox"!==g&&"terrarium"!==g)return void Dt(`"${g}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=d.height;const v=this.dim=d.height-2;this.data=new Uint32Array(d.data.buffer),this.encoding=g||"mapbox";for(let M=0;M<v;M++)this.data[this._idx(-1,M)]=this.data[this._idx(0,M)],this.data[this._idx(v,M)]=this.data[this._idx(v-1,M)],this.data[this._idx(M,-1)]=this.data[this._idx(M,0)],this.data[this._idx(M,v)]=this.data[this._idx(M,v-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(v,-1)]=this.data[this._idx(v-1,0)],this.data[this._idx(-1,v)]=this.data[this._idx(0,v-1)],this.data[this._idx(v,v)]=this.data[this._idx(v-1,v-1)]}get(r,d){const g=new Uint8Array(this.data.buffer),v=4*this._idx(r,d);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(g[v],g[v+1],g[v+2])}getUnpackVector(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(r,d){if(r<-1||r>=this.dim+1||d<-1||d>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(d+1)*this.stride+(r+1)}_unpackMapbox(r,d,g){return(256*r*256+256*d+g)/10-1e4}_unpackTerrarium(r,d,g){return 256*r+d+g/256-32768}getPixels(){return new hr({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(r,d,g){if(this.dim!==r.dim)throw new Error("dem dimension mismatch");let v=d*this.dim,M=d*this.dim+this.dim,E=g*this.dim,k=g*this.dim+this.dim;switch(d){case-1:v=M-1;break;case 1:M=v+1}switch(g){case-1:E=k-1;break;case 1:k=E+1}const O=-d*this.dim,V=-g*this.dim;for(let H=E;H<k;H++)for(let $=v;$<M;$++)this.data[this._idx($,H)]=r.data[this._idx($+O,H+V)]}}Gt("DEMData",Dy);class rd{constructor(r){this._stringToNumber={},this._numberToString=[];for(let d=0;d<r.length;d++){const g=r[d];this._stringToNumber[g]=d,this._numberToString[d]=g}}encode(r){return this._stringToNumber[r]}decode(r){return this._numberToString[r]}}class mh{constructor(r,d,g,v,M){this.type="Feature",this._vectorTileFeature=r,r._z=d,r._x=g,r._y=v,this.properties=r.properties,this.id=M}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(r){this._geometry=r}toJSON(){const r=function(d,g){var v={};for(var M in d)Object.prototype.hasOwnProperty.call(d,M)&&g.indexOf(M)<0&&(v[M]=d[M]);if(null!=d&&"function"==typeof Object.getOwnPropertySymbols){var E=0;for(M=Object.getOwnPropertySymbols(d);E<M.length;E++)g.indexOf(M[E])<0&&Object.prototype.propertyIsEnumerable.call(d,M[E])&&(v[M[E]]=d[M[E]])}return v}(this,["_geometry","_vectorTileFeature"]);return r.geometry=this.geometry,r}}class qf{constructor(r,d){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new Pl(Cn,16,0),this.grid3D=new Pl(Cn,16,0),this.featureIndexArray=new oi,this.promoteId=d}insert(r,d,g,v,M,E){const k=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(g,v,M);const O=E?this.grid3D:this.grid;for(let V=0;V<d.length;V++){const H=d[V],$=[1/0,1/0,-1/0,-1/0];for(let K=0;K<H.length;K++){const Q=H[K];$[0]=Math.min($[0],Q.x),$[1]=Math.min($[1],Q.y),$[2]=Math.max($[2],Q.x),$[3]=Math.max($[3],Q.y)}$[0]<Cn&&$[1]<Cn&&$[2]>=0&&$[3]>=0&&O.insert(k,$[0],$[1],$[2],$[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new tl.VectorTile(new Pi(this.rawTileData)).layers,this.sourceLayerCoder=new rd(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(r,d,g,v){this.loadVTLayers();const M=r.params||{},E=Cn/r.tileSize/r.scale,k=la(M.filter),O=r.queryGeometry,V=r.queryPadding*E,H=Yf(O),$=this.grid.query(H.minX-V,H.minY-V,H.maxX+V,H.maxY+V),K=Yf(r.cameraQueryGeometry),Q=this.grid3D.query(K.minX-V,K.minY-V,K.maxX+V,K.maxY+V,(pe,Ee,$e,ze)=>function(Ke,ct,rt,Nt,ei){for(const Bt of Ke)if(ct<=Bt.x&&rt<=Bt.y&&Nt>=Bt.x&&ei>=Bt.y)return!0;const Vt=[new Oe(ct,rt),new Oe(ct,ei),new Oe(Nt,ei),new Oe(Nt,rt)];if(Ke.length>2)for(const Bt of Vt)if(Eu(Ke,Bt))return!0;for(let Bt=0;Bt<Ke.length-1;Bt++)if(Jm(Ke[Bt],Ke[Bt+1],Vt))return!0;return!1}(r.cameraQueryGeometry,pe-V,Ee-V,$e+V,ze+V));for(const pe of Q)$.push(pe);$.sort(Dg);const ee={};let de;for(let pe=0;pe<$.length;pe++){const Ee=$[pe];if(Ee===de)continue;de=Ee;const $e=this.featureIndexArray.get(Ee);let ze=null;this.loadMatchingFeature(ee,$e.bucketIndex,$e.sourceLayerIndex,$e.featureIndex,k,M.layers,M.availableImages,d,g,v,(Ke,ct,rt)=>(ze||(ze=Vl(Ke)),ct.queryIntersectsFeature(O,Ke,rt,ze,this.z,r.transform,E,r.pixelPosMatrix)))}return ee}loadMatchingFeature(r,d,g,v,M,E,k,O,V,H,$){const K=this.bucketLayerIDs[d];if(E&&!function(pe,Ee){for(let $e=0;$e<pe.length;$e++)if(Ee.indexOf(pe[$e])>=0)return!0;return!1}(E,K))return;const Q=this.sourceLayerCoder.decode(g),ee=this.vtLayers[Q].feature(v);if(M.needGeometry){const pe=Xa(ee,!0);if(!M.filter(new Jt(this.tileID.overscaledZ),pe,this.tileID.canonical))return}else if(!M.filter(new Jt(this.tileID.overscaledZ),ee))return;const de=this.getId(ee,Q);for(let pe=0;pe<K.length;pe++){const Ee=K[pe];if(E&&E.indexOf(Ee)<0)continue;const $e=O[Ee];if(!$e)continue;let ze={};de&&H&&(ze=H.getState($e.sourceLayer||"_geojsonTileLayer",de));const Ke=ke({},V[Ee]);Ke.paint=gh(Ke.paint,$e.paint,ee,ze,k),Ke.layout=gh(Ke.layout,$e.layout,ee,ze,k);const ct=!$||$(ee,$e,ze);if(!ct)continue;const rt=new mh(ee,this.z,this.x,this.y,de);rt.layer=Ke;let Nt=r[Ee];void 0===Nt&&(Nt=r[Ee]=[]),Nt.push({featureIndex:v,feature:rt,intersectionZ:ct})}}lookupSymbolFeatures(r,d,g,v,M,E,k,O){const V={};this.loadVTLayers();const H=la(M);for(const $ of r)this.loadMatchingFeature(V,g,v,$,H,E,k,O,d);return V}hasLayer(r){for(const d of this.bucketLayerIDs)for(const g of d)if(r===g)return!0;return!1}getId(r,d){let g=r.id;return this.promoteId&&(g=r.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[d]],"boolean"==typeof g&&(g=Number(g))),g}}function gh(c,r,d,g,v){return gt(c,(M,E)=>{const k=r instanceof Is?r.get(E):null;return k&&k.evaluate?k.evaluate(d,g,v):k})}function Yf(c){let r=1/0,d=1/0,g=-1/0,v=-1/0;for(const M of c)r=Math.min(r,M.x),d=Math.min(d,M.y),g=Math.max(g,M.x),v=Math.max(v,M.y);return{minX:r,minY:d,maxX:g,maxY:v}}function Dg(c,r){return r-c}var Ep;Gt("FeatureIndex",qf,{omit:["rawTileData","sourceLayerCoder"]}),x.PerformanceMarkers=void 0,(Ep=x.PerformanceMarkers||(x.PerformanceMarkers={})).create="create",Ep.load="load",Ep.fullLoad="fullLoad";let Kl=null,od=[];const Uc=1e3/30,k0={mark(c){performance.mark(c)},frame(c){const r=c;null!=Kl&&od.push(r-Kl),Kl=r},clearMetrics(){Kl=null,od=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime");for(const c in x.PerformanceMarkers)performance.clearMarks(x.PerformanceMarkers[c])},getPerformanceMetrics(){performance.measure("loadTime",x.PerformanceMarkers.create,x.PerformanceMarkers.load),performance.measure("fullLoadTime",x.PerformanceMarkers.create,x.PerformanceMarkers.fullLoad);const c=performance.getEntriesByName("loadTime")[0].duration,r=performance.getEntriesByName("fullLoadTime")[0].duration,d=od.length,g=1/(od.reduce((M,E)=>M+E,0)/d/1e3),v=od.filter(M=>M>Uc).reduce((M,E)=>M+(E-Uc)/Uc,0);return{loadTime:c,fullLoadTime:r,fps:g,percentDroppedFrames:v/(d+v)*100}}};x.AJAXError=ns,x.ARRAY_TYPE=Hl,x.Actor=class{constructor(c,r,d){this.target=c,this.parent=r,this.mapId=d,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},yt(["receive","process"],this),this.invoker=new I0(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=xt()?c:window}send(c,r,d,g,v=!1){const M=Math.round(1e18*Math.random()).toString(36).substring(0,10);d&&(this.callbacks[M]=d);const E=xi(this.globalScope)?void 0:[];return this.target.postMessage({id:M,type:c,hasCallback:!!d,targetMapId:g,mustQueue:v,sourceMapId:this.mapId,data:Gs(r,E)},E),{cancel:()=>{d&&delete this.callbacks[M],this.target.postMessage({id:M,type:"<cancel>",targetMapId:g,sourceMapId:this.mapId})}}}receive(c){const r=c.data,d=r.id;if(d&&(!r.targetMapId||this.mapId===r.targetMapId))if("<cancel>"===r.type){delete this.tasks[d];const g=this.cancelCallbacks[d];delete this.cancelCallbacks[d],g&&g()}else xt()||r.mustQueue?(this.tasks[d]=r,this.taskQueue.push(d),this.invoker.trigger()):this.processTask(d,r)}process(){if(!this.taskQueue.length)return;const c=this.taskQueue.shift(),r=this.tasks[c];delete this.tasks[c],this.taskQueue.length&&this.invoker.trigger(),r&&this.processTask(c,r)}processTask(c,r){if("<response>"===r.type){const d=this.callbacks[c];delete this.callbacks[c],d&&(r.error?d(ua(r.error)):d(null,ua(r.data)))}else{let d=!1;const g=xi(this.globalScope)?void 0:[],v=r.hasCallback?(k,O)=>{d=!0,delete this.cancelCallbacks[c],this.target.postMessage({id:c,type:"<response>",sourceMapId:this.mapId,error:k?Gs(k):null,data:Gs(O,g)},g)}:k=>{d=!0};let M=null;const E=ua(r.data);if(this.parent[r.type])M=this.parent[r.type](r.sourceMapId,E,v);else if(this.parent.getWorkerSource){const k=r.type.split(".");M=this.parent.getWorkerSource(r.sourceMapId,k[0],E.source)[k[1]](E,v)}else v(new Error(`Could not find function ${r.type}`));!d&&M&&M.cancel&&(this.cancelCallbacks[c]=M.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},x.AlphaImage=Qa,x.CanonicalTileID=Mp,x.CollisionBoxArray=Je,x.CollisionCircleLayoutArray=class extends N{},x.Color=U,x.DEMData=Dy,x.DataConstantProperty=Wt,x.DictionaryCoder=rd,x.EXTENT=Cn,x.ErrorEvent=xr,x.EvaluationParameters=Jt,x.Event=Po,x.Evented=wr,x.FeatureIndex=qf,x.FillBucket=ql,x.FillExtrusionBucket=np,x.GeoJSONFeature=mh,x.ImageAtlas=Lc,x.ImagePosition=jo,x.LineBucket=sh,x.LineStripIndexArray=class extends De{},x.LngLat=rr,x.LngLatBounds=Ur,x.MercatorCoordinate=Cp,x.ONE_EM=24,x.OverscaledTileID=Bs,x.PerformanceUtils=k0,x.PosArray=class extends Bl{},x.Properties=qr,x.QuadTriangleArray=class extends q{},x.RGBAImage=hr,x.RasterBoundsArray=class extends Ec{},x.RequestPerformance=class{constructor(c){this._marks={start:[c.url,"start"].join("#"),end:[c.url,"end"].join("#"),measure:c.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let c=performance.getEntriesByName(this._marks.measure);return 0===c.length&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),c=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),c}},x.ResourceType=is,x.SegmentVector=fn,x.SymbolBucket=jc,x.Transitionable=qh,x.TriangleIndexArray=dr,x.Uniform1f=Zo,x.Uniform1i=class extends Ps{constructor(c,r){super(c,r),this.current=0}set(c){this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}},x.Uniform2f=class extends Ps{constructor(c,r){super(c,r),this.current=[0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1]))}},x.Uniform3f=class extends Ps{constructor(c,r){super(c,r),this.current=[0,0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2]))}},x.Uniform4f=Sc,x.UniformColor=Os,x.UniformMatrix4f=class extends Ps{constructor(c,r){super(c,r),this.current=Yh}set(c){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let r=1;r<16;r++)if(c[r]!==this.current[r]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}},x.UnwrappedTileID=Dp,x.ValidationError=Pt,x.ZoomHistory=Ua,x.addDynamicAttributes=ll,x.asyncAll=function(c,r,d){if(!c.length)return d(null,[]);let g=c.length;const v=new Array(c.length);let M=null;c.forEach((E,k)=>{r(E,(O,V)=>{O&&(M=O),v[k]=V,0==--g&&d(M,v)})})},x.bezier=ye,x.bindAll=yt,x.cacheEntryPossiblyAdded=function(c){Pr++,Pr>si&&(c.getActor().send("enforceCacheSizeLimit",br),Pr=0)},x.clamp=ne,x.clearTileCache=function(c){const r=caches.delete(Ze);c&&r.catch(c).then(()=>c())},x.clipLine=vg,x.clone=function(c){var r=new Hl(16);return r[0]=c[0],r[1]=c[1],r[2]=c[2],r[3]=c[3],r[4]=c[4],r[5]=c[5],r[6]=c[6],r[7]=c[7],r[8]=c[8],r[9]=c[9],r[10]=c[10],r[11]=c[11],r[12]=c[12],r[13]=c[13],r[14]=c[14],r[15]=c[15],r},x.clone$1=Tt,x.collisionCircleLayout=Rf,x.config=Et,x.create=function(){var c=new Hl(16);return Hl!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c},x.createExpression=fc,x.createFilter=la,x.createLayout=xn,x.createStyleLayer=function(c){return"custom"===c.type?new Mg(c):new Gf[c.type](c)},x.dot=function(c,r){return c[0]*r[0]+c[1]*r[1]+c[2]*r[2]+c[3]*r[3]},x.ease=xe,x.emitValidationErrors=Gh,x.enforceCacheSizeLimit=function(c){_i(),Ci&&Ci.then(r=>{r.keys().then(d=>{for(let g=0;g<d.length-c;g++)r.delete(d[g])})})},x.evaluateSizeForFeature=Zu,x.evaluateSizeForZoom=ms,x.evaluateVariableOffset=Xo,x.evented=Ol,x.exported=et,x.exported$1=hn,x.extend=ke,x.filterObject=vt,x.fromValues=Iu,x.getAnchorAlignment=ch,x.getAnchorJustification=td,x.getArrayBuffer=oo,x.getImage=mr,x.getJSON=function(c,r){return Ro(ke(c,{type:"json"}),r)},x.getOverlapMode=hh,x.getRTLTextPluginStatus=zt,x.getReferrer=Jn,x.getVideo=function(c,r){const d=window.document.createElement("video");d.muted=!0,d.onloadstart=function(){r(null,d)};for(let g=0;g<c.length;g++){const v=window.document.createElement("source");Eo(c[g])||(d.crossOrigin="Anonymous"),v.src=c[g],d.appendChild(v)}return{cancel:()=>{}}},x.identity=Tu,x.invert=function(c,r){var d=r[0],g=r[1],v=r[2],M=r[3],E=r[4],k=r[5],O=r[6],V=r[7],H=r[8],$=r[9],K=r[10],Q=r[11],ee=r[12],de=r[13],pe=r[14],Ee=r[15],$e=d*k-g*E,ze=d*O-v*E,Ke=d*V-M*E,ct=g*O-v*k,rt=g*V-M*k,Nt=v*V-M*O,ei=H*de-$*ee,Vt=H*pe-K*ee,Bt=H*Ee-Q*ee,It=$*pe-K*de,jt=$*Ee-Q*de,Lt=K*Ee-Q*pe,_t=$e*Lt-ze*jt+Ke*It+ct*Bt-rt*Vt+Nt*ei;return _t?(c[0]=(k*Lt-O*jt+V*It)*(_t=1/_t),c[1]=(v*jt-g*Lt-M*It)*_t,c[2]=(de*Nt-pe*rt+Ee*ct)*_t,c[3]=(K*rt-$*Nt-Q*ct)*_t,c[4]=(O*Bt-E*Lt-V*Vt)*_t,c[5]=(d*Lt-v*Bt+M*Vt)*_t,c[6]=(pe*Ke-ee*Nt-Ee*ze)*_t,c[7]=(H*Nt-K*Ke+Q*ze)*_t,c[8]=(E*jt-k*Bt+V*ei)*_t,c[9]=(g*Bt-d*jt-M*ei)*_t,c[10]=(ee*rt-de*Ke+Ee*$e)*_t,c[11]=($*Ke-H*rt-Q*$e)*_t,c[12]=(k*Vt-E*It-O*ei)*_t,c[13]=(d*It-g*Vt+v*ei)*_t,c[14]=(de*ze-ee*ct-pe*$e)*_t,c[15]=(H*ct-$*ze+K*$e)*_t,c):null},x.isImageBitmap=Ue,x.isSafari=xi,x.keysDifference=function(c,r){const d=[];for(const g in c)g in r||d.push(g);return d},x.lazyLoadRTLTextPlugin=function(){tr.isLoading()||tr.isLoaded()||"deferred"!==zt()||Ei()},x.makeRequest=Ro,x.mapObject=gt,x.mercatorXfromLng=Xr,x.mercatorYfromLat=xp,x.mercatorZfromAltitude=wp,x.mul=Kd,x.multiply=_f,x.nextPowerOfTwo=function(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))},x.number=lr,x.ortho=function(c,r,d,g,v,M,E){var k=1/(r-d),O=1/(g-v),V=1/(M-E);return c[0]=-2*k,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*O,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*V,c[11]=0,c[12]=(r+d)*k,c[13]=(v+g)*O,c[14]=(E+M)*V,c[15]=1,c},x.parseCacheControl=ut,x.parseGlyphPBF=function(c){return new Pi(c).readFields(Bf,[])},x.pbf=Pi,x.performSymbolLayout=function(c,r,d,g,v,M,E){c.createArrays(),c.tilePixelRatio=Cn/(512*c.overscaling),c.compareText={},c.iconsNeedLinear=!1;const k=c.layers[0].layout,O=c.layers[0]._unevaluatedLayout._values,V={layoutIconSize:O["icon-size"].possiblyEvaluate(new Jt(c.zoom+1),E),layoutTextSize:O["text-size"].possiblyEvaluate(new Jt(c.zoom+1),E),textMaxSize:O["text-size"].possiblyEvaluate(new Jt(18))};if("composite"===c.textSizeData.kind){const{minZoom:ee,maxZoom:de}=c.textSizeData;V.compositeTextSizes=[O["text-size"].possiblyEvaluate(new Jt(ee),E),O["text-size"].possiblyEvaluate(new Jt(de),E)]}if("composite"===c.iconSizeData.kind){const{minZoom:ee,maxZoom:de}=c.iconSizeData;V.compositeIconSizes=[O["icon-size"].possiblyEvaluate(new Jt(ee),E),O["icon-size"].possiblyEvaluate(new Jt(de),E)]}const H=24*k.get("text-line-height"),$="map"===k.get("text-rotation-alignment")&&"point"!==k.get("symbol-placement"),K=k.get("text-keep-upright"),Q=k.get("text-size");for(const ee of c.features){const de=k.get("text-font").evaluate(ee,{},E).join(","),pe=Q.evaluate(ee,{},E),Ee=V.layoutTextSize.evaluate(ee,{},E),$e=V.layoutIconSize.evaluate(ee,{},E),ze={horizontal:{},vertical:void 0},Ke=ee.text;let ct,rt=[0,0];if(Ke){const Vt=Ke.toString(),Bt=24*k.get("text-letter-spacing").evaluate(ee,{},E),It=pf(Vt)?Bt:0,jt=k.get("text-anchor").evaluate(ee,{},E),Lt=k.get("text-variable-anchor");if(!Lt){const cn=k.get("text-radial-offset").evaluate(ee,{},E);rt=cn?Xo(jt,[24*cn,mp]):k.get("text-offset").evaluate(ee,{},E).map(An=>24*An)}let _t=$?"center":k.get("text-justify").evaluate(ee,{},E);const hi=k.get("symbol-placement"),li="point"===hi?24*k.get("text-max-width").evaluate(ee,{},E):0,Gi=()=>{c.allowVerticalPlacement&&Cc(Vt)&&(ze.vertical=Gu(Ke,r,d,v,de,li,H,jt,"left",It,rt,x.WritingMode.vertical,!0,hi,Ee,pe))};if(!$&&Lt){const cn="auto"===_t?Lt.map(In=>td(In)):[_t];let An=!1;for(let In=0;In<cn.length;In++){const Qr=cn[In];if(!ze.horizontal[Qr])if(An)ze.horizontal[Qr]=ze.horizontal[0];else{const or=Gu(Ke,r,d,v,de,li,H,"center",Qr,It,rt,x.WritingMode.horizontal,!1,hi,Ee,pe);or&&(ze.horizontal[Qr]=or,An=1===or.positionedLines.length)}}Gi()}else{"auto"===_t&&(_t=td(jt));const cn=Gu(Ke,r,d,v,de,li,H,jt,_t,It,rt,x.WritingMode.horizontal,!1,hi,Ee,pe);cn&&(ze.horizontal[_t]=cn),Gi(),Cc(Vt)&&$&&K&&(ze.vertical=Gu(Ke,r,d,v,de,li,H,jt,_t,It,rt,x.WritingMode.vertical,!1,hi,Ee,pe))}}let Nt=!1;if(ee.icon&&ee.icon.name){const Vt=g[ee.icon.name];Vt&&(ct=yg(v[ee.icon.name],k.get("icon-offset").evaluate(ee,{},E),k.get("icon-anchor").evaluate(ee,{},E)),Nt=!!Vt.sdf,void 0===c.sdfIcons?c.sdfIcons=Nt:c.sdfIcons!==Nt&&Dt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Vt.pixelRatio!==c.pixelRatio||0!==k.get("icon-rotate").constantOr(1))&&(c.iconsNeedLinear=!0))}const ei=Uf(ze.horizontal)||ze.vertical;c.iconsInText=!!ei&&ei.iconsInText,(ei||ct)&&ya(c,ee,ze,ct,g,V,Ee,$e,rt,Nt,E)}M&&c.generateCollisionDebugBuffers()},x.perspective=function(c,r,d,g,v){var M,E=1/Math.tan(r/2);return c[0]=E/d,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=E,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,null!=v&&v!==1/0?(c[10]=(v+g)*(M=1/(g-v)),c[14]=2*v*g*M):(c[10]=-1,c[14]=-2*g),c},x.pick=function(c,r){const d={};for(let g=0;g<r.length;g++){const v=r[g];v in c&&(d[v]=c[v])}return d},x.plugin=tr,x.pointGeometry=Oe,x.polygonIntersectsPolygon=Yd,x.potpack=dp,x.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],x.register=Gt,x.registerForPluginStateChange=function(c){return c({pluginStatus:En,pluginURL:an}),Ol.on("pluginStateChange",c),c},x.renderColorRamp=Gl,x.rotateX=function(c,r,d){var g=Math.sin(d),v=Math.cos(d),M=r[4],E=r[5],k=r[6],O=r[7],V=r[8],H=r[9],$=r[10],K=r[11];return r!==c&&(c[0]=r[0],c[1]=r[1],c[2]=r[2],c[3]=r[3],c[12]=r[12],c[13]=r[13],c[14]=r[14],c[15]=r[15]),c[4]=M*v+V*g,c[5]=E*v+H*g,c[6]=k*v+$*g,c[7]=O*v+K*g,c[8]=V*v-M*g,c[9]=H*v-E*g,c[10]=$*v-k*g,c[11]=K*v-O*g,c},x.rotateZ=function(c,r,d){var g=Math.sin(d),v=Math.cos(d),M=r[0],E=r[1],k=r[2],O=r[3],V=r[4],H=r[5],$=r[6],K=r[7];return r!==c&&(c[8]=r[8],c[9]=r[9],c[10]=r[10],c[11]=r[11],c[12]=r[12],c[13]=r[13],c[14]=r[14],c[15]=r[15]),c[0]=M*v+V*g,c[1]=E*v+H*g,c[2]=k*v+$*g,c[3]=O*v+K*g,c[4]=V*v-M*g,c[5]=H*v-E*g,c[6]=$*v-k*g,c[7]=K*v-O*g,c},x.scale=function(c,r,d){var g=d[0],v=d[1],M=d[2];return c[0]=r[0]*g,c[1]=r[1]*g,c[2]=r[2]*g,c[3]=r[3]*g,c[4]=r[4]*v,c[5]=r[5]*v,c[6]=r[6]*v,c[7]=r[7]*v,c[8]=r[8]*M,c[9]=r[9]*M,c[10]=r[10]*M,c[11]=r[11]*M,c[12]=r[12],c[13]=r[13],c[14]=r[14],c[15]=r[15],c},x.scale$1=function(c,r,d){return c[0]=r[0]*d,c[1]=r[1]*d,c[2]=r[2]*d,c[3]=r[3]*d,c},x.setCacheLimits=function(c,r){br=c,si=r},x.setRTLTextPlugin=function(c,r,d=!1){if(En===Mc||En===wu||En===Cu)throw new Error("setRTLTextPlugin cannot be called multiple times.");an=et.resolveURL(c),En=Mc,Hd=r,As(),d||Ei()},x.spec=Xe,x.sphericalToCartesian=function([c,r,d]){return r+=90,r*=Math.PI/180,d*=Math.PI/180,{x:c*Math.cos(r)*Math.sin(d),y:c*Math.sin(r)*Math.sin(d),z:c*Math.cos(d)}},x.symbolSize=Ko,x.toEvaluationFeature=Xa,x.transformMat4=ku,x.translate=function(c,r,d){var g,v,M,E,k,O,V,H,$,K,Q,ee,de=d[0],pe=d[1],Ee=d[2];return r===c?(c[12]=r[0]*de+r[4]*pe+r[8]*Ee+r[12],c[13]=r[1]*de+r[5]*pe+r[9]*Ee+r[13],c[14]=r[2]*de+r[6]*pe+r[10]*Ee+r[14],c[15]=r[3]*de+r[7]*pe+r[11]*Ee+r[15]):(v=r[1],M=r[2],E=r[3],k=r[4],O=r[5],V=r[6],H=r[7],$=r[8],K=r[9],Q=r[10],ee=r[11],c[0]=g=r[0],c[1]=v,c[2]=M,c[3]=E,c[4]=k,c[5]=O,c[6]=V,c[7]=H,c[8]=$,c[9]=K,c[10]=Q,c[11]=ee,c[12]=g*de+k*pe+$*Ee+r[12],c[13]=v*de+O*pe+K*Ee+r[13],c[14]=M*de+V*pe+Q*Ee+r[14],c[15]=E*de+H*pe+ee*Ee+r[15]),c},x.triggerPluginCompletionEvent=zi,x.unicodeBlockLookup=Ft,x.uniqueId=function(){return Be++},x.validateCustomStyleLayer=function(c){const r=[],d=c.id;return void 0===d&&r.push({message:`layers.${d}: missing required property "id"`}),void 0===c.render&&r.push({message:`layers.${d}: missing required method "render"`}),c.renderingMode&&"2d"!==c.renderingMode&&"3d"!==c.renderingMode&&r.push({message:`layers.${d}: property "renderingMode" must be either "2d" or "3d"`}),r},x.validateLight=Bo,x.validateStyle=ur,x.vectorTile=tl,x.warnOnce=Dt,x.wrap=Le}),Te(0,function(x){function Me(re){const z=typeof re;if("number"===z||"boolean"===z||"string"===z||null==re)return JSON.stringify(re);if(Array.isArray(re)){let ie="[";for(const le of re)ie+=`${Me(le)},`;return`${ie}]`}const U=Object.keys(re).sort();let J="{";for(let ie=0;ie<U.length;ie++)J+=`${JSON.stringify(U[ie])}:${Me(re[U[ie]])},`;return`${J}}`}function Pe(re){let z="";for(const U of x.refProperties)z+=`/${Me(re[U])}`;return z}class ye{constructor(z){this.keyCache={},z&&this.replace(z)}replace(z){this._layerConfigs={},this._layers={},this.update(z,[])}update(z,U){for(const ie of z){this._layerConfigs[ie.id]=ie;const le=this._layers[ie.id]=x.createStyleLayer(ie);le._featureFilter=x.createFilter(le.filter),this.keyCache[ie.id]&&delete this.keyCache[ie.id]}for(const ie of U)delete this.keyCache[ie],delete this._layerConfigs[ie],delete this._layers[ie];this.familiesBySource={};const J=function(ie,le){const we={};for(let me=0;me<ie.length;me++){const be=le&&le[ie[me].id]||Pe(ie[me]);le&&(le[ie[me].id]=be);let He=we[be];He||(He=we[be]=[]),He.push(ie[me])}const fe=[];for(const me in we)fe.push(we[me]);return fe}(Object.values(this._layerConfigs),this.keyCache);for(const ie of J){const le=ie.map(at=>this._layers[at.id]),we=le[0];if("none"===we.visibility)continue;const fe=we.source||"";let me=this.familiesBySource[fe];me||(me=this.familiesBySource[fe]={});const be=we.sourceLayer||"_geojsonTileLayer";let He=me[be];He||(He=me[be]=[]),He.push(le)}}}class xe{constructor(z){const U={},J=[];for(const fe in z){const me=z[fe],be=U[fe]={};for(const He in me){const at=me[+He];if(!at||0===at.bitmap.width||0===at.bitmap.height)continue;const je={x:0,y:0,w:at.bitmap.width+2,h:at.bitmap.height+2};J.push(je),be[He]={rect:je,metrics:at.metrics}}}const{w:ie,h:le}=x.potpack(J),we=new x.AlphaImage({width:ie||1,height:le||1});for(const fe in z){const me=z[fe];for(const be in me){const He=me[+be];if(!He||0===He.bitmap.width||0===He.bitmap.height)continue;const at=U[fe][be].rect;x.AlphaImage.copy(He.bitmap,we,{x:0,y:0},{x:at.x+1,y:at.y+1},He.bitmap)}}this.image=we,this.positions=U}}x.register("GlyphAtlas",xe);class ne{constructor(z){this.tileID=new x.OverscaledTileID(z.tileID.overscaledZ,z.tileID.wrap,z.tileID.canonical.z,z.tileID.canonical.x,z.tileID.canonical.y),this.uid=z.uid,this.zoom=z.zoom,this.pixelRatio=z.pixelRatio,this.tileSize=z.tileSize,this.source=z.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=z.showCollisionBoxes,this.collectResourceTiming=!!z.collectResourceTiming,this.returnDependencies=!!z.returnDependencies,this.promoteId=z.promoteId}parse(z,U,J,ie,le){this.status="parsing",this.data=z,this.collisionBoxArray=new x.CollisionBoxArray;const we=new x.DictionaryCoder(Object.keys(z.layers).sort()),fe=new x.FeatureIndex(this.tileID,this.promoteId);fe.bucketLayerIDs=[];const me={},be={featureIndex:fe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:J},He=U.familiesBySource[this.source];for(const wi in He){const Xt=z.layers[wi];if(!Xt)continue;1===Xt.version&&x.warnOnce(`Vector tile source "${this.source}" layer "${wi}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const bi=we.encode(wi),on=[];for(let ri=0;ri<Xt.length;ri++){const $n=Xt.feature(ri),Lr=fe.getId($n,wi);on.push({feature:$n,id:Lr,index:ri,sourceLayerIndex:bi})}for(const ri of He[wi]){const $n=ri[0];$n.minzoom&&this.zoom<Math.floor($n.minzoom)||$n.maxzoom&&this.zoom>=$n.maxzoom||"none"!==$n.visibility&&(Le(ri,this.zoom,J),(me[$n.id]=$n.createBucket({index:fe.bucketLayerIDs.length,layers:ri,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:bi,sourceID:this.source})).populate(on,be,this.tileID.canonical),fe.bucketLayerIDs.push(ri.map(Lr=>Lr.id)))}}let at,je,We,lt;const Ct=x.mapObject(be.glyphDependencies,wi=>Object.keys(wi).map(Number));Object.keys(Ct).length?ie.send("getGlyphs",{uid:this.uid,stacks:Ct},(wi,Xt)=>{at||(at=wi,je=Xt,fi.call(this))}):je={};const Yt=Object.keys(be.iconDependencies);Yt.length?ie.send("getImages",{icons:Yt,source:this.source,tileID:this.tileID,type:"icons"},(wi,Xt)=>{at||(at=wi,We=Xt,fi.call(this))}):We={};const Ri=Object.keys(be.patternDependencies);function fi(){if(at)return le(at);if(je&&We&&lt){const wi=new xe(je),Xt=new x.ImageAtlas(We,lt);for(const bi in me){const on=me[bi];on instanceof x.SymbolBucket?(Le(on.layers,this.zoom,J),x.performSymbolLayout(on,je,wi.positions,We,Xt.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):on.hasPattern&&(on instanceof x.LineBucket||on instanceof x.FillBucket||on instanceof x.FillExtrusionBucket)&&(Le(on.layers,this.zoom,J),on.addFeatures(be,this.tileID.canonical,Xt.patternPositions))}this.status="done",le(null,{buckets:Object.values(me).filter(bi=>!bi.isEmpty()),featureIndex:fe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:wi.image,imageAtlas:Xt,glyphMap:this.returnDependencies?je:null,iconMap:this.returnDependencies?We:null,glyphPositions:this.returnDependencies?wi.positions:null})}}Ri.length?ie.send("getImages",{icons:Ri,source:this.source,tileID:this.tileID,type:"patterns"},(wi,Xt)=>{at||(at=wi,lt=Xt,fi.call(this))}):lt={},fi.call(this)}}function Le(re,z,U){const J=new x.EvaluationParameters(z);for(const ie of re)ie.recalculate(J,U)}function ke(re,z){const U=x.getArrayBuffer(re.request,(J,ie,le,we)=>{J?z(J):ie&&z(null,{vectorTile:new x.vectorTile.VectorTile(new x.pbf(ie)),rawData:ie,cacheControl:le,expires:we})});return()=>{U.cancel(),z()}}class Be{constructor(z,U,J,ie){this.actor=z,this.layerIndex=U,this.availableImages=J,this.loadVectorData=ie||ke,this.loading={},this.loaded={}}loadTile(z,U){const J=z.uid;this.loading||(this.loading={});const ie=!!(z&&z.request&&z.request.collectResourceTiming)&&new x.RequestPerformance(z.request),le=this.loading[J]=new ne(z);le.abort=this.loadVectorData(z,(we,fe)=>{if(delete this.loading[J],we||!fe)return le.status="done",this.loaded[J]=le,U(we);const me=fe.rawData,be={};fe.expires&&(be.expires=fe.expires),fe.cacheControl&&(be.cacheControl=fe.cacheControl);const He={};if(ie){const at=ie.finish();at&&(He.resourceTiming=JSON.parse(JSON.stringify(at)))}le.vectorTile=fe.vectorTile,le.parse(fe.vectorTile,this.layerIndex,this.availableImages,this.actor,(at,je)=>{if(at||!je)return U(at);U(null,x.extend({rawTileData:me.slice(0)},je,be,He))}),this.loaded=this.loaded||{},this.loaded[J]=le})}reloadTile(z,U){const J=this.loaded,ie=z.uid,le=this;if(J&&J[ie]){const we=J[ie];we.showCollisionBoxes=z.showCollisionBoxes;const fe=(me,be)=>{const He=we.reloadCallback;He&&(delete we.reloadCallback,we.parse(we.vectorTile,le.layerIndex,this.availableImages,le.actor,He)),U(me,be)};"parsing"===we.status?we.reloadCallback=fe:"done"===we.status&&(we.vectorTile?we.parse(we.vectorTile,this.layerIndex,this.availableImages,this.actor,fe):fe())}}abortTile(z,U){const J=this.loading,ie=z.uid;J&&J[ie]&&J[ie].abort&&(J[ie].abort(),delete J[ie]),U()}removeTile(z,U){const J=this.loaded,ie=z.uid;J&&J[ie]&&delete J[ie],U()}}class yt{constructor(){this.loaded={}}loadTile(z,U){const{uid:J,encoding:ie,rawImageData:le}=z,we=x.isImageBitmap(le)?this.getImageData(le):le,fe=new x.DEMData(J,we,ie);this.loaded=this.loaded||{},this.loaded[J]=fe,U(null,fe)}getImageData(z){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(z.width,z.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=z.width,this.offscreenCanvas.height=z.height,this.offscreenCanvasContext.drawImage(z,0,0,z.width,z.height);const U=this.offscreenCanvasContext.getImageData(-1,-1,z.width+2,z.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new x.RGBAImage({width:U.width,height:U.height},U.data)}removeTile(z){const U=this.loaded,J=z.uid;U&&U[J]&&delete U[J]}}var gt=function re(z,U){var J,ie=z&&z.type;if("FeatureCollection"===ie)for(J=0;J<z.features.length;J++)re(z.features[J],U);else if("GeometryCollection"===ie)for(J=0;J<z.geometries.length;J++)re(z.geometries[J],U);else if("Feature"===ie)re(z.geometry,U);else if("Polygon"===ie)vt(z.coordinates,U);else if("MultiPolygon"===ie)for(J=0;J<z.coordinates.length;J++)vt(z.coordinates[J],U);return z};function vt(re,z){if(0!==re.length){Tt(re[0],z);for(var U=1;U<re.length;U++)Tt(re[U],!z)}}function Tt(re,z){for(var U=0,J=0,ie=0,le=re.length,we=le-1;ie<le;we=ie++){var fe=(re[ie][0]-re[we][0])*(re[we][1]+re[ie][1]),me=U+fe;J+=Math.abs(U)>=Math.abs(fe)?U-me+fe:fe-me+U,U=me}U+J>=0!=!!z&&re.reverse()}const nt=x.vectorTile.VectorTileFeature.prototype.toGeoJSON;class Dt{constructor(z){this._feature=z,this.extent=x.EXTENT,this.type=z.type,this.properties=z.tags,"id"in z&&!isNaN(z.id)&&(this.id=parseInt(z.id,10))}loadGeometry(){if(1===this._feature.type){const z=[];for(const U of this._feature.geometry)z.push([new x.pointGeometry(U[0],U[1])]);return z}{const z=[];for(const U of this._feature.geometry){const J=[];for(const ie of U)J.push(new x.pointGeometry(ie[0],ie[1]));z.push(J)}return z}}toGeoJSON(z,U,J){return nt.call(this,z,U,J)}}class Ht{constructor(z){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=x.EXTENT,this.length=z.length,this._features=z}feature(z){return new Dt(this._features[z])}}var $t={exports:{}},xt=x.pointGeometry,ut=x.vectorTile.VectorTileFeature,kt=qt;function qt(re,z){this.options=z||{},this.features=re,this.length=re.length}function ni(re,z){this.id="number"==typeof re.id?re.id:void 0,this.type=re.type,this.rawGeometry=1===re.type?[re.geometry]:re.geometry,this.properties=re.tags,this.extent=z||4096}qt.prototype.feature=function(re){return new ni(this.features[re],this.options.extent)},ni.prototype.loadGeometry=function(){var re=this.rawGeometry;this.geometry=[];for(var z=0;z<re.length;z++){for(var U=re[z],J=[],ie=0;ie<U.length;ie++)J.push(new xt(U[ie][0],U[ie][1]));this.geometry.push(J)}return this.geometry},ni.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var re=this.geometry,z=1/0,U=-1/0,J=1/0,ie=-1/0,le=0;le<re.length;le++)for(var we=re[le],fe=0;fe<we.length;fe++){var me=we[fe];z=Math.min(z,me.x),U=Math.max(U,me.x),J=Math.min(J,me.y),ie=Math.max(ie,me.y)}return[z,J,U,ie]},ni.prototype.toGeoJSON=ut.prototype.toGeoJSON;var xi=x.pbf,Ue=kt;function et(re){var z=new xi;return function(U,J){for(var ie in U.layers)J.writeMessage(3,Oe,U.layers[ie])}(re,z),z.finish()}function Oe(re,z){var U;z.writeVarintField(15,re.version||1),z.writeStringField(1,re.name||""),z.writeVarintField(5,re.extent||4096);var J={keys:[],values:[],keycache:{},valuecache:{}};for(U=0;U<re.length;U++)J.feature=re.feature(U),z.writeMessage(2,Qe,J);var ie=J.keys;for(U=0;U<ie.length;U++)z.writeStringField(3,ie[U]);var le=J.values;for(U=0;U<le.length;U++)z.writeMessage(4,br,le[U])}function Qe(re,z){var U=re.feature;void 0!==U.id&&z.writeVarintField(1,U.id),z.writeMessage(2,Et,re),z.writeVarintField(3,U.type),z.writeMessage(4,tn,U)}function Et(re,z){var U=re.feature,J=re.keys,ie=re.values,le=re.keycache,we=re.valuecache;for(var fe in U.properties){var me=U.properties[fe],be=le[fe];if(null!==me){void 0===be&&(J.push(fe),le[fe]=be=J.length-1),z.writeVarint(be);var He=typeof me;"string"!==He&&"boolean"!==He&&"number"!==He&&(me=JSON.stringify(me));var at=He+":"+me,je=we[at];void 0===je&&(ie.push(me),we[at]=je=ie.length-1),z.writeVarint(je)}}}function Ze(re,z){return(z<<3)+(7&re)}function Ci(re){return re<<1^re>>31}function tn(re,z){for(var U=re.loadGeometry(),J=re.type,ie=0,le=0,we=U.length,fe=0;fe<we;fe++){var me=U[fe],be=1;1===J&&(be=me.length),z.writeVarint(Ze(1,be));for(var He=3===J?me.length-1:me.length,at=0;at<He;at++){1===at&&1!==J&&z.writeVarint(Ze(2,He-1));var je=me[at].x-ie,We=me[at].y-le;z.writeVarint(Ci(je)),z.writeVarint(Ci(We)),ie+=je,le+=We}3===J&&z.writeVarint(Ze(7,1))}}function br(re,z){var U=typeof re;"string"===U?z.writeStringField(1,re):"boolean"===U?z.writeBooleanField(7,re):"number"===U&&(re%1!=0?z.writeDoubleField(3,re):re<0?z.writeSVarintField(6,re):z.writeVarintField(5,re))}$t.exports=et,$t.exports.fromVectorTileJs=et,$t.exports.fromGeojsonVt=function(re,z){z=z||{};var U={};for(var J in re)U[J]=new Ue(re[J].features,z),U[J].name=J,U[J].version=z.version,U[J].extent=z.extent;return et({layers:U})},$t.exports.GeoJSONWrapper=Ue;var si=$t.exports;function _i(re,z,U,J,ie,le){if(ie-J<=U)return;const we=J+ie>>1;Pr(re,z,we,J,ie,le%2),_i(re,z,U,J,we-1,le+1),_i(re,z,U,we+1,ie,le+1)}function Pr(re,z,U,J,ie,le){for(;ie>J;){if(ie-J>600){const be=ie-J+1,He=U-J+1,at=Math.log(be),je=.5*Math.exp(2*at/3),We=.5*Math.sqrt(at*je*(be-je)/be)*(He-be/2<0?-1:1);Pr(re,z,U,Math.max(J,Math.floor(U-He*je/be+We)),Math.min(ie,Math.floor(U+(be-He)*je/be+We)),le)}const we=z[2*U+le];let fe=J,me=ie;for(hn(re,z,J,U),z[2*ie+le]>we&&hn(re,z,J,ie);fe<me;){for(hn(re,z,fe,me),fe++,me--;z[2*fe+le]<we;)fe++;for(;z[2*me+le]>we;)me--}z[2*J+le]===we?hn(re,z,J,me):(me++,hn(re,z,me,ie)),me<=U&&(J=me+1),U<=me&&(ie=me-1)}}function hn(re,z,U,J){Gn(re,U,J),Gn(z,2*U,2*J),Gn(z,2*U+1,2*J+1)}function Gn(re,z,U){const J=re[z];re[z]=re[U],re[U]=J}function Qi(re,z,U,J){const ie=re-U,le=z-J;return ie*ie+le*le}const Mo=re=>re[0],Do=re=>re[1];class Wn{constructor(z,U=Mo,J=Do,ie=64,le=Float64Array){this.nodeSize=ie,this.points=z;const we=z.length<65536?Uint16Array:Uint32Array,fe=this.ids=new we(z.length),me=this.coords=new le(2*z.length);for(let be=0;be<z.length;be++)fe[be]=be,me[2*be]=U(z[be]),me[2*be+1]=J(z[be]);_i(fe,me,ie,0,fe.length-1,0)}range(z,U,J,ie){return function(le,we,fe,me,be,He,at){const je=[0,le.length-1,0],We=[];let lt,Ct;for(;je.length;){const Yt=je.pop(),Ri=je.pop(),fi=je.pop();if(Ri-fi<=at){for(let bi=fi;bi<=Ri;bi++)lt=we[2*bi],Ct=we[2*bi+1],lt>=fe&&lt<=be&&Ct>=me&&Ct<=He&&We.push(le[bi]);continue}const wi=Math.floor((fi+Ri)/2);lt=we[2*wi],Ct=we[2*wi+1],lt>=fe&&lt<=be&&Ct>=me&&Ct<=He&&We.push(le[wi]);const Xt=(Yt+1)%2;(0===Yt?fe<=lt:me<=Ct)&&(je.push(fi),je.push(wi-1),je.push(Xt)),(0===Yt?be>=lt:He>=Ct)&&(je.push(wi+1),je.push(Ri),je.push(Xt))}return We}(this.ids,this.coords,z,U,J,ie,this.nodeSize)}within(z,U,J){return function(ie,le,we,fe,me,be){const He=[0,ie.length-1,0],at=[],je=me*me;for(;He.length;){const We=He.pop(),lt=He.pop(),Ct=He.pop();if(lt-Ct<=be){for(let Xt=Ct;Xt<=lt;Xt++)Qi(le[2*Xt],le[2*Xt+1],we,fe)<=je&&at.push(ie[Xt]);continue}const Yt=Math.floor((Ct+lt)/2),Ri=le[2*Yt],fi=le[2*Yt+1];Qi(Ri,fi,we,fe)<=je&&at.push(ie[Yt]);const wi=(We+1)%2;(0===We?we-me<=Ri:fe-me<=fi)&&(He.push(Ct),He.push(Yt-1),He.push(wi)),(0===We?we+me>=Ri:fe+me>=fi)&&(He.push(Yt+1),He.push(lt),He.push(wi))}return at}(this.ids,this.coords,z,U,J,this.nodeSize)}}const is={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:re=>re},ns=Math.fround||(Jn=new Float32Array(1),re=>(Jn[0]=+re,Jn[0]));var Jn;class Cs{constructor(z){this.options=er(Object.create(is),z),this.trees=new Array(this.options.maxZoom+1)}load(z){const{log:U,minZoom:J,maxZoom:ie,nodeSize:le}=this.options;U&&console.time("total time");const we=`prepare ${z.length} points`;U&&console.time(we),this.points=z;let fe=[];for(let me=0;me<z.length;me++)z[me].geometry&&fe.push(oo(z[me],me));this.trees[ie+1]=new Wn(fe,Hi,Po,le,Float32Array),U&&console.timeEnd(we);for(let me=ie;me>=J;me--){const be=+Date.now();fe=this._cluster(fe,me),this.trees[me]=new Wn(fe,Hi,Po,le,Float32Array),U&&console.log("z%d: %d clusters in %dms",me,fe.length,+Date.now()-be)}return U&&console.timeEnd("total time"),this}getClusters(z,U){let J=((z[0]+180)%360+360)%360-180;const ie=Math.max(-90,Math.min(90,z[1]));let le=180===z[2]?180:((z[2]+180)%360+360)%360-180;const we=Math.max(-90,Math.min(90,z[3]));if(z[2]-z[0]>=360)J=-180,le=180;else if(J>le){const He=this.getClusters([J,ie,180,we],U),at=this.getClusters([-180,ie,le,we],U);return He.concat(at)}const fe=this.trees[this._limitZoom(U)],me=fe.range(pi(J),Or(we),pi(le),Or(ie)),be=[];for(const He of me){const at=fe.points[He];be.push(at.numPoints?Eo(at):this.points[at.index])}return be}getChildren(z){const U=this._getOriginId(z),J=this._getOriginZoom(z),ie="No cluster with the specified id.",le=this.trees[J];if(!le)throw new Error(ie);const we=le.points[U];if(!we)throw new Error(ie);const fe=this.options.radius/(this.options.extent*Math.pow(2,J-1)),me=le.within(we.x,we.y,fe),be=[];for(const He of me){const at=le.points[He];at.parentId===z&&be.push(at.numPoints?Eo(at):this.points[at.index])}if(0===be.length)throw new Error(ie);return be}getLeaves(z,U,J){const ie=[];return this._appendLeaves(ie,z,U=U||10,J=J||0,0),ie}getTile(z,U,J){const ie=this.trees[this._limitZoom(z)],le=Math.pow(2,z),{extent:we,radius:fe}=this.options,me=fe/we,be=(J-me)/le,He=(J+1+me)/le,at={features:[]};return this._addTileFeatures(ie.range((U-me)/le,be,(U+1+me)/le,He),ie.points,U,J,le,at),0===U&&this._addTileFeatures(ie.range(1-me/le,be,1,He),ie.points,le,J,le,at),U===le-1&&this._addTileFeatures(ie.range(0,be,me/le,He),ie.points,-1,J,le,at),at.features.length?at:null}getClusterExpansionZoom(z){let U=this._getOriginZoom(z)-1;for(;U<=this.options.maxZoom;){const J=this.getChildren(z);if(U++,1!==J.length)break;z=J[0].properties.cluster_id}return U}_appendLeaves(z,U,J,ie,le){const we=this.getChildren(U);for(const fe of we){const me=fe.properties;if(me&&me.cluster?le+me.point_count<=ie?le+=me.point_count:le=this._appendLeaves(z,me.cluster_id,J,ie,le):le<ie?le++:z.push(fe),z.length===J)break}return le}_addTileFeatures(z,U,J,ie,le,we){for(const fe of z){const me=U[fe],be=me.numPoints;let He,at,je;if(be)He=rs(me),at=me.x,je=me.y;else{const Ct=this.points[me.index];He=Ct.properties,at=pi(Ct.geometry.coordinates[0]),je=Or(Ct.geometry.coordinates[1])}const We={type:1,geometry:[[Math.round(this.options.extent*(at*le-J)),Math.round(this.options.extent*(je*le-ie))]],tags:He};let lt;be?lt=me.id:this.options.generateId?lt=me.index:this.points[me.index].id&&(lt=this.points[me.index].id),void 0!==lt&&(We.id=lt),we.features.push(We)}}_limitZoom(z){return Math.max(this.options.minZoom,Math.min(+z,this.options.maxZoom+1))}_cluster(z,U){const J=[],{radius:ie,extent:le,reduce:we,minPoints:fe}=this.options,me=ie/(le*Math.pow(2,U));for(let be=0;be<z.length;be++){const He=z[be];if(He.zoom<=U)continue;He.zoom=U;const at=this.trees[U+1],je=at.within(He.x,He.y,me),We=He.numPoints||1;let lt=We;for(const Ct of je){const Yt=at.points[Ct];Yt.zoom>U&&(lt+=Yt.numPoints||1)}if(lt>We&&lt>=fe){let Ct=He.x*We,Yt=He.y*We,Ri=we&&We>1?this._map(He,!0):null;const fi=(be<<5)+(U+1)+this.points.length;for(const wi of je){const Xt=at.points[wi];if(Xt.zoom<=U)continue;Xt.zoom=U;const bi=Xt.numPoints||1;Ct+=Xt.x*bi,Yt+=Xt.y*bi,Xt.parentId=fi,we&&(Ri||(Ri=this._map(He,!0)),we(Ri,this._map(Xt)))}He.parentId=fi,J.push(Ro(Ct/lt,Yt/lt,fi,lt,Ri))}else if(J.push(He),lt>1)for(const Ct of je){const Yt=at.points[Ct];Yt.zoom<=U||(Yt.zoom=U,J.push(Yt))}}return J}_getOriginId(z){return z-this.points.length>>5}_getOriginZoom(z){return(z-this.points.length)%32}_map(z,U){if(z.numPoints)return U?er({},z.properties):z.properties;const J=this.points[z.index].properties,ie=this.options.map(J);return U&&ie===J?er({},ie):ie}}function Ro(re,z,U,J,ie){return{x:ns(re),y:ns(z),zoom:1/0,id:U,parentId:-1,numPoints:J,properties:ie}}function oo(re,z){const[U,J]=re.geometry.coordinates;return{x:ns(pi(U)),y:ns(Or(J)),zoom:1/0,index:z,parentId:-1}}function Eo(re){return{type:"Feature",id:re.id,properties:rs(re),geometry:{type:"Point",coordinates:[(z=re.x,360*(z-.5)),mr(re.y)]}};var z}function rs(re){const z=re.numPoints,U=z>=1e4?`${Math.round(z/1e3)}k`:z>=1e3?Math.round(z/100)/10+"k":z;return er(er({},re.properties),{cluster:!0,cluster_id:re.id,point_count:z,point_count_abbreviated:U})}function pi(re){return re/360+.5}function Or(re){const z=Math.sin(re*Math.PI/180),U=.5-.25*Math.log((1+z)/(1-z))/Math.PI;return U<0?0:U>1?1:U}function mr(re){const z=(180-360*re)*Math.PI/180;return 360*Math.atan(Math.exp(z))/Math.PI-90}function er(re,z){for(const U in z)re[U]=z[U];return re}function Hi(re){return re.x}function Po(re){return re.y}function xr(re,z,U,J){for(var ie,le=J,we=U-z>>1,fe=U-z,me=re[z],be=re[z+1],He=re[U],at=re[U+1],je=z+3;je<U;je+=3){var We=wr(re[je],re[je+1],me,be,He,at);if(We>le)ie=je,le=We;else if(We===le){var lt=Math.abs(je-we);lt<fe&&(ie=je,fe=lt)}}le>J&&(ie-z>3&&xr(re,z,ie,J),re[ie+2]=le,U-ie>3&&xr(re,ie,U,J))}function wr(re,z,U,J,ie,le){var we=ie-U,fe=le-J;if(0!==we||0!==fe){var me=((re-U)*we+(z-J)*fe)/(we*we+fe*fe);me>1?(U=ie,J=le):me>0&&(U+=we*me,J+=fe*me)}return(we=re-U)*we+(fe=z-J)*fe}function Xe(re,z,U,J){var ie={id:void 0===re?null:re,type:z,geometry:U,tags:J,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(le){var we=le.geometry,fe=le.type;if("Point"===fe||"MultiPoint"===fe||"LineString"===fe)Pt(le,we);else if("Polygon"===fe||"MultiLineString"===fe)for(var me=0;me<we.length;me++)Pt(le,we[me]);else if("MultiPolygon"===fe)for(me=0;me<we.length;me++)for(var be=0;be<we[me].length;be++)Pt(le,we[me][be])}(ie),ie}function Pt(re,z){for(var U=0;U<z.length;U+=3)re.minX=Math.min(re.minX,z[U]),re.minY=Math.min(re.minY,z[U+1]),re.maxX=Math.max(re.maxX,z[U]),re.maxY=Math.max(re.maxY,z[U+1])}function Yi(re,z,U,J){if(z.geometry){var ie=z.geometry.coordinates,le=z.geometry.type,we=Math.pow(U.tolerance/((1<<U.maxZoom)*U.extent),2),fe=[],me=z.id;if(U.promoteId?me=z.properties[U.promoteId]:U.generateId&&(me=J||0),"Point"===le)ai(ie,fe);else if("MultiPoint"===le)for(var be=0;be<ie.length;be++)ai(ie[be],fe);else if("LineString"===le)Kt(ie,fe,we,!1);else if("MultiLineString"===le){if(U.lineMetrics){for(be=0;be<ie.length;be++)Kt(ie[be],fe=[],we,!1),re.push(Xe(me,"LineString",fe,z.properties));return}Fr(ie,fe,we,!1)}else if("Polygon"===le)Fr(ie,fe,we,!0);else{if("MultiPolygon"!==le){if("GeometryCollection"===le){for(be=0;be<z.geometry.geometries.length;be++)Yi(re,{id:me,geometry:z.geometry.geometries[be],properties:z.properties},U,J);return}throw new Error("Input data is not a valid GeoJSON object.")}for(be=0;be<ie.length;be++){var He=[];Fr(ie[be],He,we,!0),fe.push(He)}}re.push(Xe(me,le,fe,z.properties))}}function ai(re,z){z.push(gr(re[0])),z.push(Vi(re[1])),z.push(0)}function Kt(re,z,U,J){for(var ie,le,we=0,fe=0;fe<re.length;fe++){var me=gr(re[fe][0]),be=Vi(re[fe][1]);z.push(me),z.push(be),z.push(0),fe>0&&(we+=J?(ie*be-me*le)/2:Math.sqrt(Math.pow(me-ie,2)+Math.pow(be-le,2))),ie=me,le=be}var He=z.length-3;z[2]=1,xr(z,0,He,U),z[He+2]=1,z.size=Math.abs(we),z.start=0,z.end=z.size}function Fr(re,z,U,J){for(var ie=0;ie<re.length;ie++){var le=[];Kt(re[ie],le,U,J),z.push(le)}}function gr(re){return re/360+.5}function Vi(re){var z=Math.sin(re*Math.PI/180),U=.5-.25*Math.log((1+z)/(1-z))/Math.PI;return U<0?0:U>1?1:U}function Zn(re,z,U,J,ie,le,we,fe){if(J/=z,le>=(U/=z)&&we<J)return re;if(we<U||le>=J)return null;for(var me=[],be=0;be<re.length;be++){var He=re[be],at=He.geometry,je=He.type,We=0===ie?He.minX:He.minY,lt=0===ie?He.maxX:He.maxY;if(We>=U&&lt<J)me.push(He);else if(!(lt<U||We>=J)){var Ct=[];if("Point"===je||"MultiPoint"===je)ft(at,Ct,U,J,ie);else if("LineString"===je)vi(at,Ct,U,J,ie,!1,fe.lineMetrics);else if("MultiLineString"===je)sr(at,Ct,U,J,ie,!1);else if("Polygon"===je)sr(at,Ct,U,J,ie,!0);else if("MultiPolygon"===je)for(var Yt=0;Yt<at.length;Yt++){var Ri=[];sr(at[Yt],Ri,U,J,ie,!0),Ri.length&&Ct.push(Ri)}if(Ct.length){if(fe.lineMetrics&&"LineString"===je){for(Yt=0;Yt<Ct.length;Yt++)me.push(Xe(He.id,je,Ct[Yt],He.tags));continue}"LineString"!==je&&"MultiLineString"!==je||(1===Ct.length?(je="LineString",Ct=Ct[0]):je="MultiLineString"),"Point"!==je&&"MultiPoint"!==je||(je=3===Ct.length?"Point":"MultiPoint"),me.push(Xe(He.id,je,Ct,He.tags))}}}return me.length?me:null}function ft(re,z,U,J,ie){for(var le=0;le<re.length;le+=3){var we=re[le+ie];we>=U&&we<=J&&(z.push(re[le]),z.push(re[le+1]),z.push(re[le+2]))}}function vi(re,z,U,J,ie,le,we){for(var fe,me,be=wt(re),He=0===ie?Mi:Oo,at=re.start,je=0;je<re.length-3;je+=3){var We=re[je],lt=re[je+1],Ct=re[je+2],Yt=re[je+3],Ri=re[je+4],fi=0===ie?We:lt,wi=0===ie?Yt:Ri,Xt=!1;we&&(fe=Math.sqrt(Math.pow(We-Yt,2)+Math.pow(lt-Ri,2))),fi<U?wi>U&&(me=He(be,We,lt,Yt,Ri,U),we&&(be.start=at+fe*me)):fi>J?wi<J&&(me=He(be,We,lt,Yt,Ri,J),we&&(be.start=at+fe*me)):Li(be,We,lt,Ct),wi<U&&fi>=U&&(me=He(be,We,lt,Yt,Ri,U),Xt=!0),wi>J&&fi<=J&&(me=He(be,We,lt,Yt,Ri,J),Xt=!0),!le&&Xt&&(we&&(be.end=at+fe*me),z.push(be),be=wt(re)),we&&(at+=fe)}var bi=re.length-3;We=re[bi],lt=re[bi+1],Ct=re[bi+2],(fi=0===ie?We:lt)>=U&&fi<=J&&Li(be,We,lt,Ct),bi=be.length-3,le&&bi>=3&&(be[bi]!==be[0]||be[bi+1]!==be[1])&&Li(be,be[0],be[1],be[2]),be.length&&z.push(be)}function wt(re){var z=[];return z.size=re.size,z.start=re.start,z.end=re.end,z}function sr(re,z,U,J,ie,le){for(var we=0;we<re.length;we++)vi(re[we],z,U,J,ie,le,!1)}function Li(re,z,U,J){re.push(z),re.push(U),re.push(J)}function Mi(re,z,U,J,ie,le){var we=(le-z)/(J-z);return re.push(le),re.push(U+(ie-U)*we),re.push(1),we}function Oo(re,z,U,J,ie,le){var we=(le-U)/(ie-U);return re.push(z+(J-z)*we),re.push(le),re.push(1),we}function ar(re,z){for(var U=[],J=0;J<re.length;J++){var ie,le=re[J],we=le.type;if("Point"===we||"MultiPoint"===we||"LineString"===we)ie=Fn(le.geometry,z);else if("MultiLineString"===we||"Polygon"===we){ie=[];for(var fe=0;fe<le.geometry.length;fe++)ie.push(Fn(le.geometry[fe],z))}else if("MultiPolygon"===we)for(ie=[],fe=0;fe<le.geometry.length;fe++){for(var me=[],be=0;be<le.geometry[fe].length;be++)me.push(Fn(le.geometry[fe][be],z));ie.push(me)}U.push(Xe(le.id,we,ie,le.tags))}return U}function Fn(re,z){var U=[];U.size=re.size,void 0!==re.start&&(U.start=re.start,U.end=re.end);for(var J=0;J<re.length;J+=3)U.push(re[J]+z,re[J+1],re[J+2]);return U}function Cr(re,z){if(re.transformed)return re;var U,J,ie,le=1<<re.z,we=re.x,fe=re.y;for(U=0;U<re.features.length;U++){var me=re.features[U],be=me.geometry,He=me.type;if(me.geometry=[],1===He)for(J=0;J<be.length;J+=2)me.geometry.push(Wi(be[J],be[J+1],z,le,we,fe));else for(J=0;J<be.length;J++){var at=[];for(ie=0;ie<be[J].length;ie+=2)at.push(Wi(be[J][ie],be[J][ie+1],z,le,we,fe));me.geometry.push(at)}}return re.transformed=!0,re}function Wi(re,z,U,J,ie,le){return[Math.round(U*(re*J-ie)),Math.round(U*(z*J-le))]}function os(re,z,U,J,ie){for(var le=z===ie.maxZoom?0:ie.tolerance/((1<<z)*ie.extent),we={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:U,y:J,z,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},fe=0;fe<re.length;fe++){we.numFeatures++,Rn(we,re[fe],le,ie);var me=re[fe].minX,be=re[fe].minY,He=re[fe].maxX,at=re[fe].maxY;me<we.minX&&(we.minX=me),be<we.minY&&(we.minY=be),He>we.maxX&&(we.maxX=He),at>we.maxY&&(we.maxY=at)}return we}function Rn(re,z,U,J){var ie=z.geometry,le=z.type,we=[];if("Point"===le||"MultiPoint"===le)for(var fe=0;fe<ie.length;fe+=3)we.push(ie[fe]),we.push(ie[fe+1]),re.numPoints++,re.numSimplified++;else if("LineString"===le)Fo(we,ie,re,U,!1,!1);else if("MultiLineString"===le||"Polygon"===le)for(fe=0;fe<ie.length;fe++)Fo(we,ie[fe],re,U,"Polygon"===le,0===fe);else if("MultiPolygon"===le)for(var me=0;me<ie.length;me++){var be=ie[me];for(fe=0;fe<be.length;fe++)Fo(we,be[fe],re,U,!0,0===fe)}if(we.length){var He=z.tags||null;if("LineString"===le&&J.lineMetrics){for(var at in He={},z.tags)He[at]=z.tags[at];He.mapbox_clip_start=ie.start/ie.size,He.mapbox_clip_end=ie.end/ie.size}var je={geometry:we,type:"Polygon"===le||"MultiPolygon"===le?3:"LineString"===le||"MultiLineString"===le?2:1,tags:He};null!==z.id&&(je.id=z.id),re.features.push(je)}}function Fo(re,z,U,J,ie,le){var we=J*J;if(J>0&&z.size<(ie?we:J))U.numPoints+=z.length/3;else{for(var fe=[],me=0;me<z.length;me+=3)(0===J||z[me+2]>we)&&(U.numSimplified++,fe.push(z[me]),fe.push(z[me+1])),U.numPoints++;ie&&function(be,He){for(var at=0,je=0,We=be.length,lt=We-2;je<We;lt=je,je+=2)at+=(be[je]-be[lt])*(be[je+1]+be[lt+1]);if(at>0===He)for(je=0,We=be.length;je<We/2;je+=2){var Ct=be[je],Yt=be[je+1];be[je]=be[We-2-je],be[je+1]=be[We-1-je],be[We-2-je]=Ct,be[We-1-je]=Yt}}(fe,le),re.push(fe)}}function Dn(re,z){var U=(z=this.options=function(ie,le){for(var we in le)ie[we]=le[we];return ie}(Object.create(this.options),z)).debug;if(U&&console.time("preprocess data"),z.maxZoom<0||z.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(z.promoteId&&z.generateId)throw new Error("promoteId and generateId cannot be used together.");var ie,le,we,fe,me,be,J=function(ie,le){var we=[];if("FeatureCollection"===ie.type)for(var fe=0;fe<ie.features.length;fe++)Yi(we,ie.features[fe],le,fe);else Yi(we,"Feature"===ie.type?ie:{geometry:ie},le);return we}(re,z);this.tiles={},this.tileCoords=[],U&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",z.indexMaxZoom,z.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),fe=ie=J,me=Zn(ie,1,-1-(we=(le=z).buffer/le.extent),we,0,-1,2,le),be=Zn(ie,1,1-we,2+we,0,-1,2,le),(me||be)&&(fe=Zn(ie,1,-we,1+we,0,-1,2,le)||[],me&&(fe=ar(me,1).concat(fe)),be&&(fe=fe.concat(ar(be,-1)))),(J=fe).length&&this.splitTile(J,0,0,0),U&&(J.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function so(re,z,U){return 32*((1<<re)*U+z)+re}function Ms(re,z){const U=re.tileID.canonical;if(!this._geoJSONIndex)return z(null,null);const J=this._geoJSONIndex.getTile(U.z,U.x,U.y);if(!J)return z(null,null);const ie=new Ht(J.features);let le=si(ie);0===le.byteOffset&&le.byteLength===le.buffer.byteLength||(le=new Uint8Array(le)),z(null,{vectorTile:ie,rawData:le.buffer})}Dn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Dn.prototype.splitTile=function(re,z,U,J,ie,le,we){for(var fe=[re,z,U,J],me=this.options,be=me.debug;fe.length;){J=fe.pop(),U=fe.pop(),z=fe.pop(),re=fe.pop();var He=1<<z,at=so(z,U,J),je=this.tiles[at];if(!je&&(be>1&&console.time("creation"),je=this.tiles[at]=os(re,z,U,J,me),this.tileCoords.push({z,x:U,y:J}),be)){be>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",z,U,J,je.numFeatures,je.numPoints,je.numSimplified),console.timeEnd("creation"));var We="z"+z;this.stats[We]=(this.stats[We]||0)+1,this.total++}if(je.source=re,ie){if(z===me.maxZoom||z===ie)continue;var lt=1<<ie-z;if(U!==Math.floor(le/lt)||J!==Math.floor(we/lt))continue}else if(z===me.indexMaxZoom||je.numPoints<=me.indexMaxPoints)continue;if(je.source=null,0!==re.length){be>1&&console.time("clipping");var Ct,Yt,Ri,fi,wi,Xt,bi=.5*me.buffer/me.extent,on=.5-bi,ri=.5+bi,$n=1+bi;Ct=Yt=Ri=fi=null,wi=Zn(re,He,U-bi,U+ri,0,je.minX,je.maxX,me),Xt=Zn(re,He,U+on,U+$n,0,je.minX,je.maxX,me),re=null,wi&&(Ct=Zn(wi,He,J-bi,J+ri,1,je.minY,je.maxY,me),Yt=Zn(wi,He,J+on,J+$n,1,je.minY,je.maxY,me),wi=null),Xt&&(Ri=Zn(Xt,He,J-bi,J+ri,1,je.minY,je.maxY,me),fi=Zn(Xt,He,J+on,J+$n,1,je.minY,je.maxY,me),Xt=null),be>1&&console.timeEnd("clipping"),fe.push(Ct||[],z+1,2*U,2*J),fe.push(Yt||[],z+1,2*U,2*J+1),fe.push(Ri||[],z+1,2*U+1,2*J),fe.push(fi||[],z+1,2*U+1,2*J+1)}}},Dn.prototype.getTile=function(re,z,U){var J=this.options,ie=J.extent,le=J.debug;if(re<0||re>24)return null;var we=1<<re,fe=so(re,z=(z%we+we)%we,U);if(this.tiles[fe])return Cr(this.tiles[fe],ie);le>1&&console.log("drilling down to z%d-%d-%d",re,z,U);for(var me,be=re,He=z,at=U;!me&&be>0;)be--,He=Math.floor(He/2),at=Math.floor(at/2),me=this.tiles[so(be,He,at)];return me&&me.source?(le>1&&console.log("found parent tile z%d-%d-%d",be,He,at),le>1&&console.time("drilling down"),this.splitTile(me.source,be,He,at,re,z,U),le>1&&console.timeEnd("drilling down"),this.tiles[fe]?Cr(this.tiles[fe],ie):null):null};class ss extends Be{constructor(z,U,J,ie){super(z,U,J,Ms),ie&&(this.loadGeoJSON=ie)}loadData(z,U){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=U,this._pendingLoadDataParams=z,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())}_loadData(){if(!this._pendingCallback||!this._pendingLoadDataParams)return;const z=this._pendingCallback,U=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;const J=!!(U&&U.request&&U.request.collectResourceTiming)&&new x.RequestPerformance(U.request);this.loadGeoJSON(U,(ie,le)=>{if(ie||!le)return z(ie);if("object"!=typeof le)return z(new Error(`Input data given to '${U.source}' is not a valid GeoJSON object.`));{gt(le,!0);try{if(U.filter){const fe=x.createExpression(U.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===fe.result)throw new Error(fe.value.map(be=>`${be.key}: ${be.message}`).join(", "));const me=le.features.filter(be=>fe.value.evaluate({zoom:0},be));le={type:"FeatureCollection",features:me}}this._geoJSONIndex=U.cluster?new Cs(function({superclusterOptions:fe,clusterProperties:me}){if(!me||!fe)return fe;const be={},He={},at={accumulated:null,zoom:0},je={properties:null},We=Object.keys(me);for(const lt of We){const[Ct,Yt]=me[lt],Ri=x.createExpression(Yt),fi=x.createExpression("string"==typeof Ct?[Ct,["accumulated"],["get",lt]]:Ct);be[lt]=Ri.value,He[lt]=fi.value}return fe.map=lt=>{je.properties=lt;const Ct={};for(const Yt of We)Ct[Yt]=be[Yt].evaluate(at,je);return Ct},fe.reduce=(lt,Ct)=>{je.properties=Ct;for(const Yt of We)at.accumulated=lt[Yt],lt[Yt]=He[Yt].evaluate(at,je)},fe}(U)).load(le.features):new Dn(fe=le,U.geojsonVtOptions)}catch(fe){return z(fe)}this.loaded={};const we={};if(J){const fe=J.finish();fe&&(we.resourceTiming={},we.resourceTiming[U.source]=JSON.parse(JSON.stringify(fe)))}z(null,we)}var fe})}coalesce(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())}reloadTile(z,U){const J=this.loaded;return J&&J[z.uid]?super.reloadTile(z,U):this.loadTile(z,U)}loadGeoJSON(z,U){if(z.request)x.getJSON(z.request,U);else{if("string"!=typeof z.data)return U(new Error(`Input data given to '${z.source}' is not a valid GeoJSON object.`));try{return U(null,JSON.parse(z.data))}catch(J){return U(new Error(`Input data given to '${z.source}' is not a valid GeoJSON object.`))}}}removeSource(z,U){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),U()}getClusterExpansionZoom(z,U){try{U(null,this._geoJSONIndex.getClusterExpansionZoom(z.clusterId))}catch(J){U(J)}}getClusterChildren(z,U){try{U(null,this._geoJSONIndex.getChildren(z.clusterId))}catch(J){U(J)}}getClusterLeaves(z,U){try{U(null,this._geoJSONIndex.getLeaves(z.clusterId,z.limit,z.offset))}catch(J){U(J)}}}class Ds{constructor(z){this.self=z,this.actor=new x.Actor(z,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:Be,geojson:ss},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(U,J)=>{if(this.workerSourceTypes[U])throw new Error(`Worker source with name "${U}" already registered.`);this.workerSourceTypes[U]=J},this.self.registerRTLTextPlugin=U=>{if(x.plugin.isParsed())throw new Error("RTL text plugin already registered.");x.plugin.applyArabicShaping=U.applyArabicShaping,x.plugin.processBidirectionalText=U.processBidirectionalText,x.plugin.processStyledBidirectionalText=U.processStyledBidirectionalText}}setReferrer(z,U){this.referrer=U}setImages(z,U,J){this.availableImages[z]=U;for(const ie in this.workerSources[z]){const le=this.workerSources[z][ie];for(const we in le)le[we].availableImages=U}J()}setLayers(z,U,J){this.getLayerIndex(z).replace(U),J()}updateLayers(z,U,J){this.getLayerIndex(z).update(U.layers,U.removedIds),J()}loadTile(z,U,J){this.getWorkerSource(z,U.type,U.source).loadTile(U,J)}loadDEMTile(z,U,J){this.getDEMWorkerSource(z,U.source).loadTile(U,J)}reloadTile(z,U,J){this.getWorkerSource(z,U.type,U.source).reloadTile(U,J)}abortTile(z,U,J){this.getWorkerSource(z,U.type,U.source).abortTile(U,J)}removeTile(z,U,J){this.getWorkerSource(z,U.type,U.source).removeTile(U,J)}removeDEMTile(z,U){this.getDEMWorkerSource(z,U.source).removeTile(U)}removeSource(z,U,J){if(!this.workerSources[z]||!this.workerSources[z][U.type]||!this.workerSources[z][U.type][U.source])return;const ie=this.workerSources[z][U.type][U.source];delete this.workerSources[z][U.type][U.source],void 0!==ie.removeSource?ie.removeSource(U,J):J()}loadWorkerSource(z,U,J){try{this.self.importScripts(U.url),J()}catch(ie){J(ie.toString())}}syncRTLPluginState(z,U,J){try{x.plugin.setState(U);const ie=x.plugin.getPluginURL();if(x.plugin.isLoaded()&&!x.plugin.isParsed()&&null!=ie){this.self.importScripts(ie);const le=x.plugin.isParsed();J(le?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ie}`),le)}}catch(ie){J(ie.toString())}}getAvailableImages(z){let U=this.availableImages[z];return U||(U=[]),U}getLayerIndex(z){let U=this.layerIndexes[z];return U||(U=this.layerIndexes[z]=new ye),U}getWorkerSource(z,U,J){return this.workerSources[z]||(this.workerSources[z]={}),this.workerSources[z][U]||(this.workerSources[z][U]={}),this.workerSources[z][U][J]||(this.workerSources[z][U][J]=new this.workerSourceTypes[U]({send:(le,we,fe)=>{this.actor.send(le,we,fe,z)}},this.getLayerIndex(z),this.getAvailableImages(z))),this.workerSources[z][U][J]}getDEMWorkerSource(z,U){return this.demWorkerSources[z]||(this.demWorkerSources[z]={}),this.demWorkerSources[z][U]||(this.demWorkerSources[z][U]=new yt),this.demWorkerSources[z][U]}enforceCacheSizeLimit(z,U){x.enforceCacheSizeLimit(U)}}return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new Ds(self)),Ds}),Te(0,function(x){var Me=Pe;function Pe(b){return a=b,!("undefined"==typeof window||"undefined"==typeof document||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var y,w,S=new Blob([""],{type:"text/javascript"}),R=URL.createObjectURL(S);try{w=new Worker(R),y=!0}catch(F){y=!1}return w&&w.terminate(),URL.revokeObjectURL(R),y}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var y=document.createElement("canvas");y.width=y.height=1;var w=y.getContext("2d");if(!w)return!1;var S=w.getImageData(0,0,1,1);return S&&S.width===y.width}()||(void 0===ye[p=a&&a.failIfMajorPerformanceCaveat]&&(ye[p]=function(y){var w,R,F,N,S=(R=y,F=document.createElement("canvas"),(N=Object.create(Pe.webGLContextAttributes)).failIfMajorPerformanceCaveat=R,F.getContext("webgl",N)||F.getContext("experimental-webgl",N));if(!S)return!1;try{w=S.createShader(S.VERTEX_SHADER)}catch(R){return!1}return!(!w||S.isContextLost())&&(S.shaderSource(w,"void main() {}"),S.compileShader(w),!0===S.getShaderParameter(w,S.COMPILE_STATUS))}(p)),!ye[p]||document.documentMode));var a,p}var ye={};function xe(b,a){if(Array.isArray(b)){if(!Array.isArray(a)||b.length!==a.length)return!1;for(let p=0;p<b.length;p++)if(!xe(b[p],a[p]))return!1;return!0}if("object"==typeof b&&null!==b&&null!==a){if("object"!=typeof a||Object.keys(b).length!==Object.keys(a).length)return!1;for(const p in b)if(!xe(b[p],a[p]))return!1;return!0}return b===a}Pe.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};class ne{static testProp(a){if(!ne.docStyle)return a[0];for(let p=0;p<a.length;p++)if(a[p]in ne.docStyle)return a[p];return a[0]}static create(a,p,y){const w=window.document.createElement(a);return void 0!==p&&(w.className=p),y&&y.appendChild(w),w}static createNS(a,p){return window.document.createElementNS(a,p)}static disableDrag(){ne.docStyle&&ne.selectProp&&(ne.userSelect=ne.docStyle[ne.selectProp],ne.docStyle[ne.selectProp]="none")}static enableDrag(){ne.docStyle&&ne.selectProp&&(ne.docStyle[ne.selectProp]=ne.userSelect)}static setTransform(a,p){a.style[ne.transformProp]=p}static addEventListener(a,p,y,w={}){a.addEventListener(p,y,"passive"in w?w:w.capture)}static removeEventListener(a,p,y,w={}){a.removeEventListener(p,y,"passive"in w?w:w.capture)}static suppressClickInternal(a){a.preventDefault(),a.stopPropagation(),window.removeEventListener("click",ne.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",ne.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",ne.suppressClickInternal,!0)},0)}static mousePos(a,p){const y=a.getBoundingClientRect();return new x.pointGeometry(p.clientX-y.left-a.clientLeft,p.clientY-y.top-a.clientTop)}static touchPos(a,p){const y=a.getBoundingClientRect(),w=[];for(let S=0;S<p.length;S++)w.push(new x.pointGeometry(p[S].clientX-y.left-a.clientLeft,p[S].clientY-y.top-a.clientTop));return w}static mouseButton(a){return a.button}static remove(a){a.parentNode&&a.parentNode.removeChild(a)}}ne.docStyle="undefined"!=typeof window&&window.document&&window.document.documentElement.style,ne.selectProp=ne.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),ne.transformProp=ne.testProp(["transform","WebkitTransform"]);class Le{constructor(a){this._transformRequestFn=a}transformRequest(a,p){return this._transformRequestFn&&this._transformRequestFn(a,p)||{url:a}}normalizeSpriteURL(a,p,y){const w=function(S){const R=S.match(ke);if(!R)throw new Error(`Unable to parse URL "${S}"`);return{protocol:R[1],authority:R[2],path:R[3]||"/",params:R[4]?R[4].split("&"):[]}}(a);return w.path+=`${p}${y}`,function(S){const R=S.params.length?`?${S.params.join("&")}`:"";return`${S.protocol}://${S.authority}${S.path}${R}`}(w)}setTransformRequest(a){this._transformRequestFn=a}}const ke=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Be(b){var a=new x.ARRAY_TYPE(3);return a[0]=b[0],a[1]=b[1],a[2]=b[2],a}function yt(b,a,p){var y=new x.ARRAY_TYPE(3);return y[0]=b,y[1]=a,y[2]=p,y}var gt,vt=function(b,a,p){return b[0]=a[0]-p[0],b[1]=a[1]-p[1],b[2]=a[2]-p[2],b};gt=new x.ARRAY_TYPE(3),x.ARRAY_TYPE!=Float32Array&&(gt[0]=0,gt[1]=0,gt[2]=0);var b,Tt=function(b){var a=b[0],p=b[1];return a*a+p*p};b=new x.ARRAY_TYPE(2),x.ARRAY_TYPE!=Float32Array&&(b[0]=0,b[1]=0);class nt{constructor(a,p,y,w){this.context=a,this.format=y,this.texture=a.gl.createTexture(),this.update(p,w)}update(a,p,y){const{width:w,height:S}=a,R=!(this.size&&this.size[0]===w&&this.size[1]===S||y),{context:F}=this,{gl:N}=F;if(this.useMipmap=Boolean(p&&p.useMipmap),N.bindTexture(N.TEXTURE_2D,this.texture),F.pixelStoreUnpackFlipY.set(!1),F.pixelStoreUnpack.set(1),F.pixelStoreUnpackPremultiplyAlpha.set(this.format===N.RGBA&&(!p||!1!==p.premultiply)),R)this.size=[w,S],a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement||a instanceof ImageData||x.isImageBitmap(a)?N.texImage2D(N.TEXTURE_2D,0,this.format,this.format,N.UNSIGNED_BYTE,a):N.texImage2D(N.TEXTURE_2D,0,this.format,w,S,0,this.format,N.UNSIGNED_BYTE,a.data);else{const{x:j,y:q}=y||{x:0,y:0};a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement||a instanceof ImageData||x.isImageBitmap(a)?N.texSubImage2D(N.TEXTURE_2D,0,j,q,N.RGBA,N.UNSIGNED_BYTE,a):N.texSubImage2D(N.TEXTURE_2D,0,j,q,w,S,N.RGBA,N.UNSIGNED_BYTE,a.data)}this.useMipmap&&this.isSizePowerOfTwo()&&N.generateMipmap(N.TEXTURE_2D)}bind(a,p,y){const{context:w}=this,{gl:S}=w;S.bindTexture(S.TEXTURE_2D,this.texture),y!==S.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(y=S.LINEAR),a!==this.filter&&(S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MAG_FILTER,a),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MIN_FILTER,y||a),this.filter=a),p!==this.wrap&&(S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_S,p),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_T,p),this.wrap=p)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:a}=this.context;a.deleteTexture(this.texture),this.texture=null}}function Dt(b){const{userImage:a}=b;return!!(a&&a.render&&a.render())&&(b.data.replace(new Uint8Array(a.data.buffer)),!0)}class Ht extends x.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new x.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(a){if(this.loaded!==a&&(this.loaded=a,a)){for(const{ids:p,callback:y}of this.requestors)this._notify(p,y);this.requestors=[]}}getImage(a){return this.images[a]}addImage(a,p){this._validate(a,p)&&(this.images[a]=p)}_validate(a,p){let y=!0;return this._validateStretch(p.stretchX,p.data&&p.data.width)||(this.fire(new x.ErrorEvent(new Error(`Image "${a}" has invalid "stretchX" value`))),y=!1),this._validateStretch(p.stretchY,p.data&&p.data.height)||(this.fire(new x.ErrorEvent(new Error(`Image "${a}" has invalid "stretchY" value`))),y=!1),this._validateContent(p.content,p)||(this.fire(new x.ErrorEvent(new Error(`Image "${a}" has invalid "content" value`))),y=!1),y}_validateStretch(a,p){if(!a)return!0;let y=0;for(const w of a){if(w[0]<y||w[1]<w[0]||p<w[1])return!1;y=w[1]}return!0}_validateContent(a,p){return!(a&&(4!==a.length||a[0]<0||p.data.width<a[0]||a[1]<0||p.data.height<a[1]||a[2]<0||p.data.width<a[2]||a[3]<0||p.data.height<a[3]||a[2]<a[0]||a[3]<a[1]))}updateImage(a,p){p.version=this.images[a].version+1,this.images[a]=p,this.updatedImages[a]=!0}removeImage(a){const p=this.images[a];delete this.images[a],delete this.patterns[a],p.userImage&&p.userImage.onRemove&&p.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(a,p){let y=!0;if(!this.isLoaded())for(const w of a)this.images[w]||(y=!1);this.isLoaded()||y?this._notify(a,p):this.requestors.push({ids:a,callback:p})}_notify(a,p){const y={};for(const w of a){this.images[w]||this.fire(new x.Event("styleimagemissing",{id:w}));const S=this.images[w];S?y[w]={data:S.data.clone(),pixelRatio:S.pixelRatio,sdf:S.sdf,version:S.version,stretchX:S.stretchX,stretchY:S.stretchY,content:S.content,hasRenderCallback:Boolean(S.userImage&&S.userImage.render)}:x.warnOnce(`Image "${w}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}p(null,y)}getPixelSize(){const{width:a,height:p}=this.atlasImage;return{width:a,height:p}}getPattern(a){const p=this.patterns[a],y=this.getImage(a);if(!y)return null;if(p&&p.position.version===y.version)return p.position;if(p)p.position.version=y.version;else{const w={w:y.data.width+2,h:y.data.height+2,x:0,y:0},S=new x.ImagePosition(w,y);this.patterns[a]={bin:w,position:S}}return this._updatePatternAtlas(),this.patterns[a].position}bind(a){const p=a.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new nt(a,this.atlasImage,p.RGBA),this.atlasTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE)}_updatePatternAtlas(){const a=[];for(const S in this.patterns)a.push(this.patterns[S].bin);const{w:p,h:y}=x.potpack(a),w=this.atlasImage;w.resize({width:p||1,height:y||1});for(const S in this.patterns){const{bin:R}=this.patterns[S],F=R.x+1,N=R.y+1,j=this.images[S].data,q=j.width,X=j.height;x.RGBAImage.copy(j,w,{x:0,y:0},{x:F,y:N},{width:q,height:X}),x.RGBAImage.copy(j,w,{x:0,y:X-1},{x:F,y:N-1},{width:q,height:1}),x.RGBAImage.copy(j,w,{x:0,y:0},{x:F,y:N+X},{width:q,height:1}),x.RGBAImage.copy(j,w,{x:q-1,y:0},{x:F-1,y:N},{width:1,height:X}),x.RGBAImage.copy(j,w,{x:0,y:0},{x:F+q,y:N},{width:1,height:X})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(a){for(const p of a){if(this.callbackDispatchedThisFrame[p])continue;this.callbackDispatchedThisFrame[p]=!0;const y=this.images[p];Dt(y)&&this.updateImage(p,y)}}}const $t=1e20;function xt(b,a,p,y,w,S,R,F,N){for(let j=a;j<a+y;j++)ut(b,p*S+j,S,w,R,F,N);for(let j=p;j<p+w;j++)ut(b,j*S+a,1,y,R,F,N)}function ut(b,a,p,y,w,S,R){S[0]=0,R[0]=-$t,R[1]=$t,w[0]=b[a];for(let F=1,N=0,j=0;F<y;F++){w[F]=b[a+F*p];const q=F*F;do{const X=S[N];j=(w[F]-w[X]+q-X*X)/(F-X)/2}while(j<=R[N]&&--N>-1);N++,S[N]=F,R[N]=j,R[N+1]=$t}for(let F=0,N=0;F<y;F++){for(;R[N+1]<F;)N++;const j=S[N],q=F-j;b[a+F*p]=w[j]+q*q}}class kt{constructor(a,p){this.requestManager=a,this.localIdeographFontFamily=p,this.entries={}}setURL(a){this.url=a}getGlyphs(a,p){const y=[];for(const w in a)for(const S of a[w])y.push({stack:w,id:S});x.asyncAll(y,({stack:w,id:S},R)=>{let F=this.entries[w];F||(F=this.entries[w]={glyphs:{},requests:{},ranges:{}});let N=F.glyphs[S];if(void 0!==N)return void R(null,{stack:w,id:S,glyph:N});if(N=this._tinySDF(F,w,S),N)return F.glyphs[S]=N,void R(null,{stack:w,id:S,glyph:N});const j=Math.floor(S/256);if(256*j>65535)return void R(new Error("glyphs > 65535 not supported"));if(F.ranges[j])return void R(null,{stack:w,id:S,glyph:N});let q=F.requests[j];q||(q=F.requests[j]=[],kt.loadGlyphRange(w,j,this.url,this.requestManager,(X,te)=>{if(te){for(const ce in te)this._doesCharSupportLocalGlyph(+ce)||(F.glyphs[+ce]=te[+ce]);F.ranges[j]=!0}for(const ce of q)ce(X,te);delete F.requests[j]})),q.push((X,te)=>{X?R(X):te&&R(null,{stack:w,id:S,glyph:te[S]||null})})},(w,S)=>{if(w)p(w);else if(S){const R={};for(const{stack:F,id:N,glyph:j}of S)(R[F]||(R[F]={}))[N]=j&&{id:j.id,bitmap:j.bitmap.clone(),metrics:j.metrics};p(null,R)}})}_doesCharSupportLocalGlyph(a){return!!this.localIdeographFontFamily&&(x.unicodeBlockLookup["CJK Unified Ideographs"](a)||x.unicodeBlockLookup["Hangul Syllables"](a)||x.unicodeBlockLookup.Hiragana(a)||x.unicodeBlockLookup.Katakana(a))}_tinySDF(a,p,y){const w=this.localIdeographFontFamily;if(!w||!this._doesCharSupportLocalGlyph(y))return;let S=a.tinySDF;if(!S){let F="400";/bold/i.test(p)?F="900":/medium/i.test(p)?F="500":/light/i.test(p)&&(F="200"),S=a.tinySDF=new kt.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:w,fontWeight:F})}const R=S.draw(String.fromCharCode(y));return{id:y,bitmap:new x.AlphaImage({width:R.width||30,height:R.height||30},R.data),metrics:{width:R.glyphWidth||24,height:R.glyphHeight||24,left:R.glyphLeft||0,top:R.glyphTop-27||-8,advance:R.glyphAdvance||24}}}}kt.loadGlyphRange=function(b,a,p,y,w){const S=256*a,R=S+255,F=y.transformRequest(p.replace("{fontstack}",b).replace("{range}",`${S}-${R}`),x.ResourceType.Glyphs);x.getArrayBuffer(F,(N,j)=>{if(N)w(N);else if(j){const q={};for(const X of x.parseGlyphPBF(j))q[X.id]=X;w(null,q)}})},kt.TinySDF=class{constructor({fontSize:b=24,buffer:a=3,radius:p=8,cutoff:y=.25,fontFamily:w="sans-serif",fontWeight:S="normal",fontStyle:R="normal"}){this.buffer=a,this.cutoff=y,this.radius=p;const F=this.size=b+4*a,N=this._createCanvas(F),j=this.ctx=N.getContext("2d",{willReadFrequently:!0});j.font=`${R} ${S} ${b}px ${w}`,j.textBaseline="alphabetic",j.textAlign="left",j.fillStyle="black",this.gridOuter=new Float64Array(F*F),this.gridInner=new Float64Array(F*F),this.f=new Float64Array(F),this.z=new Float64Array(F+1),this.v=new Uint16Array(F)}_createCanvas(b){const a=document.createElement("canvas");return a.width=a.height=b,a}draw(b){const{width:a,actualBoundingBoxAscent:p,actualBoundingBoxDescent:y,actualBoundingBoxLeft:w,actualBoundingBoxRight:S}=this.ctx.measureText(b),R=Math.floor(p),F=Math.min(this.size-this.buffer,Math.ceil(S-w)),N=Math.min(this.size-this.buffer,Math.ceil(p)+Math.ceil(y)),j=F+2*this.buffer,q=N+2*this.buffer,X=j*q,te=new Uint8ClampedArray(X),ce={data:te,width:j,height:q,glyphWidth:F,glyphHeight:N,glyphTop:R,glyphLeft:0,glyphAdvance:a};if(0===F||0===N)return ce;const{ctx:oe,buffer:he,gridInner:Ce,gridOuter:De}=this;oe.clearRect(he,he,F,N),oe.fillText(b,he,he+R+1);const Ne=oe.getImageData(he,he,F,N);De.fill($t,0,X),Ce.fill(0,0,X);for(let Se=0;Se<N;Se++)for(let Je=0;Je<F;Je++){const Ye=Ne.data[4*(Se*F+Je)+3]/255;if(0===Ye)continue;const Ge=(Se+he)*j+Je+he;if(1===Ye)De[Ge]=0,Ce[Ge]=$t;else{const ht=.5-Ye;De[Ge]=ht>0?ht*ht:0,Ce[Ge]=ht<0?ht*ht:0}}xt(De,0,0,j,q,j,this.f,this.v,this.z),xt(Ce,he,he,F,N,j,this.f,this.v,this.z);for(let Se=0;Se<X;Se++){const Je=Math.sqrt(De[Se])-Math.sqrt(Ce[Se]);te[Se]=Math.round(255-255*(Je/this.radius+this.cutoff))}return ce}};const qt=new x.Properties({anchor:new x.DataConstantProperty(x.spec.light.anchor),position:new class{constructor(){this.specification=x.spec.light.position}possiblyEvaluate(b,a){return x.sphericalToCartesian(b.expression.evaluate(a))}interpolate(b,a,p){return{x:x.number(b.x,a.x,p),y:x.number(b.y,a.y,p),z:x.number(b.z,a.z,p)}}},color:new x.DataConstantProperty(x.spec.light.color),intensity:new x.DataConstantProperty(x.spec.light.intensity)}),ni="-transition";class xi extends x.Evented{constructor(a){super(),this._transitionable=new x.Transitionable(qt),this.setLight(a),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(a,p={}){if(!this._validate(x.validateLight,a,p))for(const y in a){const w=a[y];y.endsWith(ni)?this._transitionable.setTransition(y.slice(0,-ni.length),w):this._transitionable.setValue(y,w)}}updateTransitions(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(a){this.properties=this._transitioning.possiblyEvaluate(a)}_validate(a,p,y){return(!y||!1!==y.validate)&&x.emitValidationErrors(this,a.call(x.validateStyle,x.extend({value:p,style:{glyphs:!0,sprite:!0},styleSpec:x.spec})))}}class Ue{constructor(a,p){this.width=a,this.height=p,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(a,p){const y=a.join(",")+String(p);return this.dashEntry[y]||(this.dashEntry[y]=this.addDash(a,p)),this.dashEntry[y]}getDashRanges(a,p,y){const w=[];let S=a.length%2==1?-a[a.length-1]*y:0,R=a[0]*y,F=!0;w.push({left:S,right:R,isDash:F,zeroLength:0===a[0]});let N=a[0];for(let j=1;j<a.length;j++){F=!F;const q=a[j];S=N*y,N+=q,R=N*y,w.push({left:S,right:R,isDash:F,zeroLength:0===q})}return w}addRoundDash(a,p,y){const w=p/2;for(let S=-y;S<=y;S++){const R=this.width*(this.nextRow+y+S);let F=0,N=a[F];for(let j=0;j<this.width;j++){j/N.right>1&&(N=a[++F]);const q=Math.abs(j-N.left),X=Math.abs(j-N.right),te=Math.min(q,X);let ce;const oe=S/y*(w+1);if(N.isDash){const he=w-Math.abs(oe);ce=Math.sqrt(te*te+he*he)}else ce=w-Math.sqrt(te*te+oe*oe);this.data[R+j]=Math.max(0,Math.min(255,ce+128))}}}addRegularDash(a){for(let F=a.length-1;F>=0;--F){const N=a[F],j=a[F+1];N.zeroLength?a.splice(F,1):j&&j.isDash===N.isDash&&(j.left=N.left,a.splice(F,1))}const p=a[0],y=a[a.length-1];p.isDash===y.isDash&&(p.left=y.left-this.width,y.right=p.right+this.width);const w=this.width*this.nextRow;let S=0,R=a[S];for(let F=0;F<this.width;F++){F/R.right>1&&(R=a[++S]);const N=Math.abs(F-R.left),j=Math.abs(F-R.right),q=Math.min(N,j);this.data[w+F]=Math.max(0,Math.min(255,(R.isDash?q:-q)+128))}}addDash(a,p){const y=p?7:0,w=2*y+1;if(this.nextRow+w>this.height)return x.warnOnce("LineAtlas out of space"),null;let S=0;for(let F=0;F<a.length;F++)S+=a[F];if(0!==S){const F=this.width/S,N=this.getDashRanges(a,this.width,F);p?this.addRoundDash(N,F,y):this.addRegularDash(N)}const R={y:(this.nextRow+y+.5)/this.height,height:2*y/this.height,width:S};return this.nextRow+=w,this.dirty=!0,R}bind(a){const p=a.gl;this.texture?(p.bindTexture(p.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,p.texSubImage2D(p.TEXTURE_2D,0,0,0,this.width,this.height,p.ALPHA,p.UNSIGNED_BYTE,this.data))):(this.texture=p.createTexture(),p.bindTexture(p.TEXTURE_2D,this.texture),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.REPEAT),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.REPEAT),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.LINEAR),p.texImage2D(p.TEXTURE_2D,0,p.ALPHA,this.width,this.height,0,p.ALPHA,p.UNSIGNED_BYTE,this.data))}}class et{constructor(a,p){this.workerPool=a,this.actors=[],this.currentActor=0,this.id=x.uniqueId();const y=this.workerPool.acquire(this.id);for(let w=0;w<y.length;w++){const S=new et.Actor(y[w],p,this.id);S.name=`Worker ${w}`,this.actors.push(S)}}broadcast(a,p,y){x.asyncAll(this.actors,(w,S)=>{w.send(a,p,S)},y=y||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(a=>{a.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Oe(b,a,p){const y=function(w,S){if(w)return p(w);if(S){const R=x.pick(x.extend(S,b),["tiles","minzoom","maxzoom","attribution","maplibreLogo","bounds","scheme","tileSize","encoding"]);S.vector_layers&&(R.vectorLayers=S.vector_layers,R.vectorLayerIds=R.vectorLayers.map(F=>F.id)),p(null,R)}};return b.url?x.getJSON(a.transformRequest(b.url,x.ResourceType.Source),y):x.exported.frame(()=>y(null,b))}et.Actor=x.Actor;class Qe{constructor(a,p,y){this.bounds=x.LngLatBounds.convert(this.validateBounds(a)),this.minzoom=p||0,this.maxzoom=y||24}validateBounds(a){return Array.isArray(a)&&4===a.length?[Math.max(-180,a[0]),Math.max(-90,a[1]),Math.min(180,a[2]),Math.min(90,a[3])]:[-180,-90,180,90]}contains(a){const p=Math.pow(2,a.z),y=Math.floor(x.mercatorXfromLng(this.bounds.getWest())*p),w=Math.floor(x.mercatorYfromLat(this.bounds.getNorth())*p),S=Math.ceil(x.mercatorXfromLng(this.bounds.getEast())*p),R=Math.ceil(x.mercatorYfromLat(this.bounds.getSouth())*p);return a.x>=y&&a.x<S&&a.y>=w&&a.y<R}}class Et extends x.Evented{constructor(a,p,y,w){if(super(),this.id=a,this.dispatcher=y,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,x.extend(this,x.pick(p,["url","scheme","tileSize","promoteId"])),this._options=x.extend({type:"vector"},p),this._collectResourceTiming=p.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w)}load(){this._loaded=!1,this.fire(new x.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Oe(this._options,this.map._requestManager,(a,p)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),a?this.fire(new x.ErrorEvent(a)):p&&(x.extend(this,p),p.bounds&&(this.tileBounds=new Qe(p.bounds,this.minzoom,this.maxzoom)),this.fire(new x.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new x.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)}onAdd(a){this.map=a,this.load()}setSourceProperty(a){this._tileJSONRequest&&this._tileJSONRequest.cancel(),a(),this.load()}setTiles(a){return this.setSourceProperty(()=>{this._options.tiles=a}),this}setUrl(a){return this.setSourceProperty(()=>{this.url=a,this._options.url=a}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return x.extend({},this._options)}loadTile(a,p){const y=a.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),w={request:this.map._requestManager.transformRequest(y,x.ResourceType.Tile),uid:a.uid,tileID:a.tileID,zoom:a.tileID.overscaledZ,tileSize:this.tileSize*a.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function S(R,F){return delete a.request,a.aborted?p(null):R&&404!==R.status?p(R):(F&&F.resourceTiming&&(a.resourceTiming=F.resourceTiming),this.map._refreshExpiredTiles&&F&&a.setExpiryData(F),a.loadVectorData(F,this.map.painter),x.cacheEntryPossiblyAdded(this.dispatcher),p(null),void(a.reloadCallback&&(this.loadTile(a,a.reloadCallback),a.reloadCallback=null)))}w.request.collectResourceTiming=this._collectResourceTiming,a.actor&&"expired"!==a.state?"loading"===a.state?a.reloadCallback=p:a.request=a.actor.send("reloadTile",w,S.bind(this)):(a.actor=this.dispatcher.getActor(),a.request=a.actor.send("loadTile",w,S.bind(this)))}abortTile(a){a.request&&(a.request.cancel(),delete a.request),a.actor&&a.actor.send("abortTile",{uid:a.uid,type:this.type,source:this.id},void 0)}unloadTile(a){a.unloadVectorData(),a.actor&&a.actor.send("removeTile",{uid:a.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class Ze extends x.Evented{constructor(a,p,y,w){super(),this.id=a,this.dispatcher=y,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=x.extend({type:"raster"},p),x.extend(this,x.pick(p,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new x.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Oe(this._options,this.map._requestManager,(a,p)=>{this._tileJSONRequest=null,this._loaded=!0,a?this.fire(new x.ErrorEvent(a)):p&&(x.extend(this,p),p.bounds&&(this.tileBounds=new Qe(p.bounds,this.minzoom,this.maxzoom)),this.fire(new x.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new x.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(a){this.map=a,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return x.extend({},this._options)}hasTile(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)}loadTile(a,p){const y=a.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);a.request=x.getImage(this.map._requestManager.transformRequest(y,x.ResourceType.Tile),(w,S)=>{if(delete a.request,a.aborted)a.state="unloaded",p(null);else if(w)a.state="errored",p(w);else if(S){this.map._refreshExpiredTiles&&a.setExpiryData(S),delete S.cacheControl,delete S.expires;const R=this.map.painter.context,F=R.gl;a.texture=this.map.painter.getTileTexture(S.width),a.texture?a.texture.update(S,{useMipmap:!0}):(a.texture=new nt(R,S,F.RGBA,{useMipmap:!0}),a.texture.bind(F.LINEAR,F.CLAMP_TO_EDGE,F.LINEAR_MIPMAP_NEAREST),R.extTextureFilterAnisotropic&&F.texParameterf(F.TEXTURE_2D,R.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,R.extTextureFilterAnisotropicMax)),a.state="loaded",x.cacheEntryPossiblyAdded(this.dispatcher),p(null)}})}abortTile(a,p){a.request&&(a.request.cancel(),delete a.request),p()}unloadTile(a,p){a.texture&&this.map.painter.saveTileTexture(a.texture),p()}hasTransition(){return!1}}let Ci;class tn extends Ze{constructor(a,p,y,w){super(a,p,y,w),this.type="raster-dem",this.maxzoom=22,this._options=x.extend({type:"raster-dem"},p),this.encoding=p.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(a,p){const y=a.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function w(S,R){S&&(a.state="errored",p(S)),R&&(a.dem=R,a.needsHillshadePrepare=!0,a.state="loaded",p(null))}a.request=x.getImage(this.map._requestManager.transformRequest(y,x.ResourceType.Tile),function(S,R){if(delete a.request,a.aborted)a.state="unloaded",p(null);else if(S)a.state="errored",p(S);else if(R){this.map._refreshExpiredTiles&&a.setExpiryData(R),delete R.cacheControl,delete R.expires;const F=x.isImageBitmap(R)&&(null==Ci&&(Ci="undefined"!=typeof OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof createImageBitmap),Ci)?R:x.exported.getImageData(R,1),N={uid:a.uid,coord:a.tileID,source:this.id,rawImageData:F,encoding:this.encoding};a.actor&&"expired"!==a.state||(a.actor=this.dispatcher.getActor(),a.actor.send("loadDEMTile",N,w.bind(this)))}}.bind(this)),a.neighboringTiles=this._getNeighboringTiles(a.tileID)}_getNeighboringTiles(a){const p=a.canonical,y=Math.pow(2,p.z),w=(p.x-1+y)%y,S=0===p.x?a.wrap-1:a.wrap,R=(p.x+1+y)%y,F=p.x+1===y?a.wrap+1:a.wrap,N={};return N[new x.OverscaledTileID(a.overscaledZ,S,p.z,w,p.y).key]={backfilled:!1},N[new x.OverscaledTileID(a.overscaledZ,F,p.z,R,p.y).key]={backfilled:!1},p.y>0&&(N[new x.OverscaledTileID(a.overscaledZ,S,p.z,w,p.y-1).key]={backfilled:!1},N[new x.OverscaledTileID(a.overscaledZ,a.wrap,p.z,p.x,p.y-1).key]={backfilled:!1},N[new x.OverscaledTileID(a.overscaledZ,F,p.z,R,p.y-1).key]={backfilled:!1}),p.y+1<y&&(N[new x.OverscaledTileID(a.overscaledZ,S,p.z,w,p.y+1).key]={backfilled:!1},N[new x.OverscaledTileID(a.overscaledZ,a.wrap,p.z,p.x,p.y+1).key]={backfilled:!1},N[new x.OverscaledTileID(a.overscaledZ,F,p.z,R,p.y+1).key]={backfilled:!1}),N}unloadTile(a){a.demTexture&&this.map.painter.saveTileTexture(a.demTexture),a.fbo&&(a.fbo.destroy(),delete a.fbo),a.dem&&delete a.dem,delete a.neighboringTiles,a.state="unloaded",a.actor&&a.actor.send("removeDEMTile",{uid:a.uid,source:this.id})}}class br extends x.Evented{constructor(a,p,y,w){super(),this.id=a,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=y.getActor(),this.setEventedParent(w),this._data=p.data,this._options=x.extend({},p),this._collectResourceTiming=p.collectResourceTiming,void 0!==p.maxzoom&&(this.maxzoom=p.maxzoom),p.type&&(this.type=p.type),p.attribution&&(this.attribution=p.attribution),this.promoteId=p.promoteId;const S=x.EXTENT/this.tileSize;this.workerOptions=x.extend({source:this.id,cluster:p.cluster||!1,geojsonVtOptions:{buffer:(void 0!==p.buffer?p.buffer:128)*S,tolerance:(void 0!==p.tolerance?p.tolerance:.375)*S,extent:x.EXTENT,maxZoom:this.maxzoom,lineMetrics:p.lineMetrics||!1,generateId:p.generateId||!1},superclusterOptions:{maxZoom:void 0!==p.clusterMaxZoom?p.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,p.clusterMinPoints||2),extent:x.EXTENT,radius:(p.clusterRadius||50)*S,log:!1,generateId:p.generateId||!1},clusterProperties:p.clusterProperties,filter:p.filter},p.workerOptions)}load(){this._updateWorkerData("metadata")}onAdd(a){this.map=a,this.load()}setData(a){return this._data=a,this._updateWorkerData("content"),this}getClusterExpansionZoom(a,p){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:a,source:this.id},p),this}getClusterChildren(a,p){return this.actor.send("geojson.getClusterChildren",{clusterId:a,source:this.id},p),this}getClusterLeaves(a,p,y,w){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:a,limit:p,offset:y},w),this}_updateWorkerData(a){const p=x.extend({},this.workerOptions),y=this._data;"string"==typeof y?(p.request=this.map._requestManager.transformRequest(x.exported.resolveURL(y),x.ResourceType.Source),p.request.collectResourceTiming=this._collectResourceTiming):p.data=JSON.stringify(y),this._pendingLoads++,this.fire(new x.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,p,(w,S)=>{if(this._pendingLoads--,this._removed||S&&S.abandoned)return;let R=null;if(S&&S.resourceTiming&&S.resourceTiming[this.id]&&(R=S.resourceTiming[this.id].slice(0)),this.actor.send(`${this.type}.coalesce`,{source:p.source},null),w)return void this.fire(new x.ErrorEvent(w));const F={dataType:"source",sourceDataType:a};this._collectResourceTiming&&R&&R.length>0&&x.extend(F,{resourceTiming:R}),this.fire(new x.Event("data",F))})}loaded(){return 0===this._pendingLoads}loadTile(a,p){const y=a.actor?"reloadTile":"loadTile";a.actor=this.actor;const w={type:this.type,uid:a.uid,tileID:a.tileID,zoom:a.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};a.request=this.actor.send(y,w,(S,R)=>(delete a.request,a.unloadVectorData(),a.aborted?p(null):S?p(S):(a.loadVectorData(R,this.map.painter,"reloadTile"===y),p(null))))}abortTile(a){a.request&&(a.request.cancel(),delete a.request),a.aborted=!0}unloadTile(a){a.unloadVectorData(),this.actor.send("removeTile",{uid:a.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return x.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var si=x.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class _i extends x.Evented{constructor(a,p,y,w){super(),this.id=a,this.dispatcher=y,this.coordinates=p.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(w),this.options=p}load(a,p){this._loaded=!1,this.fire(new x.Event("dataloading",{dataType:"source"})),this.url=this.options.url,x.getImage(this.map._requestManager.transformRequest(this.url,x.ResourceType.Image),(y,w)=>{this._loaded=!0,y?this.fire(new x.ErrorEvent(y)):w&&(this.image=w,a&&(this.coordinates=a),p&&p(),this._finishLoading())})}loaded(){return this._loaded}updateImage(a){return this.image&&a.url?(this.options.url=a.url,this.load(a.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new x.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(a){this.map=a,this.load()}setCoordinates(a){this.coordinates=a;const p=a.map(x.MercatorCoordinate.fromLngLat);this.tileID=function(w){let S=1/0,R=1/0,F=-1/0,N=-1/0;for(const te of w)S=Math.min(S,te.x),R=Math.min(R,te.y),F=Math.max(F,te.x),N=Math.max(N,te.y);const j=Math.max(F-S,N-R),q=Math.max(0,Math.floor(-Math.log(j)/Math.LN2)),X=Math.pow(2,q);return new x.CanonicalTileID(q,Math.floor((S+F)/2*X),Math.floor((R+N)/2*X))}(p),this.minzoom=this.maxzoom=this.tileID.z;const y=p.map(w=>this.tileID.getTilePoint(w)._round());return this._boundsArray=new x.RasterBoundsArray,this._boundsArray.emplaceBack(y[0].x,y[0].y,0,0),this._boundsArray.emplaceBack(y[1].x,y[1].y,x.EXTENT,0),this._boundsArray.emplaceBack(y[3].x,y[3].y,0,x.EXTENT),this._boundsArray.emplaceBack(y[2].x,y[2].y,x.EXTENT,x.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new x.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const a=this.map.painter.context,p=a.gl;this.boundsBuffer||(this.boundsBuffer=a.createVertexBuffer(this._boundsArray,si.members)),this.boundsSegments||(this.boundsSegments=x.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new nt(a,this.image,p.RGBA),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE));for(const y in this.tiles){const w=this.tiles[y];"loaded"!==w.state&&(w.state="loaded",w.texture=this.texture)}}loadTile(a,p){this.tileID&&this.tileID.equals(a.tileID.canonical)?(this.tiles[String(a.tileID.wrap)]=a,a.buckets={},p(null)):(a.state="errored",p(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Pr extends _i{constructor(a,p,y,w){super(a,p,y,w),this.roundZoom=!0,this.type="video",this.options=p}load(){this._loaded=!1;const a=this.options;this.urls=[];for(const p of a.urls)this.urls.push(this.map._requestManager.transformRequest(p,x.ResourceType.Source).url);x.getVideo(this.urls,(p,y)=>{this._loaded=!0,p?this.fire(new x.ErrorEvent(p)):y&&(this.video=y,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(a){if(this.video){const p=this.video.seekable;a<p.start(0)||a>p.end(0)?this.fire(new x.ErrorEvent(new x.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${p.start(0)} and ${p.end(0)}-second mark.`))):this.video.currentTime=a}}getVideo(){return this.video}onAdd(a){this.map||(this.map=a,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const a=this.map.painter.context,p=a.gl;this.boundsBuffer||(this.boundsBuffer=a.createVertexBuffer(this._boundsArray,si.members)),this.boundsSegments||(this.boundsSegments=x.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE),p.texSubImage2D(p.TEXTURE_2D,0,0,0,p.RGBA,p.UNSIGNED_BYTE,this.video)):(this.texture=new nt(a,this.video,p.RGBA),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE));for(const y in this.tiles){const w=this.tiles[y];"loaded"!==w.state&&(w.state="loaded",w.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class hn extends _i{constructor(a,p,y,w){super(a,p,y,w),p.coordinates?Array.isArray(p.coordinates)&&4===p.coordinates.length&&!p.coordinates.some(S=>!Array.isArray(S)||2!==S.length||S.some(R=>"number"!=typeof R))||this.fire(new x.ErrorEvent(new x.ValidationError(`sources.${a}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new x.ErrorEvent(new x.ValidationError(`sources.${a}`,null,'missing required property "coordinates"'))),p.animate&&"boolean"!=typeof p.animate&&this.fire(new x.ErrorEvent(new x.ValidationError(`sources.${a}`,null,'optional "animate" property must be a boolean value'))),p.canvas?"string"==typeof p.canvas||p.canvas instanceof HTMLCanvasElement||this.fire(new x.ErrorEvent(new x.ValidationError(`sources.${a}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new x.ErrorEvent(new x.ValidationError(`sources.${a}`,null,'missing required property "canvas"'))),this.options=p,this.animate=void 0===p.animate||p.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new x.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(a){this.map=a,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let a=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,a=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,a=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const p=this.map.painter.context,y=p.gl;this.boundsBuffer||(this.boundsBuffer=p.createVertexBuffer(this._boundsArray,si.members)),this.boundsSegments||(this.boundsSegments=x.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(a||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new nt(p,this.canvas,y.RGBA,{premultiply:!0});for(const w in this.tiles){const S=this.tiles[w];"loaded"!==S.state&&(S.state="loaded",S.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const a of[this.canvas.width,this.canvas.height])if(isNaN(a)||a<=0)return!0;return!1}}const Gn={vector:Et,raster:Ze,"raster-dem":tn,geojson:br,video:Pr,image:_i,canvas:hn};function Qi(b,a){const p=x.create();return x.translate(p,p,[1,1,0]),x.scale(p,p,[.5*b.width,.5*b.height,1]),x.multiply(p,p,b.calculatePosMatrix(a.toUnwrapped()))}function Mo(b,a,p,y,w,S){const R=function(X,te,ce){if(X)for(const oe of X){const he=te[oe];if(he&&he.source===ce&&"fill-extrusion"===he.type)return!0}else for(const oe in te){const he=te[oe];if(he.source===ce&&"fill-extrusion"===he.type)return!0}return!1}(w&&w.layers,a,b.id),F=S.maxPitchScaleFactor(),N=b.tilesIn(y,F,R);N.sort(Do);const j=[];for(const X of N)j.push({wrappedTileID:X.tileID.wrapped().key,queryResults:X.tile.queryRenderedFeatures(a,p,b._state,X.queryGeometry,X.cameraQueryGeometry,X.scale,w,S,F,Qi(b.transform,X.tileID))});const q=function(X){const te={},ce={};for(const oe of X){const he=oe.queryResults,Ce=oe.wrappedTileID,De=ce[Ce]=ce[Ce]||{};for(const Ne in he){const Se=he[Ne],Je=De[Ne]=De[Ne]||{},Ye=te[Ne]=te[Ne]||[];for(const Ge of Se)Je[Ge.featureIndex]||(Je[Ge.featureIndex]=!0,Ye.push(Ge))}}return te}(j);for(const X in q)q[X].forEach(te=>{const ce=te.feature,oe=b.getFeatureState(ce.layer["source-layer"],ce.id);ce.source=ce.layer.source,ce.layer["source-layer"]&&(ce.sourceLayer=ce.layer["source-layer"]),ce.state=oe});return q}function Do(b,a){const p=b.tileID,y=a.tileID;return p.overscaledZ-y.overscaledZ||p.canonical.y-y.canonical.y||p.wrap-y.wrap||p.canonical.x-y.canonical.x}class Wn{constructor(a,p){this.tileID=a,this.uid=x.uniqueId(),this.uses=0,this.tileSize=p,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(a){const p=a+this.timeAdded;p<x.exported.now()||this.fadeEndTime&&p<this.fadeEndTime||(this.fadeEndTime=p)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}loadVectorData(a,p,y){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",a){a.featureIndex&&(this.latestFeatureIndex=a.featureIndex,a.rawTileData?(this.latestRawTileData=a.rawTileData,this.latestFeatureIndex.rawTileData=a.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=a.collisionBoxArray,this.buckets=function(w,S){const R={};if(!S)return R;for(const F of w){const N=F.layerIds.map(j=>S.getLayer(j)).filter(Boolean);if(0!==N.length){F.layers=N,F.stateDependentLayerIds&&(F.stateDependentLayers=F.stateDependentLayerIds.map(j=>N.filter(q=>q.id===j)[0]));for(const j of N)R[j.id]=F}}return R}(a.buckets,p.style),this.hasSymbolBuckets=!1;for(const w in this.buckets){const S=this.buckets[w];if(S instanceof x.SymbolBucket){if(this.hasSymbolBuckets=!0,!y)break;S.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const w in this.buckets){const S=this.buckets[w];if(S instanceof x.SymbolBucket&&S.hasRTLText){this.hasRTLText=!0,x.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const w in this.buckets){const S=this.buckets[w];this.queryPadding=Math.max(this.queryPadding,p.style.getLayer(w).queryRadius(S))}a.imageAtlas&&(this.imageAtlas=a.imageAtlas),a.glyphAtlasImage&&(this.glyphAtlasImage=a.glyphAtlasImage)}else this.collisionBoxArray=new x.CollisionBoxArray}unloadVectorData(){for(const a in this.buckets)this.buckets[a].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(a){return this.buckets[a.id]}upload(a){for(const y in this.buckets){const w=this.buckets[y];w.uploadPending()&&w.upload(a)}const p=a.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new nt(a,this.imageAtlas.image,p.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new nt(a,this.glyphAtlasImage,p.ALPHA),this.glyphAtlasImage=null)}prepare(a){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(a,this.imageAtlasTexture)}queryRenderedFeatures(a,p,y,w,S,R,F,N,j,q){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:w,cameraQueryGeometry:S,scale:R,tileSize:this.tileSize,pixelPosMatrix:q,transform:N,params:F,queryPadding:this.queryPadding*j},a,p,y):{}}querySourceFeatures(a,p){const y=this.latestFeatureIndex;if(!y||!y.rawTileData)return;const w=y.loadVTLayers(),S=p?p.sourceLayer:"",R=w._geojsonTileLayer||w[S];if(!R)return;const F=x.createFilter(p&&p.filter),{z:N,x:j,y:q}=this.tileID.canonical,X={z:N,x:j,y:q};for(let te=0;te<R.length;te++){const ce=R.feature(te);if(F.needGeometry){const Ce=x.toEvaluationFeature(ce,!0);if(!F.filter(new x.EvaluationParameters(this.tileID.overscaledZ),Ce,this.tileID.canonical))continue}else if(!F.filter(new x.EvaluationParameters(this.tileID.overscaledZ),ce))continue;const oe=y.getId(ce,S),he=new x.GeoJSONFeature(ce,N,j,q,oe);he.tile=X,a.push(he)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(a){const p=this.expirationTime;if(a.cacheControl){const y=x.parseCacheControl(a.cacheControl);y["max-age"]&&(this.expirationTime=Date.now()+1e3*y["max-age"])}else a.expires&&(this.expirationTime=new Date(a.expires).getTime());if(this.expirationTime){const y=Date.now();let w=!1;if(this.expirationTime>y)w=!1;else if(p)if(this.expirationTime<p)w=!0;else{const S=this.expirationTime-p;S?this.expirationTime=y+Math.max(S,3e4):w=!0}else w=!0;w?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(a,p){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(a).length)return;const y=this.latestFeatureIndex.loadVTLayers();for(const w in this.buckets){if(!p.style.hasLayer(w))continue;const S=this.buckets[w],R=S.layers[0].sourceLayer||"_geojsonTileLayer",F=y[R],N=a[R];if(!F||!N||0===Object.keys(N).length)continue;S.update(N,F,this.imageAtlas&&this.imageAtlas.patternPositions||{});const j=p&&p.style&&p.style.getLayer(w);j&&(this.queryPadding=Math.max(this.queryPadding,j.queryRadius(S)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<x.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(a){this.symbolFadeHoldUntil=x.exported.now()+a}setDependencies(a,p){const y={};for(const w of p)y[w]=!0;this.dependencies[a]=y}hasDependency(a,p){for(const y of a){const w=this.dependencies[y];if(w)for(const S of p)if(w[S])return!0}return!1}}class is{constructor(a,p){this.max=a,this.onRemove=p,this.reset()}reset(){for(const a in this.data)for(const p of this.data[a])p.timeout&&clearTimeout(p.timeout),this.onRemove(p.value);return this.data={},this.order=[],this}add(a,p,y){const w=a.wrapped().key;void 0===this.data[w]&&(this.data[w]=[]);const S={value:p,timeout:void 0};if(void 0!==y&&(S.timeout=setTimeout(()=>{this.remove(a,S)},y)),this.data[w].push(S),this.order.push(w),this.order.length>this.max){const R=this._getAndRemoveByKey(this.order[0]);R&&this.onRemove(R)}return this}has(a){return a.wrapped().key in this.data}getAndRemove(a){return this.has(a)?this._getAndRemoveByKey(a.wrapped().key):null}_getAndRemoveByKey(a){const p=this.data[a].shift();return p.timeout&&clearTimeout(p.timeout),0===this.data[a].length&&delete this.data[a],this.order.splice(this.order.indexOf(a),1),p.value}getByKey(a){const p=this.data[a];return p?p[0].value:null}get(a){return this.has(a)?this.data[a.wrapped().key][0].value:null}remove(a,p){if(!this.has(a))return this;const y=a.wrapped().key,w=void 0===p?0:this.data[y].indexOf(p),S=this.data[y][w];return this.data[y].splice(w,1),S.timeout&&clearTimeout(S.timeout),0===this.data[y].length&&delete this.data[y],this.onRemove(S.value),this.order.splice(this.order.indexOf(y),1),this}setMaxSize(a){for(this.max=a;this.order.length>this.max;){const p=this._getAndRemoveByKey(this.order[0]);p&&this.onRemove(p)}return this}filter(a){const p=[];for(const y in this.data)for(const w of this.data[y])a(w.value)||p.push(w);for(const y of p)this.remove(y.value.tileID,y)}}class ns{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(a,p,y){const w=String(p);if(this.stateChanges[a]=this.stateChanges[a]||{},this.stateChanges[a][w]=this.stateChanges[a][w]||{},x.extend(this.stateChanges[a][w],y),null===this.deletedStates[a]){this.deletedStates[a]={};for(const S in this.state[a])S!==w&&(this.deletedStates[a][S]=null)}else if(this.deletedStates[a]&&null===this.deletedStates[a][w]){this.deletedStates[a][w]={};for(const S in this.state[a][w])y[S]||(this.deletedStates[a][w][S]=null)}else for(const S in y)this.deletedStates[a]&&this.deletedStates[a][w]&&null===this.deletedStates[a][w][S]&&delete this.deletedStates[a][w][S]}removeFeatureState(a,p,y){if(null===this.deletedStates[a])return;const w=String(p);if(this.deletedStates[a]=this.deletedStates[a]||{},y&&void 0!==p)null!==this.deletedStates[a][w]&&(this.deletedStates[a][w]=this.deletedStates[a][w]||{},this.deletedStates[a][w][y]=null);else if(void 0!==p)if(this.stateChanges[a]&&this.stateChanges[a][w])for(y in this.deletedStates[a][w]={},this.stateChanges[a][w])this.deletedStates[a][w][y]=null;else this.deletedStates[a][w]=null;else this.deletedStates[a]=null}getState(a,p){const y=String(p),w=x.extend({},(this.state[a]||{})[y],(this.stateChanges[a]||{})[y]);if(null===this.deletedStates[a])return{};if(this.deletedStates[a]){const S=this.deletedStates[a][p];if(null===S)return{};for(const R in S)delete w[R]}return w}initializeTileState(a,p){a.setFeatureState(this.state,p)}coalesceChanges(a,p){const y={};for(const w in this.stateChanges){this.state[w]=this.state[w]||{};const S={};for(const R in this.stateChanges[w])this.state[w][R]||(this.state[w][R]={}),x.extend(this.state[w][R],this.stateChanges[w][R]),S[R]=this.state[w][R];y[w]=S}for(const w in this.deletedStates){this.state[w]=this.state[w]||{};const S={};if(null===this.deletedStates[w])for(const R in this.state[w])S[R]={},this.state[w][R]={};else for(const R in this.deletedStates[w]){if(null===this.deletedStates[w][R])this.state[w][R]={};else for(const F of Object.keys(this.deletedStates[w][R]))delete this.state[w][R][F];S[R]=this.state[w][R]}y[w]=y[w]||{},x.extend(y[w],S)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(y).length)for(const w in a)a[w].setFeatureState(y,p)}}class Jn extends x.Evented{constructor(a,p,y){super(),this.id=a,this.dispatcher=y,this.on("data",w=>{"source"===w.dataType&&"metadata"===w.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===w.dataType&&"content"===w.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=!0}),this._source=function(w,S,R,F){const N=new Gn[S.type](w,S,R,F);if(N.id!==w)throw new Error(`Expected Source id to be ${w} instead of ${N.id}`);return x.bindAll(["load","abort","unload","serialize","prepare"],N),N}(a,p,y,this),this._tiles={},this._cache=new is(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new ns}onAdd(a){this.map=a,this._maxTileCacheSize=a?a._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(a)}onRemove(a){this._source&&this._source.onRemove&&this._source.onRemove(a)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const a in this._tiles){const p=this._tiles[a];if("loaded"!==p.state&&"errored"!==p.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const a=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,a&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(a,p){return this._source.loadTile(a,p)}_unloadTile(a){if(this._source.unloadTile)return this._source.unloadTile(a,()=>{})}_abortTile(a){this._source.abortTile&&this._source.abortTile(a,()=>{}),this._source.fire(new x.Event("dataabort",{tile:a,coord:a.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(a){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const p in this._tiles){const y=this._tiles[p];y.upload(a),y.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(a=>a.tileID).sort(Cs).map(a=>a.key)}getRenderableIds(a){const p=[];for(const y in this._tiles)this._isIdRenderable(y,a)&&p.push(this._tiles[y]);return a?p.sort((y,w)=>{const S=y.tileID,R=w.tileID,F=new x.pointGeometry(S.canonical.x,S.canonical.y)._rotate(this.transform.angle),N=new x.pointGeometry(R.canonical.x,R.canonical.y)._rotate(this.transform.angle);return S.overscaledZ-R.overscaledZ||N.y-F.y||N.x-F.x}).map(y=>y.tileID.key):p.map(y=>y.tileID).sort(Cs).map(y=>y.key)}hasRenderableParent(a){const p=this.findLoadedParent(a,0);return!!p&&this._isIdRenderable(p.tileID.key)}_isIdRenderable(a,p){return this._tiles[a]&&this._tiles[a].hasData()&&!this._coveredTiles[a]&&(p||!this._tiles[a].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const a in this._tiles)"errored"!==this._tiles[a].state&&this._reloadTile(a,"reloading")}}_reloadTile(a,p){const y=this._tiles[a];y&&("loading"!==y.state&&(y.state=p),this._loadTile(y,this._tileLoaded.bind(this,y,a,p)))}_tileLoaded(a,p,y,w){if(w)return a.state="errored",void(404!==w.status?this._source.fire(new x.ErrorEvent(w,{tile:a})):this.update(this.transform));a.timeAdded=x.exported.now(),"expired"===y&&(a.refreshedUponExpiration=!0),this._setTileReloadTimer(p,a),"raster-dem"===this.getSource().type&&a.dem&&this._backfillDEM(a),this._state.initializeTileState(a,this.map?this.map.painter:null),this._source.fire(new x.Event("data",{dataType:"source",tile:a,coord:a.tileID}))}_backfillDEM(a){const p=this.getRenderableIds();for(let w=0;w<p.length;w++){const S=p[w];if(a.neighboringTiles&&a.neighboringTiles[S]){const R=this.getTileByID(S);y(a,R),y(R,a)}}function y(w,S){w.needsHillshadePrepare=!0;let R=S.tileID.canonical.x-w.tileID.canonical.x;const F=S.tileID.canonical.y-w.tileID.canonical.y,N=Math.pow(2,w.tileID.canonical.z),j=S.tileID.key;0===R&&0===F||Math.abs(F)>1||(Math.abs(R)>1&&(1===Math.abs(R+N)?R+=N:1===Math.abs(R-N)&&(R-=N)),S.dem&&w.dem&&(w.dem.backfillBorder(S.dem,R,F),w.neighboringTiles&&w.neighboringTiles[j]&&(w.neighboringTiles[j].backfilled=!0)))}}getTile(a){return this.getTileByID(a.key)}getTileByID(a){return this._tiles[a]}_retainLoadedChildren(a,p,y,w){for(const S in this._tiles){let R=this._tiles[S];if(w[S]||!R.hasData()||R.tileID.overscaledZ<=p||R.tileID.overscaledZ>y)continue;let F=R.tileID;for(;R&&R.tileID.overscaledZ>p+1;){const j=R.tileID.scaledTo(R.tileID.overscaledZ-1);R=this._tiles[j.key],R&&R.hasData()&&(F=j)}let N=F;for(;N.overscaledZ>p;)if(N=N.scaledTo(N.overscaledZ-1),a[N.key]){w[F.key]=F;break}}}findLoadedParent(a,p){if(a.key in this._loadedParentTiles){const y=this._loadedParentTiles[a.key];return y&&y.tileID.overscaledZ>=p?y:null}for(let y=a.overscaledZ-1;y>=p;y--){const w=a.scaledTo(y),S=this._getLoadedTile(w);if(S)return S}}_getLoadedTile(a){const p=this._tiles[a.key];return p&&p.hasData()?p:this._cache.getByKey(a.wrapped().key)}updateCacheSize(a){const p=Math.ceil(a.width/this._source.tileSize)+1,y=Math.ceil(a.height/this._source.tileSize)+1,w=Math.floor(p*y*5),S="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(S)}handleWrapJump(a){const p=Math.round((a-(void 0===this._prevLng?a:this._prevLng))/360);if(this._prevLng=a,p){const y={};for(const w in this._tiles){const S=this._tiles[w];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+p),y[S.tileID.key]=S}this._tiles=y;for(const w in this._timers)clearTimeout(this._timers[w]),delete this._timers[w];for(const w in this._tiles)this._setTileReloadTimer(w,this._tiles[w])}}update(a){if(this.transform=a,!this._sourceLoaded||this._paused)return;let p;this.updateCacheSize(a),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?p=a.getVisibleUnwrappedCoordinates(this._source.tileID).map(N=>new x.OverscaledTileID(N.canonical.z,N.wrap,N.canonical.z,N.canonical.x,N.canonical.y)):(p=a.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(p=p.filter(N=>this._source.hasTile(N)))):p=[];const y=a.coveringZoomLevel(this._source),w=Math.max(y-Jn.maxOverzooming,this._source.minzoom),S=Math.max(y+Jn.maxUnderzooming,this._source.minzoom),R=this._updateRetainedTiles(p,y);if(Ro(this._source.type)){const N={},j={},q=Object.keys(R);for(const X of q){const te=R[X],ce=this._tiles[X];if(!ce||ce.fadeEndTime&&ce.fadeEndTime<=x.exported.now())continue;const oe=this.findLoadedParent(te,w);oe&&(this._addTile(oe.tileID),N[oe.tileID.key]=oe.tileID),j[X]=te}this._retainLoadedChildren(j,y,S,R);for(const X in N)R[X]||(this._coveredTiles[X]=!0,R[X]=N[X])}for(const N in R)this._tiles[N].clearFadeHold();const F=x.keysDifference(this._tiles,R);for(const N of F){const j=this._tiles[N];j.hasSymbolBuckets&&!j.holdingForFade()?j.setHoldDuration(this.map._fadeDuration):j.hasSymbolBuckets&&!j.symbolFadeFinished()||this._removeTile(N)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const a in this._tiles)this._tiles[a].holdingForFade()&&this._removeTile(a)}_updateRetainedTiles(a,p){const y={},w={},S=Math.max(p-Jn.maxOverzooming,this._source.minzoom),R=Math.max(p+Jn.maxUnderzooming,this._source.minzoom),F={};for(const N of a){const j=this._addTile(N);y[N.key]=N,j.hasData()||p<this._source.maxzoom&&(F[N.key]=N)}this._retainLoadedChildren(F,p,R,y);for(const N of a){let j=this._tiles[N.key];if(j.hasData())continue;if(p+1>this._source.maxzoom){const X=N.children(this._source.maxzoom)[0],te=this.getTile(X);if(te&&te.hasData()){y[X.key]=X;continue}}else{const X=N.children(this._source.maxzoom);if(y[X[0].key]&&y[X[1].key]&&y[X[2].key]&&y[X[3].key])continue}let q=j.wasRequested();for(let X=N.overscaledZ-1;X>=S;--X){const te=N.scaledTo(X);if(w[te.key]||(w[te.key]=!0,j=this.getTile(te),!j&&q&&(j=this._addTile(te)),j&&(y[te.key]=te,q=j.wasRequested(),j.hasData())))break}}return y}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const a in this._tiles){const p=[];let y,w=this._tiles[a].tileID;for(;w.overscaledZ>0;){if(w.key in this._loadedParentTiles){y=this._loadedParentTiles[w.key];break}p.push(w.key);const S=w.scaledTo(w.overscaledZ-1);if(y=this._getLoadedTile(S),y)break;w=S}for(const S of p)this._loadedParentTiles[S]=y}}_addTile(a){let p=this._tiles[a.key];if(p)return p;p=this._cache.getAndRemove(a),p&&(this._setTileReloadTimer(a.key,p),p.tileID=a,this._state.initializeTileState(p,this.map?this.map.painter:null),this._cacheTimers[a.key]&&(clearTimeout(this._cacheTimers[a.key]),delete this._cacheTimers[a.key],this._setTileReloadTimer(a.key,p)));const y=p;return p||(p=new Wn(a,this._source.tileSize*a.overscaleFactor()),this._loadTile(p,this._tileLoaded.bind(this,p,a.key,p.state))),p.uses++,this._tiles[a.key]=p,y||this._source.fire(new x.Event("dataloading",{tile:p,coord:p.tileID,dataType:"source"})),p}_setTileReloadTimer(a,p){a in this._timers&&(clearTimeout(this._timers[a]),delete this._timers[a]);const y=p.getExpiryTimeout();y&&(this._timers[a]=setTimeout(()=>{this._reloadTile(a,"expired"),delete this._timers[a]},y))}_removeTile(a){const p=this._tiles[a];p&&(p.uses--,delete this._tiles[a],this._timers[a]&&(clearTimeout(this._timers[a]),delete this._timers[a]),p.uses>0||(p.hasData()&&"reloading"!==p.state?this._cache.add(p.tileID,p,p.getExpiryTimeout()):(p.aborted=!0,this._abortTile(p),this._unloadTile(p))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const a in this._tiles)this._removeTile(a);this._cache.reset()}tilesIn(a,p,y){const w=[],S=this.transform;if(!S)return w;const R=y?S.getCameraQueryGeometry(a):a,F=a.map(oe=>S.pointCoordinate(oe)),N=R.map(oe=>S.pointCoordinate(oe)),j=this.getIds();let q=1/0,X=1/0,te=-1/0,ce=-1/0;for(const oe of N)q=Math.min(q,oe.x),X=Math.min(X,oe.y),te=Math.max(te,oe.x),ce=Math.max(ce,oe.y);for(let oe=0;oe<j.length;oe++){const he=this._tiles[j[oe]];if(he.holdingForFade())continue;const Ce=he.tileID,De=Math.pow(2,S.zoom-he.tileID.overscaledZ),Ne=p*he.queryPadding*x.EXTENT/he.tileSize/De,Se=[Ce.getTilePoint(new x.MercatorCoordinate(q,X)),Ce.getTilePoint(new x.MercatorCoordinate(te,ce))];if(Se[0].x-Ne<x.EXTENT&&Se[0].y-Ne<x.EXTENT&&Se[1].x+Ne>=0&&Se[1].y+Ne>=0){const Je=F.map(Ge=>Ce.getTilePoint(Ge)),Ye=N.map(Ge=>Ce.getTilePoint(Ge));w.push({tile:he,tileID:Ce,queryGeometry:Je,cameraQueryGeometry:Ye,scale:De})}}return w}getVisibleCoordinates(a){const p=this.getRenderableIds(a).map(y=>this._tiles[y].tileID);for(const y of p)y.posMatrix=this.transform.calculatePosMatrix(y.toUnwrapped());return p}hasTransition(){if(this._source.hasTransition())return!0;if(Ro(this._source.type))for(const a in this._tiles){const p=this._tiles[a];if(void 0!==p.fadeEndTime&&p.fadeEndTime>=x.exported.now())return!0}return!1}setFeatureState(a,p,y){this._state.updateState(a=a||"_geojsonTileLayer",p,y)}removeFeatureState(a,p,y){this._state.removeFeatureState(a=a||"_geojsonTileLayer",p,y)}getFeatureState(a,p){return this._state.getState(a=a||"_geojsonTileLayer",p)}setDependencies(a,p,y){const w=this._tiles[a];w&&w.setDependencies(p,y)}reloadTilesForDependencies(a,p){for(const y in this._tiles)this._tiles[y].hasDependency(a,p)&&this._reloadTile(y,"reloading");this._cache.filter(y=>!y.hasDependency(a,p))}}function Cs(b,a){const p=Math.abs(2*b.wrap)-+(b.wrap<0),y=Math.abs(2*a.wrap)-+(a.wrap<0);return b.overscaledZ-a.overscaledZ||y-p||a.canonical.y-b.canonical.y||a.canonical.x-b.canonical.x}function Ro(b){return"raster"===b||"image"===b||"video"===b}Jn.maxOverzooming=10,Jn.maxUnderzooming=3;const oo="mapboxgl_preloaded_worker_pool";class Eo{constructor(){this.active={}}acquire(a){if(!this.workers)for(this.workers=[];this.workers.length<Eo.workerCount;)this.workers.push(new Worker(qa.workerUrl));return this.active[a]=!0,this.workers.slice()}release(a){delete this.active[a],0===this.numActive()&&(this.workers.forEach(p=>{p.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[oo]}numActive(){return Object.keys(this.active).length}}const rs=Math.floor(x.exported.hardwareConcurrency/2);let pi;function Or(){return pi||(pi=new Eo),pi}function mr(b,a){const p={};for(const y in b)"ref"!==y&&(p[y]=b[y]);return x.refProperties.forEach(y=>{y in a&&(p[y]=a[y])}),p}function er(b){b=b.slice();const a=Object.create(null);for(let p=0;p<b.length;p++)a[b[p].id]=b[p];for(let p=0;p<b.length;p++)"ref"in b[p]&&(b[p]=mr(b[p],a[b[p].ref]));return b}Eo.workerCount=Math.max(Math.min(rs,6),1);const Hi={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Po(b,a,p){p.push({command:Hi.addSource,args:[b,a[b]]})}function xr(b,a,p){a.push({command:Hi.removeSource,args:[b]}),p[b]=!0}function wr(b,a,p,y){xr(b,p,y),Po(b,a,p)}function Xe(b,a,p){let y;for(y in b[p])if(Object.prototype.hasOwnProperty.call(b[p],y)&&"data"!==y&&!xe(b[p][y],a[p][y]))return!1;for(y in a[p])if(Object.prototype.hasOwnProperty.call(a[p],y)&&"data"!==y&&!xe(b[p][y],a[p][y]))return!1;return!0}function Pt(b,a,p,y,w,S){let R;for(R in a=a||{},b=b||{})Object.prototype.hasOwnProperty.call(b,R)&&(xe(b[R],a[R])||p.push({command:S,args:[y,R,a[R],w]}));for(R in a)Object.prototype.hasOwnProperty.call(a,R)&&!Object.prototype.hasOwnProperty.call(b,R)&&(xe(b[R],a[R])||p.push({command:S,args:[y,R,a[R],w]}))}function Yi(b){return b.id}function ai(b,a){return b[a.id]=a,b}class Kt{constructor(a,p){this.reset(a,p)}reset(a,p){this.points=a||[],this._distances=[0];for(let y=1;y<this.points.length;y++)this._distances[y]=this._distances[y-1]+this.points[y].dist(this.points[y-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(p||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(a){if(1===this.points.length)return this.points[0];a=x.clamp(a,0,1);let p=1,y=this._distances[p];const w=a*this.paddedLength+this.padding;for(;y<w&&p<this._distances.length;)y=this._distances[++p];const S=p-1,R=this._distances[S],F=y-R,N=F>0?(w-R)/F:0;return this.points[S].mult(1-N).add(this.points[p].mult(N))}}function Fr(b,a){let p=!0;return"always"===b||"never"!==b&&"never"!==a||(p=!1),p}class gr{constructor(a,p,y){const w=this.boxCells=[],S=this.circleCells=[];this.xCellCount=Math.ceil(a/y),this.yCellCount=Math.ceil(p/y);for(let R=0;R<this.xCellCount*this.yCellCount;R++)w.push([]),S.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=a,this.height=p,this.xScale=this.xCellCount/a,this.yScale=this.yCellCount/p,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(a,p,y,w,S){this._forEachCell(p,y,w,S,this._insertBoxCell,this.boxUid++),this.boxKeys.push(a),this.bboxes.push(p),this.bboxes.push(y),this.bboxes.push(w),this.bboxes.push(S)}insertCircle(a,p,y,w){this._forEachCell(p-w,y-w,p+w,y+w,this._insertCircleCell,this.circleUid++),this.circleKeys.push(a),this.circles.push(p),this.circles.push(y),this.circles.push(w)}_insertBoxCell(a,p,y,w,S,R){this.boxCells[S].push(R)}_insertCircleCell(a,p,y,w,S,R){this.circleCells[S].push(R)}_query(a,p,y,w,S,R,F){if(y<0||a>this.width||w<0||p>this.height)return[];const N=[];if(a<=0&&p<=0&&this.width<=y&&this.height<=w){if(S)return[{key:null,x1:a,y1:p,x2:y,y2:w}];for(let j=0;j<this.boxKeys.length;j++)N.push({key:this.boxKeys[j],x1:this.bboxes[4*j],y1:this.bboxes[4*j+1],x2:this.bboxes[4*j+2],y2:this.bboxes[4*j+3]});for(let j=0;j<this.circleKeys.length;j++){const q=this.circles[3*j],X=this.circles[3*j+1],te=this.circles[3*j+2];N.push({key:this.circleKeys[j],x1:q-te,y1:X-te,x2:q+te,y2:X+te})}}else this._forEachCell(a,p,y,w,this._queryCell,N,{hitTest:S,overlapMode:R,seenUids:{box:{},circle:{}}},F);return N}query(a,p,y,w){return this._query(a,p,y,w,!1,null)}hitTest(a,p,y,w,S,R){return this._query(a,p,y,w,!0,S,R).length>0}hitTestCircle(a,p,y,w,S){const R=a-y,F=a+y,N=p-y,j=p+y;if(F<0||R>this.width||j<0||N>this.height)return!1;const q=[];return this._forEachCell(R,N,F,j,this._queryCellCircle,q,{hitTest:!0,overlapMode:w,circle:{x:a,y:p,radius:y},seenUids:{box:{},circle:{}}},S),q.length>0}_queryCell(a,p,y,w,S,R,F,N){const{seenUids:j,hitTest:q,overlapMode:X}=F,te=this.boxCells[S];if(null!==te){const oe=this.bboxes;for(const he of te)if(!j.box[he]){j.box[he]=!0;const Ce=4*he,De=this.boxKeys[he];if(a<=oe[Ce+2]&&p<=oe[Ce+3]&&y>=oe[Ce+0]&&w>=oe[Ce+1]&&(!N||N(De))&&(!q||!Fr(X,De.overlapMode))&&(R.push({key:De,x1:oe[Ce],y1:oe[Ce+1],x2:oe[Ce+2],y2:oe[Ce+3]}),q))return!0}}const ce=this.circleCells[S];if(null!==ce){const oe=this.circles;for(const he of ce)if(!j.circle[he]){j.circle[he]=!0;const Ce=3*he,De=this.circleKeys[he];if(this._circleAndRectCollide(oe[Ce],oe[Ce+1],oe[Ce+2],a,p,y,w)&&(!N||N(De))&&(!q||!Fr(X,De.overlapMode))){const Ne=oe[Ce],Se=oe[Ce+1],Je=oe[Ce+2];if(R.push({key:De,x1:Ne-Je,y1:Se-Je,x2:Ne+Je,y2:Se+Je}),q)return!0}}}return!1}_queryCellCircle(a,p,y,w,S,R,F,N){const{circle:j,seenUids:q,overlapMode:X}=F,te=this.boxCells[S];if(null!==te){const oe=this.bboxes;for(const he of te)if(!q.box[he]){q.box[he]=!0;const Ce=4*he,De=this.boxKeys[he];if(this._circleAndRectCollide(j.x,j.y,j.radius,oe[Ce+0],oe[Ce+1],oe[Ce+2],oe[Ce+3])&&(!N||N(De))&&!Fr(X,De.overlapMode))return R.push(!0),!0}}const ce=this.circleCells[S];if(null!==ce){const oe=this.circles;for(const he of ce)if(!q.circle[he]){q.circle[he]=!0;const Ce=3*he,De=this.circleKeys[he];if(this._circlesCollide(oe[Ce],oe[Ce+1],oe[Ce+2],j.x,j.y,j.radius)&&(!N||N(De))&&!Fr(X,De.overlapMode))return R.push(!0),!0}}}_forEachCell(a,p,y,w,S,R,F,N){const j=this._convertToXCellCoord(a),q=this._convertToYCellCoord(p),X=this._convertToXCellCoord(y),te=this._convertToYCellCoord(w);for(let ce=j;ce<=X;ce++)for(let oe=q;oe<=te;oe++)if(S.call(this,a,p,y,w,this.xCellCount*oe+ce,R,F,N))return}_convertToXCellCoord(a){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(a*this.xScale)))}_convertToYCellCoord(a){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(a*this.yScale)))}_circlesCollide(a,p,y,w,S,R){const F=w-a,N=S-p,j=y+R;return j*j>F*F+N*N}_circleAndRectCollide(a,p,y,w,S,R,F){const N=(R-w)/2,j=Math.abs(a-(w+N));if(j>N+y)return!1;const q=(F-S)/2,X=Math.abs(p-(S+q));if(X>q+y)return!1;if(j<=N||X<=q)return!0;const te=j-N,ce=X-q;return te*te+ce*ce<=y*y}}function Vi(b,a,p,y,w){const S=x.create();return a?(x.scale(S,S,[1/w,1/w,1]),p||x.rotateZ(S,S,y.angle)):x.multiply(S,y.labelPlaneMatrix,b),S}function Zn(b,a,p,y,w){if(a){const S=x.clone(b);return x.scale(S,S,[w,w,1]),p||x.rotateZ(S,S,-y.angle),S}return y.glCoordMatrix}function ft(b,a){const p=x.fromValues(b.x,b.y,0,1);os(p,p,a);const y=p[3];return{point:new x.pointGeometry(p[0]/y,p[1]/y),signedDistanceFromCamera:y}}function vi(b,a){return.5+b/a*.5}function wt(b,a){const p=b[0]/b[3],y=b[1]/b[3];return p>=-a[0]&&p<=a[0]&&y>=-a[1]&&y<=a[1]}function sr(b,a,p,y,w,S,R,F){const N=y?b.textSizeData:b.iconSizeData,j=x.evaluateSizeForZoom(N,p.transform.zoom),q=[256/p.width*2+1,256/p.height*2+1],X=y?b.text.dynamicLayoutVertexArray:b.icon.dynamicLayoutVertexArray;X.clear();const te=b.lineVertexArray,ce=y?b.text.placedSymbolArray:b.icon.placedSymbolArray,oe=p.transform.width/p.transform.height;let he=!1;for(let Ce=0;Ce<ce.length;Ce++){const De=ce.get(Ce);if(De.hidden||De.writingMode===x.WritingMode.vertical&&!he){Wi(De.numGlyphs,X);continue}he=!1;const Ne=x.fromValues(De.anchorX,De.anchorY,0,1);if(x.transformMat4(Ne,Ne,a),!wt(Ne,q)){Wi(De.numGlyphs,X);continue}const Se=vi(p.transform.cameraToCenterDistance,Ne[3]),Je=x.evaluateSizeForFeature(N,j,De),Ye=R?Je/Se:Je*Se,Ge=new x.pointGeometry(De.anchorX,De.anchorY),ht=ft(Ge,w).point,mt={},ot=Oo(De,Ye,!1,F,a,w,S,b.glyphOffsetArray,te,X,ht,Ge,mt,oe);he=ot.useVertical,(ot.notEnoughRoom||he||ot.needsFlipping&&Oo(De,Ye,!0,F,a,w,S,b.glyphOffsetArray,te,X,ht,Ge,mt,oe).notEnoughRoom)&&Wi(De.numGlyphs,X)}y?b.text.dynamicLayoutVertexBuffer.updateData(X):b.icon.dynamicLayoutVertexBuffer.updateData(X)}function Li(b,a,p,y,w,S,R,F,N,j,q){const X=F.glyphStartIndex+F.numGlyphs,te=F.lineStartIndex,ce=F.lineStartIndex+F.lineLength,oe=a.getoffsetX(F.glyphStartIndex),he=a.getoffsetX(X-1),Ce=Fn(b*oe,p,y,w,S,R,F.segment,te,ce,N,j,q);if(!Ce)return null;const De=Fn(b*he,p,y,w,S,R,F.segment,te,ce,N,j,q);return De?{first:Ce,last:De}:null}function Mi(b,a,p,y){return b===x.WritingMode.horizontal&&Math.abs(p.y-a.y)>Math.abs(p.x-a.x)*y?{useVertical:!0}:(b===x.WritingMode.vertical?a.y<p.y:a.x>p.x)?{needsFlipping:!0}:null}function Oo(b,a,p,y,w,S,R,F,N,j,q,X,te,ce){const oe=a/24,he=b.lineOffsetX*oe,Ce=b.lineOffsetY*oe;let De;if(b.numGlyphs>1){const Ne=b.glyphStartIndex+b.numGlyphs,Se=b.lineStartIndex,Je=b.lineStartIndex+b.lineLength,Ye=Li(oe,F,he,Ce,p,q,X,b,N,S,te);if(!Ye)return{notEnoughRoom:!0};const Ge=ft(Ye.first.point,R).point,ht=ft(Ye.last.point,R).point;if(y&&!p){const mt=Mi(b.writingMode,Ge,ht,ce);if(mt)return mt}De=[Ye.first];for(let mt=b.glyphStartIndex+1;mt<Ne-1;mt++)De.push(Fn(oe*F.getoffsetX(mt),he,Ce,p,q,X,b.segment,Se,Je,N,S,te));De.push(Ye.last)}else{if(y&&!p){const Se=ft(X,w).point,Je=b.lineStartIndex+b.segment+1,Ye=new x.pointGeometry(N.getx(Je),N.gety(Je)),Ge=ft(Ye,w),ht=Ge.signedDistanceFromCamera>0?Ge.point:ar(X,Ye,Se,1,w),mt=Mi(b.writingMode,Se,ht,ce);if(mt)return mt}const Ne=Fn(oe*F.getoffsetX(b.glyphStartIndex),he,Ce,p,q,X,b.segment,b.lineStartIndex,b.lineStartIndex+b.lineLength,N,S,te);if(!Ne)return{notEnoughRoom:!0};De=[Ne]}for(const Ne of De)x.addDynamicAttributes(j,Ne.point,Ne.angle);return{}}function ar(b,a,p,y,w){const S=ft(b.add(b.sub(a)._unit()),w).point,R=p.sub(S);return p.add(R._mult(y/R.mag()))}function Fn(b,a,p,y,w,S,R,F,N,j,q,X){const te=y?b-a:b+a;let ce=te>0?1:-1,oe=0;y&&(ce*=-1,oe=Math.PI),ce<0&&(oe+=Math.PI);let he=ce>0?F+R:F+R+1,Ce=w,De=w,Ne=0,Se=0;const Je=Math.abs(te),Ye=[];for(;Ne+Se<=Je;){if(he+=ce,he<F||he>=N)return null;if(De=Ce,Ye.push(Ce),Ce=X[he],void 0===Ce){const Zt=new x.pointGeometry(j.getx(he),j.gety(he)),St=ft(Zt,q);if(St.signedDistanceFromCamera>0)Ce=X[he]=St.point;else{const oi=he-ce;Ce=ar(0===Ne?S:new x.pointGeometry(j.getx(oi),j.gety(oi)),Zt,De,Je-Ne+1,q)}}Ne+=Se,Se=De.dist(Ce)}const Ge=(Je-Ne)/Se,ht=Ce.sub(De),mt=ht.mult(Ge)._add(De);mt._add(ht._unit()._perp()._mult(p*ce));const ot=oe+Math.atan2(Ce.y-De.y,Ce.x-De.x);return Ye.push(mt),{point:mt,angle:ot,path:Ye}}const Cr=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Wi(b,a){for(let p=0;p<b;p++){const y=a.length;a.resize(y+4),a.float32.set(Cr,3*y)}}function os(b,a,p){const y=a[0],w=a[1];return b[0]=p[0]*y+p[4]*w+p[12],b[1]=p[1]*y+p[5]*w+p[13],b[3]=p[3]*y+p[7]*w+p[15],b}const Rn=100;class Fo{constructor(a,p=new gr(a.width+200,a.height+200,25),y=new gr(a.width+200,a.height+200,25)){this.transform=a,this.grid=p,this.ignoredGrid=y,this.pitchfactor=Math.cos(a._pitch)*a.cameraToCenterDistance,this.screenRightBoundary=a.width+Rn,this.screenBottomBoundary=a.height+Rn,this.gridRightBoundary=a.width+200,this.gridBottomBoundary=a.height+200}placeCollisionBox(a,p,y,w,S){const R=this.projectAndGetPerspectiveRatio(w,a.anchorPointX,a.anchorPointY),F=y*R.perspectiveRatio,N=a.x1*F+R.point.x,j=a.y1*F+R.point.y,q=a.x2*F+R.point.x,X=a.y2*F+R.point.y;return!this.isInsideGrid(N,j,q,X)||"always"!==p&&this.grid.hitTest(N,j,q,X,p,S)?{box:[],offscreen:!1}:{box:[N,j,q,X],offscreen:this.isOffscreen(N,j,q,X)}}placeCollisionCircles(a,p,y,w,S,R,F,N,j,q,X,te,ce){const oe=[],he=new x.pointGeometry(p.anchorX,p.anchorY),Ce=ft(he,R),De=vi(this.transform.cameraToCenterDistance,Ce.signedDistanceFromCamera),Ne=(q?S/De:S*De)/x.ONE_EM,Se=ft(he,F).point,Je=Li(Ne,w,p.lineOffsetX*Ne,p.lineOffsetY*Ne,!1,Se,he,p,y,F,{});let Ye=!1,Ge=!1,ht=!0;if(Je){const mt=.5*te*De+ce,ot=new x.pointGeometry(-100,-100),Zt=new x.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),St=new Kt,oi=Je.first,Zi=Je.last;let mi=[];for(let Si=oi.path.length-1;Si>=1;Si--)mi.push(oi.path[Si]);for(let Si=1;Si<Zi.path.length;Si++)mi.push(Zi.path[Si]);const Ii=2.5*mt;if(N){const Si=mi.map(Ni=>ft(Ni,N));mi=Si.some(Ni=>Ni.signedDistanceFromCamera<=0)?[]:Si.map(Ni=>Ni.point)}let wn=[];if(mi.length>0){const Si=mi[0].clone(),Ni=mi[0].clone();for(let Sn=1;Sn<mi.length;Sn++)Si.x=Math.min(Si.x,mi[Sn].x),Si.y=Math.min(Si.y,mi[Sn].y),Ni.x=Math.max(Ni.x,mi[Sn].x),Ni.y=Math.max(Ni.y,mi[Sn].y);wn=Si.x>=ot.x&&Ni.x<=Zt.x&&Si.y>=ot.y&&Ni.y<=Zt.y?[mi]:Ni.x<ot.x||Si.x>Zt.x||Ni.y<ot.y||Si.y>Zt.y?[]:x.clipLine([mi],ot.x,ot.y,Zt.x,Zt.y)}for(const Si of wn){St.reset(Si,.25*mt);let Ni=0;Ni=St.length<=.5*mt?1:Math.ceil(St.paddedLength/Ii)+1;for(let Sn=0;Sn<Ni;Sn++){const Yr=Sn/Math.max(Ni-1,1),go=St.lerp(Yr),ln=go.x+Rn,_o=go.y+Rn;oe.push(ln,_o,mt,0);const dr=ln-mt,us=_o-mt,ds=ln+mt,Ws=_o+mt;if(ht=ht&&this.isOffscreen(dr,us,ds,Ws),Ge=Ge||this.isInsideGrid(dr,us,ds,Ws),"always"!==a&&this.grid.hitTestCircle(ln,_o,mt,a,X)&&(Ye=!0,!j))return{circles:[],offscreen:!1,collisionDetected:Ye}}}}return{circles:!j&&Ye||!Ge?[]:oe,offscreen:ht,collisionDetected:Ye}}queryRenderedSymbols(a){if(0===a.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const p=[];let y=1/0,w=1/0,S=-1/0,R=-1/0;for(const q of a){const X=new x.pointGeometry(q.x+Rn,q.y+Rn);y=Math.min(y,X.x),w=Math.min(w,X.y),S=Math.max(S,X.x),R=Math.max(R,X.y),p.push(X)}const F=this.grid.query(y,w,S,R).concat(this.ignoredGrid.query(y,w,S,R)),N={},j={};for(const q of F){const X=q.key;if(void 0===N[X.bucketInstanceId]&&(N[X.bucketInstanceId]={}),N[X.bucketInstanceId][X.featureIndex])continue;const te=[new x.pointGeometry(q.x1,q.y1),new x.pointGeometry(q.x2,q.y1),new x.pointGeometry(q.x2,q.y2),new x.pointGeometry(q.x1,q.y2)];x.polygonIntersectsPolygon(p,te)&&(N[X.bucketInstanceId][X.featureIndex]=!0,void 0===j[X.bucketInstanceId]&&(j[X.bucketInstanceId]=[]),j[X.bucketInstanceId].push(X.featureIndex))}return j}insertCollisionBox(a,p,y,w,S,R){(y?this.ignoredGrid:this.grid).insert({bucketInstanceId:w,featureIndex:S,collisionGroupID:R,overlapMode:p},a[0],a[1],a[2],a[3])}insertCollisionCircles(a,p,y,w,S,R){const F=y?this.ignoredGrid:this.grid,N={bucketInstanceId:w,featureIndex:S,collisionGroupID:R,overlapMode:p};for(let j=0;j<a.length;j+=4)F.insertCircle(N,a[j],a[j+1],a[j+2])}projectAndGetPerspectiveRatio(a,p,y){const w=x.fromValues(p,y,0,1);return os(w,w,a),{point:new x.pointGeometry((w[0]/w[3]+1)/2*this.transform.width+Rn,(-w[1]/w[3]+1)/2*this.transform.height+Rn),perspectiveRatio:.5+this.transform.cameraToCenterDistance/w[3]*.5}}isOffscreen(a,p,y,w){return y<Rn||a>=this.screenRightBoundary||w<Rn||p>this.screenBottomBoundary}isInsideGrid(a,p,y,w){return y>=0&&a<this.gridRightBoundary&&w>=0&&p<this.gridBottomBoundary}getViewportMatrix(){const a=x.identity([]);return x.translate(a,a,[-100,-100,0]),a}}function Dn(b,a,p){return a*(x.EXTENT/(b.tileSize*Math.pow(2,p-b.tileID.overscaledZ)))}class so{constructor(a,p,y,w){this.opacity=a?Math.max(0,Math.min(1,a.opacity+(a.placed?p:-p))):w&&y?1:0,this.placed=y}isHidden(){return 0===this.opacity&&!this.placed}}class Ms{constructor(a,p,y,w,S){this.text=new so(a?a.text:null,p,y,S),this.icon=new so(a?a.icon:null,p,w,S)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ss{constructor(a,p,y){this.text=a,this.icon=p,this.skipFade=y}}class Ds{constructor(){this.invProjMatrix=x.create(),this.viewportMatrix=x.create(),this.circles=[]}}class re{constructor(a,p,y,w,S){this.bucketInstanceId=a,this.featureIndex=p,this.sourceLayerIndex=y,this.bucketIndex=w,this.tileID=S}}class z{constructor(a){this.crossSourceCollisions=a,this.maxGroupID=0,this.collisionGroups={}}get(a){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[a]){const p=++this.maxGroupID;this.collisionGroups[a]={ID:p,predicate:y=>y.collisionGroupID===p}}return this.collisionGroups[a]}}function U(b,a,p,y,w){const{horizontalAlign:S,verticalAlign:R}=x.getAnchorAlignment(b),F=-(S-.5)*a,N=-(R-.5)*p,j=x.evaluateVariableOffset(b,y);return new x.pointGeometry(F+j[0]*w,N+j[1]*w)}function J(b,a,p,y,w,S){const{x1:R,x2:F,y1:N,y2:j,anchorPointX:q,anchorPointY:X}=b,te=new x.pointGeometry(a,p);return y&&te._rotate(w?S:-S),{x1:R+te.x,y1:N+te.y,x2:F+te.x,y2:j+te.y,anchorPointX:q,anchorPointY:X}}class ie{constructor(a,p,y,w){this.transform=a.clone(),this.collisionIndex=new Fo(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new z(y),this.collisionCircleArrays={},this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(a,p,y,w){const S=y.getBucket(p),R=y.latestFeatureIndex;if(!S||!R||p.id!==S.layerIds[0])return;const F=y.collisionBoxArray,N=S.layers[0].layout,j=Math.pow(2,this.transform.zoom-y.tileID.overscaledZ),q=y.tileSize/x.EXTENT,X=this.transform.calculatePosMatrix(y.tileID.toUnwrapped()),te="map"===N.get("text-pitch-alignment"),ce="map"===N.get("text-rotation-alignment"),oe=Dn(y,1,this.transform.zoom),he=Vi(X,te,ce,this.transform,oe);let Ce=null;if(te){const Ne=Zn(X,te,ce,this.transform,oe);Ce=x.multiply([],this.transform.labelPlaneMatrix,Ne)}this.retainedQueryData[S.bucketInstanceId]=new re(S.bucketInstanceId,R,S.sourceLayerIndex,S.index,y.tileID);const De={bucket:S,layout:N,posMatrix:X,textLabelPlaneMatrix:he,labelToScreenMatrix:Ce,scale:j,textPixelRatio:q,holdingForFade:y.holdingForFade(),collisionBoxArray:F,partiallyEvaluatedTextSize:x.evaluateSizeForZoom(S.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(S.sourceID)};if(w)for(const Ne of S.sortKeyRanges){const{sortKey:Se,symbolInstanceStart:Je,symbolInstanceEnd:Ye}=Ne;a.push({sortKey:Se,symbolInstanceStart:Je,symbolInstanceEnd:Ye,parameters:De})}else a.push({symbolInstanceStart:0,symbolInstanceEnd:S.symbolInstances.length,parameters:De})}attemptAnchorPlacement(a,p,y,w,S,R,F,N,j,q,X,te,ce,oe,he){const Ce=[te.textOffset0,te.textOffset1],De=U(a,y,w,Ce,S),Ne=this.collisionIndex.placeCollisionBox(J(p,De.x,De.y,R,F,this.transform.angle),X,N,j,q.predicate);if((!he||0!==this.collisionIndex.placeCollisionBox(J(he,De.x,De.y,R,F,this.transform.angle),X,N,j,q.predicate).box.length)&&Ne.box.length>0){let Se;return this.prevPlacement&&this.prevPlacement.variableOffsets[te.crossTileID]&&this.prevPlacement.placements[te.crossTileID]&&this.prevPlacement.placements[te.crossTileID].text&&(Se=this.prevPlacement.variableOffsets[te.crossTileID].anchor),this.variableOffsets[te.crossTileID]={textOffset:Ce,width:y,height:w,anchor:a,textBoxScale:S,prevAnchor:Se},this.markUsedJustification(ce,a,te,oe),ce.allowVerticalPlacement&&(this.markUsedOrientation(ce,oe,te),this.placedOrientations[te.crossTileID]=oe),{shift:De,placedGlyphBoxes:Ne}}}placeLayerBucketPart(a,p,y){const{bucket:w,layout:S,posMatrix:R,textLabelPlaneMatrix:F,labelToScreenMatrix:N,textPixelRatio:j,holdingForFade:q,collisionBoxArray:X,partiallyEvaluatedTextSize:te,collisionGroup:ce}=a.parameters,oe=S.get("text-optional"),he=S.get("icon-optional"),Ce=x.getOverlapMode(S,"text-overlap","text-allow-overlap"),De="always"===Ce,Ne=x.getOverlapMode(S,"icon-overlap","icon-allow-overlap"),Se="always"===Ne,Je="map"===S.get("text-rotation-alignment"),Ye="map"===S.get("text-pitch-alignment"),Ge="none"!==S.get("icon-text-fit"),ht="viewport-y"===S.get("symbol-z-order"),mt=De&&(Se||!w.hasIconData()||he),ot=Se&&(De||!w.hasTextData()||oe);!w.collisionArrays&&X&&w.deserializeCollisionBoxes(X);const Zt=(St,oi)=>{if(p[St.crossTileID])return;if(q)return void(this.placements[St.crossTileID]=new ss(!1,!1,!1));let Zi=!1,mi=!1,Ii=!0,wn=null,Si={box:null,offscreen:null},Ni={box:null,offscreen:null},Sn=null,Yr=null,go=null,ln=0,_o=0,dr=0;oi.textFeatureIndex?ln=oi.textFeatureIndex:St.useRuntimeCollisionCircles&&(ln=St.featureIndex),oi.verticalTextFeatureIndex&&(_o=oi.verticalTextFeatureIndex);const us=oi.textBox;if(us){const fn=Ki=>{let nr=x.WritingMode.horizontal;if(w.allowVerticalPlacement&&!Ki&&this.prevPlacement){const Wr=this.prevPlacement.placedOrientations[St.crossTileID];Wr&&(this.placedOrientations[St.crossTileID]=Wr,nr=Wr,this.markUsedOrientation(w,nr,St))}return nr},ir=(Ki,nr)=>{if(w.allowVerticalPlacement&&St.numVerticalGlyphVertices>0&&oi.verticalTextBox){for(const Wr of w.writingModes)if(Wr===x.WritingMode.vertical?(Si=nr(),Ni=Si):Si=Ki(),Si&&Si.box&&Si.box.length)break}else Si=Ki()};if(S.get("text-variable-anchor")){let Ki=S.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[St.crossTileID]){const _n=this.prevPlacement.variableOffsets[St.crossTileID];Ki.indexOf(_n.anchor)>0&&(Ki=Ki.filter(Vo=>Vo!==_n.anchor),Ki.unshift(_n.anchor))}const nr=(_n,Vo,ks)=>{const To=_n.x2-_n.x1,Rs=_n.y2-_n.y1,Ya=St.textBoxScale,Nl=Ge&&"never"===Ne?Vo:null;let yo={box:[],offscreen:!1};const Ps="never"!==Ce?2*Ki.length:Ki.length;for(let Zo=0;Zo<Ps;++Zo){const Sc=this.attemptAnchorPlacement(Ki[Zo%Ki.length],_n,To,Rs,Ya,Je,Ye,j,R,ce,Zo>=Ki.length?Ce:"never",St,w,ks,Nl);if(Sc&&(yo=Sc.placedGlyphBoxes,yo&&yo.box&&yo.box.length)){Zi=!0,wn=Sc.shift;break}}return yo};ir(()=>nr(us,oi.iconBox,x.WritingMode.horizontal),()=>{const _n=oi.verticalTextBox;return w.allowVerticalPlacement&&!(Si&&Si.box&&Si.box.length)&&St.numVerticalGlyphVertices>0&&_n?nr(_n,oi.verticalIconBox,x.WritingMode.vertical):{box:null,offscreen:null}}),Si&&(Zi=Si.box,Ii=Si.offscreen);const Wr=fn(Si&&Si.box);if(!Zi&&this.prevPlacement){const _n=this.prevPlacement.variableOffsets[St.crossTileID];_n&&(this.variableOffsets[St.crossTileID]=_n,this.markUsedJustification(w,_n.anchor,St,Wr))}}else{const Ki=(nr,Wr)=>{const _n=this.collisionIndex.placeCollisionBox(nr,Ce,j,R,ce.predicate);return _n&&_n.box&&_n.box.length&&(this.markUsedOrientation(w,Wr,St),this.placedOrientations[St.crossTileID]=Wr),_n};ir(()=>Ki(us,x.WritingMode.horizontal),()=>{const nr=oi.verticalTextBox;return w.allowVerticalPlacement&&St.numVerticalGlyphVertices>0&&nr?Ki(nr,x.WritingMode.vertical):{box:null,offscreen:null}}),fn(Si&&Si.box&&Si.box.length)}}if(Sn=Si,Zi=Sn&&Sn.box&&Sn.box.length>0,Ii=Sn&&Sn.offscreen,St.useRuntimeCollisionCircles){const fn=w.text.placedSymbolArray.get(St.centerJustifiedTextSymbolIndex),ir=x.evaluateSizeForFeature(w.textSizeData,te,fn),Ki=S.get("text-padding");Yr=this.collisionIndex.placeCollisionCircles(Ce,fn,w.lineVertexArray,w.glyphOffsetArray,ir,R,F,N,y,Ye,ce.predicate,St.collisionCircleDiameter,Ki),Zi=De||Yr.circles.length>0&&!Yr.collisionDetected,Ii=Ii&&Yr.offscreen}if(oi.iconFeatureIndex&&(dr=oi.iconFeatureIndex),oi.iconBox){const fn=ir=>{const Ki=Ge&&wn?J(ir,wn.x,wn.y,Je,Ye,this.transform.angle):ir;return this.collisionIndex.placeCollisionBox(Ki,Ne,j,R,ce.predicate)};Ni&&Ni.box&&Ni.box.length&&oi.verticalIconBox?(go=fn(oi.verticalIconBox),mi=go.box.length>0):(go=fn(oi.iconBox),mi=go.box.length>0),Ii=Ii&&go.offscreen}const ds=oe||0===St.numHorizontalGlyphVertices&&0===St.numVerticalGlyphVertices,Ws=he||0===St.numIconVertices;if(ds||Ws?Ws?ds||(mi=mi&&Zi):Zi=mi&&Zi:mi=Zi=mi&&Zi,Zi&&Sn&&Sn.box&&this.collisionIndex.insertCollisionBox(Sn.box,Ce,S.get("text-ignore-placement"),w.bucketInstanceId,Ni&&Ni.box&&_o?_o:ln,ce.ID),mi&&go&&this.collisionIndex.insertCollisionBox(go.box,Ne,S.get("icon-ignore-placement"),w.bucketInstanceId,dr,ce.ID),Yr&&(Zi&&this.collisionIndex.insertCollisionCircles(Yr.circles,Ce,S.get("text-ignore-placement"),w.bucketInstanceId,ln,ce.ID),y)){const fn=w.bucketInstanceId;let ir=this.collisionCircleArrays[fn];void 0===ir&&(ir=this.collisionCircleArrays[fn]=new Ds);for(let Ki=0;Ki<Yr.circles.length;Ki+=4)ir.circles.push(Yr.circles[Ki+0]),ir.circles.push(Yr.circles[Ki+1]),ir.circles.push(Yr.circles[Ki+2]),ir.circles.push(Yr.collisionDetected?1:0)}this.placements[St.crossTileID]=new ss(Zi||mt,mi||ot,Ii||w.justReloaded),p[St.crossTileID]=!0};if(ht){const St=w.getSortedSymbolIndexes(this.transform.angle);for(let oi=St.length-1;oi>=0;--oi){const Zi=St[oi];Zt(w.symbolInstances.get(Zi),w.collisionArrays[Zi])}}else for(let St=a.symbolInstanceStart;St<a.symbolInstanceEnd;St++)Zt(w.symbolInstances.get(St),w.collisionArrays[St]);if(y&&w.bucketInstanceId in this.collisionCircleArrays){const St=this.collisionCircleArrays[w.bucketInstanceId];x.invert(St.invProjMatrix,R),St.viewportMatrix=this.collisionIndex.getViewportMatrix()}w.justReloaded=!1}markUsedJustification(a,p,y,w){let S;S=w===x.WritingMode.vertical?y.verticalPlacedTextSymbolIndex:{left:y.leftJustifiedTextSymbolIndex,center:y.centerJustifiedTextSymbolIndex,right:y.rightJustifiedTextSymbolIndex}[x.getAnchorJustification(p)];const R=[y.leftJustifiedTextSymbolIndex,y.centerJustifiedTextSymbolIndex,y.rightJustifiedTextSymbolIndex,y.verticalPlacedTextSymbolIndex];for(const F of R)F>=0&&(a.text.placedSymbolArray.get(F).crossTileID=S>=0&&F!==S?0:y.crossTileID)}markUsedOrientation(a,p,y){const w=p===x.WritingMode.horizontal||p===x.WritingMode.horizontalOnly?p:0,S=p===x.WritingMode.vertical?p:0,R=[y.leftJustifiedTextSymbolIndex,y.centerJustifiedTextSymbolIndex,y.rightJustifiedTextSymbolIndex];for(const F of R)a.text.placedSymbolArray.get(F).placedOrientation=w;y.verticalPlacedTextSymbolIndex&&(a.text.placedSymbolArray.get(y.verticalPlacedTextSymbolIndex).placedOrientation=S)}commit(a){this.commitTime=a,this.zoomAtLastRecencyCheck=this.transform.zoom;const p=this.prevPlacement;let y=!1;this.prevZoomAdjustment=p?p.zoomAdjustment(this.transform.zoom):0;const w=p?p.symbolFadeChange(a):1,S=p?p.opacities:{},R=p?p.variableOffsets:{},F=p?p.placedOrientations:{};for(const N in this.placements){const j=this.placements[N],q=S[N];q?(this.opacities[N]=new Ms(q,w,j.text,j.icon),y=y||j.text!==q.text.placed||j.icon!==q.icon.placed):(this.opacities[N]=new Ms(null,w,j.text,j.icon,j.skipFade),y=y||j.text||j.icon)}for(const N in S){const j=S[N];if(!this.opacities[N]){const q=new Ms(j,w,!1,!1);q.isHidden()||(this.opacities[N]=q,y=y||j.text.placed||j.icon.placed)}}for(const N in R)this.variableOffsets[N]||!this.opacities[N]||this.opacities[N].isHidden()||(this.variableOffsets[N]=R[N]);for(const N in F)this.placedOrientations[N]||!this.opacities[N]||this.opacities[N].isHidden()||(this.placedOrientations[N]=F[N]);y?this.lastPlacementChangeTime=a:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=p?p.lastPlacementChangeTime:a)}updateLayerOpacities(a,p){const y={};for(const w of p){const S=w.getBucket(a);S&&w.latestFeatureIndex&&a.id===S.layerIds[0]&&this.updateBucketOpacities(S,y,w.collisionBoxArray)}}updateBucketOpacities(a,p,y){a.hasTextData()&&a.text.opacityVertexArray.clear(),a.hasIconData()&&a.icon.opacityVertexArray.clear(),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexArray.clear(),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexArray.clear();const w=a.layers[0].layout,S=new Ms(null,0,!1,!1,!0),R=w.get("text-allow-overlap"),F=w.get("icon-allow-overlap"),N=w.get("text-variable-anchor"),j="map"===w.get("text-rotation-alignment"),q="map"===w.get("text-pitch-alignment"),X="none"!==w.get("icon-text-fit"),te=new Ms(null,0,R&&(F||!a.hasIconData()||w.get("icon-optional")),F&&(R||!a.hasTextData()||w.get("text-optional")),!0);!a.collisionArrays&&y&&(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData())&&a.deserializeCollisionBoxes(y);const ce=(oe,he,Ce)=>{for(let De=0;De<he/4;De++)oe.opacityVertexArray.emplaceBack(Ce)};for(let oe=0;oe<a.symbolInstances.length;oe++){const he=a.symbolInstances.get(oe),{numHorizontalGlyphVertices:Ce,numVerticalGlyphVertices:De,crossTileID:Ne}=he;let Se=this.opacities[Ne];p[Ne]?Se=S:Se||(Se=te,this.opacities[Ne]=Se),p[Ne]=!0;const Je=he.numIconVertices>0,Ye=this.placedOrientations[he.crossTileID],Ge=Ye===x.WritingMode.vertical,ht=Ye===x.WritingMode.horizontal||Ye===x.WritingMode.horizontalOnly;if(Ce>0||De>0){const mt=We(Se.text);ce(a.text,Ce,Ge?lt:mt),ce(a.text,De,ht?lt:mt);const ot=Se.text.isHidden();[he.rightJustifiedTextSymbolIndex,he.centerJustifiedTextSymbolIndex,he.leftJustifiedTextSymbolIndex].forEach(oi=>{oi>=0&&(a.text.placedSymbolArray.get(oi).hidden=ot||Ge?1:0)}),he.verticalPlacedTextSymbolIndex>=0&&(a.text.placedSymbolArray.get(he.verticalPlacedTextSymbolIndex).hidden=ot||ht?1:0);const Zt=this.variableOffsets[he.crossTileID];Zt&&this.markUsedJustification(a,Zt.anchor,he,Ye);const St=this.placedOrientations[he.crossTileID];St&&(this.markUsedJustification(a,"left",he,St),this.markUsedOrientation(a,St,he))}if(Je){const mt=We(Se.icon),ot=!(X&&he.verticalPlacedIconSymbolIndex&&Ge);he.placedIconSymbolIndex>=0&&(ce(a.icon,he.numIconVertices,ot?mt:lt),a.icon.placedSymbolArray.get(he.placedIconSymbolIndex).hidden=Se.icon.isHidden()),he.verticalPlacedIconSymbolIndex>=0&&(ce(a.icon,he.numVerticalIconVertices,ot?lt:mt),a.icon.placedSymbolArray.get(he.verticalPlacedIconSymbolIndex).hidden=Se.icon.isHidden())}if(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData()){const mt=a.collisionArrays[oe];if(mt){let ot=new x.pointGeometry(0,0);if(mt.textBox||mt.verticalTextBox){let St=!0;if(N){const oi=this.variableOffsets[Ne];oi?(ot=U(oi.anchor,oi.width,oi.height,oi.textOffset,oi.textBoxScale),j&&ot._rotate(q?this.transform.angle:-this.transform.angle)):St=!1}mt.textBox&&le(a.textCollisionBox.collisionVertexArray,Se.text.placed,!St||Ge,ot.x,ot.y),mt.verticalTextBox&&le(a.textCollisionBox.collisionVertexArray,Se.text.placed,!St||ht,ot.x,ot.y)}const Zt=Boolean(!ht&&mt.verticalIconBox);mt.iconBox&&le(a.iconCollisionBox.collisionVertexArray,Se.icon.placed,Zt,X?ot.x:0,X?ot.y:0),mt.verticalIconBox&&le(a.iconCollisionBox.collisionVertexArray,Se.icon.placed,!Zt,X?ot.x:0,X?ot.y:0)}}}if(a.sortFeatures(this.transform.angle),this.retainedQueryData[a.bucketInstanceId]&&(this.retainedQueryData[a.bucketInstanceId].featureSortOrder=a.featureSortOrder),a.hasTextData()&&a.text.opacityVertexBuffer&&a.text.opacityVertexBuffer.updateData(a.text.opacityVertexArray),a.hasIconData()&&a.icon.opacityVertexBuffer&&a.icon.opacityVertexBuffer.updateData(a.icon.opacityVertexArray),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexBuffer&&a.iconCollisionBox.collisionVertexBuffer.updateData(a.iconCollisionBox.collisionVertexArray),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexBuffer&&a.textCollisionBox.collisionVertexBuffer.updateData(a.textCollisionBox.collisionVertexArray),a.bucketInstanceId in this.collisionCircleArrays){const oe=this.collisionCircleArrays[a.bucketInstanceId];a.placementInvProjMatrix=oe.invProjMatrix,a.placementViewportMatrix=oe.viewportMatrix,a.collisionCircleArray=oe.circles,delete this.collisionCircleArrays[a.bucketInstanceId]}}symbolFadeChange(a){return 0===this.fadeDuration?1:(a-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(a){return Math.max(0,(this.transform.zoom-a)/1.5)}hasTransitions(a){return this.stale||a-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(a,p){const y=this.zoomAtLastRecencyCheck===p?1-this.zoomAdjustment(p):1;return this.zoomAtLastRecencyCheck=p,this.commitTime+this.fadeDuration*y>a}setStale(){this.stale=!0}}function le(b,a,p,y,w){b.emplaceBack(a?1:0,p?1:0,y||0,w||0),b.emplaceBack(a?1:0,p?1:0,y||0,w||0),b.emplaceBack(a?1:0,p?1:0,y||0,w||0),b.emplaceBack(a?1:0,p?1:0,y||0,w||0)}const we=Math.pow(2,25),fe=Math.pow(2,24),me=Math.pow(2,17),be=Math.pow(2,16),He=Math.pow(2,9),at=Math.pow(2,8),je=Math.pow(2,1);function We(b){if(0===b.opacity&&!b.placed)return 0;if(1===b.opacity&&b.placed)return 4294967295;const a=b.placed?1:0,p=Math.floor(127*b.opacity);return p*we+a*fe+p*me+a*be+p*He+a*at+p*je+a}const lt=0;class Ct{constructor(a){this._sortAcrossTiles="viewport-y"!==a.layout.get("symbol-z-order")&&!a.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(a,p,y,w,S){const R=this._bucketParts;for(;this._currentTileIndex<a.length;)if(p.getBucketParts(R,w,a[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,S())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,R.sort((F,N)=>F.sortKey-N.sortKey));this._currentPartIndex<R.length;)if(p.placeLayerBucketPart(R[this._currentPartIndex],this._seenCrossTileIDs,y),this._currentPartIndex++,S())return!0;return!1}}class Yt{constructor(a,p,y,w,S,R,F){this.placement=new ie(a,S,R,F),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=w,this._done=!1}isDone(){return this._done}continuePlacement(a,p,y){const w=x.exported.now(),S=()=>{const R=x.exported.now()-w;return!this._forceFullPlacement&&R>2};for(;this._currentPlacementIndex>=0;){const R=p[a[this._currentPlacementIndex]],F=this.placement.collisionIndex.transform.zoom;if("symbol"===R.type&&(!R.minzoom||R.minzoom<=F)&&(!R.maxzoom||R.maxzoom>F)){if(this._inProgressLayer||(this._inProgressLayer=new Ct(R)),this._inProgressLayer.continuePlacement(y[R.source],this.placement,this._showCollisionBoxes,R,S))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(a){return this.placement.commit(a),this.placement}}const Ri=512/x.EXTENT/2;class fi{constructor(a,p,y){this.tileID=a,this.indexedSymbolInstances={},this.bucketInstanceId=y;for(let w=0;w<p.length;w++){const S=p.get(w),R=S.key;this.indexedSymbolInstances[R]||(this.indexedSymbolInstances[R]=[]),this.indexedSymbolInstances[R].push({crossTileID:S.crossTileID,coord:this.getScaledCoordinates(S,a)})}}getScaledCoordinates(a,p){const y=Ri/Math.pow(2,p.canonical.z-this.tileID.canonical.z);return{x:Math.floor((p.canonical.x*x.EXTENT+a.anchorX)*y),y:Math.floor((p.canonical.y*x.EXTENT+a.anchorY)*y)}}findMatches(a,p,y){const w=this.tileID.canonical.z<p.canonical.z?1:Math.pow(2,this.tileID.canonical.z-p.canonical.z);for(let S=0;S<a.length;S++){const R=a.get(S);if(R.crossTileID)continue;const F=this.indexedSymbolInstances[R.key];if(!F)continue;const N=this.getScaledCoordinates(R,p);for(const j of F)if(Math.abs(j.coord.x-N.x)<=w&&Math.abs(j.coord.y-N.y)<=w&&!y[j.crossTileID]){y[j.crossTileID]=!0,R.crossTileID=j.crossTileID;break}}}}class wi{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Xt{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(a){const p=Math.round((a-this.lng)/360);if(0!==p)for(const y in this.indexes){const w=this.indexes[y],S={};for(const R in w){const F=w[R];F.tileID=F.tileID.unwrapTo(F.tileID.wrap+p),S[F.tileID.key]=F}this.indexes[y]=S}this.lng=a}addBucket(a,p,y){if(this.indexes[a.overscaledZ]&&this.indexes[a.overscaledZ][a.key]){if(this.indexes[a.overscaledZ][a.key].bucketInstanceId===p.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(a.overscaledZ,this.indexes[a.overscaledZ][a.key])}for(let S=0;S<p.symbolInstances.length;S++)p.symbolInstances.get(S).crossTileID=0;this.usedCrossTileIDs[a.overscaledZ]||(this.usedCrossTileIDs[a.overscaledZ]={});const w=this.usedCrossTileIDs[a.overscaledZ];for(const S in this.indexes){const R=this.indexes[S];if(Number(S)>a.overscaledZ)for(const F in R){const N=R[F];N.tileID.isChildOf(a)&&N.findMatches(p.symbolInstances,a,w)}else{const F=R[a.scaledTo(Number(S)).key];F&&F.findMatches(p.symbolInstances,a,w)}}for(let S=0;S<p.symbolInstances.length;S++){const R=p.symbolInstances.get(S);R.crossTileID||(R.crossTileID=y.generate(),w[R.crossTileID]=!0)}return void 0===this.indexes[a.overscaledZ]&&(this.indexes[a.overscaledZ]={}),this.indexes[a.overscaledZ][a.key]=new fi(a,p.symbolInstances,p.bucketInstanceId),!0}removeBucketCrossTileIDs(a,p){for(const y in p.indexedSymbolInstances)for(const w of p.indexedSymbolInstances[y])delete this.usedCrossTileIDs[a][w.crossTileID]}removeStaleBuckets(a){let p=!1;for(const y in this.indexes){const w=this.indexes[y];for(const S in w)a[w[S].bucketInstanceId]||(this.removeBucketCrossTileIDs(y,w[S]),delete w[S],p=!0)}return p}}class bi{constructor(){this.layerIndexes={},this.crossTileIDs=new wi,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(a,p,y){let w=this.layerIndexes[a.id];void 0===w&&(w=this.layerIndexes[a.id]=new Xt);let S=!1;const R={};w.handleWrapJump(y);for(const F of p){const N=F.getBucket(a);N&&a.id===N.layerIds[0]&&(N.bucketInstanceId||(N.bucketInstanceId=++this.maxBucketInstanceId),w.addBucket(F.tileID,N,this.crossTileIDs)&&(S=!0),R[N.bucketInstanceId]=!0)}return w.removeStaleBuckets(R)&&(S=!0),S}pruneUnusedLayers(a){const p={};a.forEach(y=>{p[y]=!0});for(const y in this.layerIndexes)p[y]||delete this.layerIndexes[y]}}const on=(b,a)=>x.emitValidationErrors(b,a&&a.filter(p=>"source.canvas"!==p.identifier)),ri=x.pick(Hi,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),$n=x.pick(Hi,["setCenter","setZoom","setBearing","setPitch"]),Lr=function(){const b={},a=x.spec.$version;for(const p in x.spec.$root){const y=x.spec.$root[p];if(y.required){let w=null;w="version"===p?a:"array"===y.type?[]:{},null!=w&&(b[p]=w)}}return b}();class ue extends x.Evented{constructor(a,p={}){super(),this.map=a,this.dispatcher=new et(Or(),this),this.imageManager=new Ht,this.imageManager.setEventedParent(this),this.glyphManager=new kt(a._requestManager,p.localIdeographFontFamily),this.lineAtlas=new Ue(256,512),this.crossTileSymbolIndex=new bi,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new x.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",x.getReferrer());const y=this;this._rtlTextPluginCallback=ue.registerForPluginStateChange(w=>{y.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:w.pluginStatus,pluginURL:w.pluginURL},(S,R)=>{if(x.triggerPluginCompletionEvent(S),R&&R.every(F=>F))for(const F in y.sourceCaches)y.sourceCaches[F].reload()})}),this.on("data",w=>{if("source"!==w.dataType||"metadata"!==w.sourceDataType)return;const S=this.sourceCaches[w.sourceId];if(!S)return;const R=S.getSource();if(R&&R.vectorLayerIds)for(const F in this._layers){const N=this._layers[F];N.source===R.id&&this._validateLayer(N)}})}loadURL(a,p={}){this.fire(new x.Event("dataloading",{dataType:"style"}));const y="boolean"!=typeof p.validate||p.validate,w=this.map._requestManager.transformRequest(a,x.ResourceType.Style);this._request=x.getJSON(w,(S,R)=>{this._request=null,S?this.fire(new x.ErrorEvent(S)):R&&this._load(R,y)})}loadJSON(a,p={}){this.fire(new x.Event("dataloading",{dataType:"style"})),this._request=x.exported.frame(()=>{this._request=null,this._load(a,!1!==p.validate)})}loadEmpty(){this.fire(new x.Event("dataloading",{dataType:"style"})),this._load(Lr,!1)}_load(a,p){if(p&&on(this,x.validateStyle(a)))return;this._loaded=!0,this.stylesheet=a;for(const w in a.sources)this.addSource(w,a.sources[w],{validate:!1});a.sprite?this._loadSprite(a.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(a.glyphs);const y=er(this.stylesheet.layers);this._order=y.map(w=>w.id),this._layers={},this._serializedLayers={};for(let w of y)w=x.createStyleLayer(w),w.setEventedParent(this,{layer:{id:w.id}}),this._layers[w.id]=w,this._serializedLayers[w.id]=w.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new xi(this.stylesheet.light),this.fire(new x.Event("data",{dataType:"style"})),this.fire(new x.Event("style.load"))}_loadSprite(a){this._spriteRequest=function(p,y,w,S){let R,F,N;const j=w>1?"@2x":"";let q=x.getJSON(y.transformRequest(y.normalizeSpriteURL(p,j,".json"),x.ResourceType.SpriteJSON),(ce,oe)=>{q=null,N||(N=ce,R=oe,te())}),X=x.getImage(y.transformRequest(y.normalizeSpriteURL(p,j,".png"),x.ResourceType.SpriteImage),(ce,oe)=>{X=null,N||(N=ce,F=oe,te())});function te(){if(N)S(N);else if(R&&F){const ce=x.exported.getImageData(F),oe={};for(const he in R){const{width:Ce,height:De,x:Ne,y:Se,sdf:Je,pixelRatio:Ye,stretchX:Ge,stretchY:ht,content:mt}=R[he],ot=new x.RGBAImage({width:Ce,height:De});x.RGBAImage.copy(ce,ot,{x:Ne,y:Se},{x:0,y:0},{width:Ce,height:De}),oe[he]={data:ot,pixelRatio:Ye,sdf:Je,stretchX:Ge,stretchY:ht,content:mt}}S(null,oe)}}return{cancel(){q&&(q.cancel(),q=null),X&&(X.cancel(),X=null)}}}(a,this.map._requestManager,this.map.getPixelRatio(),(p,y)=>{if(this._spriteRequest=null,p)this.fire(new x.ErrorEvent(p));else if(y)for(const w in y)this.imageManager.addImage(w,y[w]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new x.Event("data",{dataType:"style"}))})}_validateLayer(a){const p=this.sourceCaches[a.source];if(!p)return;const y=a.sourceLayer;if(!y)return;const w=p.getSource();("geojson"===w.type||w.vectorLayerIds&&-1===w.vectorLayerIds.indexOf(y))&&this.fire(new x.ErrorEvent(new Error(`Source layer "${y}" does not exist on source "${w.id}" as specified by style layer "${a.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const a in this.sourceCaches)if(!this.sourceCaches[a].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(a){const p=[];for(const y of a){const w=this._layers[y];"custom"!==w.type&&p.push(w.serialize())}return p}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const a in this.sourceCaches)if(this.sourceCaches[a].hasTransition())return!0;for(const a in this._layers)if(this._layers[a].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(a){if(!this._loaded)return;const p=this._changed;if(this._changed){const w=Object.keys(this._updatedLayers),S=Object.keys(this._removedLayers);(w.length||S.length)&&this._updateWorkerLayers(w,S);for(const R in this._updatedSources){const F=this._updatedSources[R];"reload"===F?this._reloadSource(R):"clear"===F&&this._clearSource(R)}this._updateTilesForChangedImages();for(const R in this._updatedPaintProps)this._layers[R].updateTransitions(a);this.light.updateTransitions(a),this._resetUpdates()}const y={};for(const w in this.sourceCaches){const S=this.sourceCaches[w];y[w]=S.used,S.used=!1}for(const w of this._order){const S=this._layers[w];S.recalculate(a,this._availableImages),!S.isHidden(a.zoom)&&S.source&&(this.sourceCaches[S.source].used=!0)}for(const w in y){const S=this.sourceCaches[w];y[w]!==S.used&&S.fire(new x.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:w}))}this.light.recalculate(a),this.z=a.zoom,p&&this.fire(new x.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const a=Object.keys(this._changedImages);if(a.length){for(const p in this.sourceCaches)this.sourceCaches[p].reloadTilesForDependencies(["icons","patterns"],a);this._changedImages={}}}_updateWorkerLayers(a,p){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(a),removedIds:p})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(a){if(this._checkLoaded(),on(this,x.validateStyle(a)))return!1;(a=x.clone$1(a)).layers=er(a.layers);const p=function(w,S){if(!w)return[{command:Hi.setStyle,args:[S]}];let R=[];try{if(!xe(w.version,S.version))return[{command:Hi.setStyle,args:[S]}];xe(w.center,S.center)||R.push({command:Hi.setCenter,args:[S.center]}),xe(w.zoom,S.zoom)||R.push({command:Hi.setZoom,args:[S.zoom]}),xe(w.bearing,S.bearing)||R.push({command:Hi.setBearing,args:[S.bearing]}),xe(w.pitch,S.pitch)||R.push({command:Hi.setPitch,args:[S.pitch]}),xe(w.sprite,S.sprite)||R.push({command:Hi.setSprite,args:[S.sprite]}),xe(w.glyphs,S.glyphs)||R.push({command:Hi.setGlyphs,args:[S.glyphs]}),xe(w.transition,S.transition)||R.push({command:Hi.setTransition,args:[S.transition]}),xe(w.light,S.light)||R.push({command:Hi.setLight,args:[S.light]});const F={},N=[];!function(q,X,te,ce){let oe;for(oe in X=X||{},q=q||{})Object.prototype.hasOwnProperty.call(q,oe)&&(Object.prototype.hasOwnProperty.call(X,oe)||xr(oe,te,ce));for(oe in X)Object.prototype.hasOwnProperty.call(X,oe)&&(Object.prototype.hasOwnProperty.call(q,oe)?xe(q[oe],X[oe])||("geojson"===q[oe].type&&"geojson"===X[oe].type&&Xe(q,X,oe)?te.push({command:Hi.setGeoJSONSourceData,args:[oe,X[oe].data]}):wr(oe,X,te,ce)):Po(oe,X,te))}(w.sources,S.sources,N,F);const j=[];w.layers&&w.layers.forEach(q=>{F[q.source]?R.push({command:Hi.removeLayer,args:[q.id]}):j.push(q)}),R=R.concat(N),function(q,X,te){X=X||[];const ce=(q=q||[]).map(Yi),oe=X.map(Yi),he=q.reduce(ai,{}),Ce=X.reduce(ai,{}),De=ce.slice(),Ne=Object.create(null);let Se,Je,Ye,Ge,ht,mt,ot;for(Se=0,Je=0;Se<ce.length;Se++)Ye=ce[Se],Object.prototype.hasOwnProperty.call(Ce,Ye)?Je++:(te.push({command:Hi.removeLayer,args:[Ye]}),De.splice(De.indexOf(Ye,Je),1));for(Se=0,Je=0;Se<oe.length;Se++)Ye=oe[oe.length-1-Se],De[De.length-1-Se]!==Ye&&(Object.prototype.hasOwnProperty.call(he,Ye)?(te.push({command:Hi.removeLayer,args:[Ye]}),De.splice(De.lastIndexOf(Ye,De.length-Je),1)):Je++,mt=De[De.length-Se],te.push({command:Hi.addLayer,args:[Ce[Ye],mt]}),De.splice(De.length-Se,0,Ye),Ne[Ye]=!0);for(Se=0;Se<oe.length;Se++)if(Ye=oe[Se],Ge=he[Ye],ht=Ce[Ye],!Ne[Ye]&&!xe(Ge,ht))if(xe(Ge.source,ht.source)&&xe(Ge["source-layer"],ht["source-layer"])&&xe(Ge.type,ht.type)){for(ot in Pt(Ge.layout,ht.layout,te,Ye,null,Hi.setLayoutProperty),Pt(Ge.paint,ht.paint,te,Ye,null,Hi.setPaintProperty),xe(Ge.filter,ht.filter)||te.push({command:Hi.setFilter,args:[Ye,ht.filter]}),xe(Ge.minzoom,ht.minzoom)&&xe(Ge.maxzoom,ht.maxzoom)||te.push({command:Hi.setLayerZoomRange,args:[Ye,ht.minzoom,ht.maxzoom]}),Ge)Object.prototype.hasOwnProperty.call(Ge,ot)&&"layout"!==ot&&"paint"!==ot&&"filter"!==ot&&"metadata"!==ot&&"minzoom"!==ot&&"maxzoom"!==ot&&(0===ot.indexOf("paint.")?Pt(Ge[ot],ht[ot],te,Ye,ot.slice(6),Hi.setPaintProperty):xe(Ge[ot],ht[ot])||te.push({command:Hi.setLayerProperty,args:[Ye,ot,ht[ot]]}));for(ot in ht)Object.prototype.hasOwnProperty.call(ht,ot)&&!Object.prototype.hasOwnProperty.call(Ge,ot)&&"layout"!==ot&&"paint"!==ot&&"filter"!==ot&&"metadata"!==ot&&"minzoom"!==ot&&"maxzoom"!==ot&&(0===ot.indexOf("paint.")?Pt(Ge[ot],ht[ot],te,Ye,ot.slice(6),Hi.setPaintProperty):xe(Ge[ot],ht[ot])||te.push({command:Hi.setLayerProperty,args:[Ye,ot,ht[ot]]}))}else te.push({command:Hi.removeLayer,args:[Ye]}),mt=De[De.lastIndexOf(Ye)+1],te.push({command:Hi.addLayer,args:[ht,mt]})}(j,S.layers,R)}catch(F){console.warn("Unable to compute style diff:",F),R=[{command:Hi.setStyle,args:[S]}]}return R}(this.serialize(),a).filter(w=>!(w.command in $n));if(0===p.length)return!1;const y=p.filter(w=>!(w.command in ri));if(y.length>0)throw new Error(`Unimplemented: ${y.map(w=>w.command).join(", ")}.`);return p.forEach(w=>{"setTransition"!==w.command&&this[w.command].apply(this,w.args)}),this.stylesheet=a,!0}addImage(a,p){if(this.getImage(a))return this.fire(new x.ErrorEvent(new Error(`An image named "${a}" already exists.`)));this.imageManager.addImage(a,p),this._afterImageUpdated(a)}updateImage(a,p){this.imageManager.updateImage(a,p)}getImage(a){return this.imageManager.getImage(a)}removeImage(a){if(!this.getImage(a))return this.fire(new x.ErrorEvent(new Error(`An image named "${a}" does not exist.`)));this.imageManager.removeImage(a),this._afterImageUpdated(a)}_afterImageUpdated(a){this._availableImages=this.imageManager.listImages(),this._changedImages[a]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new x.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(a,p,y={}){if(this._checkLoaded(),void 0!==this.sourceCaches[a])throw new Error(`Source "${a}" already exists.`);if(!p.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(p).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(p.type)>=0&&this._validate(x.validateStyle.source,`sources.${a}`,p,null,y))return;this.map&&this.map._collectResourceTiming&&(p.collectResourceTiming=!0);const w=this.sourceCaches[a]=new Jn(a,p,this.dispatcher);w.style=this,w.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:w.serialize(),sourceId:a})),w.onAdd(this.map),this._changed=!0}removeSource(a){if(this._checkLoaded(),void 0===this.sourceCaches[a])throw new Error("There is no source with this ID");for(const y in this._layers)if(this._layers[y].source===a)return this.fire(new x.ErrorEvent(new Error(`Source "${a}" cannot be removed while layer "${y}" is using it.`)));const p=this.sourceCaches[a];delete this.sourceCaches[a],delete this._updatedSources[a],p.fire(new x.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:a})),p.setEventedParent(null),p.clearTiles(),p.onRemove&&p.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(a,p){this._checkLoaded(),this.sourceCaches[a].getSource().setData(p),this._changed=!0}getSource(a){return this.sourceCaches[a]&&this.sourceCaches[a].getSource()}addLayer(a,p,y={}){this._checkLoaded();const w=a.id;if(this.getLayer(w))return void this.fire(new x.ErrorEvent(new Error(`Layer "${w}" already exists on this map.`)));let S;if("custom"===a.type){if(on(this,x.validateCustomStyleLayer(a)))return;S=x.createStyleLayer(a)}else{if("object"==typeof a.source&&(this.addSource(w,a.source),a=x.clone$1(a),a=x.extend(a,{source:w})),this._validate(x.validateStyle.layer,`layers.${w}`,a,{arrayIndex:-1},y))return;S=x.createStyleLayer(a),this._validateLayer(S),S.setEventedParent(this,{layer:{id:w}}),this._serializedLayers[S.id]=S.serialize()}const R=p?this._order.indexOf(p):this._order.length;if(p&&-1===R)this.fire(new x.ErrorEvent(new Error(`Cannot add layer "${w}" before non-existing layer "${p}".`)));else{if(this._order.splice(R,0,w),this._layerOrderChanged=!0,this._layers[w]=S,this._removedLayers[w]&&S.source&&"custom"!==S.type){const F=this._removedLayers[w];delete this._removedLayers[w],F.type!==S.type?this._updatedSources[S.source]="clear":(this._updatedSources[S.source]="reload",this.sourceCaches[S.source].pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map)}}moveLayer(a,p){if(this._checkLoaded(),this._changed=!0,!this._layers[a])return void this.fire(new x.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style and cannot be moved.`)));if(a===p)return;const y=this._order.indexOf(a);this._order.splice(y,1);const w=p?this._order.indexOf(p):this._order.length;p&&-1===w?this.fire(new x.ErrorEvent(new Error(`Cannot move layer "${a}" before non-existing layer "${p}".`))):(this._order.splice(w,0,a),this._layerOrderChanged=!0)}removeLayer(a){this._checkLoaded();const p=this._layers[a];if(!p)return void this.fire(new x.ErrorEvent(new Error(`Cannot remove non-existing layer "${a}".`)));p.setEventedParent(null);const y=this._order.indexOf(a);this._order.splice(y,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[a]=p,delete this._layers[a],delete this._serializedLayers[a],delete this._updatedLayers[a],delete this._updatedPaintProps[a],p.onRemove&&p.onRemove(this.map)}getLayer(a){return this._layers[a]}hasLayer(a){return a in this._layers}setLayerZoomRange(a,p,y){this._checkLoaded();const w=this.getLayer(a);w?w.minzoom===p&&w.maxzoom===y||(null!=p&&(w.minzoom=p),null!=y&&(w.maxzoom=y),this._updateLayer(w)):this.fire(new x.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${a}".`)))}setFilter(a,p,y={}){this._checkLoaded();const w=this.getLayer(a);if(w){if(!xe(w.filter,p))return null==p?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(x.validateStyle.filter,`layers.${w.id}.filter`,p,null,y)||(w.filter=x.clone$1(p),this._updateLayer(w)))}else this.fire(new x.ErrorEvent(new Error(`Cannot filter non-existing layer "${a}".`)))}getFilter(a){return x.clone$1(this.getLayer(a).filter)}setLayoutProperty(a,p,y,w={}){this._checkLoaded();const S=this.getLayer(a);S?xe(S.getLayoutProperty(p),y)||(S.setLayoutProperty(p,y,w),this._updateLayer(S)):this.fire(new x.ErrorEvent(new Error(`Cannot style non-existing layer "${a}".`)))}getLayoutProperty(a,p){const y=this.getLayer(a);if(y)return y.getLayoutProperty(p);this.fire(new x.ErrorEvent(new Error(`Cannot get style of non-existing layer "${a}".`)))}setPaintProperty(a,p,y,w={}){this._checkLoaded();const S=this.getLayer(a);S?xe(S.getPaintProperty(p),y)||(S.setPaintProperty(p,y,w)&&this._updateLayer(S),this._changed=!0,this._updatedPaintProps[a]=!0):this.fire(new x.ErrorEvent(new Error(`Cannot style non-existing layer "${a}".`)))}getPaintProperty(a,p){return this.getLayer(a).getPaintProperty(p)}setFeatureState(a,p){this._checkLoaded();const y=a.source,w=a.sourceLayer,S=this.sourceCaches[y];if(void 0===S)return void this.fire(new x.ErrorEvent(new Error(`The source '${y}' does not exist in the map's style.`)));const R=S.getSource().type;"geojson"===R&&w?this.fire(new x.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==R||w?(void 0===a.id&&this.fire(new x.ErrorEvent(new Error("The feature id parameter must be provided."))),S.setFeatureState(w,a.id,p)):this.fire(new x.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(a,p){this._checkLoaded();const y=a.source,w=this.sourceCaches[y];if(void 0===w)return void this.fire(new x.ErrorEvent(new Error(`The source '${y}' does not exist in the map's style.`)));const S=w.getSource().type,R="vector"===S?a.sourceLayer:void 0;"vector"!==S||R?p&&"string"!=typeof a.id&&"number"!=typeof a.id?this.fire(new x.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):w.removeFeatureState(R,a.id,p):this.fire(new x.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(a){this._checkLoaded();const p=a.source,y=a.sourceLayer,w=this.sourceCaches[p];if(void 0!==w)return"vector"!==w.getSource().type||y?(void 0===a.id&&this.fire(new x.ErrorEvent(new Error("The feature id parameter must be provided."))),w.getFeatureState(y,a.id)):void this.fire(new x.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new x.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)))}getTransition(){return x.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){return x.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:x.mapObject(this.sourceCaches,a=>a.serialize()),layers:this._serializeLayers(this._order)},a=>void 0!==a)}_updateLayer(a){this._updatedLayers[a.id]=!0,a.source&&!this._updatedSources[a.source]&&"raster"!==this.sourceCaches[a.source].getSource().type&&(this._updatedSources[a.source]="reload",this.sourceCaches[a.source].pause()),this._changed=!0}_flattenAndSortRenderedFeatures(a){const p=R=>"fill-extrusion"===this._layers[R].type,y={},w=[];for(let R=this._order.length-1;R>=0;R--){const F=this._order[R];if(p(F)){y[F]=R;for(const N of a){const j=N[F];if(j)for(const q of j)w.push(q)}}}w.sort((R,F)=>F.intersectionZ-R.intersectionZ);const S=[];for(let R=this._order.length-1;R>=0;R--){const F=this._order[R];if(p(F))for(let N=w.length-1;N>=0;N--){const j=w[N].feature;if(y[j.layer.id]<R)break;S.push(j),w.pop()}else for(const N of a){const j=N[F];if(j)for(const q of j)S.push(q.feature)}}return S}queryRenderedFeatures(a,p,y){p&&p.filter&&this._validate(x.validateStyle.filter,"queryRenderedFeatures.filter",p.filter,null,p);const w={};if(p&&p.layers){if(!Array.isArray(p.layers))return this.fire(new x.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const R of p.layers){const F=this._layers[R];if(!F)return this.fire(new x.ErrorEvent(new Error(`The layer '${R}' does not exist in the map's style and cannot be queried for features.`))),[];w[F.source]=!0}}const S=[];p.availableImages=this._availableImages;for(const R in this.sourceCaches)p.layers&&!w[R]||S.push(Mo(this.sourceCaches[R],this._layers,this._serializedLayers,a,p,y));return this.placement&&S.push(function(R,F,N,j,q,X,te){const ce={},oe=X.queryRenderedSymbols(j),he=[];for(const Ce of Object.keys(oe).map(Number))he.push(te[Ce]);he.sort(Do);for(const Ce of he){const De=Ce.featureIndex.lookupSymbolFeatures(oe[Ce.bucketInstanceId],F,Ce.bucketIndex,Ce.sourceLayerIndex,q.filter,q.layers,q.availableImages,R);for(const Ne in De){const Se=ce[Ne]=ce[Ne]||[],Je=De[Ne];Je.sort((Ye,Ge)=>{const ht=Ce.featureSortOrder;if(ht){const mt=ht.indexOf(Ye.featureIndex);return ht.indexOf(Ge.featureIndex)-mt}return Ge.featureIndex-Ye.featureIndex});for(const Ye of Je)Se.push(Ye)}}for(const Ce in ce)ce[Ce].forEach(De=>{const Ne=De.feature,Se=N[R[Ce].source].getFeatureState(Ne.layer["source-layer"],Ne.id);Ne.source=Ne.layer.source,Ne.layer["source-layer"]&&(Ne.sourceLayer=Ne.layer["source-layer"]),Ne.state=Se});return ce}(this._layers,this._serializedLayers,this.sourceCaches,a,p,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(S)}querySourceFeatures(a,p){p&&p.filter&&this._validate(x.validateStyle.filter,"querySourceFeatures.filter",p.filter,null,p);const y=this.sourceCaches[a];return y?function(w,S){const R=w.getRenderableIds().map(j=>w.getTileByID(j)),F=[],N={};for(let j=0;j<R.length;j++){const q=R[j],X=q.tileID.canonical.key;N[X]||(N[X]=!0,q.querySourceFeatures(F,S))}return F}(y,p):[]}addSourceType(a,p,y){return ue.getSourceType(a)?y(new Error(`A source type called "${a}" already exists.`)):(ue.setSourceType(a,p),p.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:a,url:p.workerSourceURL},y):y(null,null))}getLight(){return this.light.getLight()}setLight(a,p={}){this._checkLoaded();const y=this.light.getLight();let w=!1;for(const R in a)if(!xe(a[R],y[R])){w=!0;break}if(!w)return;const S={now:x.exported.now(),transition:x.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(a,p),this.light.updateTransitions(S)}_validate(a,p,y,w,S={}){return(!S||!1!==S.validate)&&on(this,a.call(x.validateStyle,x.extend({key:p,style:this.serialize(),value:y,styleSpec:x.spec},w)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),x.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const a in this._layers)this._layers[a].setEventedParent(null);for(const a in this.sourceCaches)this.sourceCaches[a].clearTiles(),this.sourceCaches[a].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(a){this.sourceCaches[a].clearTiles()}_reloadSource(a){this.sourceCaches[a].resume(),this.sourceCaches[a].reload()}_updateSources(a){for(const p in this.sourceCaches)this.sourceCaches[p].update(a)}_generateCollisionBoxes(){for(const a in this.sourceCaches)this._reloadSource(a)}_updatePlacement(a,p,y,w,S=!1){let R=!1,F=!1;const N={};for(const j of this._order){const q=this._layers[j];if("symbol"!==q.type)continue;if(!N[q.source]){const te=this.sourceCaches[q.source];N[q.source]=te.getRenderableIds(!0).map(ce=>te.getTileByID(ce)).sort((ce,oe)=>oe.tileID.overscaledZ-ce.tileID.overscaledZ||(ce.tileID.isLessThan(oe.tileID)?-1:1))}const X=this.crossTileSymbolIndex.addLayer(q,N[q.source],a.center.lng);R=R||X}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((S=S||this._layerOrderChanged||0===y)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(x.exported.now(),a.zoom))&&(this.pauseablePlacement=new Yt(a,this._order,S,p,y,w,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,N),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(x.exported.now()),F=!0),R&&this.pauseablePlacement.placement.setStale()),F||R)for(const j of this._order){const q=this._layers[j];"symbol"===q.type&&this.placement.updateLayerOpacities(q,N[q.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(x.exported.now())}_releaseSymbolFadeTiles(){for(const a in this.sourceCaches)this.sourceCaches[a].releaseSymbolFadeTiles()}getImages(a,p,y){this.imageManager.getImages(p.icons,y),this._updateTilesForChangedImages();const w=this.sourceCaches[p.source];w&&w.setDependencies(p.tileID.key,p.type,p.icons)}getGlyphs(a,p,y){this.glyphManager.getGlyphs(p.stacks,y)}getResource(a,p,y){return x.makeRequest(p,y)}}ue.getSourceType=function(b){return Gn[b]},ue.setSourceType=function(b,a){Gn[b]=a},ue.registerForPluginStateChange=x.registerForPluginStateChange;var tt=x.createLayout([{name:"a_pos",type:"Int16",components:2}]),Ae={prelude:Fe("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),background:Fe("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Fe("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Fe("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),clippingMask:Fe("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Fe("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),heatmapTexture:Fe("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Fe("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Fe("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Fe("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),fill:Fe("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),fillOutline:Fe("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillOutlinePattern:Fe("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillPattern:Fe("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),fillExtrusion:Fe("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),fillExtrusionPattern:Fe("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),hillshadePrepare:Fe("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Fe("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Fe("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),lineGradient:Fe("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),linePattern:Fe("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),lineSDF:Fe("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),raster:Fe("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Fe("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),symbolSDF:Fe("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:Fe("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}")};function Fe(b,a){const p=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,y=a.match(/attribute ([\w]+) ([\w]+)/g),w=b.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=a.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),R=S?S.concat(w):w,F={};return{fragmentSource:b=b.replace(p,(N,j,q,X,te)=>(F[te]=!0,"define"===j?`\n#ifndef HAS_UNIFORM_u_${te}\nvarying ${q} ${X} ${te};\n#else\nuniform ${q} ${X} u_${te};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${te}\n    ${q} ${X} ${te} = u_${te};\n#endif\n`)),vertexSource:a=a.replace(p,(N,j,q,X,te)=>{const ce="float"===X?"vec2":"vec4",oe=te.match(/color/)?"color":ce;return F[te]?"define"===j?`\n#ifndef HAS_UNIFORM_u_${te}\nuniform lowp float u_${te}_t;\nattribute ${q} ${ce} a_${te};\nvarying ${q} ${X} ${te};\n#else\nuniform ${q} ${X} u_${te};\n#endif\n`:"vec4"===oe?`\n#ifndef HAS_UNIFORM_u_${te}\n    ${te} = a_${te};\n#else\n    ${q} ${X} ${te} = u_${te};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${te}\n    ${te} = unpack_mix_${oe}(a_${te}, u_${te}_t);\n#else\n    ${q} ${X} ${te} = u_${te};\n#endif\n`:"define"===j?`\n#ifndef HAS_UNIFORM_u_${te}\nuniform lowp float u_${te}_t;\nattribute ${q} ${ce} a_${te};\n#else\nuniform ${q} ${X} u_${te};\n#endif\n`:"vec4"===oe?`\n#ifndef HAS_UNIFORM_u_${te}\n    ${q} ${X} ${te} = a_${te};\n#else\n    ${q} ${X} ${te} = u_${te};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${te}\n    ${q} ${X} ${te} = unpack_mix_${oe}(a_${te}, u_${te}_t);\n#else\n    ${q} ${X} ${te} = u_${te};\n#endif\n`}),staticAttributes:y,staticUniforms:R}}class Ot{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(a,p,y,w,S,R,F,N){this.context=a;let j=this.boundPaintVertexBuffers.length!==w.length;for(let q=0;!j&&q<w.length;q++)this.boundPaintVertexBuffers[q]!==w[q]&&(j=!0);a.extVertexArrayObject&&this.vao&&this.boundProgram===p&&this.boundLayoutVertexBuffer===y&&!j&&this.boundIndexBuffer===S&&this.boundVertexOffset===R&&this.boundDynamicVertexBuffer===F&&this.boundDynamicVertexBuffer2===N?(a.bindVertexArrayOES.set(this.vao),F&&F.bind(),S&&S.dynamicDraw&&S.bind(),N&&N.bind()):this.freshBind(p,y,w,S,R,F,N)}freshBind(a,p,y,w,S,R,F){let N;const j=a.numAttributes,q=this.context,X=q.gl;if(q.extVertexArrayObject)this.vao&&this.destroy(),this.vao=q.extVertexArrayObject.createVertexArrayOES(),q.bindVertexArrayOES.set(this.vao),N=0,this.boundProgram=a,this.boundLayoutVertexBuffer=p,this.boundPaintVertexBuffers=y,this.boundIndexBuffer=w,this.boundVertexOffset=S,this.boundDynamicVertexBuffer=R,this.boundDynamicVertexBuffer2=F;else{N=q.currentNumAttributes||0;for(let te=j;te<N;te++)X.disableVertexAttribArray(te)}p.enableAttributes(X,a);for(const te of y)te.enableAttributes(X,a);R&&R.enableAttributes(X,a),F&&F.enableAttributes(X,a),p.bind(),p.setVertexAttribPointers(X,a,S);for(const te of y)te.bind(),te.setVertexAttribPointers(X,a,S);R&&(R.bind(),R.setVertexAttribPointers(X,a,S)),w&&w.bind(),F&&(F.bind(),F.setVertexAttribPointers(X,a,S)),q.currentNumAttributes=j}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function At(b){const a=[];for(let p=0;p<b.length;p++){if(null===b[p])continue;const y=b[p].split(" ");a.push(y.pop())}return a}class ui{constructor(a,p,y,w,S,R){const F=a.gl;this.program=F.createProgram();const N=At(y.staticAttributes),j=w?w.getBinderAttributes():[],q=N.concat(j),X=y.staticUniforms?At(y.staticUniforms):[],te=w?w.getBinderUniforms():[],ce=X.concat(te),oe=[];for(const Ye of ce)oe.indexOf(Ye)<0&&oe.push(Ye);const he=w?w.defines():[];R&&he.push("#define OVERDRAW_INSPECTOR;");const Ce=he.concat(Ae.prelude.fragmentSource,y.fragmentSource).join("\n"),De=he.concat(Ae.prelude.vertexSource,y.vertexSource).join("\n"),Ne=F.createShader(F.FRAGMENT_SHADER);if(F.isContextLost())return void(this.failedToCreate=!0);F.shaderSource(Ne,Ce),F.compileShader(Ne),F.attachShader(this.program,Ne);const Se=F.createShader(F.VERTEX_SHADER);if(F.isContextLost())return void(this.failedToCreate=!0);F.shaderSource(Se,De),F.compileShader(Se),F.attachShader(this.program,Se),this.attributes={};const Je={};this.numAttributes=q.length;for(let Ye=0;Ye<this.numAttributes;Ye++)q[Ye]&&(F.bindAttribLocation(this.program,Ye,q[Ye]),this.attributes[q[Ye]]=Ye);F.linkProgram(this.program),F.deleteShader(Se),F.deleteShader(Ne);for(let Ye=0;Ye<oe.length;Ye++){const Ge=oe[Ye];if(Ge&&!Je[Ge]){const ht=F.getUniformLocation(this.program,Ge);ht&&(Je[Ge]=ht)}}this.fixedUniforms=S(a,Je),this.binderUniforms=w?w.getUniforms(a,Je):[]}draw(a,p,y,w,S,R,F,N,j,q,X,te,ce,oe,he,Ce){const De=a.gl;if(this.failedToCreate)return;a.program.set(this.program),a.setDepthMode(y),a.setStencilMode(w),a.setColorMode(S),a.setCullFace(R);for(const Se in this.fixedUniforms)this.fixedUniforms[Se].set(F[Se]);oe&&oe.setUniforms(a,this.binderUniforms,te,{zoom:ce});const Ne={[De.LINES]:2,[De.TRIANGLES]:3,[De.LINE_STRIP]:1}[p];for(const Se of X.get()){const Je=Se.vaos||(Se.vaos={});(Je[N]||(Je[N]=new Ot)).bind(a,this,j,oe?oe.getPaintVertexBuffers():[],q,Se.vertexOffset,he,Ce),De.drawElements(p,Se.primitiveLength*Ne,De.UNSIGNED_SHORT,Se.primitiveOffset*Ne*2)}}}function Kn(b,a,p){const y=1/Dn(p,1,a.transform.tileZoom),w=Math.pow(2,p.tileID.overscaledZ),S=p.tileSize*Math.pow(2,a.transform.tileZoom)/w,R=S*(p.tileID.canonical.x+p.tileID.wrap*w),F=S*p.tileID.canonical.y;return{u_image:0,u_texsize:p.imageAtlasTexture.size,u_scale:[y,b.fromScale,b.toScale],u_fade:b.t,u_pixel_coord_upper:[R>>16,F>>16],u_pixel_coord_lower:[65535&R,65535&F]}}const pn=(b,a,p,y)=>{const w=a.style.light,S=w.properties.get("position"),R=yt(S.x,S.y,S.z),F=(j=new x.ARRAY_TYPE(9),x.ARRAY_TYPE!=Float32Array&&(j[1]=0,j[2]=0,j[3]=0,j[5]=0,j[6]=0,j[7]=0),j[0]=1,j[4]=1,j[8]=1,j);var j;"viewport"===w.properties.get("anchor")&&function(j,q){var X=Math.sin(q),te=Math.cos(q);j[0]=te,j[1]=X,j[2]=0,j[3]=-X,j[4]=te,j[5]=0,j[6]=0,j[7]=0,j[8]=1}(F,-a.transform.angle),function(j,q,X){var te=q[0],ce=q[1],oe=q[2];j[0]=te*X[0]+ce*X[3]+oe*X[6],j[1]=te*X[1]+ce*X[4]+oe*X[7],j[2]=te*X[2]+ce*X[5]+oe*X[8]}(R,R,F);const N=w.properties.get("color");return{u_matrix:b,u_lightpos:R,u_lightintensity:w.properties.get("intensity"),u_lightcolor:[N.r,N.g,N.b],u_vertical_gradient:+p,u_opacity:y}},mn=(b,a,p,y,w,S,R)=>x.extend(pn(b,a,p,y),Kn(S,a,R),{u_height_factor:-Math.pow(2,w.overscaledZ)/R.tileSize/8}),Bi=b=>({u_matrix:b}),Mr=(b,a,p,y)=>x.extend(Bi(b),Kn(p,a,y)),Ra=(b,a)=>({u_matrix:b,u_world:a}),ao=(b,a,p,y,w)=>x.extend(Mr(b,a,p,y),{u_world:w}),Dr=(b,a,p,y)=>{const w=b.transform;let S,R;if("map"===y.paint.get("circle-pitch-alignment")){const F=Dn(p,1,w.zoom);S=!0,R=[F,F]}else S=!1,R=w.pixelsToGLUnits;return{u_camera_to_center_distance:w.cameraToCenterDistance,u_scale_with_map:+("map"===y.paint.get("circle-pitch-scale")),u_matrix:b.translatePosMatrix(a.posMatrix,p,y.paint.get("circle-translate"),y.paint.get("circle-translate-anchor")),u_pitch_with_map:+S,u_device_pixel_ratio:b.pixelRatio,u_extrude_scale:R}},Pa=(b,a,p)=>{const y=Dn(p,1,a.zoom),w=Math.pow(2,a.zoom-p.tileID.overscaledZ),S=p.tileID.overscaleFactor();return{u_matrix:b,u_camera_to_center_distance:a.cameraToCenterDistance,u_pixels_to_tile_units:y,u_extrude_scale:[a.pixelsToGLUnits[0]/(y*w),a.pixelsToGLUnits[1]/(y*w)],u_overscale_factor:S}},ac=(b,a,p=1)=>({u_matrix:b,u_color:a,u_overlay:0,u_overlay_scale:p}),lc=b=>({u_matrix:b}),lo=(b,a,p,y)=>({u_matrix:b,u_extrude_scale:Dn(a,1,p),u_intensity:y});function Id(b,a){const p=Math.pow(2,a.canonical.z),y=a.canonical.y;return[new x.MercatorCoordinate(0,y/p).toLngLat().lat,new x.MercatorCoordinate(0,(y+1)/p).toLngLat().lat]}const bl=(b,a,p)=>{const y=b.transform;return{u_matrix:Rd(b,a,p),u_ratio:1/Dn(a,1,y.zoom),u_device_pixel_ratio:b.pixelRatio,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},cc=(b,a,p,y)=>x.extend(bl(b,a,p),{u_image:0,u_image_height:y}),lr=(b,a,p,y)=>{const w=b.transform,S=kd(a,w);return{u_matrix:Rd(b,a,p),u_texsize:a.imageAtlasTexture.size,u_ratio:1/Dn(a,1,w.zoom),u_device_pixel_ratio:b.pixelRatio,u_image:0,u_scale:[S,y.fromScale,y.toScale],u_fade:y.t,u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]]}},uc=(b,a,p,y,w)=>{const S=b.lineAtlas,R=kd(a,b.transform),F="round"===p.layout.get("line-cap"),N=S.getDash(y.from,F),j=S.getDash(y.to,F),q=N.width*w.fromScale,X=j.width*w.toScale;return x.extend(bl(b,a,p),{u_patternscale_a:[R/q,-N.height/2],u_patternscale_b:[R/X,-j.height/2],u_sdfgamma:S.width/(256*Math.min(q,X)*b.pixelRatio)/2,u_image:0,u_tex_y_a:N.y,u_tex_y_b:j.y,u_mix:w.t})};function kd(b,a){return 1/Dn(b,1,a.tileZoom)}function Rd(b,a,p){return b.translatePosMatrix(a.tileID.posMatrix,a,p.paint.get("line-translate"),p.paint.get("line-translate-anchor"))}const Vh=(b,a,p,y,w)=>{return{u_matrix:b,u_tl_parent:a,u_scale_parent:p,u_buffer_scale:1,u_fade_t:y.mix,u_opacity:y.opacity*w.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:w.paint.get("raster-brightness-min"),u_brightness_high:w.paint.get("raster-brightness-max"),u_saturation_factor:(R=w.paint.get("raster-saturation"),R>0?1-1/(1.001-R):-R),u_contrast_factor:(S=w.paint.get("raster-contrast"),S>0?1/(1-S):1+S),u_spin_weights:Pd(w.paint.get("raster-hue-rotate"))};var S,R};function Pd(b){b*=Math.PI/180;const a=Math.sin(b),p=Math.cos(b);return[(2*p+1)/3,(-Math.sqrt(3)*a-p+1)/3,(Math.sqrt(3)*a-p+1)/3]}const Od=(b,a,p,y,w,S,R,F,N,j)=>{const q=w.transform;return{u_is_size_zoom_constant:+("constant"===b||"source"===b),u_is_size_feature_constant:+("constant"===b||"camera"===b),u_size_t:a?a.uSizeT:0,u_size:a?a.uSize:0,u_camera_to_center_distance:q.cameraToCenterDistance,u_pitch:q.pitch/360*2*Math.PI,u_rotate_symbol:+p,u_aspect_ratio:q.width/q.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:S,u_label_plane_matrix:R,u_coord_matrix:F,u_is_text:+N,u_pitch_with_map:+y,u_texsize:j,u_texture:0}},zh=(b,a,p,y,w,S,R,F,N,j,q)=>{const X=w.transform;return x.extend(Od(b,a,p,y,w,S,R,F,N,j),{u_gamma_scale:y?Math.cos(X._pitch)*X.cameraToCenterDistance:1,u_device_pixel_ratio:w.pixelRatio,u_is_halo:+q})},hf=(b,a,p,y,w,S,R,F,N,j)=>x.extend(zh(b,a,p,y,w,S,R,F,!0,N,!0),{u_texsize_icon:j,u_texture_icon:1}),Fd=(b,a,p)=>({u_matrix:b,u_opacity:a,u_color:p}),Ld=(b,a,p,y,w,S)=>x.extend(function(R,F,N,j){const q=N.imageManager.getPattern(R.from.toString()),X=N.imageManager.getPattern(R.to.toString()),{width:te,height:ce}=N.imageManager.getPixelSize(),oe=Math.pow(2,j.tileID.overscaledZ),he=j.tileSize*Math.pow(2,N.transform.tileZoom)/oe,Ce=he*(j.tileID.canonical.x+j.tileID.wrap*oe),De=he*j.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:q.tl,u_pattern_br_a:q.br,u_pattern_tl_b:X.tl,u_pattern_br_b:X.br,u_texsize:[te,ce],u_mix:F.t,u_pattern_size_a:q.displaySize,u_pattern_size_b:X.displaySize,u_scale_a:F.fromScale,u_scale_b:F.toScale,u_tile_units_to_pixels:1/Dn(j,1,N.transform.tileZoom),u_pixel_coord_upper:[Ce>>16,De>>16],u_pixel_coord_lower:[65535&Ce,65535&De]}}(y,S,p,w),{u_matrix:b,u_opacity:a}),dc={fillExtrusion:(b,a)=>({u_matrix:new x.UniformMatrix4f(b,a.u_matrix),u_lightpos:new x.Uniform3f(b,a.u_lightpos),u_lightintensity:new x.Uniform1f(b,a.u_lightintensity),u_lightcolor:new x.Uniform3f(b,a.u_lightcolor),u_vertical_gradient:new x.Uniform1f(b,a.u_vertical_gradient),u_opacity:new x.Uniform1f(b,a.u_opacity)}),fillExtrusionPattern:(b,a)=>({u_matrix:new x.UniformMatrix4f(b,a.u_matrix),u_lightpos:new x.Uniform3f(b,a.u_lightpos),u_lightintensity:new x.Uniform1f(b,a.u_lightintensity),u_lightcolor:new x.Uniform3f(b,a.u_lightcolor),u_vertical_gradient:new x.Uniform1f(b,a.u_vertical_gradient),u_height_factor:new x.Uniform1f(b,a.u_height_factor),u_image:new x.Uniform1i(b,a.u_image),u_texsize:new x.Uniform2f(b,a.u_texsize),u_pixel_coord_upper:new x.Uniform2f(b,a.u_pixel_coord_upper),u_pixel_coord_lower:new x.Uniform2f(b,a.u_pixel_coord_lower),u_scale:new x.Uniform3f(b,a.u_scale),u_fade:new x.Uniform1f(b,a.u_fade),u_opacity:new x.Uniform1f(b,a.u_opacity)}),fill:(b,a)=>({u_matrix:new x.UniformMatrix4f(b,a.u_matrix)}),fillPattern:(b,a)=>({u_matrix:new x.UniformMatrix4f(b,a.u_matrix),u_image:new x.Uniform1i(b,a.u_image),u_texsize:new x.Uniform2f(b,a.u_texsize),u_pixel_coord_upper:new x.Uniform2f(b,a.u_pixel_coord_upper),u_pixel_coord_lower:new x.Uniform2f(b,a.u_pixel_coord_lower),u_scale:new x.Uniform3f(b,a.u_scale),u_fade:new x.Uniform1f(b,a.u_fade)}),fillOutline:(b,a)=>({u_matrix:new x.UniformMatrix4f(b,a.u_matrix),u_world:new x.Uniform2f(b,a.u_world)}),fillOutlinePattern:(b,a)=>({u_matrix:new x.UniformMatrix4f(b,a.u_matrix),u_world:new x.Uniform2f(b,a.u_world),u_image:new x.Uniform1i(b,a.u_image),u_texsize:new x.Uniform2f(b,a.u_texsize),u_pixel_coord_upper:new x.Uniform2f(b,a.u_pixel_coord_upper),u_pixel_coord_lower:new x.Uniform2f(b,a.u_pixel_coord_lower),u_scale:new x.Uniform3f(b,a.u_scale),u_fade:new x.Uniform1f(b,a.u_fade)}),circle:(b,a)=>({u_camera_to_center_distance:new x.Uniform1f(b,a.u_camera_to_center_distance),u_scale_with_map:new x.Uniform1i(b,a.u_scale_with_map),u_pitch_with_map:new x.Uniform1i(b,a.u_pitch_with_map),u_extrude_scale:new x.Uniform2f(b,a.u_extrude_scale),u_device_pixel_ratio:new x.Uniform1f(b,a.u_device_pixel_ratio),u_matrix:new x.UniformMatrix4f(b,a.u_matrix)}),collisionBox:(b,a)=>({u_matrix:new x.UniformMatrix4f(b,a.u_matrix),u_camera_to_center_distance:new x.Uniform1f(b,a.u_camera_to_center_distance),u_pixels_to_tile_units:new x.Uniform1f(b,a.u_pixels_to_tile_units),u_extrude_scale:new x.Uniform2f(b,a.u_extrude_scale),u_overscale_factor:new x.Uniform1f(b,a.u_overscale_factor)}),collisionCircle:(b,a)=>({u_matrix:new x.UniformMatrix4f(b,a.u_matrix),u_inv_matrix:new x.UniformMatrix4f(b,a.u_inv_matrix),u_camera_to_center_distance:new x.Uniform1f(b,a.u_camera_to_center_distance),u_viewport_size:new x.Uniform2f(b,a.u_viewport_size)}),debug:(b,a)=>({u_color:new x.UniformColor(b,a.u_color),u_matrix:new x.UniformMatrix4f(b,a.u_matrix),u_overlay:new x.Uniform1i(b,a.u_overlay),u_overlay_scale:new x.Uniform1f(b,a.u_overlay_scale)}),clippingMask:(b,a)=>({u_matrix:new x.UniformMatrix4f(b,a.u_matrix)}),heatmap:(b,a)=>({u_extrude_scale:new x.Uniform1f(b,a.u_extrude_scale),u_intensity:new x.Uniform1f(b,a.u_intensity),u_matrix:new x.UniformMatrix4f(b,a.u_matrix)}),heatmapTexture:(b,a)=>({u_matrix:new x.UniformMatrix4f(b,a.u_matrix),u_world:new x.Uniform2f(b,a.u_world),u_image:new x.Uniform1i(b,a.u_image),u_color_ramp:new x.Uniform1i(b,a.u_color_ramp),u_opacity:new x.Uniform1f(b,a.u_opacity)}),hillshade:(b,a)=>({u_matrix:new x.UniformMatrix4f(b,a.u_matrix),u_image:new x.Uniform1i(b,a.u_image),u_latrange:new x.Uniform2f(b,a.u_latrange),u_light:new x.Uniform2f(b,a.u_light),u_shadow:new x.UniformColor(b,a.u_shadow),u_highlight:new x.UniformColor(b,a.u_highlight),u_accent:new x.UniformColor(b,a.u_accent)}),hillshadePrepare:(b,a)=>({u_matrix:new x.UniformMatrix4f(b,a.u_matrix),u_image:new x.Uniform1i(b,a.u_image),u_dimension:new x.Uniform2f(b,a.u_dimension),u_zoom:new x.Uniform1f(b,a.u_zoom),u_unpack:new x.Uniform4f(b,a.u_unpack)}),line:(b,a)=>({u_matrix:new x.UniformMatrix4f(b,a.u_matrix),u_ratio:new x.Uniform1f(b,a.u_ratio),u_device_pixel_ratio:new x.Uniform1f(b,a.u_device_pixel_ratio),u_units_to_pixels:new x.Uniform2f(b,a.u_units_to_pixels)}),lineGradient:(b,a)=>({u_matrix:new x.UniformMatrix4f(b,a.u_matrix),u_ratio:new x.Uniform1f(b,a.u_ratio),u_device_pixel_ratio:new x.Uniform1f(b,a.u_device_pixel_ratio),u_units_to_pixels:new x.Uniform2f(b,a.u_units_to_pixels),u_image:new x.Uniform1i(b,a.u_image),u_image_height:new x.Uniform1f(b,a.u_image_height)}),linePattern:(b,a)=>({u_matrix:new x.UniformMatrix4f(b,a.u_matrix),u_texsize:new x.Uniform2f(b,a.u_texsize),u_ratio:new x.Uniform1f(b,a.u_ratio),u_device_pixel_ratio:new x.Uniform1f(b,a.u_device_pixel_ratio),u_image:new x.Uniform1i(b,a.u_image),u_units_to_pixels:new x.Uniform2f(b,a.u_units_to_pixels),u_scale:new x.Uniform3f(b,a.u_scale),u_fade:new x.Uniform1f(b,a.u_fade)}),lineSDF:(b,a)=>({u_matrix:new x.UniformMatrix4f(b,a.u_matrix),u_ratio:new x.Uniform1f(b,a.u_ratio),u_device_pixel_ratio:new x.Uniform1f(b,a.u_device_pixel_ratio),u_units_to_pixels:new x.Uniform2f(b,a.u_units_to_pixels),u_patternscale_a:new x.Uniform2f(b,a.u_patternscale_a),u_patternscale_b:new x.Uniform2f(b,a.u_patternscale_b),u_sdfgamma:new x.Uniform1f(b,a.u_sdfgamma),u_image:new x.Uniform1i(b,a.u_image),u_tex_y_a:new x.Uniform1f(b,a.u_tex_y_a),u_tex_y_b:new x.Uniform1f(b,a.u_tex_y_b),u_mix:new x.Uniform1f(b,a.u_mix)}),raster:(b,a)=>({u_matrix:new x.UniformMatrix4f(b,a.u_matrix),u_tl_parent:new x.Uniform2f(b,a.u_tl_parent),u_scale_parent:new x.Uniform1f(b,a.u_scale_parent),u_buffer_scale:new x.Uniform1f(b,a.u_buffer_scale),u_fade_t:new x.Uniform1f(b,a.u_fade_t),u_opacity:new x.Uniform1f(b,a.u_opacity),u_image0:new x.Uniform1i(b,a.u_image0),u_image1:new x.Uniform1i(b,a.u_image1),u_brightness_low:new x.Uniform1f(b,a.u_brightness_low),u_brightness_high:new x.Uniform1f(b,a.u_brightness_high),u_saturation_factor:new x.Uniform1f(b,a.u_saturation_factor),u_contrast_factor:new x.Uniform1f(b,a.u_contrast_factor),u_spin_weights:new x.Uniform3f(b,a.u_spin_weights)}),symbolIcon:(b,a)=>({u_is_size_zoom_constant:new x.Uniform1i(b,a.u_is_size_zoom_constant),u_is_size_feature_constant:new x.Uniform1i(b,a.u_is_size_feature_constant),u_size_t:new x.Uniform1f(b,a.u_size_t),u_size:new x.Uniform1f(b,a.u_size),u_camera_to_center_distance:new x.Uniform1f(b,a.u_camera_to_center_distance),u_pitch:new x.Uniform1f(b,a.u_pitch),u_rotate_symbol:new x.Uniform1i(b,a.u_rotate_symbol),u_aspect_ratio:new x.Uniform1f(b,a.u_aspect_ratio),u_fade_change:new x.Uniform1f(b,a.u_fade_change),u_matrix:new x.UniformMatrix4f(b,a.u_matrix),u_label_plane_matrix:new x.UniformMatrix4f(b,a.u_label_plane_matrix),u_coord_matrix:new x.UniformMatrix4f(b,a.u_coord_matrix),u_is_text:new x.Uniform1i(b,a.u_is_text),u_pitch_with_map:new x.Uniform1i(b,a.u_pitch_with_map),u_texsize:new x.Uniform2f(b,a.u_texsize),u_texture:new x.Uniform1i(b,a.u_texture)}),symbolSDF:(b,a)=>({u_is_size_zoom_constant:new x.Uniform1i(b,a.u_is_size_zoom_constant),u_is_size_feature_constant:new x.Uniform1i(b,a.u_is_size_feature_constant),u_size_t:new x.Uniform1f(b,a.u_size_t),u_size:new x.Uniform1f(b,a.u_size),u_camera_to_center_distance:new x.Uniform1f(b,a.u_camera_to_center_distance),u_pitch:new x.Uniform1f(b,a.u_pitch),u_rotate_symbol:new x.Uniform1i(b,a.u_rotate_symbol),u_aspect_ratio:new x.Uniform1f(b,a.u_aspect_ratio),u_fade_change:new x.Uniform1f(b,a.u_fade_change),u_matrix:new x.UniformMatrix4f(b,a.u_matrix),u_label_plane_matrix:new x.UniformMatrix4f(b,a.u_label_plane_matrix),u_coord_matrix:new x.UniformMatrix4f(b,a.u_coord_matrix),u_is_text:new x.Uniform1i(b,a.u_is_text),u_pitch_with_map:new x.Uniform1i(b,a.u_pitch_with_map),u_texsize:new x.Uniform2f(b,a.u_texsize),u_texture:new x.Uniform1i(b,a.u_texture),u_gamma_scale:new x.Uniform1f(b,a.u_gamma_scale),u_device_pixel_ratio:new x.Uniform1f(b,a.u_device_pixel_ratio),u_is_halo:new x.Uniform1i(b,a.u_is_halo)}),symbolTextAndIcon:(b,a)=>({u_is_size_zoom_constant:new x.Uniform1i(b,a.u_is_size_zoom_constant),u_is_size_feature_constant:new x.Uniform1i(b,a.u_is_size_feature_constant),u_size_t:new x.Uniform1f(b,a.u_size_t),u_size:new x.Uniform1f(b,a.u_size),u_camera_to_center_distance:new x.Uniform1f(b,a.u_camera_to_center_distance),u_pitch:new x.Uniform1f(b,a.u_pitch),u_rotate_symbol:new x.Uniform1i(b,a.u_rotate_symbol),u_aspect_ratio:new x.Uniform1f(b,a.u_aspect_ratio),u_fade_change:new x.Uniform1f(b,a.u_fade_change),u_matrix:new x.UniformMatrix4f(b,a.u_matrix),u_label_plane_matrix:new x.UniformMatrix4f(b,a.u_label_plane_matrix),u_coord_matrix:new x.UniformMatrix4f(b,a.u_coord_matrix),u_is_text:new x.Uniform1i(b,a.u_is_text),u_pitch_with_map:new x.Uniform1i(b,a.u_pitch_with_map),u_texsize:new x.Uniform2f(b,a.u_texsize),u_texsize_icon:new x.Uniform2f(b,a.u_texsize_icon),u_texture:new x.Uniform1i(b,a.u_texture),u_texture_icon:new x.Uniform1i(b,a.u_texture_icon),u_gamma_scale:new x.Uniform1f(b,a.u_gamma_scale),u_device_pixel_ratio:new x.Uniform1f(b,a.u_device_pixel_ratio),u_is_halo:new x.Uniform1i(b,a.u_is_halo)}),background:(b,a)=>({u_matrix:new x.UniformMatrix4f(b,a.u_matrix),u_opacity:new x.Uniform1f(b,a.u_opacity),u_color:new x.UniformColor(b,a.u_color)}),backgroundPattern:(b,a)=>({u_matrix:new x.UniformMatrix4f(b,a.u_matrix),u_opacity:new x.Uniform1f(b,a.u_opacity),u_image:new x.Uniform1i(b,a.u_image),u_pattern_tl_a:new x.Uniform2f(b,a.u_pattern_tl_a),u_pattern_br_a:new x.Uniform2f(b,a.u_pattern_br_a),u_pattern_tl_b:new x.Uniform2f(b,a.u_pattern_tl_b),u_pattern_br_b:new x.Uniform2f(b,a.u_pattern_br_b),u_texsize:new x.Uniform2f(b,a.u_texsize),u_mix:new x.Uniform1f(b,a.u_mix),u_pattern_size_a:new x.Uniform2f(b,a.u_pattern_size_a),u_pattern_size_b:new x.Uniform2f(b,a.u_pattern_size_b),u_scale_a:new x.Uniform1f(b,a.u_scale_a),u_scale_b:new x.Uniform1f(b,a.u_scale_b),u_pixel_coord_upper:new x.Uniform2f(b,a.u_pixel_coord_upper),u_pixel_coord_lower:new x.Uniform2f(b,a.u_pixel_coord_lower),u_tile_units_to_pixels:new x.Uniform1f(b,a.u_tile_units_to_pixels)})};class xl{constructor(a,p,y){this.context=a;const w=a.gl;this.buffer=w.createBuffer(),this.dynamicDraw=Boolean(y),this.context.unbindVAO(),a.bindElementBuffer.set(this.buffer),w.bufferData(w.ELEMENT_ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||delete p.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(a){const p=this.context.gl;this.context.unbindVAO(),this.bind(),p.bufferSubData(p.ELEMENT_ARRAY_BUFFER,0,a.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const jh={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Bd{constructor(a,p,y,w){this.length=p.length,this.attributes=y,this.itemSize=p.bytesPerElement,this.dynamicDraw=w,this.context=a;const S=a.gl;this.buffer=S.createBuffer(),a.bindVertexBuffer.set(this.buffer),S.bufferData(S.ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||delete p.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(a){const p=this.context.gl;this.bind(),p.bufferSubData(p.ARRAY_BUFFER,0,a.arrayBuffer)}enableAttributes(a,p){for(let y=0;y<this.attributes.length;y++){const w=p.attributes[this.attributes[y].name];void 0!==w&&a.enableVertexAttribArray(w)}}setVertexAttribPointers(a,p,y){for(let w=0;w<this.attributes.length;w++){const S=this.attributes[w],R=p.attributes[S.name];void 0!==R&&a.vertexAttribPointer(R,S.components,a[jh[S.type]],!1,this.itemSize,S.offset+this.itemSize*(y||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class sn{constructor(a){this.gl=a.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(a){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class qo extends sn{getDefault(){return x.Color.transparent}set(a){const p=this.current;(a.r!==p.r||a.g!==p.g||a.b!==p.b||a.a!==p.a||this.dirty)&&(this.gl.clearColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)}}class wl extends sn{getDefault(){return 1}set(a){(a!==this.current||this.dirty)&&(this.gl.clearDepth(a),this.current=a,this.dirty=!1)}}class Oa extends sn{getDefault(){return 0}set(a){(a!==this.current||this.dirty)&&(this.gl.clearStencil(a),this.current=a,this.dirty=!1)}}class Br extends sn{getDefault(){return[!0,!0,!0,!0]}set(a){const p=this.current;(a[0]!==p[0]||a[1]!==p[1]||a[2]!==p[2]||a[3]!==p[3]||this.dirty)&&(this.gl.colorMask(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)}}class au extends sn{getDefault(){return!0}set(a){(a!==this.current||this.dirty)&&(this.gl.depthMask(a),this.current=a,this.dirty=!1)}}class lu extends sn{getDefault(){return 255}set(a){(a!==this.current||this.dirty)&&(this.gl.stencilMask(a),this.current=a,this.dirty=!1)}}class Pn extends sn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(a){const p=this.current;(a.func!==p.func||a.ref!==p.ref||a.mask!==p.mask||this.dirty)&&(this.gl.stencilFunc(a.func,a.ref,a.mask),this.current=a,this.dirty=!1)}}class Cl extends sn{getDefault(){const a=this.gl;return[a.KEEP,a.KEEP,a.KEEP]}set(a){const p=this.current;(a[0]!==p[0]||a[1]!==p[1]||a[2]!==p[2]||this.dirty)&&(this.gl.stencilOp(a[0],a[1],a[2]),this.current=a,this.dirty=!1)}}class cu extends sn{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const p=this.gl;a?p.enable(p.STENCIL_TEST):p.disable(p.STENCIL_TEST),this.current=a,this.dirty=!1}}class Fa extends sn{getDefault(){return[0,1]}set(a){const p=this.current;(a[0]!==p[0]||a[1]!==p[1]||this.dirty)&&(this.gl.depthRange(a[0],a[1]),this.current=a,this.dirty=!1)}}class uu extends sn{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const p=this.gl;a?p.enable(p.DEPTH_TEST):p.disable(p.DEPTH_TEST),this.current=a,this.dirty=!1}}class co extends sn{getDefault(){return this.gl.LESS}set(a){(a!==this.current||this.dirty)&&(this.gl.depthFunc(a),this.current=a,this.dirty=!1)}}class Ml extends sn{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const p=this.gl;a?p.enable(p.BLEND):p.disable(p.BLEND),this.current=a,this.dirty=!1}}class Uh extends sn{getDefault(){const a=this.gl;return[a.ONE,a.ZERO]}set(a){const p=this.current;(a[0]!==p[0]||a[1]!==p[1]||this.dirty)&&(this.gl.blendFunc(a[0],a[1]),this.current=a,this.dirty=!1)}}class du extends sn{getDefault(){return x.Color.transparent}set(a){const p=this.current;(a.r!==p.r||a.g!==p.g||a.b!==p.b||a.a!==p.a||this.dirty)&&(this.gl.blendColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)}}class Dl extends sn{getDefault(){return this.gl.FUNC_ADD}set(a){(a!==this.current||this.dirty)&&(this.gl.blendEquation(a),this.current=a,this.dirty=!1)}}class Hh extends sn{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const p=this.gl;a?p.enable(p.CULL_FACE):p.disable(p.CULL_FACE),this.current=a,this.dirty=!1}}class hu extends sn{getDefault(){return this.gl.BACK}set(a){(a!==this.current||this.dirty)&&(this.gl.cullFace(a),this.current=a,this.dirty=!1)}}class Nd extends sn{getDefault(){return this.gl.CCW}set(a){(a!==this.current||this.dirty)&&(this.gl.frontFace(a),this.current=a,this.dirty=!1)}}class pu extends sn{getDefault(){return null}set(a){(a!==this.current||this.dirty)&&(this.gl.useProgram(a),this.current=a,this.dirty=!1)}}class Km extends sn{getDefault(){return this.gl.TEXTURE0}set(a){(a!==this.current||this.dirty)&&(this.gl.activeTexture(a),this.current=a,this.dirty=!1)}}class qn extends sn{getDefault(){const a=this.gl;return[0,0,a.drawingBufferWidth,a.drawingBufferHeight]}set(a){const p=this.current;(a[0]!==p[0]||a[1]!==p[1]||a[2]!==p[2]||a[3]!==p[3]||this.dirty)&&(this.gl.viewport(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)}}class hc extends sn{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const p=this.gl;p.bindFramebuffer(p.FRAMEBUFFER,a),this.current=a,this.dirty=!1}}class El extends sn{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const p=this.gl;p.bindRenderbuffer(p.RENDERBUFFER,a),this.current=a,this.dirty=!1}}class dn extends sn{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const p=this.gl;p.bindTexture(p.TEXTURE_2D,a),this.current=a,this.dirty=!1}}class Vd extends sn{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const p=this.gl;p.bindBuffer(p.ARRAY_BUFFER,a),this.current=a,this.dirty=!1}}class pc extends sn{getDefault(){return null}set(a){const p=this.gl;p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,a),this.current=a,this.dirty=!1}}class La extends sn{constructor(a){super(a),this.vao=a.extVertexArrayObject}getDefault(){return null}set(a){this.vao&&(a!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(a),this.current=a,this.dirty=!1)}}class cr extends sn{getDefault(){return 4}set(a){if(a===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_ALIGNMENT,a),this.current=a,this.dirty=!1}}class zd extends sn{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a),this.current=a,this.dirty=!1}}class zs extends sn{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,a),this.current=a,this.dirty=!1}}class uo extends sn{constructor(a,p){super(a),this.context=a,this.parent=p}getDefault(){return null}}class ho extends uo{setDirty(){this.dirty=!0}set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,a,0),this.current=a,this.dirty=!1}}class aa extends uo{set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferRenderbuffer(p.FRAMEBUFFER,p.DEPTH_ATTACHMENT,p.RENDERBUFFER,a),this.current=a,this.dirty=!1}}class Ji{constructor(a,p,y,w){this.context=a,this.width=p,this.height=y;const S=this.framebuffer=a.gl.createFramebuffer();this.colorAttachment=new ho(a,S),w&&(this.depthAttachment=new aa(a,S))}destroy(){const a=this.context.gl,p=this.colorAttachment.get();if(p&&a.deleteTexture(p),this.depthAttachment){const y=this.depthAttachment.get();y&&a.deleteRenderbuffer(y)}a.deleteFramebuffer(this.framebuffer)}}class Ln{constructor(a,p,y){this.blendFunction=a,this.blendColor=p,this.mask=y}}Ln.Replace=[1,0],Ln.disabled=new Ln(Ln.Replace,x.Color.transparent,[!1,!1,!1,!1]),Ln.unblended=new Ln(Ln.Replace,x.Color.transparent,[!0,!0,!0,!0]),Ln.alphaBlended=new Ln([1,771],x.Color.transparent,[!0,!0,!0,!0]);class Es{constructor(a){this.gl=a,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new qo(this),this.clearDepth=new wl(this),this.clearStencil=new Oa(this),this.colorMask=new Br(this),this.depthMask=new au(this),this.stencilMask=new lu(this),this.stencilFunc=new Pn(this),this.stencilOp=new Cl(this),this.stencilTest=new cu(this),this.depthRange=new Fa(this),this.depthTest=new uu(this),this.depthFunc=new co(this),this.blend=new Ml(this),this.blendFunc=new Uh(this),this.blendColor=new du(this),this.blendEquation=new Dl(this),this.cullFace=new Hh(this),this.cullFaceSide=new hu(this),this.frontFace=new Nd(this),this.program=new pu(this),this.activeTexture=new Km(this),this.viewport=new qn(this),this.bindFramebuffer=new hc(this),this.bindRenderbuffer=new El(this),this.bindTexture=new dn(this),this.bindVertexBuffer=new Vd(this),this.bindElementBuffer=new pc(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new La(this),this.pixelStoreUnpack=new cr(this),this.pixelStoreUnpackPremultiplyAlpha=new zd(this),this.pixelStoreUnpackFlipY=new zs(this),this.extTextureFilterAnisotropic=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=a.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=a.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(a.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=a.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=a.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(a,p){return new xl(this,a,p)}createVertexBuffer(a,p,y){return new Bd(this,a,p,y)}createRenderbuffer(a,p,y){const w=this.gl,S=w.createRenderbuffer();return this.bindRenderbuffer.set(S),w.renderbufferStorage(w.RENDERBUFFER,a,p,y),this.bindRenderbuffer.set(null),S}createFramebuffer(a,p,y){return new Ji(this,a,p,y)}clear({color:a,depth:p}){const y=this.gl;let w=0;a&&(w|=y.COLOR_BUFFER_BIT,this.clearColor.set(a),this.colorMask.set([!0,!0,!0,!0])),void 0!==p&&(w|=y.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(p),this.depthMask.set(!0)),y.clear(w)}setCullFace(a){!1===a.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(a.mode),this.frontFace.set(a.frontFace))}setDepthMode(a){a.func!==this.gl.ALWAYS||a.mask?(this.depthTest.set(!0),this.depthFunc.set(a.func),this.depthMask.set(a.mask),this.depthRange.set(a.range)):this.depthTest.set(!1)}setStencilMode(a){a.test.func!==this.gl.ALWAYS||a.mask?(this.stencilTest.set(!0),this.stencilMask.set(a.mask),this.stencilOp.set([a.fail,a.depthFail,a.pass]),this.stencilFunc.set({func:a.test.func,ref:a.ref,mask:a.test.mask})):this.stencilTest.set(!1)}setColorMode(a){xe(a.blendFunction,Ln.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(a.blendFunction),this.blendColor.set(a.blendColor)),this.colorMask.set(a.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class $i{constructor(a,p,y){this.func=a,this.mask=p,this.range=y}}$i.ReadOnly=!1,$i.ReadWrite=!0,$i.disabled=new $i(519,$i.ReadOnly,[0,1]);class Qt{constructor(a,p,y,w,S,R){this.test=a,this.ref=p,this.mask=y,this.fail=w,this.depthFail=S,this.pass=R}}Qt.disabled=new Qt({func:519,mask:0},0,0,7680,7680,7680);class Bn{constructor(a,p,y){this.enable=a,this.mode=p,this.frontFace=y}}let Ba;function fu(b,a,p,y,w,S,R){const F=b.context,N=F.gl,j=b.useProgram("collisionBox"),q=[];let X=0,te=0;for(let Se=0;Se<y.length;Se++){const Je=y[Se],Ye=a.getTile(Je),Ge=Ye.getBucket(p);if(!Ge)continue;let ht=Je.posMatrix;0===w[0]&&0===w[1]||(ht=b.translatePosMatrix(Je.posMatrix,Ye,w,S));const mt=R?Ge.textCollisionBox:Ge.iconCollisionBox,ot=Ge.collisionCircleArray;if(ot.length>0){const Zt=x.create(),St=ht;x.mul(Zt,Ge.placementInvProjMatrix,b.transform.glCoordMatrix),x.mul(Zt,Zt,Ge.placementViewportMatrix),q.push({circleArray:ot,circleOffset:te,transform:St,invTransform:Zt}),X+=ot.length/4,te=X}mt&&j.draw(F,N.LINES,$i.disabled,Qt.disabled,b.colorModeForRenderPass(),Bn.disabled,Pa(ht,b.transform,Ye),p.id,mt.layoutVertexBuffer,mt.indexBuffer,mt.segments,null,b.transform.zoom,null,null,mt.collisionVertexBuffer)}if(!R||!q.length)return;const ce=b.useProgram("collisionCircle"),oe=new x.CollisionCircleLayoutArray;oe.resize(4*X),oe._trim();let he=0;for(const Se of q)for(let Je=0;Je<Se.circleArray.length/4;Je++){const Ye=4*Je,Ge=Se.circleArray[Ye+0],ht=Se.circleArray[Ye+1],mt=Se.circleArray[Ye+2],ot=Se.circleArray[Ye+3];oe.emplace(he++,Ge,ht,mt,ot,0),oe.emplace(he++,Ge,ht,mt,ot,1),oe.emplace(he++,Ge,ht,mt,ot,2),oe.emplace(he++,Ge,ht,mt,ot,3)}(!Ba||Ba.length<2*X)&&(Ba=function(Se){const Je=2*Se,Ye=new x.QuadTriangleArray;Ye.resize(Je),Ye._trim();for(let Ge=0;Ge<Je;Ge++){const ht=6*Ge;Ye.uint16[ht+0]=4*Ge+0,Ye.uint16[ht+1]=4*Ge+1,Ye.uint16[ht+2]=4*Ge+2,Ye.uint16[ht+3]=4*Ge+2,Ye.uint16[ht+4]=4*Ge+3,Ye.uint16[ht+5]=4*Ge+0}return Ye}(X));const Ce=F.createIndexBuffer(Ba,!0),De=F.createVertexBuffer(oe,x.collisionCircleLayout.members,!0);for(const Se of q){const Je={u_matrix:Se.transform,u_inv_matrix:Se.invTransform,u_camera_to_center_distance:(Ne=b.transform).cameraToCenterDistance,u_viewport_size:[Ne.width,Ne.height]};ce.draw(F,N.TRIANGLES,$i.disabled,Qt.disabled,b.colorModeForRenderPass(),Bn.disabled,Je,p.id,De,Ce,x.SegmentVector.simpleSegment(0,2*Se.circleOffset,Se.circleArray.length,Se.circleArray.length/2),null,b.transform.zoom,null,null,null)}var Ne;De.destroy(),Ce.destroy()}Bn.disabled=new Bn(!1,1029,2305),Bn.backCCW=new Bn(!0,1029,2305);const mu=x.identity(new Float32Array(16));function Sl(b,a,p,y,w,S){const{horizontalAlign:R,verticalAlign:F}=x.getAnchorAlignment(b),N=-(R-.5)*a,j=-(F-.5)*p,q=x.evaluateVariableOffset(b,y);return new x.pointGeometry((N/w+q[0])*S,(j/w+q[1])*S)}function fc(b,a,p,y,w,S,R,F,N,j,q){const X=b.text.placedSymbolArray,te=b.text.dynamicLayoutVertexArray,ce=b.icon.dynamicLayoutVertexArray,oe={};te.clear();for(let he=0;he<X.length;he++){const Ce=X.get(he),De=b.allowVerticalPlacement&&!Ce.placedOrientation,Ne=Ce.hidden||!Ce.crossTileID||De?null:y[Ce.crossTileID];if(Ne){const Se=new x.pointGeometry(Ce.anchorX,Ce.anchorY),Je=ft(Se,p?F:R),Ye=vi(S.cameraToCenterDistance,Je.signedDistanceFromCamera);let Ge=w.evaluateSizeForFeature(b.textSizeData,j,Ce)*Ye/x.ONE_EM;p&&(Ge*=b.tilePixelRatio/N);const{width:ht,height:mt,anchor:ot,textOffset:Zt,textBoxScale:St}=Ne,oi=Sl(ot,ht,mt,Zt,St,Ge),Zi=p?ft(Se.add(oi),R).point:Je.point.add(a?oi.rotate(-S.angle):oi),mi=b.allowVerticalPlacement&&Ce.placedOrientation===x.WritingMode.vertical?Math.PI/2:0;for(let Ii=0;Ii<Ce.numGlyphs;Ii++)x.addDynamicAttributes(te,Zi,mi);q&&Ce.associatedIconIndex>=0&&(oe[Ce.associatedIconIndex]={shiftedAnchor:Zi,angle:mi})}else Wi(Ce.numGlyphs,te)}if(q){ce.clear();const he=b.icon.placedSymbolArray;for(let Ce=0;Ce<he.length;Ce++){const De=he.get(Ce);if(De.hidden)Wi(De.numGlyphs,ce);else{const Ne=oe[Ce];if(Ne)for(let Se=0;Se<De.numGlyphs;Se++)x.addDynamicAttributes(ce,Ne.shiftedAnchor,Ne.angle);else Wi(De.numGlyphs,ce)}}b.icon.dynamicLayoutVertexBuffer.updateData(ce)}b.text.dynamicLayoutVertexBuffer.updateData(te)}function gu(b,a,p){return p.iconsInText&&a?"symbolTextAndIcon":b?"symbolSDF":"symbolIcon"}function dt(b,a,p,y,w,S,R,F,N,j,q,X){const te=b.context,ce=te.gl,oe=b.transform,he="map"===F,Ce="map"===N,De=he&&"point"!==p.layout.get("symbol-placement"),Ne=he&&!Ce&&!De,Se=!p.layout.get("symbol-sort-key").isConstant();let Je=!1;const Ye=b.depthModeForSublayer(0,$i.ReadOnly),Ge=p.layout.get("text-variable-anchor"),ht=[];for(const mt of y){const ot=a.getTile(mt),Zt=ot.getBucket(p);if(!Zt)continue;const St=w?Zt.text:Zt.icon;if(!St||!St.segments.get().length)continue;const oi=St.programConfigurations.get(p.id),Zi=w||Zt.sdfIcons,mi=w?Zt.textSizeData:Zt.iconSizeData,Ii=Ce||0!==oe.pitch,wn=b.useProgram(gu(Zi,w,Zt),oi),Si=x.evaluateSizeForZoom(mi,oe.zoom);let Ni,Sn,Yr,go,ln=[0,0],_o=null;if(w){if(Sn=ot.glyphAtlasTexture,Yr=ce.LINEAR,Ni=ot.glyphAtlasTexture.size,Zt.iconsInText){ln=ot.imageAtlasTexture.size,_o=ot.imageAtlasTexture;const ks="composite"===mi.kind||"camera"===mi.kind;go=Ii||b.options.rotating||b.options.zooming||ks?ce.LINEAR:ce.NEAREST}}else{const ks=1!==p.layout.get("icon-size").constantOr(0)||Zt.iconsNeedLinear;Sn=ot.imageAtlasTexture,Yr=Zi||b.options.rotating||b.options.zooming||ks||Ii?ce.LINEAR:ce.NEAREST,Ni=ot.imageAtlasTexture.size}const dr=Dn(ot,1,b.transform.zoom),us=Vi(mt.posMatrix,Ce,he,b.transform,dr),ds=Zn(mt.posMatrix,Ce,he,b.transform,dr),Ws=Ge&&Zt.hasTextData(),fn="none"!==p.layout.get("icon-text-fit")&&Ws&&Zt.hasIconData();De&&sr(Zt,mt.posMatrix,b,w,us,ds,Ce,j);const ir=b.translatePosMatrix(mt.posMatrix,ot,S,R),Ki=De||w&&Ge||fn?mu:us,nr=b.translatePosMatrix(ds,ot,S,R,!0),Wr=Zi&&0!==p.paint.get(w?"text-halo-width":"icon-halo-width").constantOr(1);let _n;_n=Zi?Zt.iconsInText?hf(mi.kind,Si,Ne,Ce,b,ir,Ki,nr,Ni,ln):zh(mi.kind,Si,Ne,Ce,b,ir,Ki,nr,w,Ni,!0):Od(mi.kind,Si,Ne,Ce,b,ir,Ki,nr,w,Ni);const Vo={program:wn,buffers:St,uniformValues:_n,atlasTexture:Sn,atlasTextureIcon:_o,atlasInterpolation:Yr,atlasInterpolationIcon:go,isSDF:Zi,hasHalo:Wr};if(Se&&Zt.canOverlap){Je=!0;const ks=St.segments.get();for(const To of ks)ht.push({segments:new x.SegmentVector([To]),sortKey:To.sortKey,state:Vo})}else ht.push({segments:St.segments,sortKey:0,state:Vo})}Je&&ht.sort((mt,ot)=>mt.sortKey-ot.sortKey);for(const mt of ht){const ot=mt.state;if(te.activeTexture.set(ce.TEXTURE0),ot.atlasTexture.bind(ot.atlasInterpolation,ce.CLAMP_TO_EDGE),ot.atlasTextureIcon&&(te.activeTexture.set(ce.TEXTURE1),ot.atlasTextureIcon&&ot.atlasTextureIcon.bind(ot.atlasInterpolationIcon,ce.CLAMP_TO_EDGE)),ot.isSDF){const Zt=ot.uniformValues;ot.hasHalo&&(Zt.u_is_halo=1,qi(ot.buffers,mt.segments,p,b,ot.program,Ye,q,X,Zt)),Zt.u_is_halo=0}qi(ot.buffers,mt.segments,p,b,ot.program,Ye,q,X,ot.uniformValues)}}function qi(b,a,p,y,w,S,R,F,N){const j=y.context;w.draw(j,j.gl.TRIANGLES,S,R,F,Bn.disabled,N,p.id,b.layoutVertexBuffer,b.indexBuffer,a,p.paint,y.transform.zoom,b.programConfigurations.get(p.id),b.dynamicLayoutVertexBuffer,b.opacityVertexBuffer)}function Tl(b,a,p,y,w,S,R){const F=b.context.gl,N=p.paint.get("fill-pattern"),j=N&&N.constantOr(1),q=p.getCrossfadeParameters();let X,te,ce,oe,he;R?(te=j&&!p.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",X=F.LINES):(te=j?"fillPattern":"fill",X=F.TRIANGLES);for(const Ce of y){const De=a.getTile(Ce);if(j&&!De.patternsLoaded())continue;const Ne=De.getBucket(p);if(!Ne)continue;const Se=Ne.programConfigurations.get(p.id),Je=b.useProgram(te,Se);j&&(b.context.activeTexture.set(F.TEXTURE0),De.imageAtlasTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),Se.updatePaintBuffers(q));const Ye=N.constantOr(null);if(Ye&&De.imageAtlas){const ht=De.imageAtlas,mt=ht.patternPositions[Ye.to.toString()],ot=ht.patternPositions[Ye.from.toString()];mt&&ot&&Se.setConstantPatternPositions(mt,ot)}const Ge=b.translatePosMatrix(Ce.posMatrix,De,p.paint.get("fill-translate"),p.paint.get("fill-translate-anchor"));if(R){oe=Ne.indexBuffer2,he=Ne.segments2;const ht=[F.drawingBufferWidth,F.drawingBufferHeight];ce="fillOutlinePattern"===te&&j?ao(Ge,b,q,De,ht):Ra(Ge,ht)}else oe=Ne.indexBuffer,he=Ne.segments,ce=j?Mr(Ge,b,q,De):Bi(Ge);Je.draw(b.context,X,w,b.stencilModeForClipping(Ce),S,Bn.disabled,ce,p.id,Ne.layoutVertexBuffer,oe,he,p.paint,b.transform.zoom,Se)}}function gn(b,a,p,y,w,S,R){const F=b.context,N=F.gl,j=p.paint.get("fill-extrusion-pattern"),q=j.constantOr(1),X=p.getCrossfadeParameters(),te=p.paint.get("fill-extrusion-opacity");for(const ce of y){const oe=a.getTile(ce),he=oe.getBucket(p);if(!he)continue;const Ce=he.programConfigurations.get(p.id),De=b.useProgram(q?"fillExtrusionPattern":"fillExtrusion",Ce);q&&(b.context.activeTexture.set(N.TEXTURE0),oe.imageAtlasTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE),Ce.updatePaintBuffers(X));const Ne=j.constantOr(null);if(Ne&&oe.imageAtlas){const Ge=oe.imageAtlas,ht=Ge.patternPositions[Ne.to.toString()],mt=Ge.patternPositions[Ne.from.toString()];ht&&mt&&Ce.setConstantPatternPositions(ht,mt)}const Se=b.translatePosMatrix(ce.posMatrix,oe,p.paint.get("fill-extrusion-translate"),p.paint.get("fill-extrusion-translate-anchor")),Je=p.paint.get("fill-extrusion-vertical-gradient"),Ye=q?mn(Se,b,Je,te,ce,X,oe):pn(Se,b,Je,te);De.draw(F,F.gl.TRIANGLES,w,S,R,Bn.backCCW,Ye,p.id,he.layoutVertexBuffer,he.indexBuffer,he.segments,p.paint,b.transform.zoom,Ce)}}function po(b,a,p,y,w,S){const R=b.context,F=R.gl,N=a.fbo;if(!N)return;const j=b.useProgram("hillshade");R.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,N.colorAttachment.get());const q=((X,te,ce)=>{const oe=ce.paint.get("hillshade-shadow-color"),he=ce.paint.get("hillshade-highlight-color"),Ce=ce.paint.get("hillshade-accent-color");let De=ce.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===ce.paint.get("hillshade-illumination-anchor")&&(De-=X.transform.angle);const Ne=!X.options.moving;return{u_matrix:X.transform.calculatePosMatrix(te.tileID.toUnwrapped(),Ne),u_image:0,u_latrange:Id(0,te.tileID),u_light:[ce.paint.get("hillshade-exaggeration"),De],u_shadow:oe,u_highlight:he,u_accent:Ce}})(b,a,p);j.draw(R,F.TRIANGLES,y,w,S,Bn.disabled,q,p.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments)}function Na(b,a,p,y,w,S){const R=b.context,F=R.gl,N=a.dem;if(N&&N.data){const j=N.dim,q=N.stride,X=N.getPixels();if(R.activeTexture.set(F.TEXTURE1),R.pixelStoreUnpackPremultiplyAlpha.set(!1),a.demTexture=a.demTexture||b.getTileTexture(q),a.demTexture){const ce=a.demTexture;ce.update(X,{premultiply:!1}),ce.bind(F.NEAREST,F.CLAMP_TO_EDGE)}else a.demTexture=new nt(R,X,F.RGBA,{premultiply:!1}),a.demTexture.bind(F.NEAREST,F.CLAMP_TO_EDGE);R.activeTexture.set(F.TEXTURE0);let te=a.fbo;if(!te){const ce=new nt(R,{width:j,height:j,data:null},F.RGBA);ce.bind(F.LINEAR,F.CLAMP_TO_EDGE),te=a.fbo=R.createFramebuffer(j,j,!0),te.colorAttachment.set(ce.texture)}R.bindFramebuffer.set(te.framebuffer),R.viewport.set([0,0,j,j]),b.useProgram("hillshadePrepare").draw(R,F.TRIANGLES,y,w,S,Bn.disabled,((ce,oe)=>{const he=oe.stride,Ce=x.create();return x.ortho(Ce,0,x.EXTENT,-x.EXTENT,0,0,1),x.translate(Ce,Ce,[0,-x.EXTENT,0]),{u_matrix:Ce,u_image:1,u_dimension:[he,he],u_zoom:ce.overscaledZ,u_unpack:oe.getUnpackVector()}})(a.tileID,N),p.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments),a.needsHillshadePrepare=!1}}function Lo(b,a,p,y,w){const S=y.paint.get("raster-fade-duration");if(S>0){const R=x.exported.now(),F=(R-b.timeAdded)/S,N=a?(R-a.timeAdded)/S:-1,j=p.getSource(),q=w.coveringZoomLevel({tileSize:j.tileSize,roundZoom:j.roundZoom}),X=!a||Math.abs(a.tileID.overscaledZ-q)>Math.abs(b.tileID.overscaledZ-q),te=X&&b.refreshedUponExpiration?1:x.clamp(X?F:1-N,0,1);return b.refreshedUponExpiration&&F>=1&&(b.refreshedUponExpiration=!1),a?{opacity:1,mix:1-te}:{opacity:te,mix:0}}return{opacity:1,mix:0}}const mc=new x.Color(1,0,0,1),js=new x.Color(0,1,0,1),_u=new x.Color(0,0,1,1),gc=new x.Color(1,0,1,1),_c=new x.Color(0,1,1,1);function la(b,a,p,y){So(b,0,a+p/2,b.transform.width,p,y)}function Er(b,a,p,y){So(b,a-p/2,0,p,b.transform.height,y)}function So(b,a,p,y,w,S){const R=b.context,F=R.gl;F.enable(F.SCISSOR_TEST),F.scissor(a*b.pixelRatio,p*b.pixelRatio,y*b.pixelRatio,w*b.pixelRatio),R.clear({color:S}),F.disable(F.SCISSOR_TEST)}function Al(b,a,p){const y=b.context,w=y.gl,S=p.posMatrix,R=b.useProgram("debug"),F=$i.disabled,N=Qt.disabled,j=b.colorModeForRenderPass(),q="$debug";y.activeTexture.set(w.TEXTURE0),b.emptyTexture.bind(w.LINEAR,w.CLAMP_TO_EDGE),R.draw(y,w.LINE_STRIP,F,N,j,Bn.disabled,ac(S,x.Color.red),q,b.debugBuffer,b.tileBorderIndexBuffer,b.debugSegments);const X=a.getTileByID(p.key).latestRawTileData,te=Math.floor((X&&X.byteLength||0)/1024),ce=a.getTile(p).tileSize,oe=512/Math.min(ce,512)*(p.overscaledZ/b.transform.zoom)*.5;let he=p.canonical.toString();p.overscaledZ!==p.canonical.z&&(he+=` => ${p.overscaledZ}`),function(Ce,De){Ce.initDebugOverlayCanvas();const Ne=Ce.debugOverlayCanvas,Se=Ce.context.gl,Je=Ce.debugOverlayCanvas.getContext("2d");Je.clearRect(0,0,Ne.width,Ne.height),Je.shadowColor="white",Je.shadowBlur=2,Je.lineWidth=1.5,Je.strokeStyle="white",Je.textBaseline="top",Je.font="bold 36px Open Sans, sans-serif",Je.fillText(De,5,5),Je.strokeText(De,5,5),Ce.debugOverlayTexture.update(Ne),Ce.debugOverlayTexture.bind(Se.LINEAR,Se.CLAMP_TO_EDGE)}(b,`${he} ${te}kb`),R.draw(y,w.TRIANGLES,F,N,Ln.alphaBlended,Bn.disabled,ac(S,x.Color.transparent,oe),q,b.debugBuffer,b.quadTriangleIndexBuffer,b.debugSegments)}const Ss={symbol:function(b,a,p,y,w){if("translucent"!==b.renderPass)return;const S=Qt.disabled,R=b.colorModeForRenderPass();p.layout.get("text-variable-anchor")&&function(F,N,j,q,X,te,ce){const oe=N.transform,he="map"===X,Ce="map"===te;for(const De of F){const Ne=q.getTile(De),Se=Ne.getBucket(j);if(!Se||!Se.text||!Se.text.segments.get().length)continue;const Je=x.evaluateSizeForZoom(Se.textSizeData,oe.zoom),Ye=Dn(Ne,1,N.transform.zoom),Ge=Vi(De.posMatrix,Ce,he,N.transform,Ye),ht="none"!==j.layout.get("icon-text-fit")&&Se.hasIconData();if(Je){const mt=Math.pow(2,oe.zoom-Ne.tileID.overscaledZ);fc(Se,he,Ce,ce,x.symbolSize,oe,Ge,De.posMatrix,mt,Je,ht)}}}(y,b,p,a,p.layout.get("text-rotation-alignment"),p.layout.get("text-pitch-alignment"),w),0!==p.paint.get("icon-opacity").constantOr(1)&&dt(b,a,p,y,!1,p.paint.get("icon-translate"),p.paint.get("icon-translate-anchor"),p.layout.get("icon-rotation-alignment"),p.layout.get("icon-pitch-alignment"),p.layout.get("icon-keep-upright"),S,R),0!==p.paint.get("text-opacity").constantOr(1)&&dt(b,a,p,y,!0,p.paint.get("text-translate"),p.paint.get("text-translate-anchor"),p.layout.get("text-rotation-alignment"),p.layout.get("text-pitch-alignment"),p.layout.get("text-keep-upright"),S,R),a.map.showCollisionBoxes&&(fu(b,a,p,y,p.paint.get("text-translate"),p.paint.get("text-translate-anchor"),!0),fu(b,a,p,y,p.paint.get("icon-translate"),p.paint.get("icon-translate-anchor"),!1))},circle:function(b,a,p,y){if("translucent"!==b.renderPass)return;const w=p.paint.get("circle-opacity"),S=p.paint.get("circle-stroke-width"),R=p.paint.get("circle-stroke-opacity"),F=!p.layout.get("circle-sort-key").isConstant();if(0===w.constantOr(1)&&(0===S.constantOr(1)||0===R.constantOr(1)))return;const N=b.context,j=N.gl,q=b.depthModeForSublayer(0,$i.ReadOnly),X=Qt.disabled,te=b.colorModeForRenderPass(),ce=[];for(let oe=0;oe<y.length;oe++){const he=y[oe],Ce=a.getTile(he),De=Ce.getBucket(p);if(!De)continue;const Ne=De.programConfigurations.get(p.id),Se={programConfiguration:Ne,program:b.useProgram("circle",Ne),layoutVertexBuffer:De.layoutVertexBuffer,indexBuffer:De.indexBuffer,uniformValues:Dr(b,he,Ce,p)};if(F){const Je=De.segments.get();for(const Ye of Je)ce.push({segments:new x.SegmentVector([Ye]),sortKey:Ye.sortKey,state:Se})}else ce.push({segments:De.segments,sortKey:0,state:Se})}F&&ce.sort((oe,he)=>oe.sortKey-he.sortKey);for(const oe of ce){const{programConfiguration:he,program:Ce,layoutVertexBuffer:De,indexBuffer:Ne,uniformValues:Se}=oe.state;Ce.draw(N,j.TRIANGLES,q,X,te,Bn.disabled,Se,p.id,De,Ne,oe.segments,p.paint,b.transform.zoom,he)}},heatmap:function(b,a,p,y){if(0!==p.paint.get("heatmap-opacity"))if("offscreen"===b.renderPass){const w=b.context,S=w.gl,R=Qt.disabled,F=new Ln([S.ONE,S.ONE],x.Color.transparent,[!0,!0,!0,!0]);(function(N,j,q){const X=N.gl;N.activeTexture.set(X.TEXTURE1),N.viewport.set([0,0,j.width/4,j.height/4]);let te=q.heatmapFbo;if(te)X.bindTexture(X.TEXTURE_2D,te.colorAttachment.get()),N.bindFramebuffer.set(te.framebuffer);else{const ce=X.createTexture();X.bindTexture(X.TEXTURE_2D,ce),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_S,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_T,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MIN_FILTER,X.LINEAR),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MAG_FILTER,X.LINEAR),te=q.heatmapFbo=N.createFramebuffer(j.width/4,j.height/4,!1),function(oe,he,Ce,De){const Ne=oe.gl;Ne.texImage2D(Ne.TEXTURE_2D,0,Ne.RGBA,he.width/4,he.height/4,0,Ne.RGBA,oe.extRenderToTextureHalfFloat?oe.extTextureHalfFloat.HALF_FLOAT_OES:Ne.UNSIGNED_BYTE,null),De.colorAttachment.set(Ce)}(N,j,ce,te)}})(w,b,p),w.clear({color:x.Color.transparent});for(let N=0;N<y.length;N++){const j=y[N];if(a.hasRenderableParent(j))continue;const q=a.getTile(j),X=q.getBucket(p);if(!X)continue;const te=X.programConfigurations.get(p.id),ce=b.useProgram("heatmap",te),{zoom:oe}=b.transform;ce.draw(w,S.TRIANGLES,$i.disabled,R,F,Bn.disabled,lo(j.posMatrix,q,oe,p.paint.get("heatmap-intensity")),p.id,X.layoutVertexBuffer,X.indexBuffer,X.segments,p.paint,b.transform.zoom,te)}w.viewport.set([0,0,b.width,b.height])}else"translucent"===b.renderPass&&(b.context.setColorMode(b.colorModeForRenderPass()),function(w,S){const R=w.context,F=R.gl,N=S.heatmapFbo;if(!N)return;R.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,N.colorAttachment.get()),R.activeTexture.set(F.TEXTURE1);let j=S.colorRampTexture;j||(j=S.colorRampTexture=new nt(R,S.colorRamp,F.RGBA)),j.bind(F.LINEAR,F.CLAMP_TO_EDGE),w.useProgram("heatmapTexture").draw(R,F.TRIANGLES,$i.disabled,Qt.disabled,w.colorModeForRenderPass(),Bn.disabled,((q,X,te,ce)=>{const oe=x.create();x.ortho(oe,0,q.width,q.height,0,0,1);const he=q.context.gl;return{u_matrix:oe,u_world:[he.drawingBufferWidth,he.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:X.paint.get("heatmap-opacity")}})(w,S),S.id,w.viewportBuffer,w.quadTriangleIndexBuffer,w.viewportSegments,S.paint,w.transform.zoom)}(b,p))},line:function(b,a,p,y){if("translucent"!==b.renderPass)return;const w=p.paint.get("line-opacity"),S=p.paint.get("line-width");if(0===w.constantOr(1)||0===S.constantOr(1))return;const R=b.depthModeForSublayer(0,$i.ReadOnly),F=b.colorModeForRenderPass(),N=p.paint.get("line-dasharray"),j=p.paint.get("line-pattern"),q=j.constantOr(1),X=p.paint.get("line-gradient"),te=p.getCrossfadeParameters(),ce=q?"linePattern":N?"lineSDF":X?"lineGradient":"line",oe=b.context,he=oe.gl;let Ce=!0;for(const De of y){const Ne=a.getTile(De);if(q&&!Ne.patternsLoaded())continue;const Se=Ne.getBucket(p);if(!Se)continue;const Je=Se.programConfigurations.get(p.id),Ye=b.context.program.get(),Ge=b.useProgram(ce,Je),ht=Ce||Ge.program!==Ye,mt=j.constantOr(null);if(mt&&Ne.imageAtlas){const Zt=Ne.imageAtlas,St=Zt.patternPositions[mt.to.toString()],oi=Zt.patternPositions[mt.from.toString()];St&&oi&&Je.setConstantPatternPositions(St,oi)}const ot=q?lr(b,Ne,p,te):N?uc(b,Ne,p,N,te):X?cc(b,Ne,p,Se.lineClipsArray.length):bl(b,Ne,p);if(q)oe.activeTexture.set(he.TEXTURE0),Ne.imageAtlasTexture.bind(he.LINEAR,he.CLAMP_TO_EDGE),Je.updatePaintBuffers(te);else if(N&&(ht||b.lineAtlas.dirty))oe.activeTexture.set(he.TEXTURE0),b.lineAtlas.bind(oe);else if(X){const Zt=Se.gradients[p.id];let St=Zt.texture;if(p.gradientVersion!==Zt.version){let oi=256;if(p.stepInterpolant){const Zi=a.getSource().maxzoom,mi=De.canonical.z===Zi?Math.ceil(1<<b.transform.maxZoom-De.canonical.z):1;oi=x.clamp(x.nextPowerOfTwo(Se.maxLineLength/x.EXTENT*1024*mi),256,oe.maxTextureSize)}Zt.gradient=x.renderColorRamp({expression:p.gradientExpression(),evaluationKey:"lineProgress",resolution:oi,image:Zt.gradient||void 0,clips:Se.lineClipsArray}),Zt.texture?Zt.texture.update(Zt.gradient):Zt.texture=new nt(oe,Zt.gradient,he.RGBA),Zt.version=p.gradientVersion,St=Zt.texture}oe.activeTexture.set(he.TEXTURE0),St.bind(p.stepInterpolant?he.NEAREST:he.LINEAR,he.CLAMP_TO_EDGE)}Ge.draw(oe,he.TRIANGLES,R,b.stencilModeForClipping(De),F,Bn.disabled,ot,p.id,Se.layoutVertexBuffer,Se.indexBuffer,Se.segments,p.paint,b.transform.zoom,Je,Se.layoutVertexBuffer2),Ce=!1}},fill:function(b,a,p,y){const w=p.paint.get("fill-color"),S=p.paint.get("fill-opacity");if(0===S.constantOr(1))return;const R=b.colorModeForRenderPass(),F=p.paint.get("fill-pattern"),N=b.opaquePassEnabledForLayer()&&!F.constantOr(1)&&1===w.constantOr(x.Color.transparent).a&&1===S.constantOr(0)?"opaque":"translucent";if(b.renderPass===N){const j=b.depthModeForSublayer(1,"opaque"===b.renderPass?$i.ReadWrite:$i.ReadOnly);Tl(b,a,p,y,j,R,!1)}if("translucent"===b.renderPass&&p.paint.get("fill-antialias")){const j=b.depthModeForSublayer(p.getPaintProperty("fill-outline-color")?2:0,$i.ReadOnly);Tl(b,a,p,y,j,R,!0)}},"fill-extrusion":function(b,a,p,y){const w=p.paint.get("fill-extrusion-opacity");if(0!==w&&"translucent"===b.renderPass){const S=new $i(b.context.gl.LEQUAL,$i.ReadWrite,b.depthRangeFor3D);if(1!==w||p.paint.get("fill-extrusion-pattern").constantOr(1))gn(b,a,p,y,S,Qt.disabled,Ln.disabled),gn(b,a,p,y,S,b.stencilModeFor3D(),b.colorModeForRenderPass());else{const R=b.colorModeForRenderPass();gn(b,a,p,y,S,Qt.disabled,R)}}},hillshade:function(b,a,p,y){if("offscreen"!==b.renderPass&&"translucent"!==b.renderPass)return;const w=b.context,S=b.depthModeForSublayer(0,$i.ReadOnly),R=b.colorModeForRenderPass(),[F,N]="translucent"===b.renderPass?b.stencilConfigForOverlap(y):[{},y];for(const j of N){const q=a.getTile(j);q.needsHillshadePrepare&&"offscreen"===b.renderPass?Na(b,q,p,S,Qt.disabled,R):"translucent"===b.renderPass&&po(b,q,p,S,F[j.overscaledZ],R)}w.viewport.set([0,0,b.width,b.height])},raster:function(b,a,p,y){if("translucent"!==b.renderPass||0===p.paint.get("raster-opacity")||!y.length)return;const w=b.context,S=w.gl,R=a.getSource(),F=b.useProgram("raster"),N=b.colorModeForRenderPass(),[j,q]=R instanceof _i?[{},y]:b.stencilConfigForOverlap(y),X=q[q.length-1].overscaledZ,te=!b.options.moving;for(const ce of q){const oe=b.depthModeForSublayer(ce.overscaledZ-X,1===p.paint.get("raster-opacity")?$i.ReadWrite:$i.ReadOnly,S.LESS),he=a.getTile(ce),Ce=b.transform.calculatePosMatrix(ce.toUnwrapped(),te);he.registerFadeDuration(p.paint.get("raster-fade-duration"));const De=a.findLoadedParent(ce,0),Ne=Lo(he,De,a,p,b.transform);let Se,Je;const Ye="nearest"===p.paint.get("raster-resampling")?S.NEAREST:S.LINEAR;w.activeTexture.set(S.TEXTURE0),he.texture.bind(Ye,S.CLAMP_TO_EDGE,S.LINEAR_MIPMAP_NEAREST),w.activeTexture.set(S.TEXTURE1),De?(De.texture.bind(Ye,S.CLAMP_TO_EDGE,S.LINEAR_MIPMAP_NEAREST),Se=Math.pow(2,De.tileID.overscaledZ-he.tileID.overscaledZ),Je=[he.tileID.canonical.x*Se%1,he.tileID.canonical.y*Se%1]):he.texture.bind(Ye,S.CLAMP_TO_EDGE,S.LINEAR_MIPMAP_NEAREST);const Ge=Vh(Ce,Je||[0,0],Se||1,Ne,p);R instanceof _i?F.draw(w,S.TRIANGLES,oe,Qt.disabled,N,Bn.disabled,Ge,p.id,R.boundsBuffer,b.quadTriangleIndexBuffer,R.boundsSegments):F.draw(w,S.TRIANGLES,oe,j[ce.overscaledZ],N,Bn.disabled,Ge,p.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments)}},background:function(b,a,p){const y=p.paint.get("background-color"),w=p.paint.get("background-opacity");if(0===w)return;const S=b.context,R=S.gl,F=b.transform,N=F.tileSize,j=p.paint.get("background-pattern");if(b.isPatternMissing(j))return;const q=!j&&1===y.a&&1===w&&b.opaquePassEnabledForLayer()?"opaque":"translucent";if(b.renderPass!==q)return;const X=Qt.disabled,te=b.depthModeForSublayer(0,"opaque"===q?$i.ReadWrite:$i.ReadOnly),ce=b.colorModeForRenderPass(),oe=b.useProgram(j?"backgroundPattern":"background"),he=F.coveringTiles({tileSize:N});j&&(S.activeTexture.set(R.TEXTURE0),b.imageManager.bind(b.context));const Ce=p.getCrossfadeParameters();for(const De of he){const Ne=b.transform.calculatePosMatrix(De.toUnwrapped()),Se=j?Ld(Ne,w,b,j,{tileID:De,tileSize:N},Ce):Fd(Ne,w,y);oe.draw(S,R.TRIANGLES,te,X,ce,Bn.disabled,Se,p.id,b.tileExtentBuffer,b.quadTriangleIndexBuffer,b.tileExtentSegments)}},debug:function(b,a,p){for(let y=0;y<p.length;y++)Al(b,a,p[y])},custom:function(b,a,p){const y=b.context,w=p.implementation;if("offscreen"===b.renderPass){const S=w.prerender;S&&(b.setCustomLayerDefaults(),y.setColorMode(b.colorModeForRenderPass()),S.call(w,y.gl,b.transform.customLayerMatrix()),y.setDirty(),b.setBaseState())}else if("translucent"===b.renderPass){b.setCustomLayerDefaults(),y.setColorMode(b.colorModeForRenderPass()),y.setStencilMode(Qt.disabled);const S="3d"===w.renderingMode?new $i(b.context.gl.LEQUAL,$i.ReadWrite,b.depthRangeFor3D):b.depthModeForSublayer(0,$i.ReadOnly);y.setDepthMode(S),w.render(y.gl,b.transform.customLayerMatrix()),y.setDirty(),b.setBaseState(),y.bindFramebuffer.set(null)}}};class ls{constructor(a,p){this.context=new Es(a),this.transform=p,this._tileTextures={},this.setup(),this.numSublayers=Jn.maxUnderzooming+Jn.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new bi,this.gpuTimers={}}resize(a,p,y){if(this.width=a*y,this.height=p*y,this.pixelRatio=y,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const w of this.style._order)this.style._layers[w].resize()}setup(){const a=this.context,p=new x.PosArray;p.emplaceBack(0,0),p.emplaceBack(x.EXTENT,0),p.emplaceBack(0,x.EXTENT),p.emplaceBack(x.EXTENT,x.EXTENT),this.tileExtentBuffer=a.createVertexBuffer(p,tt.members),this.tileExtentSegments=x.SegmentVector.simpleSegment(0,0,4,2);const y=new x.PosArray;y.emplaceBack(0,0),y.emplaceBack(x.EXTENT,0),y.emplaceBack(0,x.EXTENT),y.emplaceBack(x.EXTENT,x.EXTENT),this.debugBuffer=a.createVertexBuffer(y,tt.members),this.debugSegments=x.SegmentVector.simpleSegment(0,0,4,5);const w=new x.RasterBoundsArray;w.emplaceBack(0,0,0,0),w.emplaceBack(x.EXTENT,0,x.EXTENT,0),w.emplaceBack(0,x.EXTENT,0,x.EXTENT),w.emplaceBack(x.EXTENT,x.EXTENT,x.EXTENT,x.EXTENT),this.rasterBoundsBuffer=a.createVertexBuffer(w,si.members),this.rasterBoundsSegments=x.SegmentVector.simpleSegment(0,0,4,2);const S=new x.PosArray;S.emplaceBack(0,0),S.emplaceBack(1,0),S.emplaceBack(0,1),S.emplaceBack(1,1),this.viewportBuffer=a.createVertexBuffer(S,tt.members),this.viewportSegments=x.SegmentVector.simpleSegment(0,0,4,2);const R=new x.LineStripIndexArray;R.emplaceBack(0),R.emplaceBack(1),R.emplaceBack(3),R.emplaceBack(2),R.emplaceBack(0),this.tileBorderIndexBuffer=a.createIndexBuffer(R);const F=new x.TriangleIndexArray;F.emplaceBack(0,1,2),F.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=a.createIndexBuffer(F),this.emptyTexture=new nt(a,{width:1,height:1,data:new Uint8Array([0,0,0,0])},a.gl.RGBA);const N=this.context.gl;this.stencilClearMode=new Qt({func:N.ALWAYS,mask:0},0,255,N.ZERO,N.ZERO,N.ZERO)}clearStencil(){const a=this.context,p=a.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const y=x.create();x.ortho(y,0,this.width,this.height,0,0,1),x.scale(y,y,[p.drawingBufferWidth,p.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(a,p.TRIANGLES,$i.disabled,this.stencilClearMode,Ln.disabled,Bn.disabled,lc(y),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(a,p){if(this.currentStencilSource===a.source||!a.isTileClipped()||!p||!p.length)return;this.currentStencilSource=a.source;const y=this.context,w=y.gl;this.nextStencilID+p.length>256&&this.clearStencil(),y.setColorMode(Ln.disabled),y.setDepthMode($i.disabled);const S=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const R of p){const F=this._tileClippingMaskIDs[R.key]=this.nextStencilID++;S.draw(y,w.TRIANGLES,$i.disabled,new Qt({func:w.ALWAYS,mask:0},F,255,w.KEEP,w.KEEP,w.REPLACE),Ln.disabled,Bn.disabled,lc(R.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const a=this.nextStencilID++,p=this.context.gl;return new Qt({func:p.NOTEQUAL,mask:255},a,255,p.KEEP,p.KEEP,p.REPLACE)}stencilModeForClipping(a){const p=this.context.gl;return new Qt({func:p.EQUAL,mask:255},this._tileClippingMaskIDs[a.key],0,p.KEEP,p.KEEP,p.REPLACE)}stencilConfigForOverlap(a){const p=this.context.gl,y=a.sort((R,F)=>F.overscaledZ-R.overscaledZ),w=y[y.length-1].overscaledZ,S=y[0].overscaledZ-w+1;if(S>1){this.currentStencilSource=void 0,this.nextStencilID+S>256&&this.clearStencil();const R={};for(let F=0;F<S;F++)R[F+w]=new Qt({func:p.GEQUAL,mask:255},F+this.nextStencilID,255,p.KEEP,p.KEEP,p.REPLACE);return this.nextStencilID+=S,[R,y]}return[{[w]:Qt.disabled},y]}colorModeForRenderPass(){const a=this.context.gl;return this._showOverdrawInspector?new Ln([a.CONSTANT_COLOR,a.ONE],new x.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?Ln.unblended:Ln.alphaBlended}depthModeForSublayer(a,p,y){if(!this.opaquePassEnabledForLayer())return $i.disabled;const w=1-((1+this.currentLayer)*this.numSublayers+a)*this.depthEpsilon;return new $i(y||this.context.gl.LEQUAL,p,[w,w])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(a,p){this.style=a,this.options=p,this.lineAtlas=a.lineAtlas,this.imageManager=a.imageManager,this.glyphManager=a.glyphManager,this.symbolFadeChange=a.placement.symbolFadeChange(x.exported.now()),this.imageManager.beginFrame();const y=this.style._order,w=this.style.sourceCaches;for(const N in w){const j=w[N];j.used&&j.prepare(this.context)}const S={},R={},F={};for(const N in w){const j=w[N];S[N]=j.getVisibleCoordinates(),R[N]=S[N].slice().reverse(),F[N]=j.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let N=0;N<y.length;N++)if(this.style._layers[y[N]].is3D()){this.opaquePassCutoff=N;break}this.renderPass="offscreen";for(const N of y){const j=this.style._layers[N];if(!j.hasOffscreenPass()||j.isHidden(this.transform.zoom))continue;const q=R[j.source];("custom"===j.type||q.length)&&this.renderLayer(this,w[j.source],j,q)}for(this.context.bindFramebuffer.set(null),this.context.clear({color:p.showOverdrawInspector?x.Color.black:x.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=p.showOverdrawInspector,this.depthRangeFor3D=[0,1-(a._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=y.length-1;this.currentLayer>=0;this.currentLayer--){const N=this.style._layers[y[this.currentLayer]],j=w[N.source],q=S[N.source];this._renderTileClippingMasks(N,q),this.renderLayer(this,j,N,q)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<y.length;this.currentLayer++){const N=this.style._layers[y[this.currentLayer]],j=w[N.source],q=("symbol"===N.type?F:R)[N.source];this._renderTileClippingMasks(N,S[N.source]),this.renderLayer(this,j,N,q)}if(this.options.showTileBoundaries){let N,j;Object.values(this.style._layers).forEach(q=>{q.source&&!q.isHidden(this.transform.zoom)&&(q.source!==(j&&j.id)&&(j=this.style.sourceCaches[q.source]),(!N||N.getSource().maxzoom<j.getSource().maxzoom)&&(N=j))}),N&&Ss.debug(this,N,N.getVisibleCoordinates())}this.options.showPadding&&function(N){const j=N.transform.padding;la(N,N.transform.height-(j.top||0),3,mc),la(N,j.bottom||0,3,js),Er(N,j.left||0,3,_u),Er(N,N.transform.width-(j.right||0),3,gc);const q=N.transform.centerPoint;var X,te,ce,oe;So(X=N,(te=q.x)-1,(ce=N.transform.height-q.y)-10,2,20,oe=_c),So(X,te-10,ce-1,20,2,oe)}(this),this.context.setDefault()}renderLayer(a,p,y,w){y.isHidden(this.transform.zoom)||("background"===y.type||"custom"===y.type||w.length)&&(this.id=y.id,this.gpuTimingStart(y),Ss[y.type](a,p,y,w,this.style.placement.variableOffsets),this.gpuTimingEnd())}gpuTimingStart(a){if(!this.options.gpuTiming)return;const p=this.context.extTimerQuery;let y=this.gpuTimers[a.id];y||(y=this.gpuTimers[a.id]={calls:0,cpuTime:0,query:p.createQueryEXT()}),y.calls++,p.beginQueryEXT(p.TIME_ELAPSED_EXT,y.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const a=this.context.extTimerQuery;a.endQueryEXT(a.TIME_ELAPSED_EXT)}collectGpuTimers(){const a=this.gpuTimers;return this.gpuTimers={},a}queryGpuTimers(a){const p={};for(const y in a){const w=a[y],S=this.context.extTimerQuery,R=S.getQueryObjectEXT(w.query,S.QUERY_RESULT_EXT)/1e6;S.deleteQueryEXT(w.query),p[y]=R}return p}translatePosMatrix(a,p,y,w,S){if(!y[0]&&!y[1])return a;const R=S?"map"===w?this.transform.angle:0:"viewport"===w?-this.transform.angle:0;if(R){const j=Math.sin(R),q=Math.cos(R);y=[y[0]*q-y[1]*j,y[0]*j+y[1]*q]}const F=yt(S?y[0]:Dn(p,y[0],this.transform.zoom),S?y[1]:Dn(p,y[1],this.transform.zoom),0),N=new Float32Array(16);return x.translate(N,a,F),N}saveTileTexture(a){const p=this._tileTextures[a.size[0]];p?p.push(a):this._tileTextures[a.size[0]]=[a]}getTileTexture(a){const p=this._tileTextures[a];return p&&p.length>0?p.pop():null}isPatternMissing(a){if(!a)return!1;if(!a.from||!a.to)return!0;const p=this.imageManager.getPattern(a.from.toString()),y=this.imageManager.getPattern(a.to.toString());return!p||!y}useProgram(a,p){this.cache=this.cache||{};const y=`${a}${p?p.cacheKey:""}${this._showOverdrawInspector?"/overdraw":""}`;return this.cache[y]||(this.cache[y]=new ui(this.context,a,Ae[a],p,dc[a],this._showOverdrawInspector)),this.cache[y]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const a=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(a.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new nt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class yc{constructor(a,p){this.points=a,this.planes=p}static fromInvProjectionMatrix(a,p,y){const w=Math.pow(2,y),S=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(F=>x.transformMat4([],F,a)).map(F=>x.scale$1([],F,1/F[3]/p*w)),R=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(F=>{const N=function(te,ce){var oe=ce[0],he=ce[1],Ce=ce[2],De=oe*oe+he*he+Ce*Ce;return De>0&&(De=1/Math.sqrt(De)),te[0]=ce[0]*De,te[1]=ce[1]*De,te[2]=ce[2]*De,te}([],(te=[],ce=vt([],S[F[0]],S[F[1]]),oe=vt([],S[F[2]],S[F[1]]),he=ce[0],Ne=oe[0],te[0]=(Ce=ce[1])*(Je=oe[2])-(De=ce[2])*(Se=oe[1]),te[1]=De*Ne-he*Je,te[2]=he*Se-Ce*Ne,te)),j=-((q=N)[0]*(X=S[F[1]])[0]+q[1]*X[1]+q[2]*X[2]);var te,ce,oe,he,Ce,De,Ne,Se,Je,q,X;return N.concat(j)});return new yc(S,R)}}class ca{constructor(a,p){var y,w,S;this.min=a,this.max=p,this.center=function(y,w,S){return y[0]=.5*w[0],y[1]=.5*w[1],y[2]=.5*w[2],y}([],((y=[])[0]=(w=this.min)[0]+(S=this.max)[0],y[1]=w[1]+S[1],y[2]=w[2]+S[2],y))}quadrant(a){const p=[a%2==0,a<2],y=Be(this.min),w=Be(this.max);for(let S=0;S<p.length;S++)y[S]=p[S]?this.min[S]:this.center[S],w[S]=p[S]?this.center[S]:this.max[S];return w[2]=this.max[2],new ca(y,w)}distanceX(a){return Math.max(Math.min(this.max[0],a[0]),this.min[0])-a[0]}distanceY(a){return Math.max(Math.min(this.max[1],a[1]),this.min[1])-a[1]}intersects(a){const p=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]];let y=!0;for(let w=0;w<a.planes.length;w++){const S=a.planes[w];let R=0;for(let F=0;F<p.length;F++)x.dot(S,p[F])>=0&&R++;if(0===R)return 0;R!==p.length&&(y=!1)}if(y)return 2;for(let w=0;w<3;w++){let S=Number.MAX_VALUE,R=-Number.MAX_VALUE;for(let F=0;F<a.points.length;F++){const N=a.points[F][w]-this.min[w];S=Math.min(S,N),R=Math.max(R,N)}if(R<0||S>this.max[w]-this.min[w])return 0}return 1}}class Il{constructor(a=0,p=0,y=0,w=0){if(isNaN(a)||a<0||isNaN(p)||p<0||isNaN(y)||y<0||isNaN(w)||w<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=a,this.bottom=p,this.left=y,this.right=w}interpolate(a,p,y){return null!=p.top&&null!=a.top&&(this.top=x.number(a.top,p.top,y)),null!=p.bottom&&null!=a.bottom&&(this.bottom=x.number(a.bottom,p.bottom,y)),null!=p.left&&null!=a.left&&(this.left=x.number(a.left,p.left,y)),null!=p.right&&null!=a.right&&(this.right=x.number(a.right,p.right,y)),this}getCenter(a,p){const y=x.clamp((this.left+a-this.right)/2,0,a),w=x.clamp((this.top+p-this.bottom)/2,0,p);return new x.pointGeometry(y,w)}equals(a){return this.top===a.top&&this.bottom===a.bottom&&this.left===a.left&&this.right===a.right}clone(){return new Il(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class vc{constructor(a,p,y,w,S){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===S||!!S,this._minZoom=a||0,this._maxZoom=p||22,this._minPitch=null==y?0:y,this._maxPitch=null==w?60:w,this.setMaxBounds(),this.width=0,this.height=0,this._center=new x.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Il,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const a=new vc(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return a.tileSize=this.tileSize,a.latRange=this.latRange,a.width=this.width,a.height=this.height,a._center=this._center,a.zoom=this.zoom,a.angle=this.angle,a._fov=this._fov,a._pitch=this._pitch,a._unmodified=this._unmodified,a._edgeInsets=this._edgeInsets.clone(),a._calcMatrices(),a}get minZoom(){return this._minZoom}set minZoom(a){this._minZoom!==a&&(this._minZoom=a,this.zoom=Math.max(this.zoom,a))}get maxZoom(){return this._maxZoom}set maxZoom(a){this._maxZoom!==a&&(this._maxZoom=a,this.zoom=Math.min(this.zoom,a))}get minPitch(){return this._minPitch}set minPitch(a){this._minPitch!==a&&(this._minPitch=a,this.pitch=Math.max(this.pitch,a))}get maxPitch(){return this._maxPitch}set maxPitch(a){this._maxPitch!==a&&(this._maxPitch=a,this.pitch=Math.min(this.pitch,a))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(a){void 0===a?a=!0:null===a&&(a=!1),this._renderWorldCopies=a}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new x.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(a){const p=-x.wrap(a,-180,180)*Math.PI/180;var y;this.angle!==p&&(this._unmodified=!1,this.angle=p,this._calcMatrices(),this.rotationMatrix=(y=new x.ARRAY_TYPE(4),x.ARRAY_TYPE!=Float32Array&&(y[1]=0,y[2]=0),y[0]=1,y[3]=1,y),function(y,w,S){var R=w[0],F=w[1],N=w[2],j=w[3],q=Math.sin(S),X=Math.cos(S);y[0]=R*X+N*q,y[1]=F*X+j*q,y[2]=R*-q+N*X,y[3]=F*-q+j*X}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(a){const p=x.clamp(a,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==p&&(this._unmodified=!1,this._pitch=p,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(a){a=Math.max(.01,Math.min(60,a)),this._fov!==a&&(this._unmodified=!1,this._fov=a/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(a){const p=Math.min(Math.max(a,this.minZoom),this.maxZoom);this._zoom!==p&&(this._unmodified=!1,this._zoom=p,this.scale=this.zoomScale(p),this.tileZoom=Math.floor(p),this.zoomFraction=p-this.tileZoom,this._constrain(),this._calcMatrices())}get center(){return this._center}set center(a){a.lat===this._center.lat&&a.lng===this._center.lng||(this._unmodified=!1,this._center=a,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(a){this._edgeInsets.equals(a)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,a,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(a){return this._edgeInsets.equals(a)}interpolatePadding(a,p,y){this._unmodified=!1,this._edgeInsets.interpolate(a,p,y),this._constrain(),this._calcMatrices()}coveringZoomLevel(a){const p=(a.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/a.tileSize));return Math.max(0,p)}getVisibleUnwrappedCoordinates(a){const p=[new x.UnwrappedTileID(0,a)];if(this._renderWorldCopies){const y=this.pointCoordinate(new x.pointGeometry(0,0)),w=this.pointCoordinate(new x.pointGeometry(this.width,0)),S=this.pointCoordinate(new x.pointGeometry(this.width,this.height)),R=this.pointCoordinate(new x.pointGeometry(0,this.height)),F=Math.floor(Math.min(y.x,w.x,S.x,R.x)),N=Math.floor(Math.max(y.x,w.x,S.x,R.x)),j=1;for(let q=F-j;q<=N+j;q++)0!==q&&p.push(new x.UnwrappedTileID(q,a))}return p}coveringTiles(a){let p=this.coveringZoomLevel(a);const y=p;if(void 0!==a.minzoom&&p<a.minzoom)return[];void 0!==a.maxzoom&&p>a.maxzoom&&(p=a.maxzoom);const w=x.MercatorCoordinate.fromLngLat(this.center),S=Math.pow(2,p),R=[S*w.x,S*w.y,0],F=yc.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,p);let N=a.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(N=p);const j=oe=>({aabb:new ca([oe*S,0,0],[(oe+1)*S,S,0]),zoom:0,x:0,y:0,wrap:oe,fullyVisible:!1}),q=[],X=[],te=p,ce=a.reparseOverscaled?y:p;if(this._renderWorldCopies)for(let oe=1;oe<=3;oe++)q.push(j(-oe)),q.push(j(oe));for(q.push(j(0));q.length>0;){const oe=q.pop(),he=oe.x,Ce=oe.y;let De=oe.fullyVisible;if(!De){const Ge=oe.aabb.intersects(F);if(0===Ge)continue;De=2===Ge}const Ne=oe.aabb.distanceX(R),Se=oe.aabb.distanceY(R),Je=Math.max(Math.abs(Ne),Math.abs(Se)),Ye=3+(1<<te-oe.zoom)-2;if(oe.zoom===te||Je>Ye&&oe.zoom>=N)X.push({tileID:new x.OverscaledTileID(oe.zoom===te?ce:oe.zoom,oe.wrap,oe.zoom,he,Ce),distanceSq:Tt([R[0]-.5-he,R[1]-.5-Ce])});else for(let Ge=0;Ge<4;Ge++){const ht=(he<<1)+Ge%2,mt=(Ce<<1)+(Ge>>1);q.push({aabb:oe.aabb.quadrant(Ge),zoom:oe.zoom+1,x:ht,y:mt,wrap:oe.wrap,fullyVisible:De})}}return X.sort((oe,he)=>oe.distanceSq-he.distanceSq).map(oe=>oe.tileID)}resize(a,p){this.width=a,this.height=p,this.pixelsToGLUnits=[2/a,-2/p],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(a){return Math.pow(2,a)}scaleZoom(a){return Math.log(a)/Math.LN2}project(a){const p=x.clamp(a.lat,-this.maxValidLatitude,this.maxValidLatitude);return new x.pointGeometry(x.mercatorXfromLng(a.lng)*this.worldSize,x.mercatorYfromLat(p)*this.worldSize)}unproject(a){return new x.MercatorCoordinate(a.x/this.worldSize,a.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}setLocationAtPoint(a,p){const y=this.pointCoordinate(p),w=this.pointCoordinate(this.centerPoint),S=this.locationCoordinate(a),R=new x.MercatorCoordinate(S.x-(y.x-w.x),S.y-(y.y-w.y));this.center=this.coordinateLocation(R),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(a){return this.coordinatePoint(this.locationCoordinate(a))}pointLocation(a){return this.coordinateLocation(this.pointCoordinate(a))}locationCoordinate(a){return x.MercatorCoordinate.fromLngLat(a)}coordinateLocation(a){return a.toLngLat()}pointCoordinate(a){const p=[a.x,a.y,0,1],y=[a.x,a.y,1,1];x.transformMat4(p,p,this.pixelMatrixInverse),x.transformMat4(y,y,this.pixelMatrixInverse);const w=p[3],S=y[3],R=p[1]/w,F=y[1]/S,N=p[2]/w,j=y[2]/S,q=N===j?0:(0-N)/(j-N);return new x.MercatorCoordinate(x.number(p[0]/w,y[0]/S,q)/this.worldSize,x.number(R,F,q)/this.worldSize)}coordinatePoint(a){const p=[a.x*this.worldSize,a.y*this.worldSize,0,1];return x.transformMat4(p,p,this.pixelMatrix),new x.pointGeometry(p[0]/p[3],p[1]/p[3])}getBounds(){return(new x.LngLatBounds).extend(this.pointLocation(new x.pointGeometry(0,0))).extend(this.pointLocation(new x.pointGeometry(this.width,0))).extend(this.pointLocation(new x.pointGeometry(this.width,this.height))).extend(this.pointLocation(new x.pointGeometry(0,this.height)))}getMaxBounds(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new x.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}setMaxBounds(a){a?(this.lngRange=[a.getWest(),a.getEast()],this.latRange=[a.getSouth(),a.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(a,p=!1){const y=a.key,w=p?this._alignedPosMatrixCache:this._posMatrixCache;if(w[y])return w[y];const S=a.canonical,R=this.worldSize/this.zoomScale(S.z),F=S.x+Math.pow(2,S.z)*a.wrap,N=x.identity(new Float64Array(16));return x.translate(N,N,[F*R,S.y*R,0]),x.scale(N,N,[R/x.EXTENT,R/x.EXTENT,1]),x.multiply(N,p?this.alignedProjMatrix:this.projMatrix,N),w[y]=new Float32Array(N),w[y]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let a,p,y,w,S=-90,R=90,F=-180,N=180;const j=this.size,q=this._unmodified;if(this.latRange){const ce=this.latRange;S=x.mercatorYfromLat(ce[1])*this.worldSize,R=x.mercatorYfromLat(ce[0])*this.worldSize,a=R-S<j.y?j.y/(R-S):0}if(this.lngRange){const ce=this.lngRange;F=x.mercatorXfromLng(ce[0])*this.worldSize,N=x.mercatorXfromLng(ce[1])*this.worldSize,p=N-F<j.x?j.x/(N-F):0}const X=this.point,te=Math.max(p||0,a||0);if(te)return this.center=this.unproject(new x.pointGeometry(p?(N+F)/2:X.x,a?(R+S)/2:X.y)),this.zoom+=this.scaleZoom(te),this._unmodified=q,void(this._constraining=!1);if(this.latRange){const ce=X.y,oe=j.y/2;ce-oe<S&&(w=S+oe),ce+oe>R&&(w=R-oe)}if(this.lngRange){const ce=X.x,oe=j.x/2;ce-oe<F&&(y=F+oe),ce+oe>N&&(y=N-oe)}void 0===y&&void 0===w||(this.center=this.unproject(new x.pointGeometry(void 0!==y?y:X.x,void 0!==w?w:X.y))),this._unmodified=q,this._constraining=!1}_calcMatrices(){if(!this.height)return;const a=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;const p=Math.PI/2+this._pitch,y=this._fov*(.5+a.y/this.height),w=Math.sin(y)*this.cameraToCenterDistance/Math.sin(x.clamp(Math.PI-p-y,.01,Math.PI-.01)),S=this.point,R=S.x,F=S.y,N=1.01*(Math.cos(Math.PI/2-this._pitch)*w+this.cameraToCenterDistance),j=this.height/50;let q=new Float64Array(16);x.perspective(q,this._fov,this.width/this.height,j,N),q[8]=2*-a.x/this.width,q[9]=2*a.y/this.height,x.scale(q,q,[1,-1,1]),x.translate(q,q,[0,0,-this.cameraToCenterDistance]),x.rotateX(q,q,this._pitch),x.rotateZ(q,q,this.angle),x.translate(q,q,[-R,-F,0]),this.mercatorMatrix=x.scale([],q,yt(this.worldSize,this.worldSize,this.worldSize)),x.scale(q,q,yt(1,1,x.mercatorZfromAltitude(1,this.center.lat)*this.worldSize)),this.projMatrix=q,this.invProjMatrix=x.invert([],this.projMatrix);const X=this.width%2/2,te=this.height%2/2,ce=Math.cos(this.angle),oe=Math.sin(this.angle),he=R-Math.round(R)+ce*X+oe*te,Ce=F-Math.round(F)+ce*te+oe*X,De=new Float64Array(q);if(x.translate(De,De,[he>.5?he-1:he,Ce>.5?Ce-1:Ce,0]),this.alignedProjMatrix=De,q=x.create(),x.scale(q,q,[this.width/2,-this.height/2,1]),x.translate(q,q,[1,-1,0]),this.labelPlaneMatrix=q,q=x.create(),x.scale(q,q,[1,-1,1]),x.translate(q,q,[-1,-1,0]),x.scale(q,q,[2/this.width,2/this.height,1]),this.glCoordMatrix=q,this.pixelMatrix=x.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),q=x.invert(new Float64Array(16),this.pixelMatrix),!q)throw new Error("failed to invert matrix");this.pixelMatrixInverse=q,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const a=this.pointCoordinate(new x.pointGeometry(0,0)),p=x.fromValues(a.x*this.worldSize,a.y*this.worldSize,0,1);return x.transformMat4(p,p,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const a=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new x.pointGeometry(0,a))}getCameraQueryGeometry(a){const p=this.getCameraPoint();if(1===a.length)return[a[0],p];{let y=p.x,w=p.y,S=p.x,R=p.y;for(const F of a)y=Math.min(y,F.x),w=Math.min(w,F.y),S=Math.max(S,F.x),R=Math.max(R,F.y);return[new x.pointGeometry(y,w),new x.pointGeometry(S,w),new x.pointGeometry(S,R),new x.pointGeometry(y,R),new x.pointGeometry(y,w)]}}}class bc{constructor(a){this._hashName=a&&encodeURIComponent(a),x.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(p,y){let w=!1,S=null;const R=()=>{S=null,w&&(p(),S=setTimeout(R,300),w=!1)};return()=>(w=!0,S||R(),S)}(this._updateHashUnthrottled.bind(this))}addTo(a){return this._map=a,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(a){const p=this._map.getCenter(),y=Math.round(100*this._map.getZoom())/100,w=Math.ceil((y*Math.LN2+Math.log(512/360/.5))/Math.LN10),S=Math.pow(10,w),R=Math.round(p.lng*S)/S,F=Math.round(p.lat*S)/S,N=this._map.getBearing(),j=this._map.getPitch();let q="";if(q+=a?`/${R}/${F}/${y}`:`${y}/${F}/${R}`,(N||j)&&(q+="/"+Math.round(10*N)/10),j&&(q+=`/${Math.round(j)}`),this._hashName){const X=this._hashName;let te=!1;const ce=window.location.hash.slice(1).split("&").map(oe=>{const he=oe.split("=")[0];return he===X?(te=!0,`${he}=${q}`):oe}).filter(oe=>oe);return te||ce.push(`${X}=${q}`),`#${ce.join("&")}`}return`#${q}`}_getCurrentHash(){const a=window.location.hash.replace("#","");if(this._hashName){let p;return a.split("&").map(y=>y.split("=")).forEach(y=>{y[0]===this._hashName&&(p=y)}),(p&&p[1]||"").split("/")}return a.split("/")}_onHashChange(){const a=this._getCurrentHash();if(a.length>=3&&!a.some(p=>isNaN(p))){const p=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(a[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:p,pitch:+(a[4]||0)}),!0}return!1}_updateHashUnthrottled(){const a=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,a)}catch(p){}}}const Us={linearity:.3,easing:x.bezier(0,0,.3,1)},jd=x.extend({deceleration:2500,maxSpeed:1400},Us),xc=x.extend({deceleration:20,maxSpeed:1400},Us),kl=x.extend({deceleration:1e3,maxSpeed:360},Us),Ud=x.extend({deceleration:1e3,maxSpeed:90},Us);class Rl{constructor(a){this._map=a,this.clear()}clear(){this._inertiaBuffer=[]}record(a){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:x.exported.now(),settings:a})}_drainInertiaBuffer(){const a=this._inertiaBuffer,p=x.exported.now();for(;a.length>0&&p-a[0].time>160;)a.shift()}_onMoveEnd(a){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const p={zoom:0,bearing:0,pitch:0,pan:new x.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:S}of this._inertiaBuffer)p.zoom+=S.zoomDelta||0,p.bearing+=S.bearingDelta||0,p.pitch+=S.pitchDelta||0,S.panDelta&&p.pan._add(S.panDelta),S.around&&(p.around=S.around),S.pinchAround&&(p.pinchAround=S.pinchAround);const y=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,w={};if(p.pan.mag()){const S=za(p.pan.mag(),y,x.extend({},jd,a||{}));w.offset=p.pan.mult(S.amount/p.pan.mag()),w.center=this._map.transform.center,Va(w,S)}if(p.zoom){const S=za(p.zoom,y,xc);w.zoom=this._map.transform.zoom+S.amount,Va(w,S)}if(p.bearing){const S=za(p.bearing,y,kl);w.bearing=this._map.transform.bearing+x.clamp(S.amount,-179,179),Va(w,S)}if(p.pitch){const S=za(p.pitch,y,Ud);w.pitch=this._map.transform.pitch+S.amount,Va(w,S)}if(w.zoom||w.bearing){const S=void 0===p.pinchAround?p.around:p.pinchAround;w.around=S?this._map.unproject(S):this._map.getCenter()}return this.clear(),x.extend(w,{noMoveStart:!0})}}function Va(b,a){(!b.duration||b.duration<a.duration)&&(b.duration=a.duration,b.easing=a.easing)}function za(b,a,p){const{maxSpeed:y,linearity:w,deceleration:S}=p,R=x.clamp(b*w/(a/1e3),-y,y),F=Math.abs(R)/(S*w);return{easing:p.easing,duration:1e3*F,amount:R*(F/2)}}class Yn extends x.Event{constructor(a,p,y,w={}){const S=ne.mousePos(p.getCanvasContainer(),y),R=p.unproject(S);super(a,x.extend({point:S,lngLat:R,originalEvent:y},w)),this._defaultPrevented=!1,this.target=p}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class wc extends x.Event{constructor(a,p,y){const w="touchend"===a?y.changedTouches:y.touches,S=ne.touchPos(p.getCanvasContainer(),w),R=S.map(N=>p.unproject(N)),F=S.reduce((N,j,q,X)=>N.add(j.div(X.length)),new x.pointGeometry(0,0));super(a,{points:S,point:F,lngLats:R,lngLat:p.unproject(F),originalEvent:y}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Yo extends x.Event{constructor(a,p,y){super(a,{originalEvent:y}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Ts{constructor(a,p){this._map=a,this._clickTolerance=p.clickTolerance}reset(){delete this._mousedownPos}wheel(a){return this._firePreventable(new Yo(a.type,this._map,a))}mousedown(a,p){return this._mousedownPos=p,this._firePreventable(new Yn(a.type,this._map,a))}mouseup(a){this._map.fire(new Yn(a.type,this._map,a))}click(a,p){this._mousedownPos&&this._mousedownPos.dist(p)>=this._clickTolerance||this._map.fire(new Yn(a.type,this._map,a))}dblclick(a){return this._firePreventable(new Yn(a.type,this._map,a))}mouseover(a){this._map.fire(new Yn(a.type,this._map,a))}mouseout(a){this._map.fire(new Yn(a.type,this._map,a))}touchstart(a){return this._firePreventable(new wc(a.type,this._map,a))}touchmove(a){this._map.fire(new wc(a.type,this._map,a))}touchend(a){this._map.fire(new wc(a.type,this._map,a))}touchcancel(a){this._map.fire(new wc(a.type,this._map,a))}_firePreventable(a){if(this._map.fire(a),a.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ja{constructor(a){this._map=a}reset(){this._delayContextMenu=!1,delete this._contextMenuEvent}mousemove(a){this._map.fire(new Yn(a.type,this._map,a))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Yn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(a){this._delayContextMenu?this._contextMenuEvent=a:this._map.fire(new Yn(a.type,this._map,a)),this._map.listens("contextmenu")&&a.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ur{constructor(a,p){this._map=a,this._el=a.getCanvasContainer(),this._container=a.getContainer(),this._clickTolerance=p.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(a,p){this.isEnabled()&&a.shiftKey&&0===a.button&&(ne.disableDrag(),this._startPos=this._lastPos=p,this._active=!0)}mousemoveWindow(a,p){if(!this._active)return;const y=p;if(this._lastPos.equals(y)||!this._box&&y.dist(this._startPos)<this._clickTolerance)return;const w=this._startPos;this._lastPos=y,this._box||(this._box=ne.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",a));const S=Math.min(w.x,y.x),R=Math.max(w.x,y.x),F=Math.min(w.y,y.y),N=Math.max(w.y,y.y);ne.setTransform(this._box,`translate(${S}px,${F}px)`),this._box.style.width=R-S+"px",this._box.style.height=N-F+"px"}mouseupWindow(a,p){if(!this._active||0!==a.button)return;const y=this._startPos,w=p;if(this.reset(),ne.suppressClick(),y.x!==w.x||y.y!==w.y)return this._map.fire(new x.Event("boxzoomend",{originalEvent:a})),{cameraAnimation:S=>S.fitScreenCoordinates(y,w,this._map.getBearing(),{linear:!0})};this._fireEvent("boxzoomcancel",a)}keydown(a){this._active&&27===a.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",a))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(ne.remove(this._box),this._box=null),ne.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(a,p){return this._map.fire(new x.Event(a,{originalEvent:p}))}}function Bo(b,a){const p={};for(let y=0;y<b.length;y++)p[b[y].identifier]=a[y];return p}class Nn{constructor(a){this.reset(),this.numTouches=a.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(a,p,y){(this.centroid||y.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=a.timeStamp),y.length===this.numTouches&&(this.centroid=function(w){const S=new x.pointGeometry(0,0);for(const R of w)S._add(R);return S.div(w.length)}(p),this.touches=Bo(y,p)))}touchmove(a,p,y){if(this.aborted||!this.centroid)return;const w=Bo(y,p);for(const S in this.touches){const R=this.touches[S],F=w[S];(!F||F.dist(R)>30)&&(this.aborted=!0)}}touchend(a,p,y){if((!this.centroid||a.timeStamp-this.startTime>500)&&(this.aborted=!0),0===y.length){const w=!this.aborted&&this.centroid;if(this.reset(),w)return w}}}class yu{constructor(a){this.singleTap=new Nn(a),this.numTaps=a.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(a,p,y){this.singleTap.touchstart(a,p,y)}touchmove(a,p,y){this.singleTap.touchmove(a,p,y)}touchend(a,p,y){const w=this.singleTap.touchend(a,p,y);if(w){const S=a.timeStamp-this.lastTime<500,R=!this.lastTap||this.lastTap.dist(w)<30;if(S&&R||this.reset(),this.count++,this.lastTime=a.timeStamp,this.lastTap=w,this.count===this.numTaps)return this.reset(),w}}}class Gh{constructor(){this._zoomIn=new yu({numTouches:1,numTaps:2}),this._zoomOut=new yu({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(a,p,y){this._zoomIn.touchstart(a,p,y),this._zoomOut.touchstart(a,p,y)}touchmove(a,p,y){this._zoomIn.touchmove(a,p,y),this._zoomOut.touchmove(a,p,y)}touchend(a,p,y){const w=this._zoomIn.touchend(a,p,y),S=this._zoomOut.touchend(a,p,y);return w?(this._active=!0,a.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:R.getZoom()+1,around:R.unproject(w)},{originalEvent:a})}):S?(this._active=!0,a.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:R.getZoom()-1,around:R.unproject(S)},{originalEvent:a})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Pl={0:1,2:2};class Hs{constructor(a){this.reset(),this._clickTolerance=a.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(a,p){return!1}_move(a,p){return{}}mousedown(a,p){if(this._lastPoint)return;const y=ne.mouseButton(a);this._correctButton(a,y)&&(this._lastPoint=p,this._eventButton=y)}mousemoveWindow(a,p){const y=this._lastPoint;if(y)if(a.preventDefault(),function(w,S){const R=Pl[S];return void 0===w.buttons||(w.buttons&R)!==R}(a,this._eventButton))this.reset();else if(this._moved||!(p.dist(y)<this._clickTolerance))return this._moved=!0,this._lastPoint=p,this._move(y,p)}mouseupWindow(a){this._lastPoint&&ne.mouseButton(a)===this._eventButton&&(this._moved&&ne.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Gt extends Hs{mousedown(a,p){super.mousedown(a,p),this._lastPoint&&(this._active=!0)}_correctButton(a,p){return 0===p&&!a.ctrlKey}_move(a,p){return{around:p,panDelta:p.sub(a)}}}class vu extends Hs{_correctButton(a,p){return 0===p&&a.ctrlKey||2===p}_move(a,p){const y=.8*(p.x-a.x);if(y)return this._active=!0,{bearingDelta:y}}contextmenu(a){a.preventDefault()}}class Gs extends Hs{_correctButton(a,p){return 0===p&&a.ctrlKey||2===p}_move(a,p){const y=-.5*(p.y-a.y);if(y)return this._active=!0,{pitchDelta:y}}contextmenu(a){a.preventDefault()}}class ua{constructor(a){this._minTouches=1,this._clickTolerance=a.clickTolerance||1,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new x.pointGeometry(0,0)}touchstart(a,p,y){return this._calculateTransform(a,p,y)}touchmove(a,p,y){if(this._active&&!(y.length<this._minTouches))return a.preventDefault(),this._calculateTransform(a,p,y)}touchend(a,p,y){this._calculateTransform(a,p,y),this._active&&y.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(a,p,y){y.length>0&&(this._active=!0);const w=Bo(y,p),S=new x.pointGeometry(0,0),R=new x.pointGeometry(0,0);let F=0;for(const j in w){const q=w[j],X=this._touches[j];X&&(S._add(q),R._add(q.sub(X)),F++,w[j]=q)}if(this._touches=w,F<this._minTouches||!R.mag())return;const N=R.div(F);return this._sum._add(N),this._sum.mag()<this._clickTolerance?void 0:{around:S.div(F),panDelta:N}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ua{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(a){}_move(a,p,y){return{}}touchstart(a,p,y){this._firstTwoTouches||y.length<2||(this._firstTwoTouches=[y[0].identifier,y[1].identifier],this._start([p[0],p[1]]))}touchmove(a,p,y){if(!this._firstTwoTouches)return;a.preventDefault();const[w,S]=this._firstTwoTouches,R=Ft(y,p,w),F=Ft(y,p,S);if(!R||!F)return;const N=this._aroundCenter?null:R.add(F).div(2);return this._move([R,F],N,a)}touchend(a,p,y){if(!this._firstTwoTouches)return;const[w,S]=this._firstTwoTouches,R=Ft(y,p,w),F=Ft(y,p,S);R&&F||(this._active&&ne.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(a){this._enabled=!0,this._aroundCenter=!!a&&"center"===a.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ft(b,a,p){for(let y=0;y<b.length;y++)if(b[y].identifier===p)return a[y]}function Cc(b,a){return Math.log(b/a)/Math.LN2}class pf extends Ua{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(a){this._startDistance=this._distance=a[0].dist(a[1])}_move(a,p){const y=this._distance;if(this._distance=a[0].dist(a[1]),this._active||!(Math.abs(Cc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Cc(this._distance,y),pinchAround:p}}}function $s(b,a){return 180*b.angleWith(a)/Math.PI}class Ha extends Ua{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(a){this._startVector=this._vector=a[0].sub(a[1]),this._minDiameter=a[0].dist(a[1])}_move(a,p){const y=this._vector;if(this._vector=a[0].sub(a[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:$s(this._vector,y),pinchAround:p}}_isBelowThreshold(a){this._minDiameter=Math.min(this._minDiameter,a.mag());const p=25/(Math.PI*this._minDiameter)*360,y=$s(a,this._startVector);return Math.abs(y)<p}}function bu(b){return Math.abs(b.y)>Math.abs(b.x)}class $h extends Ua{reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}_start(a){this._lastPoints=a,bu(a[0].sub(a[1]))&&(this._valid=!1)}_move(a,p,y){const w=a[0].sub(this._lastPoints[0]),S=a[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(w,S,y.timeStamp),this._valid)return this._lastPoints=a,this._active=!0,{pitchDelta:(w.y+S.y)/2*-.5}}gestureBeginsVertically(a,p,y){if(void 0!==this._valid)return this._valid;const w=a.mag()>=2,S=p.mag()>=2;if(!w&&!S)return;if(!w||!S)return void 0===this._firstMove&&(this._firstMove=y),y-this._firstMove<100&&void 0;const R=a.y>0==p.y>0;return bu(a)&&bu(p)&&R}}const da={panStep:100,bearingStep:15,pitchStep:10};class xu{constructor(){const a=da;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(a){if(a.altKey||a.ctrlKey||a.metaKey)return;let p=0,y=0,w=0,S=0,R=0;switch(a.keyCode){case 61:case 107:case 171:case 187:p=1;break;case 189:case 109:case 173:p=-1;break;case 37:a.shiftKey?y=-1:(a.preventDefault(),S=-1);break;case 39:a.shiftKey?y=1:(a.preventDefault(),S=1);break;case 38:a.shiftKey?w=1:(a.preventDefault(),R=-1);break;case 40:a.shiftKey?w=-1:(a.preventDefault(),R=1);break;default:return}return this._rotationDisabled&&(y=0,w=0),{cameraAnimation:F=>{const N=F.getZoom();F.easeTo({duration:300,easeId:"keyboardHandler",easing:Mc,zoom:p?Math.round(N)+p*(a.shiftKey?2:1):N,bearing:F.getBearing()+y*this._bearingStep,pitch:F.getPitch()+w*this._pitchStep,offset:[-S*this._panStep,-R*this._panStep],center:F.getCenter()},{originalEvent:a})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Mc(b){return b*(2-b)}const wu=4.000244140625;class Cu{constructor(a,p){this._map=a,this._el=a.getCanvasContainer(),this._handler=p,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,x.bindAll(["_onTimeout"],this)}setZoomRate(a){this._defaultZoomRate=a}setWheelZoomRate(a){this._wheelZoomRate=a}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(a){this.isEnabled()||(this._enabled=!0,this._aroundCenter=a&&"center"===a.around)}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(a){if(!this.isEnabled())return;let p=a.deltaMode===WheelEvent.DOM_DELTA_LINE?40*a.deltaY:a.deltaY;const y=x.exported.now(),w=y-(this._lastWheelEventTime||0);this._lastWheelEventTime=y,0!==p&&p%wu==0?this._type="wheel":0!==p&&Math.abs(p)<4?this._type="trackpad":w>400?(this._type=null,this._lastValue=p,this._timeout=setTimeout(this._onTimeout,40,a)):this._type||(this._type=Math.abs(w*p)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,p+=this._lastValue)),a.shiftKey&&p&&(p/=4),this._type&&(this._lastWheelEvent=a,this._delta-=p,this._active||this._start(a)),a.preventDefault()}_onTimeout(a){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(a)}_start(a){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const p=ne.mousePos(this._el,a);this._around=x.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(p)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const a=this._map.transform;if(0!==this._delta){const F="wheel"===this._type&&Math.abs(this._delta)>wu?this._wheelZoomRate:this._defaultZoomRate;let N=2/(1+Math.exp(-Math.abs(this._delta*F)));this._delta<0&&0!==N&&(N=1/N);const j="number"==typeof this._targetZoom?a.zoomScale(this._targetZoom):a.scale;this._targetZoom=Math.min(a.maxZoom,Math.max(a.minZoom,a.scaleZoom(j*N))),"wheel"===this._type&&(this._startZoom=a.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const p="number"==typeof this._targetZoom?this._targetZoom:a.zoom,y=this._startZoom,w=this._easing;let S,R=!1;if("wheel"===this._type&&y&&w){const F=Math.min((x.exported.now()-this._lastWheelEventTime)/200,1),N=w(F);S=x.number(y,p,N),F<1?this._frameId||(this._frameId=!0):R=!0}else S=p,R=!0;return this._active=!0,R&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!R,zoomDelta:S-a.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(a){let p=x.ease;if(this._prevEase){const y=this._prevEase,w=(x.exported.now()-y.start)/y.duration,S=y.easing(w+.01)-y.easing(w),R=.27/Math.sqrt(S*S+1e-4)*.01,F=Math.sqrt(.0729-R*R);p=x.bezier(R,F,.25,1)}return this._prevEase={start:x.exported.now(),duration:a,easing:p},p}reset(){this._active=!1}}class Hd{constructor(a,p){this._clickZoom=a,this._tapZoom=p}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class En{constructor(){this.reset()}reset(){this._active=!1}dblclick(a,p){return a.preventDefault(),{cameraAnimation:y=>{y.easeTo({duration:300,zoom:y.getZoom()+(a.shiftKey?-1:1),around:y.unproject(p)},{originalEvent:a})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class an{constructor(){this._tap=new yu({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(a,p,y){this._swipePoint||(this._tapTime&&a.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?y.length>0&&(this._swipePoint=p[0],this._swipeTouch=y[0].identifier):this._tap.touchstart(a,p,y))}touchmove(a,p,y){if(this._tapTime){if(this._swipePoint){if(y[0].identifier!==this._swipeTouch)return;const w=p[0],S=w.y-this._swipePoint.y;return this._swipePoint=w,a.preventDefault(),this._active=!0,{zoomDelta:S/128}}}else this._tap.touchmove(a,p,y)}touchend(a,p,y){this._tapTime?this._swipePoint&&0===y.length&&this.reset():this._tap.touchend(a,p,y)&&(this._tapTime=a.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zi{constructor(a,p,y){this._el=a,this._mousePan=p,this._touchPan=y}enable(a){this._inertiaOptions=a||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class As{constructor(a,p,y){this._pitchWithRotate=a.pitchWithRotate,this._mouseRotate=p,this._mousePitch=y}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Ol{constructor(a,p,y,w){this._el=a,this._touchZoom=p,this._touchRotate=y,this._tapDragZoom=w,this._rotationDisabled=!1,this._enabled=!0}enable(a){this._touchZoom.enable(a),this._rotationDisabled||this._touchRotate.enable(a),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const zt=b=>b.zoom||b.drag||b.pitch||b.rotate;class Ei extends x.Event{}function tr(b){return b.panDelta&&b.panDelta.mag()||b.zoomDelta||b.bearingDelta||b.pitchDelta}class Jt{constructor(a,p){this._map=a,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Rl(a),this._bearingSnap=p.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(p),x.bindAll(["handleEvent","handleWindowEvent"],this);const y=this._el;this._listeners=[[y,"touchstart",{passive:!0}],[y,"touchmove",{passive:!1}],[y,"touchend",void 0],[y,"touchcancel",void 0],[y,"mousedown",void 0],[y,"mousemove",void 0],[y,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[y,"mouseover",void 0],[y,"mouseout",void 0],[y,"dblclick",void 0],[y,"click",void 0],[y,"keydown",{capture:!1}],[y,"keyup",void 0],[y,"wheel",{passive:!1}],[y,"contextmenu",void 0],[window,"blur",void 0]];for(const[w,S,R]of this._listeners)ne.addEventListener(w,S,w===document?this.handleWindowEvent:this.handleEvent,R)}destroy(){for(const[a,p,y]of this._listeners)ne.removeEventListener(a,p,a===document?this.handleWindowEvent:this.handleEvent,y)}_addDefaultHandlers(a){const p=this._map,y=p.getCanvasContainer();this._add("mapEvent",new Ts(p,a));const w=p.boxZoom=new ur(p,a);this._add("boxZoom",w);const S=new Gh,R=new En;p.doubleClickZoom=new Hd(R,S),this._add("tapZoom",S),this._add("clickZoom",R);const F=new an;this._add("tapDragZoom",F);const N=p.touchPitch=new $h;this._add("touchPitch",N);const j=new vu(a),q=new Gs(a);p.dragRotate=new As(a,j,q),this._add("mouseRotate",j,["mousePitch"]),this._add("mousePitch",q,["mouseRotate"]);const X=new Gt(a),te=new ua(a);p.dragPan=new zi(y,X,te),this._add("mousePan",X),this._add("touchPan",te,["touchZoom","touchRotate"]);const ce=new Ha,oe=new pf;p.touchZoomRotate=new Ol(y,oe,ce,F),this._add("touchRotate",ce,["touchPan","touchZoom"]),this._add("touchZoom",oe,["touchPan","touchRotate"]);const he=p.scrollZoom=new Cu(p,this);this._add("scrollZoom",he,["mousePan"]);const Ce=p.keyboard=new xu;this._add("keyboard",Ce),this._add("blockableMapEvent",new ja(p));for(const De of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])a.interactive&&a[De]&&p[De].enable(a[De])}_add(a,p,y){this._handlers.push({handlerName:a,handler:p,allowed:y}),this._handlersById[a]=p}stop(a){if(!this._updatingCamera){for(const{handler:p}of this._handlers)p.reset();this._inertia.clear(),this._fireEvents({},{},a),this._changes=[]}}isActive(){for(const{handler:a}of this._handlers)if(a.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(zt(this._eventsInProgress))||this.isZooming()}_blockedByActive(a,p,y){for(const w in a)if(w!==y&&(!p||p.indexOf(w)<0))return!0;return!1}handleWindowEvent(a){this.handleEvent(a,`${a.type}Window`)}_getMapTouches(a){const p=[];for(const y of a)this._el.contains(y.target)&&p.push(y);return p}handleEvent(a,p){if("blur"===a.type)return void this.stop(!0);this._updatingCamera=!0;const y="renderFrame"===a.type?void 0:a,w={needsRenderFrame:!1},S={},R={},F=a.touches,N=F?this._getMapTouches(F):void 0,j=N?ne.touchPos(this._el,N):ne.mousePos(this._el,a);for(const{handlerName:te,handler:ce,allowed:oe}of this._handlers){if(!ce.isEnabled())continue;let he;this._blockedByActive(R,oe,te)?ce.reset():ce[p||a.type]&&(he=ce[p||a.type](a,j,N),this.mergeHandlerResult(w,S,he,te,y),he&&he.needsRenderFrame&&this._triggerRenderFrame()),(he||ce.isActive())&&(R[te]=ce)}const q={};for(const te in this._previousActiveHandlers)R[te]||(q[te]=y);this._previousActiveHandlers=R,(Object.keys(q).length||tr(w))&&(this._changes.push([w,S,q]),this._triggerRenderFrame()),(Object.keys(R).length||tr(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:X}=w;X&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],X(this._map))}mergeHandlerResult(a,p,y,w,S){if(!y)return;x.extend(a,y);const R={handlerName:w,originalEvent:y.originalEvent||S};void 0!==y.zoomDelta&&(p.zoom=R),void 0!==y.panDelta&&(p.drag=R),void 0!==y.pitchDelta&&(p.pitch=R),void 0!==y.bearingDelta&&(p.rotate=R)}_applyChanges(){const a={},p={},y={};for(const[w,S,R]of this._changes)w.panDelta&&(a.panDelta=(a.panDelta||new x.pointGeometry(0,0))._add(w.panDelta)),w.zoomDelta&&(a.zoomDelta=(a.zoomDelta||0)+w.zoomDelta),w.bearingDelta&&(a.bearingDelta=(a.bearingDelta||0)+w.bearingDelta),w.pitchDelta&&(a.pitchDelta=(a.pitchDelta||0)+w.pitchDelta),void 0!==w.around&&(a.around=w.around),void 0!==w.pinchAround&&(a.pinchAround=w.pinchAround),w.noInertia&&(a.noInertia=w.noInertia),x.extend(p,S),x.extend(y,R);this._updateMapTransform(a,p,y),this._changes=[]}_updateMapTransform(a,p,y){const w=this._map,S=w.transform;if(!tr(a))return this._fireEvents(p,y,!0);let{panDelta:R,zoomDelta:F,bearingDelta:N,pitchDelta:j,around:q,pinchAround:X}=a;void 0!==X&&(q=X),w._stop(!0),q=q||w.transform.centerPoint;const te=S.pointLocation(R?q.sub(R):q);N&&(S.bearing+=N),j&&(S.pitch+=j),F&&(S.zoom+=F),S.setLocationAtPoint(te,q),this._map._update(),a.noInertia||this._inertia.record(a),this._fireEvents(p,y,!0)}_fireEvents(a,p,y){const w=zt(this._eventsInProgress),S=zt(a),R={};for(const q in a){const{originalEvent:X}=a[q];this._eventsInProgress[q]||(R[`${q}start`]=X),this._eventsInProgress[q]=a[q]}!w&&S&&this._fireEvent("movestart",S.originalEvent);for(const q in R)this._fireEvent(q,R[q]);S&&this._fireEvent("move",S.originalEvent);for(const q in a){const{originalEvent:X}=a[q];this._fireEvent(q,X)}const F={};let N;for(const q in this._eventsInProgress){const{handlerName:X,originalEvent:te}=this._eventsInProgress[q];this._handlersById[X].isActive()||(delete this._eventsInProgress[q],N=p[X]||te,F[`${q}end`]=N)}for(const q in F)this._fireEvent(q,F[q]);const j=zt(this._eventsInProgress);if(y&&(w||S)&&!j){this._updatingCamera=!0;const q=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),X=te=>0!==te&&-this._bearingSnap<te&&te<this._bearingSnap;q?(X(q.bearing||this._map.getBearing())&&(q.bearing=0),this._map.easeTo(q,{originalEvent:N})):(this._map.fire(new x.Event("moveend",{originalEvent:N})),X(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(a,p){this._map.fire(new x.Event(a,p?{originalEvent:p}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(a=>{delete this._frameId,this.handleEvent(new Ei("renderFrame",{timeStamp:a})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const Fl={extend:(b,...a)=>x.extend(b,...a),run(b){b()},logToElement(b,a=!1,p="log"){const y=window.document.getElementById(p);y&&(a&&(y.innerHTML=""),y.innerHTML+=`<br>${b}`)}};class Wo extends x.Evented{constructor(a,p){super(),this._moving=!1,this._zooming=!1,this.transform=a,this._bearingSnap=p.bearingSnap,x.bindAll(["_renderFrameCallback"],this)}getCenter(){return new x.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(a,p){return this.jumpTo({center:a},p)}panBy(a,p,y){return a=x.pointGeometry.convert(a).mult(-1),this.panTo(this.transform.center,x.extend({offset:a},p),y)}panTo(a,p,y){return this.easeTo(x.extend({center:a},p),y)}getZoom(){return this.transform.zoom}setZoom(a,p){return this.jumpTo({zoom:a},p),this}zoomTo(a,p,y){return this.easeTo(x.extend({zoom:a},p),y)}zoomIn(a,p){return this.zoomTo(this.getZoom()+1,a,p),this}zoomOut(a,p){return this.zoomTo(this.getZoom()-1,a,p),this}getBearing(){return this.transform.bearing}setBearing(a,p){return this.jumpTo({bearing:a},p),this}getPadding(){return this.transform.padding}setPadding(a,p){return this.jumpTo({padding:a},p),this}rotateTo(a,p,y){return this.easeTo(x.extend({bearing:a},p),y)}resetNorth(a,p){return this.rotateTo(0,x.extend({duration:1e3},a),p),this}resetNorthPitch(a,p){return this.easeTo(x.extend({bearing:0,pitch:0,duration:1e3},a),p),this}snapToNorth(a,p){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(a,p):this}getPitch(){return this.transform.pitch}setPitch(a,p){return this.jumpTo({pitch:a},p),this}cameraForBounds(a,p){a=x.LngLatBounds.convert(a);const y=p&&p.bearing||0;return this._cameraForBoxAndBearing(a.getNorthWest(),a.getSouthEast(),y,p)}_cameraForBoxAndBearing(a,p,y,w){const S={top:0,bottom:0,right:0,left:0};if("number"==typeof(w=x.extend({padding:S,offset:[0,0],maxZoom:this.transform.maxZoom},w)).padding){const Ye=w.padding;w.padding={top:Ye,bottom:Ye,right:Ye,left:Ye}}w.padding=x.extend(S,w.padding);const R=this.transform,F=R.padding,N=R.project(x.LngLat.convert(a)),j=R.project(x.LngLat.convert(p)),q=N.rotate(-y*Math.PI/180),X=j.rotate(-y*Math.PI/180),te=new x.pointGeometry(Math.max(q.x,X.x),Math.max(q.y,X.y)),ce=new x.pointGeometry(Math.min(q.x,X.x),Math.min(q.y,X.y)),oe=te.sub(ce),he=(R.width-(F.left+F.right+w.padding.left+w.padding.right))/oe.x,Ce=(R.height-(F.top+F.bottom+w.padding.top+w.padding.bottom))/oe.y;if(Ce<0||he<0)return void x.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const De=Math.min(R.scaleZoom(R.scale*Math.min(he,Ce)),w.maxZoom),Ne=x.pointGeometry.convert(w.offset),Se=new x.pointGeometry((w.padding.left-w.padding.right)/2,(w.padding.top-w.padding.bottom)/2).rotate(y*Math.PI/180),Je=Ne.add(Se).mult(R.scale/R.zoomScale(De));return{center:R.unproject(N.add(j).div(2).sub(Je)),zoom:De,bearing:y}}fitBounds(a,p,y){return this._fitInternal(this.cameraForBounds(a,p),p,y)}fitScreenCoordinates(a,p,y,w,S){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(x.pointGeometry.convert(a)),this.transform.pointLocation(x.pointGeometry.convert(p)),y,w),w,S)}_fitInternal(a,p,y){return a?(delete(p=x.extend(a,p)).padding,p.linear?this.easeTo(p,y):this.flyTo(p,y)):this}jumpTo(a,p){this.stop();const y=this.transform;let w=!1,S=!1,R=!1;return"zoom"in a&&y.zoom!==+a.zoom&&(w=!0,y.zoom=+a.zoom),void 0!==a.center&&(y.center=x.LngLat.convert(a.center)),"bearing"in a&&y.bearing!==+a.bearing&&(S=!0,y.bearing=+a.bearing),"pitch"in a&&y.pitch!==+a.pitch&&(R=!0,y.pitch=+a.pitch),null==a.padding||y.isPaddingEqual(a.padding)||(y.padding=a.padding),this.fire(new x.Event("movestart",p)).fire(new x.Event("move",p)),w&&this.fire(new x.Event("zoomstart",p)).fire(new x.Event("zoom",p)).fire(new x.Event("zoomend",p)),S&&this.fire(new x.Event("rotatestart",p)).fire(new x.Event("rotate",p)).fire(new x.Event("rotateend",p)),R&&this.fire(new x.Event("pitchstart",p)).fire(new x.Event("pitch",p)).fire(new x.Event("pitchend",p)),this.fire(new x.Event("moveend",p))}easeTo(a,p){this._stop(!1,a.easeId),(!1===(a=x.extend({offset:[0,0],duration:500,easing:x.ease},a)).animate||!a.essential&&x.exported.prefersReducedMotion)&&(a.duration=0);const y=this.transform,w=this.getZoom(),S=this.getBearing(),R=this.getPitch(),F=this.getPadding(),N="zoom"in a?+a.zoom:w,j="bearing"in a?this._normalizeBearing(a.bearing,S):S,q="pitch"in a?+a.pitch:R,X="padding"in a?a.padding:y.padding,te=x.pointGeometry.convert(a.offset);let ce=y.centerPoint.add(te);const oe=y.pointLocation(ce),he=x.LngLat.convert(a.center||oe);this._normalizeCenter(he);const Ce=y.project(oe),De=y.project(he).sub(Ce),Ne=y.zoomScale(N-w);let Se,Je;a.around&&(Se=x.LngLat.convert(a.around),Je=y.locationPoint(Se));const Ye={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||N!==w,this._rotating=this._rotating||S!==j,this._pitching=this._pitching||q!==R,this._padding=!y.isPaddingEqual(X),this._easeId=a.easeId,this._prepareEase(p,a.noMoveStart,Ye),this._ease(Ge=>{if(this._zooming&&(y.zoom=x.number(w,N,Ge)),this._rotating&&(y.bearing=x.number(S,j,Ge)),this._pitching&&(y.pitch=x.number(R,q,Ge)),this._padding&&(y.interpolatePadding(F,X,Ge),ce=y.centerPoint.add(te)),Se)y.setLocationAtPoint(Se,Je);else{const ht=y.zoomScale(y.zoom-w),mt=N>w?Math.min(2,Ne):Math.max(.5,Ne),ot=Math.pow(mt,1-Ge),Zt=y.unproject(Ce.add(De.mult(Ge*ot)).mult(ht));y.setLocationAtPoint(y.renderWorldCopies?Zt.wrap():Zt,ce)}this._fireMoveEvents(p)},Ge=>{this._afterEase(p,Ge)},a),this}_prepareEase(a,p,y={}){this._moving=!0,p||y.moving||this.fire(new x.Event("movestart",a)),this._zooming&&!y.zooming&&this.fire(new x.Event("zoomstart",a)),this._rotating&&!y.rotating&&this.fire(new x.Event("rotatestart",a)),this._pitching&&!y.pitching&&this.fire(new x.Event("pitchstart",a))}_fireMoveEvents(a){this.fire(new x.Event("move",a)),this._zooming&&this.fire(new x.Event("zoom",a)),this._rotating&&this.fire(new x.Event("rotate",a)),this._pitching&&this.fire(new x.Event("pitch",a))}_afterEase(a,p){if(this._easeId&&p&&this._easeId===p)return;delete this._easeId;const y=this._zooming,w=this._rotating,S=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,y&&this.fire(new x.Event("zoomend",a)),w&&this.fire(new x.Event("rotateend",a)),S&&this.fire(new x.Event("pitchend",a)),this.fire(new x.Event("moveend",a))}flyTo(a,p){if(!a.essential&&x.exported.prefersReducedMotion){const Ii=x.pick(a,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ii,p)}this.stop(),a=x.extend({offset:[0,0],speed:1.2,curve:1.42,easing:x.ease},a);const y=this.transform,w=this.getZoom(),S=this.getBearing(),R=this.getPitch(),F=this.getPadding(),N="zoom"in a?x.clamp(+a.zoom,y.minZoom,y.maxZoom):w,j="bearing"in a?this._normalizeBearing(a.bearing,S):S,q="pitch"in a?+a.pitch:R,X="padding"in a?a.padding:y.padding,te=y.zoomScale(N-w),ce=x.pointGeometry.convert(a.offset);let oe=y.centerPoint.add(ce);const he=y.pointLocation(oe),Ce=x.LngLat.convert(a.center||he);this._normalizeCenter(Ce);const De=y.project(he),Ne=y.project(Ce).sub(De);let Se=a.curve;const Je=Math.max(y.width,y.height),Ye=Je/te,Ge=Ne.mag();if("minZoom"in a){const Ii=x.clamp(Math.min(a.minZoom,w,N),y.minZoom,y.maxZoom),wn=Je/y.zoomScale(Ii-w);Se=Math.sqrt(wn/Ge*2)}const ht=Se*Se;function mt(Ii){const wn=(Ye*Ye-Je*Je+(Ii?-1:1)*ht*ht*Ge*Ge)/(2*(Ii?Ye:Je)*ht*Ge);return Math.log(Math.sqrt(wn*wn+1)-wn)}function ot(Ii){return(Math.exp(Ii)-Math.exp(-Ii))/2}function Zt(Ii){return(Math.exp(Ii)+Math.exp(-Ii))/2}const St=mt(0);let oi=function(Ii){return Zt(St)/Zt(St+Se*Ii)},Zi=function(Ii){return Je*((Zt(St)*(ot(wn=St+Se*Ii)/Zt(wn))-ot(St))/ht)/Ge;var wn},mi=(mt(1)-St)/Se;if(Math.abs(Ge)<1e-6||!isFinite(mi)){if(Math.abs(Je-Ye)<1e-6)return this.easeTo(a,p);const Ii=Ye<Je?-1:1;mi=Math.abs(Math.log(Ye/Je))/Se,Zi=function(){return 0},oi=function(wn){return Math.exp(Ii*Se*wn)}}return a.duration="duration"in a?+a.duration:1e3*mi/("screenSpeed"in a?+a.screenSpeed/Se:+a.speed),a.maxDuration&&a.duration>a.maxDuration&&(a.duration=0),this._zooming=!0,this._rotating=S!==j,this._pitching=q!==R,this._padding=!y.isPaddingEqual(X),this._prepareEase(p,!1),this._ease(Ii=>{const wn=Ii*mi,Si=1/oi(wn);y.zoom=1===Ii?N:w+y.scaleZoom(Si),this._rotating&&(y.bearing=x.number(S,j,Ii)),this._pitching&&(y.pitch=x.number(R,q,Ii)),this._padding&&(y.interpolatePadding(F,X,Ii),oe=y.centerPoint.add(ce));const Ni=1===Ii?Ce:y.unproject(De.add(Ne.mult(Zi(wn))).mult(Si));y.setLocationAtPoint(y.renderWorldCopies?Ni.wrap():Ni,oe),this._fireMoveEvents(p)},()=>this._afterEase(p),a),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(a,p){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const y=this._onEaseEnd;delete this._onEaseEnd,y.call(this,p)}if(!a){const y=this.handlers;y&&y.stop(!1)}return this}_ease(a,p,y){!1===y.animate||0===y.duration?(a(1),p()):(this._easeStart=x.exported.now(),this._easeOptions=y,this._onEaseFrame=a,this._onEaseEnd=p,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const a=Math.min((x.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(a)),a<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(a,p){a=x.wrap(a,-180,180);const y=Math.abs(a-p);return Math.abs(a-360-p)<y&&(a-=360),Math.abs(a+360-p)<y&&(a+=360),a}_normalizeCenter(a){const p=this.transform;if(!p.renderWorldCopies||p.lngRange)return;const y=a.lng-p.center.lng;a.lng+=y>180?-360:y<-180?360:0}}class qh{constructor(a={}){this.options=a,x.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(a){return this._map=a,this._compact=this.options&&this.options.compact,this._container=ne.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=ne.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ne.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){ne.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(a,p){const y=this._map._getUIString(`AttributionControl.${p}`);a.title=y,a.setAttribute("aria-label",y)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}_updateData(a){!a||"metadata"!==a.sourceDataType&&"visibility"!==a.sourceDataType&&"style"!==a.dataType||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let a=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?a=a.concat(this.options.customAttribution.map(w=>"string"!=typeof w?"":w)):"string"==typeof this.options.customAttribution&&a.push(this.options.customAttribution)),this._map.style.stylesheet){const w=this._map.style.stylesheet;this.styleOwner=w.owner,this.styleId=w.id}const p=this._map.style.sourceCaches;for(const w in p){const S=p[w];if(S.used){const R=S.getSource();R.attribution&&a.indexOf(R.attribution)<0&&a.push(R.attribution)}}a=a.filter(w=>String(w).trim()),a.sort((w,S)=>w.length-S.length),a=a.filter((w,S)=>{for(let R=S+1;R<a.length;R++)if(a[R].indexOf(w)>=0)return!1;return!0});const y=a.join(" | ");y!==this._attribHTML&&(this._attribHTML=y,a.length?(this._innerContainer.innerHTML=y,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1===this._compact?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}class qs{constructor(){x.bindAll(["_updateLogo"],this),x.bindAll(["_updateCompact"],this)}onAdd(a){this._map=a,this._container=ne.create("div","maplibregl-ctrl mapboxgl-ctrl");const p=ne.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return p.target="_blank",p.rel="noopener nofollow",p.href="https://maplibre.org/",p.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),p.setAttribute("rel","noopener nofollow"),this._container.appendChild(p),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(void 0),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){ne.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(a){a&&"metadata"!==a.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return;const a=this._map.style.sourceCaches;for(const p in a)if(a[p].getSource().maplibreLogo)return!0;return!1}_updateCompact(){const a=this._container.children;if(a.length){const p=a[0];this._map.getCanvasContainer().offsetWidth<250?p.classList.add("maplibregl-compact","mapboxgl-compact"):p.classList.remove("maplibregl-compact","mapboxgl-compact")}}}class Gd{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(a){const p=++this._id;return this._queue.push({callback:a,id:p,cancelled:!1}),p}remove(a){const p=this._currentlyRunning,y=p?this._queue.concat(p):this._queue;for(const w of y)if(w.id===a)return void(w.cancelled=!0)}run(a=0){const p=this._currentlyRunning=this._queue;this._queue=[];for(const y of p)if(!y.cancelled&&(y.callback(a),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const $d={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},fo={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},Is={showCompass:!0,showZoom:!0,visualizePitch:!1};class Wt{constructor(a,p,y=!1){this._clickTolerance=10,this.element=p,this.mouseRotate=new vu({clickTolerance:a.dragRotate._mouseRotate._clickTolerance}),this.map=a,y&&(this.mousePitch=new Gs({clickTolerance:a.dragRotate._mousePitch._clickTolerance})),x.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),ne.addEventListener(p,"mousedown",this.mousedown),ne.addEventListener(p,"touchstart",this.touchstart,{passive:!1}),ne.addEventListener(p,"touchmove",this.touchmove),ne.addEventListener(p,"touchend",this.touchend),ne.addEventListener(p,"touchcancel",this.reset)}down(a,p){this.mouseRotate.mousedown(a,p),this.mousePitch&&this.mousePitch.mousedown(a,p),ne.disableDrag()}move(a,p){const y=this.map,w=this.mouseRotate.mousemoveWindow(a,p);if(w&&w.bearingDelta&&y.setBearing(y.getBearing()+w.bearingDelta),this.mousePitch){const S=this.mousePitch.mousemoveWindow(a,p);S&&S.pitchDelta&&y.setPitch(y.getPitch()+S.pitchDelta)}}off(){const a=this.element;ne.removeEventListener(a,"mousedown",this.mousedown),ne.removeEventListener(a,"touchstart",this.touchstart,{passive:!1}),ne.removeEventListener(a,"touchmove",this.touchmove),ne.removeEventListener(a,"touchend",this.touchend),ne.removeEventListener(a,"touchcancel",this.reset),this.offTemp()}offTemp(){ne.enableDrag(),ne.removeEventListener(window,"mousemove",this.mousemove),ne.removeEventListener(window,"mouseup",this.mouseup)}mousedown(a){this.down(x.extend({},a,{ctrlKey:!0,preventDefault:()=>a.preventDefault()}),ne.mousePos(this.element,a)),ne.addEventListener(window,"mousemove",this.mousemove),ne.addEventListener(window,"mouseup",this.mouseup)}mousemove(a){this.move(a,ne.mousePos(this.element,a))}mouseup(a){this.mouseRotate.mouseupWindow(a),this.mousePitch&&this.mousePitch.mouseupWindow(a),this.offTemp()}touchstart(a){1!==a.targetTouches.length?this.reset():(this._startPos=this._lastPos=ne.touchPos(this.element,a.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>a.preventDefault()},this._startPos))}touchmove(a){1!==a.targetTouches.length?this.reset():(this._lastPos=ne.touchPos(this.element,a.targetTouches)[0],this.move({preventDefault:()=>a.preventDefault()},this._lastPos))}touchend(a){0===a.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Mt(b,a,p){if(b=new x.LngLat(b.lng,b.lat),a){const y=new x.LngLat(b.lng-360,b.lat),w=new x.LngLat(b.lng+360,b.lat),S=p.locationPoint(b).distSqr(a);p.locationPoint(y).distSqr(a)<S?b=y:p.locationPoint(w).distSqr(a)<S&&(b=w)}for(;Math.abs(b.lng-p.center.lng)>180;){const y=p.locationPoint(b);if(y.x>=0&&y.y>=0&&y.x<=p.width&&y.y<=p.height)break;b.lng>p.center.lng?b.lng-=360:b.lng+=360}return b}const No={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Ys(b,a,p){const y=b.classList;for(const w in No)y.remove(`maplibregl-${p}-anchor-${w}`,`mapboxgl-${p}-anchor-${w}`);y.add(`maplibregl-${p}-anchor-${a}`,`mapboxgl-${p}-anchor-${a}`)}class Ll extends x.Evented{constructor(a,p){if(super(),(a instanceof HTMLElement||p)&&(a=x.extend({element:a},p)),x.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=a&&a.anchor||"center",this._color=a&&a.color||"#3FB1CE",this._scale=a&&a.scale||1,this._draggable=a&&a.draggable||!1,this._clickTolerance=a&&a.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=a&&a.rotation||0,this._rotationAlignment=a&&a.rotationAlignment||"auto",this._pitchAlignment=a&&a.pitchAlignment&&"auto"!==a.pitchAlignment?a.pitchAlignment:this._rotationAlignment,a&&a.element)this._element=a.element,this._offset=x.pointGeometry.convert(a&&a.offset||[0,0]);else{this._defaultMarker=!0,this._element=ne.create("div"),this._element.setAttribute("aria-label","Map marker");const y=ne.createNS("http://www.w3.org/2000/svg","svg"),w=41,S=27;y.setAttributeNS(null,"display","block"),y.setAttributeNS(null,"height",`${w}px`),y.setAttributeNS(null,"width",`${S}px`),y.setAttributeNS(null,"viewBox",`0 0 ${S} ${w}`);const R=ne.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"stroke","none"),R.setAttributeNS(null,"stroke-width","1"),R.setAttributeNS(null,"fill","none"),R.setAttributeNS(null,"fill-rule","evenodd");const F=ne.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"fill-rule","nonzero");const N=ne.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"transform","translate(3.0, 29.0)"),N.setAttributeNS(null,"fill","#000000");const j=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Ne of j){const Se=ne.createNS("http://www.w3.org/2000/svg","ellipse");Se.setAttributeNS(null,"opacity","0.04"),Se.setAttributeNS(null,"cx","10.5"),Se.setAttributeNS(null,"cy","5.80029008"),Se.setAttributeNS(null,"rx",Ne.rx),Se.setAttributeNS(null,"ry",Ne.ry),N.appendChild(Se)}const q=ne.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"fill",this._color);const X=ne.createNS("http://www.w3.org/2000/svg","path");X.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),q.appendChild(X);const te=ne.createNS("http://www.w3.org/2000/svg","g");te.setAttributeNS(null,"opacity","0.25"),te.setAttributeNS(null,"fill","#000000");const ce=ne.createNS("http://www.w3.org/2000/svg","path");ce.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),te.appendChild(ce);const oe=ne.createNS("http://www.w3.org/2000/svg","g");oe.setAttributeNS(null,"transform","translate(6.0, 7.0)"),oe.setAttributeNS(null,"fill","#FFFFFF");const he=ne.createNS("http://www.w3.org/2000/svg","g");he.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Ce=ne.createNS("http://www.w3.org/2000/svg","circle");Ce.setAttributeNS(null,"fill","#000000"),Ce.setAttributeNS(null,"opacity","0.25"),Ce.setAttributeNS(null,"cx","5.5"),Ce.setAttributeNS(null,"cy","5.5"),Ce.setAttributeNS(null,"r","5.4999962");const De=ne.createNS("http://www.w3.org/2000/svg","circle");De.setAttributeNS(null,"fill","#FFFFFF"),De.setAttributeNS(null,"cx","5.5"),De.setAttributeNS(null,"cy","5.5"),De.setAttributeNS(null,"r","5.4999962"),he.appendChild(Ce),he.appendChild(De),F.appendChild(N),F.appendChild(q),F.appendChild(te),F.appendChild(oe),F.appendChild(he),y.appendChild(F),y.setAttributeNS(null,"height",w*this._scale+"px"),y.setAttributeNS(null,"width",S*this._scale+"px"),this._element.appendChild(y),this._offset=x.pointGeometry.convert(a&&a.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",y=>{y.preventDefault()}),this._element.addEventListener("mousedown",y=>{y.preventDefault()}),Ys(this._element,this._anchor,"marker"),this._popup=null}addTo(a){return this.remove(),this._map=a,a.getCanvasContainer().appendChild(this._element),a.on("move",this._update),a.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),ne.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(a){return this._lngLat=x.LngLat.convert(a),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(a){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),a){if(!("offset"in a.options)){const w=Math.sqrt(Math.pow(13.5,2)/2);a.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[w,-1*(24.6+w)],"bottom-right":[-w,-1*(24.6+w)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=a,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(a){const p=a.code,y=a.charCode||a.keyCode;"Space"!==p&&"Enter"!==p&&32!==y&&13!==y||this.togglePopup()}_onMapClick(a){const p=a.originalEvent.target,y=this._element;this._popup&&(p===y||y.contains(p))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const a=this._popup;return a?(a.isOpen()?a.remove():a.addTo(this._map),this):this}_update(a){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=Mt(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let p="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?p=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(p=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let y="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?y="rotateX(0deg)":"map"===this._pitchAlignment&&(y=`rotateX(${this._map.getPitch()}deg)`),a&&"moveend"!==a.type||(this._pos=this._pos.round()),ne.setTransform(this._element,`${No[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${y} ${p}`)}getOffset(){return this._offset}setOffset(a){return this._offset=x.pointGeometry.convert(a),this._update(),this}_onMove(a){if(!this._isDragging){const p=this._clickTolerance||this._map._clickTolerance;this._isDragging=a.point.dist(this._pointerdownPos)>=p}this._isDragging&&(this._pos=a.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new x.Event("dragstart"))),this.fire(new x.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new x.Event("dragend")),this._state="inactive"}_addDragHandler(a){this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._pointerdownPos=a.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(a){return this._draggable=!!a,this._map&&(a?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(a){return this._rotation=a||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(a){return this._rotationAlignment=a||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(a){return this._pitchAlignment=a&&"auto"!==a?a:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const qr={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let cs,mo=0,Ga=!1;const Dc={maxWidth:100,unit:"metric"};function Vn(b,a,p){const y=p&&p.maxWidth||100,w=b._container.clientHeight/2,S=b.unproject([0,w]),R=b.unproject([y,w]),F=S.distanceTo(R);if(p&&"imperial"===p.unit){const N=3.2808*F;N>5280?xn(a,y,N/5280,b._getUIString("ScaleControl.Miles")):xn(a,y,N,b._getUIString("ScaleControl.Feet"))}else p&&"nautical"===p.unit?xn(a,y,F/1852,b._getUIString("ScaleControl.NauticalMiles")):F>=1e3?xn(a,y,F/1e3,b._getUIString("ScaleControl.Kilometers")):xn(a,y,F,b._getUIString("ScaleControl.Meters"))}function xn(b,a,p,y){const w=function(S){const R=Math.pow(10,`${Math.floor(S)}`.length-1);let F=S/R;return F=F>=10?10:F>=5?5:F>=3?3:F>=2?2:F>=1?1:function(N){const j=Math.pow(10,Math.ceil(-Math.log(N)/Math.LN10));return Math.round(N*j)/j}(F),R*F}(p);b.style.width=a*(w/p)+"px",b.innerHTML=`${w}&nbsp;${y}`}const $a={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Bl=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ec(b){if(b){if("number"==typeof b){const a=Math.round(Math.sqrt(.5*Math.pow(b,2)));return{center:new x.pointGeometry(0,0),top:new x.pointGeometry(0,b),"top-left":new x.pointGeometry(a,a),"top-right":new x.pointGeometry(-a,a),bottom:new x.pointGeometry(0,-b),"bottom-left":new x.pointGeometry(a,-a),"bottom-right":new x.pointGeometry(-a,-a),left:new x.pointGeometry(b,0),right:new x.pointGeometry(-b,0)}}if(b instanceof x.pointGeometry||Array.isArray(b)){const a=x.pointGeometry.convert(b);return{center:a,top:a,"top-left":a,"top-right":a,bottom:a,"bottom-left":a,"bottom-right":a,left:a,right:a}}return{center:x.pointGeometry.convert(b.center||[0,0]),top:x.pointGeometry.convert(b.top||[0,0]),"top-left":x.pointGeometry.convert(b["top-left"]||[0,0]),"top-right":x.pointGeometry.convert(b["top-right"]||[0,0]),bottom:x.pointGeometry.convert(b.bottom||[0,0]),"bottom-left":x.pointGeometry.convert(b["bottom-left"]||[0,0]),"bottom-right":x.pointGeometry.convert(b["bottom-right"]||[0,0]),left:x.pointGeometry.convert(b.left||[0,0]),right:x.pointGeometry.convert(b.right||[0,0])}}return Ec(new x.pointGeometry(0,0))}const qa={supported:Me,setRTLTextPlugin:x.setRTLTextPlugin,getRTLTextPluginStatus:x.getRTLTextPluginStatus,Map:class extends Wo{constructor(b){var a;if(x.PerformanceUtils.mark(x.PerformanceMarkers.create),null!=(b=x.extend({},fo,b)).minZoom&&null!=b.maxZoom&&b.minZoom>b.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=b.minPitch&&null!=b.maxPitch&&b.minPitch>b.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=b.minPitch&&b.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=b.maxPitch&&b.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new vc(b.minZoom,b.maxZoom,b.minPitch,b.maxPitch,b.renderWorldCopies),{bearingSnap:b.bearingSnap}),this._interactive=b.interactive,this._maxTileCacheSize=b.maxTileCacheSize,this._failIfMajorPerformanceCaveat=b.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=b.preserveDrawingBuffer,this._antialias=b.antialias,this._trackResize=b.trackResize,this._bearingSnap=b.bearingSnap,this._refreshExpiredTiles=b.refreshExpiredTiles,this._fadeDuration=b.fadeDuration,this._crossSourceCollisions=b.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=b.collectResourceTiming,this._renderTaskQueue=new Gd,this._controls=[],this._mapId=x.uniqueId(),this._locale=x.extend({},$d,b.locale),this._clickTolerance=b.clickTolerance,this._pixelRatio=null!==(a=b.pixelRatio)&&void 0!==a?a:devicePixelRatio,this._requestManager=new Le(b.transformRequest),"string"==typeof b.container){if(this._container=document.getElementById(b.container),!this._container)throw new Error(`Container '${b.container}' not found.`)}else{if(!(b.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=b.container}if(b.maxBounds&&this.setMaxBounds(b.maxBounds),x.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),"undefined"!=typeof window&&(addEventListener("online",this._onWindowOnline,!1),addEventListener("resize",this._onWindowResize,!1),addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Jt(this,b),this._hash=b.hash&&new bc("string"==typeof b.hash&&b.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:b.center,zoom:b.zoom,bearing:b.bearing,pitch:b.pitch}),b.bounds&&(this.resize(),this.fitBounds(b.bounds,x.extend({},b.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=b.localIdeographFontFamily,b.style&&this.setStyle(b.style,{localIdeographFontFamily:b.localIdeographFontFamily}),b.attributionControl&&this.addControl(new qh({customAttribution:b.customAttribution})),this.addControl(new qs,b.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",p=>{this._update("style"===p.dataType),this.fire(new x.Event(`${p.dataType}data`,p))}),this.on("dataloading",p=>{this.fire(new x.Event(`${p.dataType}dataloading`,p))}),this.on("dataabort",p=>{this.fire(new x.Event("sourcedataabort",p))})}_getMapId(){return this._mapId}addControl(b,a){if(void 0===a&&(a=b.getDefaultPosition?b.getDefaultPosition():"top-right"),!b||!b.onAdd)return this.fire(new x.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const p=b.onAdd(this);this._controls.push(b);const y=this._controlPositions[a];return-1!==a.indexOf("bottom")?y.insertBefore(p,y.firstChild):y.appendChild(p),this}removeControl(b){if(!b||!b.onRemove)return this.fire(new x.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const a=this._controls.indexOf(b);return a>-1&&this._controls.splice(a,1),b.onRemove(this),this}hasControl(b){return this._controls.indexOf(b)>-1}resize(b){const a=this._containerDimensions(),p=a[0],y=a[1];this._resizeCanvas(p,y,this.getPixelRatio()),this.transform.resize(p,y),this.painter.resize(p,y,this.getPixelRatio());const w=!this._moving;return w&&(this.stop(),this.fire(new x.Event("movestart",b)).fire(new x.Event("move",b))),this.fire(new x.Event("resize",b)),w&&this.fire(new x.Event("moveend",b)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(b){const[a,p]=this._containerDimensions();this._pixelRatio=b,this._resizeCanvas(a,p,b),this.painter.resize(a,p,b)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(b){return this.transform.setMaxBounds(x.LngLatBounds.convert(b)),this._update()}setMinZoom(b){if((b=null==b?-2:b)>=-2&&b<=this.transform.maxZoom)return this.transform.minZoom=b,this._update(),this.getZoom()<b&&this.setZoom(b),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(b){if((b=null==b?22:b)>=this.transform.minZoom)return this.transform.maxZoom=b,this._update(),this.getZoom()>b&&this.setZoom(b),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(b){if((b=null==b?0:b)<0)throw new Error("minPitch must be greater than or equal to 0");if(b>=0&&b<=this.transform.maxPitch)return this.transform.minPitch=b,this._update(),this.getPitch()<b&&this.setPitch(b),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(b){if((b=null==b?60:b)>85)throw new Error("maxPitch must be less than or equal to 85");if(b>=this.transform.minPitch)return this.transform.maxPitch=b,this._update(),this.getPitch()>b&&this.setPitch(b),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(b){return this.transform.renderWorldCopies=b,this._update()}project(b){return this.transform.locationPoint(x.LngLat.convert(b))}unproject(b){return this.transform.pointLocation(x.pointGeometry.convert(b))}isMoving(){return this._moving||this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers.isRotating()}_createDelegatedListener(b,a,p){if("mouseenter"===b||"mouseover"===b){let y=!1;return{layer:a,listener:p,delegates:{mousemove:S=>{const R=this.getLayer(a)?this.queryRenderedFeatures(S.point,{layers:[a]}):[];R.length?y||(y=!0,p.call(this,new Yn(b,this,S.originalEvent,{features:R}))):y=!1},mouseout:()=>{y=!1}}}}if("mouseleave"===b||"mouseout"===b){let y=!1;return{layer:a,listener:p,delegates:{mousemove:R=>{(this.getLayer(a)?this.queryRenderedFeatures(R.point,{layers:[a]}):[]).length?y=!0:y&&(y=!1,p.call(this,new Yn(b,this,R.originalEvent)))},mouseout:R=>{y&&(y=!1,p.call(this,new Yn(b,this,R.originalEvent)))}}}}{const y=w=>{const S=this.getLayer(a)?this.queryRenderedFeatures(w.point,{layers:[a]}):[];S.length&&(w.features=S,p.call(this,w),delete w.features)};return{layer:a,listener:p,delegates:{[b]:y}}}}on(b,a,p){if(void 0===p)return super.on(b,a);const y=this._createDelegatedListener(b,a,p);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[b]=this._delegatedListeners[b]||[],this._delegatedListeners[b].push(y);for(const w in y.delegates)this.on(w,y.delegates[w]);return this}once(b,a,p){if(void 0===p)return super.once(b,a);const y=this._createDelegatedListener(b,a,p);for(const w in y.delegates)this.once(w,y.delegates[w]);return this}off(b,a,p){return void 0===p?super.off(b,a):(this._delegatedListeners&&this._delegatedListeners[b]&&(y=>{const w=this._delegatedListeners[b];for(let S=0;S<w.length;S++){const R=w[S];if(R.layer===a&&R.listener===p){for(const F in R.delegates)this.off(F,R.delegates[F]);return w.splice(S,1),this}}})(),this)}queryRenderedFeatures(b,a){if(!this.style)return[];let p;if(void 0!==a||void 0===b||b instanceof x.pointGeometry||Array.isArray(b)||(a=b,b=void 0),a=a||{},(b=b||[[0,0],[this.transform.width,this.transform.height]])instanceof x.pointGeometry||"number"==typeof b[0])p=[x.pointGeometry.convert(b)];else{const y=x.pointGeometry.convert(b[0]),w=x.pointGeometry.convert(b[1]);p=[y,new x.pointGeometry(w.x,y.y),w,new x.pointGeometry(y.x,w.y),y]}return this.style.queryRenderedFeatures(p,a,this.transform)}querySourceFeatures(b,a){return this.style.querySourceFeatures(b,a)}setStyle(b,a){return!1!==(a=x.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},a)).diff&&a.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&b?(this._diffStyle(b,a),this):(this._localIdeographFontFamily=a.localIdeographFontFamily,this._updateStyle(b,a))}setTransformRequest(b){return this._requestManager.setTransformRequest(b),this}_getUIString(b){const a=this._locale[b];if(null==a)throw new Error(`Missing UI string '${b}'`);return a}_updateStyle(b,a){return this.style&&(this.style.setEventedParent(null),this.style._remove()),b?(this.style=new ue(this,a||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof b?this.style.loadURL(b):this.style.loadJSON(b),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new ue(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(b,a){if("string"==typeof b){const p=this._requestManager.transformRequest(b,x.ResourceType.Style);x.getJSON(p,(y,w)=>{y?this.fire(new x.ErrorEvent(y)):w&&this._updateDiff(w,a)})}else"object"==typeof b&&this._updateDiff(b,a)}_updateDiff(b,a){try{this.style.setState(b)&&this._update(!0)}catch(p){x.warnOnce(`Unable to perform style diff: ${p.message||p.error||p}.  Rebuilding the style from scratch.`),this._updateStyle(b,a)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():x.warnOnce("There is no style added to the map.")}addSource(b,a){return this._lazyInitEmptyStyle(),this.style.addSource(b,a),this._update(!0)}isSourceLoaded(b){const a=this.style&&this.style.sourceCaches[b];if(void 0!==a)return a.loaded();this.fire(new x.ErrorEvent(new Error(`There is no source with ID '${b}'`)))}areTilesLoaded(){const b=this.style&&this.style.sourceCaches;for(const a in b){const p=b[a]._tiles;for(const y in p){const w=p[y];if("loaded"!==w.state&&"errored"!==w.state)return!1}}return!0}addSourceType(b,a,p){return this._lazyInitEmptyStyle(),this.style.addSourceType(b,a,p)}removeSource(b){return this.style.removeSource(b),this._update(!0)}getSource(b){return this.style.getSource(b)}addImage(b,a,{pixelRatio:p=1,sdf:y=!1,stretchX:w,stretchY:S,content:R}={}){if(this._lazyInitEmptyStyle(),a instanceof HTMLImageElement||x.isImageBitmap(a)){const{width:F,height:N,data:j}=x.exported.getImageData(a);this.style.addImage(b,{data:new x.RGBAImage({width:F,height:N},j),pixelRatio:p,stretchX:w,stretchY:S,content:R,sdf:y,version:0})}else{if(void 0===a.width||void 0===a.height)return this.fire(new x.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:F,height:N,data:j}=a,q=a;this.style.addImage(b,{data:new x.RGBAImage({width:F,height:N},new Uint8Array(j)),pixelRatio:p,stretchX:w,stretchY:S,content:R,sdf:y,version:0,userImage:q}),q.onAdd&&q.onAdd(this,b)}}}updateImage(b,a){const p=this.style.getImage(b);if(!p)return this.fire(new x.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const y=a instanceof HTMLImageElement||x.isImageBitmap(a)?x.exported.getImageData(a):a,{width:w,height:S,data:R}=y;if(void 0===w||void 0===S)return this.fire(new x.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(w!==p.data.width||S!==p.data.height)return this.fire(new x.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const F=!(a instanceof HTMLImageElement||x.isImageBitmap(a));p.data.replace(R,F),this.style.updateImage(b,p)}hasImage(b){return b?!!this.style.getImage(b):(this.fire(new x.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(b){this.style.removeImage(b)}loadImage(b,a){x.getImage(this._requestManager.transformRequest(b,x.ResourceType.Image),a)}listImages(){return this.style.listImages()}addLayer(b,a){return this._lazyInitEmptyStyle(),this.style.addLayer(b,a),this._update(!0)}moveLayer(b,a){return this.style.moveLayer(b,a),this._update(!0)}removeLayer(b){return this.style.removeLayer(b),this._update(!0)}getLayer(b){return this.style.getLayer(b)}setLayerZoomRange(b,a,p){return this.style.setLayerZoomRange(b,a,p),this._update(!0)}setFilter(b,a,p={}){return this.style.setFilter(b,a,p),this._update(!0)}getFilter(b){return this.style.getFilter(b)}setPaintProperty(b,a,p,y={}){return this.style.setPaintProperty(b,a,p,y),this._update(!0)}getPaintProperty(b,a){return this.style.getPaintProperty(b,a)}setLayoutProperty(b,a,p,y={}){return this.style.setLayoutProperty(b,a,p,y),this._update(!0)}getLayoutProperty(b,a){return this.style.getLayoutProperty(b,a)}setLight(b,a={}){return this._lazyInitEmptyStyle(),this.style.setLight(b,a),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(b,a){return this.style.setFeatureState(b,a),this._update()}removeFeatureState(b,a){return this.style.removeFeatureState(b,a),this._update()}getFeatureState(b){return this.style.getFeatureState(b)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let b=0,a=0;return this._container&&(b=this._container.clientWidth||400,a=this._container.clientHeight||300),[b,a]}_setupContainer(){const b=this._container;b.classList.add("maplibregl-map","mapboxgl-map");const a=this._canvasContainer=ne.create("div","maplibregl-canvas-container mapboxgl-canvas-container",b);this._interactive&&a.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=ne.create("canvas","maplibregl-canvas mapboxgl-canvas",a),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const p=this._containerDimensions();this._resizeCanvas(p[0],p[1],this.getPixelRatio());const y=this._controlContainer=ne.create("div","maplibregl-control-container mapboxgl-control-container",b),w=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(S=>{w[S]=ne.create("div",`maplibregl-ctrl-${S} mapboxgl-ctrl-${S}`,y)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(b,a,p){this._canvas.width=p*b,this._canvas.height=p*a,this._canvas.style.width=`${b}px`,this._canvas.style.height=`${a}px`}_setupPainter(){const b=x.extend({},Me.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),a=this._canvas.getContext("webgl",b)||this._canvas.getContext("experimental-webgl",b);a?(this.painter=new ls(a,this.transform),x.exported$1.testSupport(a)):this.fire(new x.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(b){b.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new x.Event("webglcontextlost",{originalEvent:b}))}_contextRestored(b){this._setupPainter(),this.resize(),this._update(),this.fire(new x.Event("webglcontextrestored",{originalEvent:b}))}_onMapScroll(b){if(b.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(b){return this.style?(this._styleDirty=this._styleDirty||b,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(b){return this._update(),this._renderTaskQueue.add(b)}_cancelRenderFrame(b){this._renderTaskQueue.remove(b)}_render(b){let a,p=0;const y=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(a=y.createQueryEXT(),y.beginQueryEXT(y.TIME_ELAPSED_EXT,a),p=x.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(b),this._removed)return;let w=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const R=this.transform.zoom,F=x.exported.now();this.style.zoomHistory.update(R,F);const N=new x.EvaluationParameters(R,{now:F,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),j=N.crossFadingFactor();1===j&&j===this._crossFadingFactor||(w=!0,this._crossFadingFactor=j),this.style.update(N)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new x.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,x.PerformanceUtils.mark(x.PerformanceMarkers.load),this.fire(new x.Event("load"))),this.style&&(this.style.hasTransitions()||w)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const R=x.exported.now()-p;y.endQueryEXT(y.TIME_ELAPSED_EXT,a),setTimeout(()=>{const F=y.getQueryObjectEXT(a,y.QUERY_RESULT_EXT)/1e6;y.deleteQueryEXT(a),this.fire(new x.Event("gpu-timing-frame",{cpuTime:R,gpuTime:F}))},50)}if(this.listens("gpu-timing-layer")){const R=this.painter.collectGpuTimers();setTimeout(()=>{const F=this.painter.queryGpuTimers(R);this.fire(new x.Event("gpu-timing-layer",{layerTimes:F}))},50)}const S=this._sourcesDirty||this._styleDirty||this._placementDirty;return S||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new x.Event("idle")),!this._loaded||this._fullyLoaded||S||(this._fullyLoaded=!0,x.PerformanceUtils.mark(x.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),"undefined"!=typeof window&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));const b=this.painter.context.gl.getExtension("WEBGL_lose_context");b&&b.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),ne.remove(this._canvasContainer),ne.remove(this._controlContainer),this._container.classList.remove("maplibregl-map","mapboxgl-map"),x.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new x.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=x.exported.frame(b=>{x.PerformanceUtils.frame(b),this._frame=null,this._render(b)}))}_onWindowOnline(){this._update()}_onWindowResize(b){this._trackResize&&this.resize({originalEvent:b})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(b){this._showTileBoundaries!==b&&(this._showTileBoundaries=b,this._update())}get showPadding(){return!!this._showPadding}set showPadding(b){this._showPadding!==b&&(this._showPadding=b,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(b){this._showCollisionBoxes!==b&&(this._showCollisionBoxes=b,b?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(b){this._showOverdrawInspector!==b&&(this._showOverdrawInspector=b,this._update())}get repaint(){return!!this._repaint}set repaint(b){this._repaint!==b&&(this._repaint=b,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(b){this._vertices=b,this._update()}_setCacheLimits(b,a){x.setCacheLimits(b,a)}},NavigationControl:class{constructor(b){this.options=x.extend({},Is,b),this._container=ne.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",a=>a.preventDefault()),this.options.showZoom&&(x.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",a=>this._map.zoomIn({},{originalEvent:a})),ne.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",a=>this._map.zoomOut({},{originalEvent:a})),ne.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(x.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",a=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:a}):this._map.resetNorth({},{originalEvent:a})}),this._compassIcon=ne.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const b=this._map.getZoom(),a=b===this._map.getMaxZoom(),p=b===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())}_rotateCompassArrow(){const b=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=b}onAdd(b){return this._map=b,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Wt(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){ne.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(b,a){const p=ne.create("button",b,this._container);return p.type="button",p.addEventListener("click",a),p}_setButtonTitle(b,a){const p=this._map._getUIString(`NavigationControl.${a}`);b.title=p,b.setAttribute("aria-label",p)}},GeolocateControl:class extends x.Evented{constructor(b){super(),this.options=x.extend({},qr,b),x.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(b){var a;return this._map=b,this._container=ne.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),a=this._setupUI,void 0!==cs?a(cs):void 0!==window.navigator.permissions?window.navigator.permissions.query({name:"geolocation"}).then(p=>{cs="denied"!==p.state,a(cs)}):(cs=!!window.navigator.geolocation,a(cs)),this._container}onRemove(){void 0!==this._geolocationWatchID&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),ne.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,mo=0,Ga=!1}_isOutOfMapMaxBounds(b){const a=this._map.getMaxBounds(),p=b.coords;return a&&(p.longitude<a.getWest()||p.longitude>a.getEast()||p.latitude<a.getSouth()||p.latitude>a.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(b){if(this._map){if(this._isOutOfMapMaxBounds(b))return this._setErrorState(),this.fire(new x.Event("outofmaxbounds",b)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=b,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(b),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(b),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new x.Event("geolocate",b)),this._finish()}}_updateCamera(b){const a=new x.LngLat(b.coords.longitude,b.coords.latitude),p=b.coords.accuracy,y=this._map.getBearing(),w=x.extend({bearing:y},this.options.fitBoundsOptions);this._map.fitBounds(a.toBounds(p),w,{geolocateSource:!0})}_updateMarker(b){if(b){const a=new x.LngLat(b.coords.longitude,b.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=b.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const b=this._map._container.clientHeight/2,a=this._map.unproject([0,b]),p=this._map.unproject([1,b]),y=a.distanceTo(p),w=Math.ceil(2*this._accuracy/y);this._circleElement.style.width=`${w}px`,this._circleElement.style.height=`${w}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(b){if(this._map){if(this.options.trackUserLocation)if(1===b.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===b.code&&Ga)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new x.Event("error",b)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(b){if(this._container.addEventListener("contextmenu",a=>a.preventDefault()),this._geolocateButton=ne.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),ne.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===b){x.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ne.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new Ll(this._dotElement),this._circleElement=ne.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ll({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",a=>{a.geolocateSource||"ACTIVE_LOCK"!==this._watchState||a.originalEvent&&"resize"===a.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this.fire(new x.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return x.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new x.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":mo--,Ga=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new x.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new x.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let b;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),mo++,mo>1?(b={maximumAge:6e5,timeout:0},Ga=!0):(b=this.options.positionOptions,Ga=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,b)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:qh,ScaleControl:class{constructor(b){this.options=x.extend({},Dc,b),x.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){Vn(this._map,this._container,this.options)}onAdd(b){return this._map=b,this._container=ne.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",b.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){ne.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(b){this.options.unit=b,Vn(this._map,this._container,this.options)}},FullscreenControl:class{constructor(b){this._fullscreen=!1,b&&b.container&&(b.container instanceof HTMLElement?this._container=b.container:x.warnOnce("Full screen control 'container' must be a DOM element.")),x.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(b){return this._map=b,this._container||(this._container=this._map.getContainer()),this._controlContainer=ne.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",x.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){ne.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}_setupUI(){const b=this._fullscreenButton=ne.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);ne.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",b).setAttribute("aria-hidden","true"),b.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const b=this._getTitle();this._fullscreenButton.setAttribute("aria-label",b),this._fullscreenButton.title=b}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends x.Evented{constructor(b){super(),this.options=x.extend(Object.create($a),b),x.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(b){return this._map&&this.remove(),this._map=b,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new x.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&ne.remove(this._content),this._container&&(ne.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new x.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(b){return this._lngLat=x.LngLat.convert(b),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}getElement(){return this._container}setText(b){return this.setDOMContent(document.createTextNode(b))}setHTML(b){const a=document.createDocumentFragment(),p=document.createElement("body");let y;for(p.innerHTML=b;y=p.firstChild,y;)a.appendChild(y);return this.setDOMContent(a)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(b){return this.options.maxWidth=b,this._update(),this}setDOMContent(b){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=ne.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(b),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(b){this._container&&this._container.classList.add(b)}removeClassName(b){this._container&&this._container.classList.remove(b)}setOffset(b){return this.options.offset=b,this._update(),this}toggleClassName(b){if(this._container)return this._container.classList.toggle(b)}_createCloseButton(){this.options.closeButton&&(this._closeButton=ne.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(b){this._update(b.point)}_onMouseMove(b){this._update(b.point)}_onDrag(b){this._update(b.point)}_update(b){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=ne.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=ne.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(S=>this._container.classList.add(S)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Mt(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!b))return;const a=this._pos=this._trackPointer&&b?b:this._map.project(this._lngLat);let p=this.options.anchor;const y=Ec(this.options.offset);if(!p){const S=this._container.offsetWidth,R=this._container.offsetHeight;let F;F=a.y+y.bottom.y<R?["top"]:a.y>this._map.transform.height-R?["bottom"]:[],a.x<S/2?F.push("left"):a.x>this._map.transform.width-S/2&&F.push("right"),p=0===F.length?"bottom":F.join("-")}const w=a.add(y[p]).round();ne.setTransform(this._container,`${No[p]} translate(${w.x}px,${w.y}px)`),Ys(this._container,p,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const b=this._container.querySelector(Bl);b&&b.focus()}_onClose(){this.remove()}},Marker:Ll,Style:ue,LngLat:x.LngLat,LngLatBounds:x.LngLatBounds,Point:x.pointGeometry,MercatorCoordinate:x.MercatorCoordinate,Evented:x.Evented,AJAXError:x.AJAXError,config:x.config,CanvasSource:hn,GeoJSONSource:br,ImageSource:_i,RasterDEMTileSource:tn,RasterTileSource:Ze,VectorTileSource:Et,VideoSource:Pr,prewarm:function(){Or().acquire(oo)},clearPrewarmedResources:function(){const b=pi;b&&(b.isPreloaded()&&1===b.numActive()?(b.release(oo),pi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get workerCount(){return Eo.workerCount},set workerCount(b){Eo.workerCount=b},get maxParallelImageRequests(){return x.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(b){x.config.MAX_PARALLEL_IMAGE_REQUESTS=b},clearStorage(b){x.clearTileCache(b)},workerUrl:"",addProtocol(b,a){x.config.REGISTERED_PROTOCOLS[b]=a},removeProtocol(b){delete x.config.REGISTERED_PROTOCOLS[b]}};return Fl.extend(qa,{isSafari:x.isSafari,getPerformanceMetrics:x.PerformanceUtils.getPerformanceMetrics}),qa}),h}()},5e3:(Ie,_e,Y)=>{"use strict";Y.d(_e,{$8M:()=>y,$Z:()=>cx,AFp:()=>Ww,ALo:()=>S_,AaK:()=>xe,BQk:()=>Wg,CHM:()=>Tl,CRH:()=>Ow,CZH:()=>Sb,CqO:()=>dx,EJc:()=>s1,EiD:()=>Nu,EpF:()=>ux,F$t:()=>mx,F4k:()=>uv,FYo:()=>v_,FiY:()=>Cn,G48:()=>b1,Gf:()=>Rw,GfV:()=>x_,GkF:()=>lv,Gpc:()=>ke,Hsn:()=>gx,Ikx:()=>Np,JOm:()=>Un,JVY:()=>tg,L6k:()=>ig,LAX:()=>Qd,LFG:()=>Xn,LSH:()=>tp,Lbi:()=>Kw,MAs:()=>tx,NdJ:()=>dv,O4$:()=>yu,OlP:()=>te,Oqu:()=>Cv,PXZ:()=>lC,Q6J:()=>ov,QGY:()=>cv,Qsj:()=>gw,R0b:()=>Ta,RDi:()=>Nd,Rgc:()=>Em,SBq:()=>Th,Sil:()=>l1,Suo:()=>Pw,TTD:()=>Oa,TgZ:()=>$g,Udp:()=>sm,VKq:()=>bw,VLi:()=>sC,WFA:()=>hv,X6Q:()=>v1,XFs:()=>pi,Xpm:()=>Wi,Y36:()=>im,YKP:()=>nb,YNc:()=>Yy,Yjl:()=>re,Yz7:()=>Qi,ZZ4:()=>ry,_Bn:()=>g_,_UZ:()=>av,_Vd:()=>jp,_c5:()=>IC,_uU:()=>Ma,aQg:()=>sy,c2e:()=>Ab,cJS:()=>Do,cg1:()=>n_,d8E:()=>fd,dDg:()=>rC,deG:()=>ce,dqk:()=>Vi,eBb:()=>Pu,eFA:()=>cC,ekj:()=>Qg,f3M:()=>Sr,g9A:()=>Tb,h0i:()=>Ih,hGG:()=>kC,hij:()=>lm,iGM:()=>kw,ifc:()=>Yi,ip1:()=>Yw,kL8:()=>r_,kcU:()=>Pl,lG2:()=>Ds,lcZ:()=>T_,lnq:()=>Mv,mCW:()=>Jd,n5z:()=>a,n_E:()=>kh,oAB:()=>so,oxw:()=>fx,pB0:()=>Ou,q3G:()=>jn,qLn:()=>ah,qOj:()=>Ng,qZA:()=>qg,qzn:()=>Gl,s9C:()=>pv,sBO:()=>x1,sIi:()=>em,s_b:()=>tu,soG:()=>ey,tBr:()=>Za,tb:()=>Xw,tp0:()=>Ka,uIk:()=>vh,vHH:()=>vt,vpe:()=>Sa,wAp:()=>Ti,xp6:()=>_p,yhl:()=>yf,ynx:()=>Yg,z2F:()=>Rb,z3N:()=>hr,zSh:()=>Rg,zs3:()=>dl});var h=Y(7579),Te=Y(727),Ve=Y(8306),x=Y(6451),Me=Y(3099);function Pe(o){for(let s in o)if(o[s]===Pe)return s;throw Error("Could not find renamed property on target object.")}function ye(o,s){for(const u in s)s.hasOwnProperty(u)&&!o.hasOwnProperty(u)&&(o[u]=s[u])}function xe(o){if("string"==typeof o)return o;if(Array.isArray(o))return"["+o.map(xe).join(", ")+"]";if(null==o)return""+o;if(o.overriddenName)return`${o.overriddenName}`;if(o.name)return`${o.name}`;const s=o.toString();if(null==s)return""+s;const u=s.indexOf("\n");return-1===u?s:s.substring(0,u)}function ne(o,s){return null==o||""===o?null===s?"":s:null==s||""===s?o:o+" "+s}const Le=Pe({__forward_ref__:Pe});function ke(o){return o.__forward_ref__=ke,o.toString=function(){return xe(this())},o}function Be(o){return yt(o)?o():o}function yt(o){return"function"==typeof o&&o.hasOwnProperty(Le)&&o.__forward_ref__===ke}class vt extends Error{constructor(s,u){super(function Tt(o,s){return`NG0${Math.abs(o)}${s?": "+s:""}`}(s,u)),this.code=s}}function nt(o){return"string"==typeof o?o:null==o?"":String(o)}function Dt(o){return"function"==typeof o?o.name||o.toString():"object"==typeof o&&null!=o&&"function"==typeof o.type?o.type.name||o.type.toString():nt(o)}function ut(o,s){const u=s?` in ${s}`:"";throw new vt(-201,`No provider for ${Dt(o)} found${u}`)}function si(o,s){null==o&&function _i(o,s,u,m){throw new Error(`ASSERTION ERROR: ${o}`+(null==m?"":` [Expected=> ${u} ${m} ${s} <=Actual]`))}(s,o,null,"!=")}function Qi(o){return{token:o.token,providedIn:o.providedIn||null,factory:o.factory,value:void 0}}function Do(o){return{providers:o.providers||[],imports:o.imports||[]}}function Wn(o){return is(o,Ro)||is(o,Eo)}function is(o,s){return o.hasOwnProperty(s)?o[s]:null}function Cs(o){return o&&(o.hasOwnProperty(oo)||o.hasOwnProperty(rs))?o[oo]:null}const Ro=Pe({\u0275prov:Pe}),oo=Pe({\u0275inj:Pe}),Eo=Pe({ngInjectableDef:Pe}),rs=Pe({ngInjectorDef:Pe});var pi=(()=>((pi=pi||{})[pi.Default=0]="Default",pi[pi.Host=1]="Host",pi[pi.Self=2]="Self",pi[pi.SkipSelf=4]="SkipSelf",pi[pi.Optional=8]="Optional",pi))();let Or;function er(o){const s=Or;return Or=o,s}function Hi(o,s,u){const m=Wn(o);return m&&"root"==m.providedIn?void 0===m.value?m.value=m.factory():m.value:u&pi.Optional?null:void 0!==s?s:void ut(xe(o),"Injector")}function xr(o){return{toString:o}.toString()}var wr=(()=>((wr=wr||{})[wr.OnPush=0]="OnPush",wr[wr.Default=1]="Default",wr))(),Yi=(()=>{return(o=Yi||(Yi={}))[o.Emulated=0]="Emulated",o[o.None=2]="None",o[o.ShadowDom=3]="ShadowDom",Yi;var o})();const ai="undefined"!=typeof globalThis&&globalThis,Kt="undefined"!=typeof window&&window,Fr="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Vi=ai||"undefined"!=typeof global&&global||Kt||Fr,vi={},wt=[],sr=Pe({\u0275cmp:Pe}),Li=Pe({\u0275dir:Pe}),Mi=Pe({\u0275pipe:Pe}),Oo=Pe({\u0275mod:Pe}),ar=Pe({\u0275fac:Pe}),Fn=Pe({__NG_ELEMENT_ID__:Pe});let Cr=0;function Wi(o){return xr(()=>{const u={},m={type:o.type,providersResolver:null,decls:o.decls,vars:o.vars,factory:null,template:o.template||null,consts:o.consts||null,ngContentSelectors:o.ngContentSelectors,hostBindings:o.hostBindings||null,hostVars:o.hostVars||0,hostAttrs:o.hostAttrs||null,contentQueries:o.contentQueries||null,declaredInputs:u,inputs:null,outputs:null,exportAs:o.exportAs||null,onPush:o.changeDetection===wr.OnPush,directiveDefs:null,pipeDefs:null,selectors:o.selectors||wt,viewQuery:o.viewQuery||null,features:o.features||null,data:o.data||{},encapsulation:o.encapsulation||Yi.Emulated,id:"c",styles:o.styles||wt,_:null,setInput:null,schemas:o.schemas||null,tView:null},_=o.directives,C=o.features,T=o.pipes;return m.id+=Cr++,m.inputs=ss(o.inputs,u),m.outputs=ss(o.outputs),C&&C.forEach(P=>P(m)),m.directiveDefs=_?()=>("function"==typeof _?_():_).map(Rn):null,m.pipeDefs=T?()=>("function"==typeof T?T():T).map(Fo):null,m})}function Rn(o){return z(o)||function U(o){return o[Li]||null}(o)}function Fo(o){return function J(o){return o[Mi]||null}(o)}const Dn={};function so(o){return xr(()=>{const s={type:o.type,bootstrap:o.bootstrap||wt,declarations:o.declarations||wt,imports:o.imports||wt,exports:o.exports||wt,transitiveCompileScopes:null,schemas:o.schemas||null,id:o.id||null};return null!=o.id&&(Dn[o.id]=o.type),s})}function ss(o,s){if(null==o)return vi;const u={};for(const m in o)if(o.hasOwnProperty(m)){let _=o[m],C=_;Array.isArray(_)&&(C=_[1],_=_[0]),u[_]=m,s&&(s[_]=C)}return u}const Ds=Wi;function re(o){return{type:o.type,name:o.name,factory:null,pure:!1!==o.pure,onDestroy:o.type.prototype.ngOnDestroy||null}}function z(o){return o[sr]||null}function ie(o,s){const u=o[Oo]||null;if(!u&&!0===s)throw new Error(`Type ${xe(o)} does not have '\u0275mod' property.`);return u}function mn(o){return Array.isArray(o)&&"object"==typeof o[1]}function Bi(o){return Array.isArray(o)&&!0===o[1]}function Mr(o){return 0!=(8&o.flags)}function Ra(o){return 2==(2&o.flags)}function ao(o){return 1==(1&o.flags)}function Dr(o){return null!==o.template}function Pa(o){return 0!=(512&o[2])}function qo(o,s){return o.hasOwnProperty(ar)?o[ar]:null}class wl{constructor(s,u,m){this.previousValue=s,this.currentValue=u,this.firstChange=m}isFirstChange(){return this.firstChange}}function Oa(){return Br}function Br(o){return o.type.prototype.ngOnChanges&&(o.setInput=lu),au}function au(){const o=Cl(this),s=null==o?void 0:o.current;if(s){const u=o.previous;if(u===vi)o.previous=s;else for(let m in s)u[m]=s[m];o.current=null,this.ngOnChanges(s)}}function lu(o,s,u,m){const _=Cl(o)||function cu(o,s){return o[Pn]=s}(o,{previous:vi,current:null}),C=_.current||(_.current={}),T=_.previous,P=this.declaredInputs[u],L=T[P];C[P]=new wl(L&&L.currentValue,s,T===vi),o[m]=s}Oa.ngInherit=!0;const Pn="__ngSimpleChanges__";function Cl(o){return o[Pn]||null}let hu;function Nd(o){hu=o}function qn(o){return!!o.listen}const hc={createRenderer:(o,s)=>function pu(){return void 0!==hu?hu:"undefined"!=typeof document?document:void 0}()};function dn(o){for(;Array.isArray(o);)o=o[0];return o}function La(o,s){return dn(s[o])}function cr(o,s){return dn(s[o.index])}function zs(o,s){return o.data[s]}function uo(o,s){return o[s]}function ho(o,s){const u=s[o];return mn(u)?u:u[0]}function aa(o){return 4==(4&o[2])}function Ji(o){return 128==(128&o[2])}function Es(o,s){return null==s?null:o[s]}function $i(o){o[18]=0}function as(o,s){o[5]+=s;let u=o,m=o[3];for(;null!==m&&(1===s&&1===u[5]||-1===s&&0===u[5]);)m[5]+=s,u=m,m=m[3]}const Qt={lFrame:za(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Sl(){return Qt.bindingsEnabled}function dt(){return Qt.lFrame.lView}function qi(){return Qt.lFrame.tView}function Tl(o){return Qt.lFrame.contextLView=o,o[8]}function gn(){let o=po();for(;null!==o&&64===o.type;)o=o.parent;return o}function po(){return Qt.lFrame.currentTNode}function Lo(o,s){const u=Qt.lFrame;u.currentTNode=o,u.isParent=s}function mc(){return Qt.lFrame.isParent}function js(){Qt.lFrame.isParent=!1}function _c(){return Qt.isInCheckNoChangesMode}function la(o){Qt.isInCheckNoChangesMode=o}function Er(){const o=Qt.lFrame;let s=o.bindingRootIndex;return-1===s&&(s=o.bindingRootIndex=o.tView.bindingStartIndex),s}function Ss(){return Qt.lFrame.bindingIndex++}function ls(o){const s=Qt.lFrame,u=s.bindingIndex;return s.bindingIndex=s.bindingIndex+o,u}function Il(o,s){const u=Qt.lFrame;u.bindingIndex=u.bindingRootIndex=o,bc(s)}function bc(o){Qt.lFrame.currentDirectiveIndex=o}function Us(o){const s=Qt.lFrame.currentDirectiveIndex;return-1===s?null:o[s]}function jd(){return Qt.lFrame.currentQueryIndex}function xc(o){Qt.lFrame.currentQueryIndex=o}function kl(o){const s=o[1];return 2===s.type?s.declTNode:1===s.type?o[6]:null}function Ud(o,s,u){if(u&pi.SkipSelf){let _=s,C=o;for(;!(_=_.parent,null!==_||u&pi.Host||(_=kl(C),null===_||(C=C[15],10&_.type))););if(null===_)return!1;s=_,o=C}const m=Qt.lFrame=Va();return m.currentTNode=s,m.lView=o,!0}function Rl(o){const s=Va(),u=o[1];Qt.lFrame=s,s.currentTNode=u.firstChild,s.lView=o,s.tView=u,s.contextLView=o,s.bindingIndex=u.bindingStartIndex,s.inI18n=!1}function Va(){const o=Qt.lFrame,s=null===o?null:o.child;return null===s?za(o):s}function za(o){const s={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:o,child:null,inI18n:!1};return null!==o&&(o.child=s),s}function Yn(){const o=Qt.lFrame;return Qt.lFrame=o.parent,o.currentTNode=null,o.lView=null,o}const wc=Yn;function Yo(){const o=Yn();o.isParent=!0,o.tView=null,o.selectedIndex=-1,o.contextLView=null,o.elementDepthCount=0,o.currentDirectiveIndex=-1,o.currentNamespace=null,o.bindingRootIndex=-1,o.bindingIndex=-1,o.currentQueryIndex=0}function ur(){return Qt.lFrame.selectedIndex}function Bo(o){Qt.lFrame.selectedIndex=o}function Nn(){const o=Qt.lFrame;return zs(o.tView,o.selectedIndex)}function yu(){Qt.lFrame.currentNamespace="svg"}function Pl(){!function Hs(){Qt.lFrame.currentNamespace=null}()}function Gs(o,s){for(let u=s.directiveStart,m=s.directiveEnd;u<m;u++){const C=o.data[u].type.prototype,{ngAfterContentInit:T,ngAfterContentChecked:P,ngAfterViewInit:L,ngAfterViewChecked:G,ngOnDestroy:W}=C;T&&(o.contentHooks||(o.contentHooks=[])).push(-u,T),P&&((o.contentHooks||(o.contentHooks=[])).push(u,P),(o.contentCheckHooks||(o.contentCheckHooks=[])).push(u,P)),L&&(o.viewHooks||(o.viewHooks=[])).push(-u,L),G&&((o.viewHooks||(o.viewHooks=[])).push(u,G),(o.viewCheckHooks||(o.viewCheckHooks=[])).push(u,G)),null!=W&&(o.destroyHooks||(o.destroyHooks=[])).push(u,W)}}function ua(o,s,u){Cc(o,s,3,u)}function Ua(o,s,u,m){(3&o[2])===u&&Cc(o,s,u,m)}function Ft(o,s){let u=o[2];(3&u)===s&&(u&=2047,u+=1,o[2]=u)}function Cc(o,s,u,m){const C=null!=m?m:-1,T=s.length-1;let P=0;for(let L=void 0!==m?65535&o[18]:0;L<T;L++)if("number"==typeof s[L+1]){if(P=s[L],null!=m&&P>=m)break}else s[L]<0&&(o[18]+=65536),(P<C||-1==C)&&(pf(o,u,s,L),o[18]=(4294901760&o[18])+L+2),L++}function pf(o,s,u,m){const _=u[m]<0,C=u[m+1],P=o[_?-u[m]:u[m]];if(_){if(o[2]>>11<o[18]>>16&&(3&o[2])===s){o[2]+=2048;try{C.call(P)}finally{}}}else try{C.call(P)}finally{}}class Ha{constructor(s,u,m){this.factory=s,this.resolving=!1,this.canSeeViewProviders=u,this.injectImpl=m}}function En(o,s,u){const m=qn(o);let _=0;for(;_<u.length;){const C=u[_];if("number"==typeof C){if(0!==C)break;_++;const T=u[_++],P=u[_++],L=u[_++];m?o.setAttribute(s,P,L,T):s.setAttributeNS(T,P,L)}else{const T=C,P=u[++_];zi(T)?m&&o.setProperty(s,T,P):m?o.setAttribute(s,T,P):s.setAttribute(T,P),_++}}return _}function an(o){return 3===o||4===o||6===o}function zi(o){return 64===o.charCodeAt(0)}function As(o,s){if(null!==s&&0!==s.length)if(null===o||0===o.length)o=s.slice();else{let u=-1;for(let m=0;m<s.length;m++){const _=s[m];"number"==typeof _?u=_:0===u||Ol(o,u,_,null,-1===u||2===u?s[++m]:null)}}return o}function Ol(o,s,u,m,_){let C=0,T=o.length;if(-1===s)T=-1;else for(;C<o.length;){const P=o[C++];if("number"==typeof P){if(P===s){T=-1;break}if(P>s){T=C-1;break}}}for(;C<o.length;){const P=o[C];if("number"==typeof P)break;if(P===u){if(null===m)return void(null!==_&&(o[C+1]=_));if(m===o[C+1])return void(o[C+2]=_)}C++,null!==m&&C++,null!==_&&C++}-1!==T&&(o.splice(T,0,s),C=T+1),o.splice(C++,0,u),null!==m&&o.splice(C++,0,m),null!==_&&o.splice(C++,0,_)}function zt(o){return-1!==o}function Ei(o){return 32767&o}function Jt(o,s){let u=function tr(o){return o>>16}(o),m=s;for(;u>0;)m=m[15],u--;return m}let Fl=!0;function Wo(o){const s=Fl;return Fl=o,s}let $d=0;function Is(o,s){const u=Mt(o,s);if(-1!==u)return u;const m=s[1];m.firstCreatePass&&(o.injectorIndex=s.length,Wt(m.data,o),Wt(s,null),Wt(m.blueprint,null));const _=No(o,s),C=o.injectorIndex;if(zt(_)){const T=Ei(_),P=Jt(_,s),L=P[1].data;for(let G=0;G<8;G++)s[C+G]=P[T+G]|L[T+G]}return s[C+8]=_,C}function Wt(o,s){o.push(0,0,0,0,0,0,0,0,s)}function Mt(o,s){return-1===o.injectorIndex||o.parent&&o.parent.injectorIndex===o.injectorIndex||null===s[o.injectorIndex+8]?-1:o.injectorIndex}function No(o,s){if(o.parent&&-1!==o.parent.injectorIndex)return o.parent.injectorIndex;let u=0,m=null,_=s;for(;null!==_;){const C=_[1],T=C.type;if(m=2===T?C.declTNode:1===T?_[6]:null,null===m)return-1;if(u++,_=_[15],-1!==m.injectorIndex)return m.injectorIndex|u<<16}return-1}function Ys(o,s,u){!function fo(o,s,u){let m;"string"==typeof u?m=u.charCodeAt(0)||0:u.hasOwnProperty(Fn)&&(m=u[Fn]),null==m&&(m=u[Fn]=$d++);const _=255&m;s.data[o+(_>>5)]|=1<<_}(o,s,u)}function qr(o,s,u){if(u&pi.Optional)return o;ut(s,"NodeInjector")}function cs(o,s,u,m){if(u&pi.Optional&&void 0===m&&(m=null),0==(u&(pi.Self|pi.Host))){const _=o[9],C=er(void 0);try{return _?_.get(s,m,u&pi.Optional):Hi(s,m,u&pi.Optional)}finally{er(C)}}return qr(m,s,u)}function mo(o,s,u,m=pi.Default,_){if(null!==o){const C=function Bl(o){if("string"==typeof o)return o.charCodeAt(0)||0;const s=o.hasOwnProperty(Fn)?o[Fn]:void 0;return"number"==typeof s?s>=0?255&s:Dc:s}(u);if("function"==typeof C){if(!Ud(s,o,m))return m&pi.Host?qr(_,u,m):cs(s,u,m,_);try{const T=C(m);if(null!=T||m&pi.Optional)return T;ut(u)}finally{wc()}}else if("number"==typeof C){let T=null,P=Mt(o,s),L=-1,G=m&pi.Host?s[16][6]:null;for((-1===P||m&pi.SkipSelf)&&(L=-1===P?No(o,s):s[P+8],-1!==L&&qa(m,!1)?(T=s[1],P=Ei(L),s=Jt(L,s)):P=-1);-1!==P;){const W=s[1];if(Ec(C,P,W.data)){const ae=Vn(P,s,u,T,m,G);if(ae!==Ga)return ae}L=s[P+8],-1!==L&&qa(m,s[1].data[P+8]===G)&&Ec(C,P,s)?(T=W,P=Ei(L),s=Jt(L,s)):P=-1}}}return cs(s,u,m,_)}const Ga={};function Dc(){return new b(gn(),dt())}function Vn(o,s,u,m,_,C){const T=s[1],P=T.data[o+8],W=xn(P,T,u,null==m?Ra(P)&&Fl:m!=T&&0!=(3&P.type),_&pi.Host&&C===P);return null!==W?$a(s,T,W,P):Ga}function xn(o,s,u,m,_){const C=o.providerIndexes,T=s.data,P=1048575&C,L=o.directiveStart,W=C>>20,ve=_?P+W:o.directiveEnd;for(let Re=m?P:P+W;Re<ve;Re++){const st=T[Re];if(Re<L&&u===st||Re>=L&&st.type===u)return Re}if(_){const Re=T[L];if(Re&&Dr(Re)&&Re.type===u)return L}return null}function $a(o,s,u,m){let _=o[u];const C=s.data;if(function bu(o){return o instanceof Ha}(_)){const T=_;T.resolving&&function Ht(o,s){const u=s?`. Dependency path: ${s.join(" > ")} > ${o}`:"";throw new vt(-200,`Circular dependency in DI detected for ${o}${u}`)}(Dt(C[u]));const P=Wo(T.canSeeViewProviders);T.resolving=!0;const L=T.injectImpl?er(T.injectImpl):null;Ud(o,m,pi.Default);try{_=o[u]=T.factory(void 0,C,o,m),s.firstCreatePass&&u>=m.directiveStart&&function vu(o,s,u){const{ngOnChanges:m,ngOnInit:_,ngDoCheck:C}=s.type.prototype;if(m){const T=Br(s);(u.preOrderHooks||(u.preOrderHooks=[])).push(o,T),(u.preOrderCheckHooks||(u.preOrderCheckHooks=[])).push(o,T)}_&&(u.preOrderHooks||(u.preOrderHooks=[])).push(0-o,_),C&&((u.preOrderHooks||(u.preOrderHooks=[])).push(o,C),(u.preOrderCheckHooks||(u.preOrderCheckHooks=[])).push(o,C))}(u,C[u],s)}finally{null!==L&&er(L),Wo(P),T.resolving=!1,wc()}}return _}function Ec(o,s,u){return!!(u[s+(o>>5)]&1<<o)}function qa(o,s){return!(o&pi.Self||o&pi.Host&&s)}class b{constructor(s,u){this._tNode=s,this._lView=u}get(s,u,m){return mo(this._tNode,this._lView,s,m,u)}}function a(o){return xr(()=>{const s=o.prototype.constructor,u=s[ar]||p(s),m=Object.prototype;let _=Object.getPrototypeOf(o.prototype).constructor;for(;_&&_!==m;){const C=_[ar]||p(_);if(C&&C!==u)return C;_=Object.getPrototypeOf(_)}return C=>new C})}function p(o){return yt(o)?()=>{const s=p(Be(o));return s&&s()}:qo(o)}function y(o){return function Ll(o,s){if("class"===s)return o.classes;if("style"===s)return o.styles;const u=o.attrs;if(u){const m=u.length;let _=0;for(;_<m;){const C=u[_];if(an(C))break;if(0===C)_+=2;else if("number"==typeof C)for(_++;_<m&&"string"==typeof u[_];)_++;else{if(C===s)return u[_+1];_+=2}}}return null}(gn(),o)}const S="__parameters__";function j(o,s,u){return xr(()=>{const m=function N(o){return function(...u){if(o){const m=o(...u);for(const _ in m)this[_]=m[_]}}}(s);function _(...C){if(this instanceof _)return m.apply(this,C),this;const T=new _(...C);return P.annotation=T,P;function P(L,G,W){const ae=L.hasOwnProperty(S)?L[S]:Object.defineProperty(L,S,{value:[]})[S];for(;ae.length<=W;)ae.push(null);return(ae[W]=ae[W]||[]).push(T),L}}return u&&(_.prototype=Object.create(u.prototype)),_.prototype.ngMetadataName=o,_.annotationCls=_,_})}class te{constructor(s,u){this._desc=s,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof u?this.__NG_ELEMENT_ID__=u:void 0!==u&&(this.\u0275prov=Qi({token:this,providedIn:u.providedIn||"root",factory:u.factory}))}toString(){return`InjectionToken ${this._desc}`}}const ce=new te("AnalyzeForEntryComponents");function St(o,s){void 0===s&&(s=o);for(let u=0;u<o.length;u++){let m=o[u];Array.isArray(m)?(s===o&&(s=o.slice(0,u)),St(m,s)):s!==o&&s.push(m)}return s}function oi(o,s){o.forEach(u=>Array.isArray(u)?oi(u,s):s(u))}function Zi(o,s,u){s>=o.length?o.push(u):o.splice(s,0,u)}function mi(o,s){return s>=o.length-1?o.pop():o.splice(s,1)[0]}function Ii(o,s){const u=[];for(let m=0;m<o;m++)u.push(s);return u}function ln(o,s,u){let m=dr(o,s);return m>=0?o[1|m]=u:(m=~m,function Ni(o,s,u,m){let _=o.length;if(_==s)o.push(u,m);else if(1===_)o.push(m,o[0]),o[0]=u;else{for(_--,o.push(o[_-1],o[_]);_>s;)o[_]=o[_-2],_--;o[s]=u,o[s+1]=m}}(o,m,s,u)),m}function _o(o,s){const u=dr(o,s);if(u>=0)return o[1|u]}function dr(o,s){return function ds(o,s,u){let m=0,_=o.length>>u;for(;_!==m;){const C=m+(_-m>>1),T=o[C<<u];if(s===T)return C<<u;T>s?_=C:m=C+1}return~(_<<u)}(o,s,1)}const To={},Rs="__NG_DI_FLAG__",Ya="ngTempTokenPath",yo=/\n/gm,Zo="__source",Sc=Pe({provide:String,useValue:Pe});let Os;function Yh(o){const s=Os;return Os=o,s}function Zs(o,s=pi.Default){if(void 0===Os)throw new vt(203,"");return null===Os?Hi(o,void 0,s):Os.get(o,s&pi.Optional?null:void 0,s)}function Xn(o,s=pi.Default){return(function mr(){return Or}()||Zs)(Be(o),s)}const Sr=Xn;function Tr(o){const s=[];for(let u=0;u<o.length;u++){const m=Be(o[u]);if(Array.isArray(m)){if(0===m.length)throw new vt(900,"");let _,C=pi.Default;for(let T=0;T<m.length;T++){const P=m[T],L=ff(P);"number"==typeof L?-1===L?_=P.token:C|=L:_=P}s.push(Xn(_,C))}else s.push(Xn(m))}return s}function vo(o,s){return o[Rs]=s,o.prototype[Rs]=s,o}function ff(o){return o[Rs]}const Za=vo(j("Inject",o=>({token:o})),-1),Cn=vo(j("Optional"),8),Ka=vo(j("SkipSelf"),4);let Ks;function Ul(o){var s;return(null===(s=function Zd(){if(void 0===Ks&&(Ks=null,Vi.trustedTypes))try{Ks=Vi.trustedTypes.createPolicy("angular",{createHTML:o=>o,createScript:o=>o,createScriptURL:o=>o})}catch(o){}return Ks}())||void 0===s?void 0:s.createHTML(o))||o}class Fs{constructor(s){this.changingThisBreaksApplicationSecurity=s}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class eg extends Fs{getTypeName(){return"HTML"}}class pa extends Fs{getTypeName(){return"Style"}}class Xd extends Fs{getTypeName(){return"Script"}}class Ru extends Fs{getTypeName(){return"URL"}}class Qa extends Fs{getTypeName(){return"ResourceURL"}}function hr(o){return o instanceof Fs?o.changingThisBreaksApplicationSecurity:o}function Gl(o,s){const u=yf(o);if(null!=u&&u!==s){if("ResourceURL"===u&&"URL"===s)return!0;throw new Error(`Required a safe ${s}, got a ${u} (see https://g.co/ng/security#xss)`)}return u===s}function yf(o){return o instanceof Fs&&o.getTypeName()||null}function tg(o){return new eg(o)}function ig(o){return new pa(o)}function Pu(o){return new Xd(o)}function Qd(o){return new Ru(o)}function Ou(o){return new Qa(o)}class Ja{constructor(s){this.inertDocumentHelper=s}getInertBodyElement(s){s="<body><remove></remove>"+s;try{const u=(new window.DOMParser).parseFromString(Ul(s),"text/html").body;return null===u?this.inertDocumentHelper.getInertBodyElement(s):(u.removeChild(u.firstChild),u)}catch(u){return null}}}class ng{constructor(s){if(this.defaultDoc=s,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const u=this.inertDocument.createElement("html");this.inertDocument.appendChild(u);const m=this.inertDocument.createElement("body");u.appendChild(m)}}getInertBodyElement(s){const u=this.inertDocument.createElement("template");if("content"in u)return u.innerHTML=Ul(s),u;const m=this.inertDocument.createElement("body");return m.innerHTML=Ul(s),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(m),m}stripCustomNsAttrs(s){const u=s.attributes;for(let _=u.length-1;0<_;_--){const T=u.item(_).name;("xmlns:ns1"===T||0===T.indexOf("ns1:"))&&s.removeAttribute(T)}let m=s.firstChild;for(;m;)m.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(m),m=m.nextSibling}}const rg=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Zh=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Jd(o){return(o=String(o)).match(rg)||o.match(Zh)?o:"unsafe:"+o}function hs(o){const s={};for(const u of o.split(","))s[u]=!0;return s}function Fu(...o){const s={};for(const u of o)for(const m in u)u.hasOwnProperty(m)&&(s[m]=!0);return s}const el=hs("area,br,col,hr,img,wbr"),eh=hs("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),zn=hs("rp,rt"),Ic=Fu(el,Fu(eh,hs("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Fu(zn,hs("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Fu(zn,eh)),$l=hs("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Lu=hs("srcset"),Bu=Fu($l,Lu,hs("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),hs("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Qh=hs("script,style,template");class ih{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(s){let u=s.firstChild,m=!0;for(;u;)if(u.nodeType===Node.ELEMENT_NODE?m=this.startElement(u):u.nodeType===Node.TEXT_NODE?this.chars(u.nodeValue):this.sanitizedSomething=!0,m&&u.firstChild)u=u.firstChild;else for(;u;){u.nodeType===Node.ELEMENT_NODE&&this.endElement(u);let _=this.checkClobberedElement(u,u.nextSibling);if(_){u=_;break}u=this.checkClobberedElement(u,u.parentNode)}return this.buf.join("")}startElement(s){const u=s.nodeName.toLowerCase();if(!Ic.hasOwnProperty(u))return this.sanitizedSomething=!0,!Qh.hasOwnProperty(u);this.buf.push("<"),this.buf.push(u);const m=s.attributes;for(let _=0;_<m.length;_++){const C=m.item(_),T=C.name,P=T.toLowerCase();if(!Bu.hasOwnProperty(P)){this.sanitizedSomething=!0;continue}let L=C.value;$l[P]&&(L=Jd(L)),Lu[P]&&(o=L,L=(o=String(o)).split(",").map(s=>Jd(s.trim())).join(", ")),this.buf.push(" ",T,'="',kc(L),'"')}var o;return this.buf.push(">"),!0}endElement(s){const u=s.nodeName.toLowerCase();Ic.hasOwnProperty(u)&&!el.hasOwnProperty(u)&&(this.buf.push("</"),this.buf.push(u),this.buf.push(">"))}chars(s){this.buf.push(kc(s))}checkClobberedElement(s,u){if(u&&(s.compareDocumentPosition(u)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${s.outerHTML}`);return u}}const ag=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,xf=/([^\#-~ |!])/g;function kc(o){return o.replace(/&/g,"&amp;").replace(ag,function(s){return"&#"+(1024*(s.charCodeAt(0)-55296)+(s.charCodeAt(1)-56320)+65536)+";"}).replace(xf,function(s){return"&#"+s.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let nh;function Nu(o,s){let u=null;try{nh=nh||function Ls(o){const s=new ng(o);return function vf(){try{return!!(new window.DOMParser).parseFromString(Ul(""),"text/html")}catch(o){return!1}}()?new Ja(s):s}(o);let m=s?String(s):"";u=nh.getInertBodyElement(m);let _=5,C=m;do{if(0===_)throw new Error("Failed to sanitize html because the input is unstable");_--,m=C,C=u.innerHTML,u=nh.getInertBodyElement(m)}while(m!==C);return Ul((new ih).sanitizeChildren(Jh(u)||u))}finally{if(u){const m=Jh(u)||u;for(;m.firstChild;)m.removeChild(m.firstChild)}}}function Jh(o){return"content"in o&&function zo(o){return o.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===o.nodeName}(o)?o.content:null}var jn=(()=>((jn=jn||{})[jn.NONE=0]="NONE",jn[jn.HTML=1]="HTML",jn[jn.STYLE=2]="STYLE",jn[jn.SCRIPT=3]="SCRIPT",jn[jn.URL=4]="URL",jn[jn.RESOURCE_URL=5]="RESOURCE_URL",jn))();function tp(o){const s=function Pc(){const o=dt();return o&&o[12]}();return s?s.sanitize(jn.URL,o)||"":Gl(o,"URL")?hr(o):Jd(nt(o))}const Mf="__ngContext__";function Zr(o,s){o[Mf]=s}function Oc(o){const s=function zu(o){return o[Mf]||null}(o);return s?Array.isArray(s)?s:s.lView:null}function oh(o){return o.ngOriginalError}function sh(o,...s){o.error(...s)}class ah{constructor(){this._console=console}handleError(s){const u=this._findOriginalError(s),m=function Tf(o){return o&&o.ngErrorLogger||sh}(s);m(this._console,"ERROR",s),u&&m(this._console,"ORIGINAL ERROR",u)}_findOriginalError(s){let u=s&&oh(s);for(;u&&oh(u);)u=oh(u);return u||null}}const Vr=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Vi))();function en(o){return o instanceof Function?o():o}var Un=(()=>((Un=Un||{})[Un.Important=1]="Important",Un[Un.DashCase=2]="DashCase",Un))();function zr(o,s){return undefined(o,s)}function ji(o){const s=o[3];return Bi(s)?s[3]:s}function Uu(o){return Lf(o[13])}function lp(o){return Lf(o[4])}function Lf(o){for(;null!==o&&!Bi(o);)o=o[4];return o}function bo(o,s,u,m,_){if(null!=m){let C,T=!1;Bi(m)?C=m:mn(m)&&(T=!0,m=m[0]);const P=dn(m);0===o&&null!==u?null==_?ch(s,u,P):ma(s,u,P,_||null,!0):1===o&&null!==u?ma(s,u,P,_||null,!0):2===o?function Kr(o,s,u){const m=Wu(o,s);m&&function yg(o,s,u,m){qn(o)?o.removeChild(s,u,m):s.removeChild(u)}(o,m,s,u)}(s,P,T):3===o&&s.destroyNode(P),null!=C&&function ed(o,s,u,m,_){const C=u[7];C!==dn(u)&&bo(s,o,m,C,_);for(let P=10;P<u.length;P++){const L=u[P];jr(L[1],L,o,s,m,C)}}(s,o,C,u,_)}}function up(o,s,u){if(qn(o))return o.createElement(s,u);{const m=null!==u?function Hh(o){const s=o.toLowerCase();return"svg"===s?"http://www.w3.org/2000/svg":"math"===s?"http://www.w3.org/1998/MathML/":null}(u):null;return null===m?o.createElement(s):o.createElementNS(m,s)}}function Gu(o,s){const u=o[9],m=u.indexOf(s),_=s[3];1024&s[2]&&(s[2]&=-1025,as(_,-1)),u.splice(m,1)}function $u(o,s){if(o.length<=10)return;const u=10+s,m=o[u];if(m){const _=m[17];null!==_&&_!==o&&Gu(_,m),s>0&&(o[u-1][4]=m[4]);const C=mi(o,10+s);!function dp(o,s){jr(o,s,s[11],2,null,null),s[0]=null,s[6]=null}(m[1],m);const T=C[19];null!==T&&T.detachView(C[1]),m[3]=null,m[4]=null,m[2]&=-129}return m}function Nf(o,s){if(!(256&s[2])){const u=s[11];qn(u)&&u.destroyNode&&jr(o,s,u,3,null,null),function lh(o){let s=o[13];if(!s)return Vc(o[1],o);for(;s;){let u=null;if(mn(s))u=s[13];else{const m=s[10];m&&(u=m)}if(!u){for(;s&&!s[4]&&s!==o;)mn(s)&&Vc(s[1],s),s=s[3];null===s&&(s=o),mn(s)&&Vc(s[1],s),u=s&&s[4]}s=u}}(s)}}function Vc(o,s){if(!(256&s[2])){s[2]&=-129,s[2]|=256,function Vf(o,s){let u;if(null!=o&&null!=(u=o.destroyHooks))for(let m=0;m<u.length;m+=2){const _=s[u[m]];if(!(_ instanceof Ha)){const C=u[m+1];if(Array.isArray(C))for(let T=0;T<C.length;T+=2){const P=_[C[T]],L=C[T+1];try{L.call(P)}finally{}}else try{C.call(_)}finally{}}}}(o,s),function qu(o,s){const u=o.cleanup,m=s[7];let _=-1;if(null!==u)for(let C=0;C<u.length-1;C+=2)if("string"==typeof u[C]){const T=u[C+1],P="function"==typeof T?T(s):dn(s[T]),L=m[_=u[C+2]],G=u[C+3];"boolean"==typeof G?P.removeEventListener(u[C],L,G):G>=0?m[_=G]():m[_=-G].unsubscribe(),C+=2}else{const T=m[_=u[C+1]];u[C].call(T)}if(null!==m){for(let C=_+1;C<m.length;C++)m[C]();s[7]=null}}(o,s),1===s[1].type&&qn(s[11])&&s[11].destroy();const u=s[17];if(null!==u&&Bi(s[3])){u!==s[3]&&Gu(u,s);const m=s[19];null!==m&&m.detachView(o)}}}function hp(o,s,u){return function zf(o,s,u){let m=s;for(;null!==m&&40&m.type;)m=(s=m).parent;if(null===m)return u[0];if(2&m.flags){const _=o.data[m.directiveStart].encapsulation;if(_===Yi.None||_===Yi.Emulated)return null}return cr(m,u)}(o,s.parent,u)}function ma(o,s,u,m,_){qn(o)?o.insertBefore(s,u,m,_):s.insertBefore(u,m,_)}function ch(o,s,u){qn(o)?o.appendChild(s,u):s.appendChild(u)}function Yu(o,s,u,m,_){null!==m?ma(o,s,u,m,_):ch(o,s,u)}function Wu(o,s){return qn(o)?o.parentNode(s):s.parentNode}function pp(o,s,u){return ms(o,s,u)}let ms=function Zu(o,s,u){return 40&o.type?cr(o,u):null};function Ku(o,s,u,m){const _=hp(o,m,s),C=s[11],P=pp(m.parent||s[6],m,s);if(null!=_)if(Array.isArray(u))for(let L=0;L<u.length;L++)Yu(C,_,u[L],P,!1);else Yu(C,_,u,P,!1)}function Xu(o,s){if(null!==s){const u=s.type;if(3&u)return cr(s,o);if(4&u)return Qu(-1,o[s.index]);if(8&u){const m=s.child;if(null!==m)return Xu(o,m);{const _=o[s.index];return Bi(_)?Qu(-1,_):dn(_)}}if(32&u)return zr(s,o)()||dn(o[s.index]);{const m=uh(o,s);return null!==m?Array.isArray(m)?m[0]:Xu(ji(o[16]),m):Xu(o,s.next)}}return null}function uh(o,s){return null!==s?o[16][6].projection[s.projection]:null}function Qu(o,s){const u=10+o+1;if(u<s.length){const m=s[u],_=m[1].firstChild;if(null!==_)return Xu(m,_)}return s[7]}function Ju(o,s,u,m,_,C,T){for(;null!=u;){const P=m[u.index],L=u.type;if(T&&0===s&&(P&&Zr(dn(P),m),u.flags|=4),64!=(64&u.flags))if(8&L)Ju(o,s,u.child,m,_,C,!1),bo(s,o,_,P,C);else if(32&L){const G=zr(u,m);let W;for(;W=G();)bo(s,o,_,W,C);bo(s,o,_,P,C)}else 16&L?rl(o,s,m,u,_,C):bo(s,o,_,P,C);u=T?u.projectionNext:u.next}}function jr(o,s,u,m,_,C){Ju(u,m,o.firstChild,s,_,C,!1)}function rl(o,s,u,m,_,C){const T=u[16],L=T[6].projection[m.projection];if(Array.isArray(L))for(let G=0;G<L.length;G++)bo(s,o,_,L[G],C);else Ju(o,s,L,T[3],_,C,!0)}function _a(o,s,u){qn(o)?o.setAttribute(s,"style",u):s.style.cssText=u}function zc(o,s,u){qn(o)?""===u?o.removeAttribute(s,"class"):o.setAttribute(s,"class",u):s.className=u}function gs(o,s,u){let m=o.length;for(;;){const _=o.indexOf(s,u);if(-1===_)return _;if(0===_||o.charCodeAt(_-1)<=32){const C=s.length;if(_+C===m||o.charCodeAt(_+C)<=32)return _}u=_+1}}const ol="ng-template";function xg(o,s,u){let m=0;for(;m<o.length;){let _=o[m++];if(u&&"class"===_){if(_=o[m],-1!==gs(_.toLowerCase(),s,0))return!0}else if(1===_){for(;m<o.length&&"string"==typeof(_=o[m++]);)if(_.toLowerCase()===s)return!0;return!1}}return!1}function wg(o){return 4===o.type&&o.value!==ol}function sl(o,s,u){return s===(4!==o.type||u?o.value:ol)}function mp(o,s,u){let m=4;const _=o.attrs||[],C=function jf(o){for(let s=0;s<o.length;s++)if(an(o[s]))return s;return o.length}(_);let T=!1;for(let P=0;P<s.length;P++){const L=s[P];if("number"!=typeof L){if(!T)if(4&m){if(m=2|1&m,""!==L&&!sl(o,L,u)||""===L&&1===s.length){if(Xo(m))return!1;T=!0}}else{const G=8&m?L:s[++P];if(8&m&&null!==o.attrs){if(!xg(o.attrs,G,u)){if(Xo(m))return!1;T=!0}continue}const ae=td(8&m?"class":L,_,wg(o),u);if(-1===ae){if(Xo(m))return!1;T=!0;continue}if(""!==G){let ve;ve=ae>C?"":_[ae+1].toLowerCase();const Re=8&m?ve:null;if(Re&&-1!==gs(Re,G,0)||2&m&&G!==ve){if(Xo(m))return!1;T=!0}}}}else{if(!T&&!Xo(m)&&!Xo(L))return!1;if(T&&Xo(L))continue;T=!1,m=L|1&m}}return Xo(m)||T}function Xo(o){return 0==(1&o)}function td(o,s,u,m){if(null===s)return-1;let _=0;if(m||!u){let C=!1;for(;_<s.length;){const T=s[_];if(T===o)return _;if(3===T||6===T)C=!0;else{if(1===T||2===T){let P=s[++_];for(;"string"==typeof P;)P=s[++_];continue}if(4===T)break;if(0===T){_+=4;continue}}_+=C?1:2}return-1}return function Uf(o,s){let u=o.indexOf(4);if(u>-1)for(u++;u<o.length;){const m=o[u];if("number"==typeof m)return-1;if(m===s)return u;u++}return-1}(s,o)}function ya(o,s,u=!1){for(let m=0;m<s.length;m++)if(mp(o,s[m],u))return!0;return!1}function Cg(o,s){e:for(let u=0;u<s.length;u++){const m=s[u];if(o.length===m.length){for(let _=0;_<o.length;_++)if(o[_]!==m[_])continue e;return!0}}return!1}function Hf(o,s){return o?":not("+s.trim()+")":s}function al(o){let s=o[0],u=1,m=2,_="",C=!1;for(;u<o.length;){let T=o[u];if("string"==typeof T)if(2&m){const P=o[++u];_+="["+T+(P.length>0?'="'+P+'"':"")+"]"}else 8&m?_+="."+T:4&m&&(_+=" "+T);else""!==_&&!Xo(T)&&(s+=Hf(C,_),_=""),m=T,C=C||!Xo(m);u++}return""!==_&&(s+=Hf(C,_)),s}const Fi={};function _p(o){yp(qi(),dt(),ur()+o,_c())}function yp(o,s,u,m){if(!m)if(3==(3&s[2])){const C=o.preOrderCheckHooks;null!==C&&ua(s,C,u)}else{const C=o.preOrderHooks;null!==C&&Ua(s,C,0,u)}Bo(u)}function vp(o,s){return o<<17|s<<2}function _s(o){return o>>17&32767}function hh(o){return 2|o}function va(o){return(131068&o)>>2}function Wl(o,s){return-131069&o|s<<2}function Gf(o){return 1|o}function pe(o,s){const u=o.contentQueries;if(null!==u)for(let m=0;m<u.length;m+=2){const _=u[m],C=u[m+1];if(-1!==C){const T=o.data[C];xc(_),T.contentQueries(2,s[C],C)}}}function ze(o,s,u,m,_,C,T,P,L,G){const W=s.blueprint.slice();return W[0]=_,W[2]=140|m,$i(W),W[3]=W[15]=o,W[8]=u,W[10]=T||o&&o[10],W[11]=P||o&&o[11],W[12]=L||o&&o[12]||null,W[9]=G||o&&o[9]||null,W[6]=C,W[16]=2==s.type?o[16]:W,W}function Ke(o,s,u,m,_){let C=o.data[s];if(null===C)C=function ct(o,s,u,m,_){const C=po(),T=mc(),L=o.data[s]=function Qr(o,s,u,m,_,C){return{type:u,index:m,insertBeforeIndex:null,injectorIndex:s?s.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:_,attrs:C,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:s,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,T?C:C&&C.parent,u,s,m,_);return null===o.firstChild&&(o.firstChild=L),null!==C&&(T?null==C.child&&null!==L.parent&&(C.child=L):null===C.next&&(C.next=L)),L}(o,s,u,m,_),function yc(){return Qt.lFrame.inI18n}()&&(C.flags|=64);else if(64&C.type){C.type=u,C.value=m,C.attrs=_;const T=function Na(){const o=Qt.lFrame,s=o.currentTNode;return o.isParent?s:s.parent}();C.injectorIndex=null===T?-1:T.injectorIndex}return Lo(C,!0),C}function rt(o,s,u,m){if(0===u)return-1;const _=s.length;for(let C=0;C<u;C++)s.push(m),o.blueprint.push(m),o.data.push(null);return _}function Nt(o,s,u){Rl(s);try{const m=o.viewQuery;null!==m&&sd(1,m,u);const _=o.template;null!==_&&Bt(o,s,_,1,u),o.firstCreatePass&&(o.firstCreatePass=!1),o.staticContentQueries&&pe(o,s),o.staticViewQueries&&sd(2,o.viewQuery,u);const C=o.components;null!==C&&function $e(o,s){for(let u=0;u<s.length;u++)Ag(o,s[u])}(s,C)}catch(m){throw o.firstCreatePass&&(o.incompleteFirstPass=!0,o.firstCreatePass=!1),m}finally{s[2]&=-5,Yo()}}function ei(o,s,u,m){const _=s[2];if(256==(256&_))return;Rl(s);const C=_c();try{$i(s),function Al(o){return Qt.lFrame.bindingIndex=o}(o.bindingStartIndex),null!==u&&Bt(o,s,u,2,m);const T=3==(3&_);if(!C)if(T){const G=o.preOrderCheckHooks;null!==G&&ua(s,G,null)}else{const G=o.preOrderHooks;null!==G&&Ua(s,G,0,null),Ft(s,0)}if(function Tg(o){for(let s=Uu(o);null!==s;s=lp(s)){if(!s[2])continue;const u=s[9];for(let m=0;m<u.length;m++){const _=u[m],C=_[3];0==(1024&_[2])&&as(C,1),_[2]|=1024}}}(s),function cl(o){for(let s=Uu(o);null!==s;s=lp(s))for(let u=10;u<s.length;u++){const m=s[u],_=m[1];Ji(m)&&ei(_,m,_.template,m[8])}}(s),null!==o.contentQueries&&pe(o,s),!C)if(T){const G=o.contentCheckHooks;null!==G&&ua(s,G)}else{const G=o.contentHooks;null!==G&&Ua(s,G,1),Ft(s,1)}!function de(o,s){const u=o.hostBindingOpCodes;if(null!==u)try{for(let m=0;m<u.length;m++){const _=u[m];if(_<0)Bo(~_);else{const C=_,T=u[++m],P=u[++m];Il(T,C),P(2,s[C])}}}finally{Bo(-1)}}(o,s);const P=o.components;null!==P&&function Ee(o,s){for(let u=0;u<s.length;u++)Wf(o,s[u])}(s,P);const L=o.viewQuery;if(null!==L&&sd(2,L,m),!C)if(T){const G=o.viewCheckHooks;null!==G&&ua(s,G)}else{const G=o.viewHooks;null!==G&&Ua(s,G,2),Ft(s,2)}!0===o.firstUpdatePass&&(o.firstUpdatePass=!1),C||(s[2]&=-73),1024&s[2]&&(s[2]&=-1025,as(s[3],-1))}finally{Yo()}}function Vt(o,s,u,m){const _=s[10],C=!_c(),T=aa(s);try{C&&!T&&_.begin&&_.begin(),T&&Nt(o,s,m),ei(o,s,u,m)}finally{C&&!T&&_.end&&_.end()}}function Bt(o,s,u,m,_){const C=ur(),T=2&m;try{Bo(-1),T&&s.length>20&&yp(o,s,20,_c()),u(m,_)}finally{Bo(C)}}function It(o,s,u){if(Mr(s)){const _=s.directiveEnd;for(let C=s.directiveStart;C<_;C++){const T=o.data[C];T.contentQueries&&T.contentQueries(1,u[C],C)}}}function jt(o,s,u){!Sl()||(function Ui(o,s,u,m){const _=u.directiveStart,C=u.directiveEnd;o.firstCreatePass||Is(u,s),Zr(m,s);const T=u.initialInputs;for(let P=_;P<C;P++){const L=o.data[P],G=Dr(L);G&&bs(s,u,L);const W=$a(s,o,P,u);Zr(W,s),null!==T&&_h(0,P-_,W,L,0,T),G&&(ho(u.index,s)[8]=W)}}(o,s,u,cr(u,s)),128==(128&u.flags)&&function Qo(o,s,u){const m=u.directiveStart,_=u.directiveEnd,T=u.index,P=function vc(){return Qt.lFrame.currentDirectiveIndex}();try{Bo(T);for(let L=m;L<_;L++){const G=o.data[L],W=s[L];bc(L),(null!==G.hostBindings||0!==G.hostVars||null!==G.hostAttrs)&&Hr(G,W)}}finally{Bo(-1),bc(P)}}(o,s,u))}function Lt(o,s,u=cr){const m=s.localNames;if(null!==m){let _=s.index+1;for(let C=0;C<m.length;C+=2){const T=m[C+1],P=-1===T?u(s,o):o[T];o[_++]=P}}}function _t(o){const s=o.tView;return null===s||s.incompleteFirstPass?o.tView=hi(1,null,o.template,o.decls,o.vars,o.directiveDefs,o.pipeDefs,o.viewQuery,o.schemas,o.consts):s}function hi(o,s,u,m,_,C,T,P,L,G){const W=20+m,ae=W+_,ve=function li(o,s){const u=[];for(let m=0;m<s;m++)u.push(m<o?null:Fi);return u}(W,ae),Re="function"==typeof G?G():G;return ve[1]={type:o,blueprint:ve,template:u,queries:null,viewQuery:P,declTNode:s,data:ve.slice().fill(null,W),bindingStartIndex:W,expandoStartIndex:ae,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof C?C():C,pipeRegistry:"function"==typeof T?T():T,firstChild:null,schemas:L,consts:Re,incompleteFirstPass:!1}}function In(o,s,u,m){const _=na(s);null===u?_.push(m):(_.push(u),o.firstCreatePass&&ad(o).push(m,_.length-1))}function or(o,s,u){for(let m in o)if(o.hasOwnProperty(m)){const _=o[m];(u=null===u?{}:u).hasOwnProperty(m)?u[m].push(s,_):u[m]=[s,_]}return u}function yn(o,s,u,m,_,C,T,P){const L=cr(s,u);let W,G=s.inputs;!P&&null!=G&&(W=G[m])?(Xl(o,u,W,m,_),Ra(s)&&function Jr(o,s){const u=ho(s,o);16&u[2]||(u[2]|=64)}(u,s.index)):3&s.type&&(m=function Ar(o){return"class"===o?"className":"for"===o?"htmlFor":"formaction"===o?"formAction":"innerHtml"===o?"innerHTML":"readonly"===o?"readOnly":"tabindex"===o?"tabIndex":o}(m),_=null!=T?T(_,s.value||"",m):_,qn(C)?C.setProperty(L,m,_):zi(m)||(L.setProperty?L.setProperty(m,_):L[m]=_))}function wo(o,s,u,m){let _=!1;if(Sl()){const C=function Co(o,s,u){const m=o.directiveRegistry;let _=null;if(m)for(let C=0;C<m.length;C++){const T=m[C];ya(u,T.selectors,!1)&&(_||(_=[]),Ys(Is(u,s),o,T.type),Dr(T)?(ys(o,u),_.unshift(T)):_.push(T))}return _}(o,s,u),T=null===m?null:{"":-1};if(null!==C){_=!0,ba(u,o.data.length,C.length);for(let W=0;W<C.length;W++){const ae=C[W];ae.providersResolver&&ae.providersResolver(ae)}let P=!1,L=!1,G=rt(o,s,C.length,null);for(let W=0;W<C.length;W++){const ae=C[W];u.mergedAttrs=As(u.mergedAttrs,ae.hostAttrs),vs(o,u,s,G,ae),ea(G,ae,T),null!==ae.contentQueries&&(u.flags|=8),(null!==ae.hostBindings||null!==ae.hostAttrs||0!==ae.hostVars)&&(u.flags|=128);const ve=ae.type.prototype;!P&&(ve.ngOnChanges||ve.ngOnInit||ve.ngDoCheck)&&((o.preOrderHooks||(o.preOrderHooks=[])).push(u.index),P=!0),!L&&(ve.ngOnChanges||ve.ngDoCheck)&&((o.preOrderCheckHooks||(o.preOrderCheckHooks=[])).push(u.index),L=!0),G++}!function pr(o,s){const m=s.directiveEnd,_=o.data,C=s.attrs,T=[];let P=null,L=null;for(let G=s.directiveStart;G<m;G++){const W=_[G],ae=W.inputs,ve=null===C||wg(s)?null:Eg(ae,C);T.push(ve),P=or(ae,G,P),L=or(W.outputs,G,L)}null!==P&&(P.hasOwnProperty("class")&&(s.flags|=16),P.hasOwnProperty("style")&&(s.flags|=32)),s.initialInputs=T,s.inputs=P,s.outputs=L}(o,u)}T&&function Js(o,s,u){if(s){const m=o.localNames=[];for(let _=0;_<s.length;_+=2){const C=u[s[_+1]];if(null==C)throw new vt(-301,!1);m.push(s[_],C)}}}(u,m,T)}return u.mergedAttrs=As(u.mergedAttrs,u.attrs),_}function On(o,s,u,m,_,C){const T=C.hostBindings;if(T){let P=o.hostBindingOpCodes;null===P&&(P=o.hostBindingOpCodes=[]);const L=~s.index;(function Ir(o){let s=o.length;for(;s>0;){const u=o[--s];if("number"==typeof u&&u<0)return u}return 0})(P)!=L&&P.push(L),P.push(m,_,T)}}function Hr(o,s){null!==o.hostBindings&&o.hostBindings(1,s)}function ys(o,s){s.flags|=2,(o.components||(o.components=[])).push(s.index)}function ea(o,s,u){if(u){if(s.exportAs)for(let m=0;m<s.exportAs.length;m++)u[s.exportAs[m]]=o;Dr(s)&&(u[""]=o)}}function ba(o,s,u){o.flags|=1,o.directiveStart=s,o.directiveEnd=s+u,o.providerIndexes=s}function vs(o,s,u,m,_){o.data[m]=_;const C=_.factory||(_.factory=qo(_.type)),T=new Ha(C,Dr(_),null);o.blueprint[m]=T,u[m]=T,On(o,s,0,m,rt(o,u,_.hostVars,Fi),_)}function bs(o,s,u){const m=cr(s,o),_=_t(u),C=o[10],T=Tp(o,ze(o,_,null,u.onPush?64:16,m,s,C,C.createRenderer(m,u),null,null));o[s.index]=T}function Qn(o,s,u,m,_,C){const T=cr(o,s);!function ta(o,s,u,m,_,C,T){if(null==C)qn(o)?o.removeAttribute(s,_,u):s.removeAttribute(_);else{const P=null==T?nt(C):T(C,m||"",_);qn(o)?o.setAttribute(s,_,P,u):u?s.setAttributeNS(u,_,P):s.setAttribute(_,P)}}(s[11],T,C,o.value,u,m,_)}function _h(o,s,u,m,_,C){const T=C[s];if(null!==T){const P=m.setInput;for(let L=0;L<T.length;){const G=T[L++],W=T[L++],ae=T[L++];null!==P?m.setInput(u,ae,G,W):u[W]=ae}}}function Eg(o,s){let u=null,m=0;for(;m<s.length;){const _=s[m];if(0!==_)if(5!==_){if("number"==typeof _)break;o.hasOwnProperty(_)&&(null===u&&(u=[]),u.push(_,o[_],s[m+1])),m+=2}else m+=2;else m+=4}return u}function Sp(o,s,u,m){return new Array(o,!0,!1,s,null,0,m,u,null,null)}function Wf(o,s){const u=ho(s,o);if(Ji(u)){const m=u[1];80&u[2]?ei(m,u,m.template,u[8]):u[5]>0&&yh(u)}}function yh(o){for(let m=Uu(o);null!==m;m=lp(m))for(let _=10;_<m.length;_++){const C=m[_];if(1024&C[2]){const T=C[1];ei(T,C,T.template,C[8])}else C[5]>0&&yh(C)}const u=o[1].components;if(null!==u)for(let m=0;m<u.length;m++){const _=ho(u[m],o);Ji(_)&&_[5]>0&&yh(_)}}function Ag(o,s){const u=ho(s,o),m=u[1];(function Ey(o,s){for(let u=s.length;u<o.blueprint.length;u++)s.push(o.blueprint[u])})(m,u),Nt(m,u,u[8])}function Tp(o,s){return o[13]?o[14][4]=s:o[13]=s,o[14]=s,s}function Zf(o){for(;o;){o[2]|=64;const s=ji(o);if(Pa(o)&&!s)return o;o=s}return null}function Xf(o,s,u){const m=s[10];m.begin&&m.begin();try{ei(o,s,o.template,u)}catch(_){throw Qf(s,_),_}finally{m.end&&m.end()}}function Ig(o){!function Kf(o){for(let s=0;s<o.components.length;s++){const u=o.components[s],m=Oc(u),_=m[1];Vt(_,m,_.template,u)}}(o[8])}function sd(o,s,u){xc(0),s(o,u)}const Go=(()=>Promise.resolve(null))();function na(o){return o[7]||(o[7]=[])}function ad(o){return o.cleanup||(o.cleanup=[])}function ld(o,s,u){return(null===o||Dr(o))&&(u=function Vd(o){for(;Array.isArray(o);){if("object"==typeof o[1])return o;o=o[0]}return null}(u[s.index])),u[11]}function Qf(o,s){const u=o[9],m=u?u.get(ah,null):null;m&&m.handleError(s)}function Xl(o,s,u,m,_){for(let C=0;C<u.length;){const T=u[C++],P=u[C++],L=s[T],G=o.data[T];null!==G.setInput?G.setInput(L,_,m,P):L[P]=_}}function Hc(o,s,u){const m=La(s,o);!function Bf(o,s,u){qn(o)?o.setValue(s,u):s.textContent=u}(o[11],m,u)}function kg(o,s,u){let m=u?o.styles:null,_=u?o.classes:null,C=0;if(null!==s)for(let T=0;T<s.length;T++){const P=s[T];"number"==typeof P?C=P:1==C?_=ne(_,P):2==C&&(m=ne(m,P+": "+s[++T]+";"))}u?o.styles=m:o.stylesWithoutHost=m,u?o.classes=_:o.classesWithoutHost=_}const Iy=new te("INJECTOR",-1);class R0{get(s,u=To){if(u===To){const m=new Error(`NullInjectorError: No provider for ${xe(s)}!`);throw m.name="NullInjectorError",m}return u}}const Rg=new te("Set Injector scope."),xs={},Ap={};let Gr;function Pg(){return void 0===Gr&&(Gr=new R0),Gr}function ko(o,s=null,u=null,m){const _=ky(o,s,u,m);return _._resolveInjectorDefTypes(),_}function ky(o,s=null,u=null,m){return new P0(o,u,s||Pg(),m)}class P0{constructor(s,u,m,_=null){this.parent=m,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const C=[];u&&oi(u,P=>this.processProvider(P,s,u)),oi([s],P=>this.processInjectorType(P,[],C)),this.records.set(Iy,ul(void 0,this));const T=this.records.get(Rg);this.scope=null!=T?T.value:null,this.source=_||("object"==typeof s?null:xe(s))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(s=>s.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(s,u=To,m=pi.Default){this.assertNotDestroyed();const _=Yh(this),C=er(void 0);try{if(!(m&pi.SkipSelf)){let P=this.records.get(s);if(void 0===P){const L=function L0(o){return"function"==typeof o||"object"==typeof o&&o instanceof te}(s)&&Wn(s);P=L&&this.injectableDefInScope(L)?ul($r(s),xs):null,this.records.set(s,P)}if(null!=P)return this.hydrate(s,P)}return(m&pi.Self?Pg():this.parent).get(s,u=m&pi.Optional&&u===To?null:u)}catch(T){if("NullInjectorError"===T.name){if((T[Ya]=T[Ya]||[]).unshift(xe(s)),_)throw T;return function ha(o,s,u,m){const _=o[Ya];throw s[Zo]&&_.unshift(s[Zo]),o.message=function mf(o,s,u,m=null){o=o&&"\n"===o.charAt(0)&&"\u0275"==o.charAt(1)?o.substr(2):o;let _=xe(s);if(Array.isArray(s))_=s.map(xe).join(" -> ");else if("object"==typeof s){let C=[];for(let T in s)if(s.hasOwnProperty(T)){let P=s[T];C.push(T+":"+("string"==typeof P?JSON.stringify(P):xe(P)))}_=`{${C.join(", ")}}`}return`${u}${m?"("+m+")":""}[${_}]: ${o.replace(yo,"\n  ")}`}("\n"+o.message,_,u,m),o.ngTokenPath=_,o[Ya]=null,o}(T,s,"R3InjectorError",this.source)}throw T}finally{er(C),Yh(_)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(s=>this.get(s))}toString(){const s=[];return this.records.forEach((m,_)=>s.push(xe(_))),`R3Injector[${s.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new vt(205,!1)}processInjectorType(s,u,m){if(!(s=Be(s)))return!1;let _=Cs(s);const C=null==_&&s.ngModule||void 0,T=void 0===C?s:C,P=-1!==m.indexOf(T);if(void 0!==C&&(_=Cs(C)),null==_)return!1;if(null!=_.imports&&!P){let W;m.push(T);try{oi(_.imports,ae=>{this.processInjectorType(ae,u,m)&&(void 0===W&&(W=[]),W.push(ae))})}finally{}if(void 0!==W)for(let ae=0;ae<W.length;ae++){const{ngModule:ve,providers:Re}=W[ae];oi(Re,st=>this.processProvider(st,ve,Re||wt))}}this.injectorDefTypes.add(T);const L=qo(T)||(()=>new T);this.records.set(T,ul(L,xs));const G=_.providers;if(null!=G&&!P){const W=s;oi(G,ae=>this.processProvider(ae,W,G))}return void 0!==C&&void 0!==s.providers}processProvider(s,u,m){let _=cd(s=Be(s))?s:Be(s&&s.provide);const C=function O0(o,s,u){return Fg(o)?ul(void 0,o.useValue):ul(Og(o),xs)}(s);if(cd(s)||!0!==s.multi)this.records.get(_);else{let T=this.records.get(_);T||(T=ul(void 0,xs,!0),T.factory=()=>Tr(T.multi),this.records.set(_,T)),_=s,T.multi.push(s)}this.records.set(_,C)}hydrate(s,u){return u.value===xs&&(u.value=Ap,u.value=u.factory()),"object"==typeof u.value&&u.value&&function PM(o){return null!==o&&"object"==typeof o&&"function"==typeof o.ngOnDestroy}(u.value)&&this.onDestroy.add(u.value),u.value}injectableDefInScope(s){if(!s.providedIn)return!1;const u=Be(s.providedIn);return"string"==typeof u?"any"===u||u===this.scope:this.injectorDefTypes.has(u)}}function $r(o){const s=Wn(o),u=null!==s?s.factory:qo(o);if(null!==u)return u;if(o instanceof te)throw new vt(204,!1);if(o instanceof Function)return function Ry(o){const s=o.length;if(s>0)throw Ii(s,"?"),new vt(204,!1);const u=function ns(o){const s=o&&(o[Ro]||o[Eo]);if(s){const u=function Jn(o){if(o.hasOwnProperty("name"))return o.name;const s=(""+o).match(/^function\s*([^\s(]+)/);return null===s?"":s[1]}(o);return console.warn(`DEPRECATED: DI is instantiating a token "${u}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${u}" class.`),s}return null}(o);return null!==u?()=>u.factory(o):()=>new o}(o);throw new vt(204,!1)}function Og(o,s,u){let m;if(cd(o)){const _=Be(o);return qo(_)||$r(_)}if(Fg(o))m=()=>Be(o.useValue);else if(function kM(o){return!(!o||!o.useFactory)}(o))m=()=>o.useFactory(...Tr(o.deps||[]));else if(function IM(o){return!(!o||!o.useExisting)}(o))m=()=>Xn(Be(o.useExisting));else{const _=Be(o&&(o.useClass||o.provide));if(!function F0(o){return!!o.deps}(o))return qo(_)||$r(_);m=()=>new _(...Tr(o.deps))}return m}function ul(o,s,u=!1){return{factory:o,value:s,multi:u?[]:void 0}}function Fg(o){return null!==o&&"object"==typeof o&&Sc in o}function cd(o){return"function"==typeof o}let dl=(()=>{class o{static create(u,m){var _;if(Array.isArray(u))return ko({name:""},m,u,"");{const C=null!==(_=u.name)&&void 0!==_?_:"";return ko({name:C},u.parent,u.providers,C)}}}return o.THROW_IF_NOT_FOUND=To,o.NULL=new R0,o.\u0275prov=Qi({token:o,providedIn:"any",factory:()=>Xn(Iy)}),o.__NG_ELEMENT_ID__=-1,o})();function zy(o,s){Gs(Oc(o)[1],gn())}function Ng(o){let s=function jy(o){return Object.getPrototypeOf(o.prototype).constructor}(o.type),u=!0;const m=[o];for(;s;){let _;if(Dr(o))_=s.\u0275cmp||s.\u0275dir;else{if(s.\u0275cmp)throw new vt(903,"");_=s.\u0275dir}if(_){if(u){m.push(_);const T=o;T.inputs=Gc(o.inputs),T.declaredInputs=Gc(o.declaredInputs),T.outputs=Gc(o.outputs);const P=_.hostBindings;P&&X0(o,P);const L=_.viewQuery,G=_.contentQueries;if(L&&K0(o,L),G&&BM(o,G),ye(o.inputs,_.inputs),ye(o.declaredInputs,_.declaredInputs),ye(o.outputs,_.outputs),Dr(_)&&_.data.animation){const W=o.data;W.animation=(W.animation||[]).concat(_.data.animation)}}const C=_.features;if(C)for(let T=0;T<C.length;T++){const P=C[T];P&&P.ngInherit&&P(o),P===Ng&&(u=!1)}}s=Object.getPrototypeOf(s)}!function Uy(o){let s=0,u=null;for(let m=o.length-1;m>=0;m--){const _=o[m];_.hostVars=s+=_.hostVars,_.hostAttrs=As(_.hostAttrs,u=As(u,_.hostAttrs))}}(m)}function Gc(o){return o===vi?{}:o===wt?[]:o}function K0(o,s){const u=o.viewQuery;o.viewQuery=u?(m,_)=>{s(m,_),u(m,_)}:s}function BM(o,s){const u=o.contentQueries;o.contentQueries=u?(m,_,C)=>{s(m,_,C),u(m,_,C)}:s}function X0(o,s){const u=o.hostBindings;o.hostBindings=u?(m,_)=>{s(m,_),u(m,_)}:s}let Jf=null;function Ql(){if(!Jf){const o=Vi.Symbol;if(o&&o.iterator)Jf=o.iterator;else{const s=Object.getOwnPropertyNames(Map.prototype);for(let u=0;u<s.length;++u){const m=s[u];"entries"!==m&&"size"!==m&&Map.prototype[m]===Map.prototype.entries&&(Jf=m)}}}return Jf}function em(o){return!!Ip(o)&&(Array.isArray(o)||!(o instanceof Map)&&Ql()in o)}function Ip(o){return null!==o&&("function"==typeof o||"object"==typeof o)}function to(o,s,u){return!Object.is(o[s],u)&&(o[s]=u,!0)}function qc(o,s,u,m,_){const C=function dd(o,s,u,m){const _=to(o,s,u);return to(o,s+1,m)||_}(o,s,u,m);return to(o,s+2,_)||C}function vh(o,s,u,m){const _=dt();return to(_,Ss(),s)&&(qi(),Qn(Nn(),_,o,s,u,m)),vh}function kp(o,s,u,m){return to(o,Ss(),u)?s+nt(u)+m:Fi}function Pp(o,s,u,m,_,C,T,P){const G=qc(o,function So(){return Qt.lFrame.bindingIndex}(),u,_,T);return ls(3),G?s+nt(u)+m+nt(_)+C+nt(T)+P:Fi}function Yy(o,s,u,m,_,C,T,P){const L=dt(),G=qi(),W=o+20,ae=G.firstCreatePass?function xh(o,s,u,m,_,C,T,P,L){const G=s.consts,W=Ke(s,o,4,T||null,Es(G,P));wo(s,u,W,Es(G,L)),Gs(s,W);const ae=W.tViews=hi(2,W,m,_,C,s.directiveRegistry,s.pipeRegistry,null,s.schemas,G);return null!==s.queries&&(s.queries.template(s,W),ae.queries=s.queries.embeddedTView(W)),W}(W,G,L,s,u,m,_,C,T):G.data[W];Lo(ae,!1);const ve=L[11].createComment("");Ku(G,L,ve,ae),Zr(ve,L),Tp(L,L[W]=Sp(ve,L,ve,ae)),ao(ae)&&jt(G,L,ae),null!=T&&Lt(L,ae,P)}function tx(o){return uo(function gc(){return Qt.lFrame.contextLView}(),20+o)}function im(o,s=pi.Default){const u=dt();return null===u?Xn(o,s):mo(gn(),u,Be(o),s)}function cx(){throw new Error("invalid")}function ov(o,s,u){const m=dt();return to(m,Ss(),s)&&yn(qi(),Nn(),m,o,s,m[11],u,!1),ov}function sv(o,s,u,m,_){const T=_?"class":"style";Xl(o,u,s.inputs[T],T,m)}function $g(o,s,u,m){const _=dt(),C=qi(),T=20+o,P=_[11],L=_[T]=up(P,s,function Gt(){return Qt.lFrame.currentNamespace}()),G=C.firstCreatePass?function QM(o,s,u,m,_,C,T){const P=s.consts,G=Ke(s,o,2,_,Es(P,C));return wo(s,u,G,Es(P,T)),null!==G.attrs&&kg(G,G.attrs,!1),null!==G.mergedAttrs&&kg(G,G.mergedAttrs,!0),null!==s.queries&&s.queries.elementStart(s,G),G}(T,C,_,0,s,u,m):C.data[T];Lo(G,!0);const W=G.mergedAttrs;null!==W&&En(P,L,W);const ae=G.classes;null!==ae&&zc(P,L,ae);const ve=G.styles;return null!==ve&&_a(P,L,ve),64!=(64&G.flags)&&Ku(C,_,L,G),0===function Ba(){return Qt.lFrame.elementDepthCount}()&&Zr(L,_),function fu(){Qt.lFrame.elementDepthCount++}(),ao(G)&&(jt(C,_,G),It(C,G,_)),null!==m&&Lt(_,G),$g}function qg(){let o=gn();mc()?js():(o=o.parent,Lo(o,!1));const s=o;!function mu(){Qt.lFrame.elementDepthCount--}();const u=qi();return u.firstCreatePass&&(Gs(u,o),Mr(o)&&u.queries.elementEnd(o)),null!=s.classesWithoutHost&&function Mc(o){return 0!=(16&o.flags)}(s)&&sv(u,s,dt(),s.classesWithoutHost,!0),null!=s.stylesWithoutHost&&function wu(o){return 0!=(32&o.flags)}(s)&&sv(u,s,dt(),s.stylesWithoutHost,!1),qg}function av(o,s,u,m){return $g(o,s,u,m),qg(),av}function Yg(o,s,u){const m=dt(),_=qi(),C=o+20,T=_.firstCreatePass?function JM(o,s,u,m,_){const C=s.consts,T=Es(C,m),P=Ke(s,o,8,"ng-container",T);return null!==T&&kg(P,T,!0),wo(s,u,P,Es(C,_)),null!==s.queries&&s.queries.elementStart(s,P),P}(C,_,m,s,u):_.data[C];Lo(T,!0);const P=m[C]=m[11].createComment("");return Ku(_,m,P,T),Zr(P,m),ao(T)&&(jt(_,m,T),It(_,T,m)),null!=u&&Lt(m,T),Yg}function Wg(){let o=gn();const s=qi();return mc()?js():(o=o.parent,Lo(o,!1)),s.firstCreatePass&&(Gs(s,o),Mr(o)&&s.queries.elementEnd(o)),Wg}function lv(o,s,u){return Yg(o,s,u),Wg(),lv}function ux(){return dt()}function cv(o){return!!o&&"function"==typeof o.then}function uv(o){return!!o&&"function"==typeof o.subscribe}const dx=uv;function dv(o,s,u,m){const _=dt(),C=qi(),T=gn();return hx(C,_,_[11],T,o,s,!!u,m),dv}function hv(o,s){const u=gn(),m=dt(),_=qi();return hx(_,m,ld(Us(_.data),u,m),u,o,s,!1),hv}function hx(o,s,u,m,_,C,T,P){const L=ao(m),W=o.firstCreatePass&&ad(o),ae=s[8],ve=na(s);let Re=!0;if(3&m.type||P){const Ut=cr(m,s),ci=P?P(Ut):Ut,pt=ve.length,Di=P?nn=>P(dn(nn[m.index])):m.index;if(qn(u)){let nn=null;if(!P&&L&&(nn=function eD(o,s,u,m){const _=o.cleanup;if(null!=_)for(let C=0;C<_.length-1;C+=2){const T=_[C];if(T===u&&_[C+1]===m){const P=s[7],L=_[C+2];return P.length>L?P[L]:null}"string"==typeof T&&(C+=2)}return null}(o,s,_,m.index)),null!==nn)(nn.__ngLastListenerFn__||nn).__ngNextListenerFn__=C,nn.__ngLastListenerFn__=C,Re=!1;else{C=Bp(m,s,ae,C,!1);const kn=u.listen(ci,_,C);ve.push(C,kn),W&&W.push(_,Di,pt,pt+1)}}else C=Bp(m,s,ae,C,!0),ci.addEventListener(_,C,T),ve.push(C),W&&W.push(_,Di,pt,T)}else C=Bp(m,s,ae,C,!1);const st=m.outputs;let Rt;if(Re&&null!==st&&(Rt=st[_])){const Ut=Rt.length;if(Ut)for(let ci=0;ci<Ut;ci+=2){const oa=s[Rt[ci]][Rt[ci+1]].subscribe(C),Ph=ve.length;ve.push(C,oa),W&&W.push(_,m.index,Ph,-(Ph+1))}}}function px(o,s,u,m){try{return!1!==u(m)}catch(_){return Qf(o,_),!1}}function Bp(o,s,u,m,_){return function C(T){if(T===Function)return m;const P=2&o.flags?ho(o.index,s):s;0==(32&s[2])&&Zf(P);let L=px(s,0,m,T),G=C.__ngNextListenerFn__;for(;G;)L=px(s,0,G,T)&&L,G=G.__ngNextListenerFn__;return _&&!1===L&&(T.preventDefault(),T.returnValue=!1),L}}function fx(o=1){return function Ts(o){return(Qt.lFrame.contextLView=function ja(o,s){for(;o>0;)s=s[15],o--;return s}(o,Qt.lFrame.contextLView))[8]}(o)}function tD(o,s){let u=null;const m=function Qs(o){const s=o.attrs;if(null!=s){const u=s.indexOf(5);if(0==(1&u))return s[u+1]}return null}(o);for(let _=0;_<s.length;_++){const C=s[_];if("*"!==C){if(null===m?ya(o,C,!0):Cg(m,C))return _}else u=_}return u}function mx(o){const s=dt()[16][6];if(!s.projection){const m=s.projection=Ii(o?o.length:1,null),_=m.slice();let C=s.child;for(;null!==C;){const T=o?tD(C,o):0;null!==T&&(_[T]?_[T].projectionNext=C:m[T]=C,_[T]=C),C=C.next}}}function gx(o,s=0,u){const m=dt(),_=qi(),C=Ke(_,20+o,16,null,u||null);null===C.projection&&(C.projection=s),js(),64!=(64&C.flags)&&function vg(o,s,u){rl(s[11],0,s,u,hp(o,u,s),pp(u.parent||s[6],u,s))}(_,m,C)}function pv(o,s,u){return fv(o,"",s,"",u),pv}function fv(o,s,u,m,_){const C=dt(),T=kp(C,s,u,m);return T!==Fi&&yn(qi(),Nn(),C,o,T,C[11],_,!1),fv}function om(o,s,u,m,_){const C=o[u+1],T=null===s;let P=m?_s(C):va(C),L=!1;for(;0!==P&&(!1===L||T);){const W=o[P+1];iD(o[P],s)&&(L=!0,o[P+1]=m?Gf(W):hh(W)),P=m?_s(W):va(W)}L&&(o[u+1]=m?hh(C):Gf(C))}function iD(o,s){return null===o||null==s||(Array.isArray(o)?o[1]:o)===s||!(!Array.isArray(o)||"string"!=typeof s)&&dr(o,s)>=0}function sm(o,s,u){return Ca(o,s,u,!1),sm}function Qg(o,s){return Ca(o,s,null,!0),Qg}function Ca(o,s,u,m){const _=dt(),C=qi(),T=ls(2);C.firstUpdatePass&&function yv(o,s,u,m){const _=o.data;if(null===_[u+1]){const C=_[ur()],T=function Ax(o,s){return s>=o.expandoStartIndex}(o,u);(function wv(o,s){return 0!=(o.flags&(s?16:32))})(C,m)&&null===s&&!T&&(s=!1),s=function e_(o,s,u,m){const _=Us(o);let C=m?s.residualClasses:s.residualStyles;if(null===_)0===(m?s.classBindings:s.styleBindings)&&(u=Ch(u=ic(null,o,s,u,m),s.attrs,m),C=null);else{const T=s.directiveStylingLast;if(-1===T||o[T]!==_)if(u=ic(_,o,s,u,m),null===C){let L=function vv(o,s,u){const m=u?s.classBindings:s.styleBindings;if(0!==va(m))return o[_s(m)]}(o,s,m);void 0!==L&&Array.isArray(L)&&(L=ic(null,o,s,L[1],m),L=Ch(L,s.attrs,m),function Ix(o,s,u,m){o[_s(u?s.classBindings:s.styleBindings)]=m}(o,s,m,L))}else C=function kx(o,s,u){let m;const _=s.directiveEnd;for(let C=1+s.directiveStylingLast;C<_;C++)m=Ch(m,o[C].hostAttrs,u);return Ch(m,s.attrs,u)}(o,s,m)}return void 0!==C&&(m?s.residualClasses=C:s.residualStyles=C),u}(_,C,s,m),function Zg(o,s,u,m,_,C){let T=C?s.classBindings:s.styleBindings,P=_s(T),L=va(T);o[m]=u;let W,G=!1;if(Array.isArray(u)){const ae=u;W=ae[1],(null===W||dr(ae,W)>0)&&(G=!0)}else W=u;if(_)if(0!==L){const ve=_s(o[P+1]);o[m+1]=vp(ve,P),0!==ve&&(o[ve+1]=Wl(o[ve+1],m)),o[P+1]=function dh(o,s){return 131071&o|s<<17}(o[P+1],m)}else o[m+1]=vp(P,0),0!==P&&(o[P+1]=Wl(o[P+1],m)),P=m;else o[m+1]=vp(L,0),0===P?P=m:o[L+1]=Wl(o[L+1],m),L=m;G&&(o[m+1]=hh(o[m+1])),om(o,W,m,!0),om(o,W,m,!1),function Cx(o,s,u,m,_){const C=_?o.residualClasses:o.residualStyles;null!=C&&"string"==typeof s&&dr(C,s)>=0&&(u[m+1]=Gf(u[m+1]))}(s,W,o,m,C),T=vp(P,L),C?s.classBindings=T:s.styleBindings=T}(_,C,s,u,T,m)}}(C,o,T,m),s!==Fi&&to(_,T,s)&&function xv(o,s,u,m,_,C,T,P){if(!(3&s.type))return;const L=o.data,G=L[P+1];am(function Mg(o){return 1==(1&o)}(G)?i_(L,s,u,_,va(G),T):void 0)||(am(C)||function bp(o){return 2==(2&o)}(G)&&(C=i_(L,null,u,_,P,T)),function bg(o,s,u,m,_){const C=qn(o);if(s)_?C?o.addClass(u,m):u.classList.add(m):C?o.removeClass(u,m):u.classList.remove(m);else{let T=-1===m.indexOf("-")?void 0:Un.DashCase;if(null==_)C?o.removeStyle(u,m,T):u.style.removeProperty(m);else{const P="string"==typeof _&&_.endsWith("!important");P&&(_=_.slice(0,-10),T|=Un.Important),C?o.setStyle(u,m,_,T):u.style.setProperty(m,_,P?"important":"")}}}(m,T,La(ur(),u),_,C))}(C,C.data[ur()],_,_[11],o,_[T+1]=function Px(o,s){return null==o||("string"==typeof s?o+=s:"object"==typeof o&&(o=xe(hr(o)))),o}(s,u),m,T)}function ic(o,s,u,m,_){let C=null;const T=u.directiveEnd;let P=u.directiveStylingLast;for(-1===P?P=u.directiveStart:P++;P<T&&(C=s[P],m=Ch(m,C.hostAttrs,_),C!==o);)P++;return null!==o&&(u.directiveStylingLast=P),m}function Ch(o,s,u){const m=u?1:2;let _=-1;if(null!==s)for(let C=0;C<s.length;C++){const T=s[C];"number"==typeof T?_=T:_===m&&(Array.isArray(o)||(o=void 0===o?[]:["",o]),ln(o,T,!!u||s[++C]))}return void 0===o?null:o}function i_(o,s,u,m,_,C){const T=null===s;let P;for(;_>0;){const L=o[_],G=Array.isArray(L),W=G?L[1]:L,ae=null===W;let ve=u[_+1];ve===Fi&&(ve=ae?wt:void 0);let Re=ae?_o(ve,m):W===m?ve:void 0;if(G&&!am(Re)&&(Re=_o(L,m)),am(Re)&&(P=Re,T))return P;const st=o[_+1];_=T?_s(st):va(st)}if(null!==s){let L=C?s.residualClasses:s.residualStyles;null!=L&&(P=_o(L,m))}return P}function am(o){return void 0!==o}function Ma(o,s=""){const u=dt(),m=qi(),_=o+20,C=m.firstCreatePass?Ke(m,_,1,s,null):m.data[_],T=u[_]=function Hu(o,s){return qn(o)?o.createText(s):o.createTextNode(s)}(u[11],s);Ku(m,u,T,C),Lo(C,!1)}function Cv(o){return lm("",o,""),Cv}function lm(o,s,u){const m=dt(),_=kp(m,o,s,u);return _!==Fi&&Hc(m,ur(),_),lm}function Mv(o,s,u,m,_,C,T){const P=dt(),L=Pp(P,o,s,u,m,_,C,T);return L!==Fi&&Hc(P,ur(),L),Mv}function Np(o,s,u){const m=dt();return to(m,Ss(),s)&&yn(qi(),Nn(),m,o,s,m[11],u,!0),Np}function fd(o,s,u){const m=dt();if(to(m,Ss(),s)){const C=qi(),T=Nn();yn(C,T,m,o,s,ld(Us(C.data),T,m),u,!0)}return fd}const md=void 0;var qx=["en",[["a","p"],["AM","PM"],md],[["AM","PM"],md,md],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],md,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],md,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",md,"{1} 'at' {0}",md],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function $x(o){const u=Math.floor(Math.abs(o)),m=o.toString().replace(/^[^.]*\.?/,"").length;return 1===u&&0===m?1:5}];let Mh={};function n_(o){const s=function Dh(o){return o.toLowerCase().replace(/_/g,"-")}(o);let u=rc(s);if(u)return u;const m=s.split("-")[0];if(u=rc(m),u)return u;if("en"===m)return qx;throw new Error(`Missing locale data for the locale "${o}".`)}function r_(o){return n_(o)[Ti.PluralCase]}function rc(o){return o in Mh||(Mh[o]=Vi.ng&&Vi.ng.common&&Vi.ng.common.locales&&Vi.ng.common.locales[o]),Mh[o]}var Ti=(()=>((Ti=Ti||{})[Ti.LocaleId=0]="LocaleId",Ti[Ti.DayPeriodsFormat=1]="DayPeriodsFormat",Ti[Ti.DayPeriodsStandalone=2]="DayPeriodsStandalone",Ti[Ti.DaysFormat=3]="DaysFormat",Ti[Ti.DaysStandalone=4]="DaysStandalone",Ti[Ti.MonthsFormat=5]="MonthsFormat",Ti[Ti.MonthsStandalone=6]="MonthsStandalone",Ti[Ti.Eras=7]="Eras",Ti[Ti.FirstDayOfWeek=8]="FirstDayOfWeek",Ti[Ti.WeekendRange=9]="WeekendRange",Ti[Ti.DateFormat=10]="DateFormat",Ti[Ti.TimeFormat=11]="TimeFormat",Ti[Ti.DateTimeFormat=12]="DateTimeFormat",Ti[Ti.NumberSymbols=13]="NumberSymbols",Ti[Ti.NumberFormats=14]="NumberFormats",Ti[Ti.CurrencyCode=15]="CurrencyCode",Ti[Ti.CurrencySymbol=16]="CurrencySymbol",Ti[Ti.CurrencyName=17]="CurrencyName",Ti[Ti.Currencies=18]="Currencies",Ti[Ti.Directionality=19]="Directionality",Ti[Ti.PluralCase=20]="PluralCase",Ti[Ti.ExtraData=21]="ExtraData",Ti))();const Da="en-US";let o_=Da;function f_(o,s,u,m,_){if(o=Be(o),Array.isArray(o))for(let C=0;C<o.length;C++)f_(o[C],s,u,m,_);else{const C=qi(),T=dt();let P=cd(o)?o:Be(o.provide),L=Og(o);const G=gn(),W=1048575&G.providerIndexes,ae=G.directiveStart,ve=G.providerIndexes>>20;if(cd(o)||!o.multi){const Re=new Ha(L,_,im),st=ml(P,s,_?W:W+ve,ae);-1===st?(Ys(Is(G,T),C,P),m_(C,o,s.length),s.push(P),G.directiveStart++,G.directiveEnd++,_&&(G.providerIndexes+=1048576),u.push(Re),T.push(Re)):(u[st]=Re,T[st]=Re)}else{const Re=ml(P,s,W+ve,ae),st=ml(P,s,W,W+ve),Rt=Re>=0&&u[Re],Ut=st>=0&&u[st];if(_&&!Ut||!_&&!Rt){Ys(Is(G,T),C,P);const ci=function pw(o,s,u,m,_){const C=new Ha(o,u,im);return C.multi=[],C.index=s,C.componentProviders=0,bm(C,_,m&&!u),C}(_?ro:Yv,u.length,_,m,L);!_&&Ut&&(u[st].providerFactory=ci),m_(C,o,s.length,0),s.push(P),G.directiveStart++,G.directiveEnd++,_&&(G.providerIndexes+=1048576),u.push(ci),T.push(ci)}else m_(C,o,Re>-1?Re:st,bm(u[_?st:Re],L,!_&&m));!_&&m&&Ut&&u[st].componentProviders++}}}function m_(o,s,u,m){const _=cd(s),C=function RM(o){return!!o.useClass}(s);if(_||C){const L=(C?Be(s.useClass):s).prototype.ngOnDestroy;if(L){const G=o.destroyHooks||(o.destroyHooks=[]);if(!_&&s.multi){const W=G.indexOf(u);-1===W?G.push(u,[m,L]):G[W+1].push(m,L)}else G.push(u,L)}}}function bm(o,s,u){return u&&o.componentProviders++,o.multi.push(s)-1}function ml(o,s,u,m){for(let _=u;_<m;_++)if(s[_]===o)return _;return-1}function Yv(o,s,u,m){return gl(this.multi,[])}function ro(o,s,u,m){const _=this.multi;let C;if(this.providerFactory){const T=this.providerFactory.componentProviders,P=$a(u,u[1],this.providerFactory.index,m);C=P.slice(0,T),gl(_,C);for(let L=T;L<P.length;L++)C.push(P[L])}else C=[],gl(_,C);return C}function gl(o,s){for(let u=0;u<o.length;u++)s.push((0,o[u])());return s}function g_(o,s=[]){return u=>{u.providersResolver=(m,_)=>function hw(o,s,u){const m=qi();if(m.firstCreatePass){const _=Dr(o);f_(u,m.data,m.blueprint,_,!0),f_(s,m.data,m.blueprint,_,!1)}}(m,_?_(o):o,s)}}class __{}class Kv{resolveComponentFactory(s){throw function Zv(o){const s=Error(`No component factory found for ${xe(o)}. Did you add it to @NgModule.entryComponents?`);return s.ngComponent=o,s}(s)}}let jp=(()=>{class o{}return o.NULL=new Kv,o})();function Xv(){return oc(gn(),dt())}function oc(o,s){return new Th(cr(o,s))}let Th=(()=>{class o{constructor(u){this.nativeElement=u}}return o.__NG_ELEMENT_ID__=Xv,o})();function Qv(o){return o instanceof Th?o.nativeElement:o}class v_{}let gw=(()=>{class o{}return o.__NG_ELEMENT_ID__=()=>function eb(){const o=dt(),u=ho(gn().index,o);return function Jv(o){return o[11]}(mn(u)?u:o)}(),o})(),b_=(()=>{class o{}return o.\u0275prov=Qi({token:o,providedIn:"root",factory:()=>null}),o})();class x_{constructor(s){this.full=s,this.major=s.split(".")[0],this.minor=s.split(".")[1],this.patch=s.split(".").slice(2).join(".")}}const w_=new x_("13.3.0"),xm={};function Up(o,s,u,m,_=!1){for(;null!==u;){const C=s[u.index];if(null!==C&&m.push(dn(C)),Bi(C))for(let P=10;P<C.length;P++){const L=C[P],G=L[1].firstChild;null!==G&&Up(L[1],L,G,m)}const T=u.type;if(8&T)Up(o,s,u.child,m);else if(32&T){const P=zr(u,s);let L;for(;L=P();)m.push(L)}else if(16&T){const P=uh(s,u);if(Array.isArray(P))m.push(...P);else{const L=ji(s[16]);Up(L[1],L,P,m,!0)}}u=_?u.projectionNext:u.next}return m}class Ah{constructor(s,u){this._lView=s,this._cdRefInjectingView=u,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const s=this._lView,u=s[1];return Up(u,s,u.firstChild,[])}get context(){return this._lView[8]}set context(s){this._lView[8]=s}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const s=this._lView[3];if(Bi(s)){const u=s[8],m=u?u.indexOf(this):-1;m>-1&&($u(s,m),mi(u,m))}this._attachedToViewContainer=!1}Nf(this._lView[1],this._lView)}onDestroy(s){In(this._lView[1],this._lView,null,s)}markForCheck(){Zf(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){Xf(this._lView[1],this._lView,this.context)}checkNoChanges(){!function Ty(o,s,u){la(!0);try{Xf(o,s,u)}finally{la(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new vt(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Lc(o,s){jr(o,s,s[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(s){if(this._attachedToViewContainer)throw new vt(902,"");this._appRef=s}}class C_ extends Ah{constructor(s){super(s),this._view=s}detectChanges(){Ig(this._view)}checkNoChanges(){!function ia(o){la(!0);try{Ig(o)}finally{la(!1)}}(this._view)}get context(){return null}}class Hp extends jp{constructor(s){super(),this.ngModule=s}resolveComponentFactory(s){const u=z(s);return new Ea(u,this.ngModule)}}function M_(o){const s=[];for(let u in o)o.hasOwnProperty(u)&&s.push({propName:o[u],templateName:u});return s}class Ea extends __{constructor(s,u){super(),this.componentDef=s,this.ngModule=u,this.componentType=s.type,this.selector=function gp(o){return o.map(al).join(",")}(s.selectors),this.ngContentSelectors=s.ngContentSelectors?s.ngContentSelectors:[],this.isBoundToModule=!!u}get inputs(){return M_(this.componentDef.inputs)}get outputs(){return M_(this.componentDef.outputs)}create(s,u,m,_){const C=(_=_||this.ngModule)?function ib(o,s){return{get:(u,m,_)=>{const C=o.get(u,xm,_);return C!==xm||m===xm?C:s.get(u,m,_)}}}(s,_.injector):s,T=C.get(v_,hc),P=C.get(b_,null),L=T.createRenderer(null,this.componentDef),G=this.componentDef.selectors[0][0]||"div",W=m?function An(o,s,u){if(qn(o))return o.selectRootElement(s,u===Yi.ShadowDom);let m="string"==typeof s?o.querySelector(s):s;return m.textContent="",m}(L,m,this.componentDef.encapsulation):up(T.createRenderer(null,this.componentDef),G,function tb(o){const s=o.toLowerCase();return"svg"===s?"svg":"math"===s?"math":null}(G)),ae=this.componentDef.onPush?576:528,ve=function W0(o,s){return{components:[],scheduler:o||Vr,clean:Go,playerHandler:s||null,flags:0}}(),Re=hi(0,null,null,1,0,null,null,null,null,null),st=ze(null,Re,ve,ae,null,null,T,L,P,C);let Rt,Ut;Rl(st);try{const ci=function q0(o,s,u,m,_,C){const T=u[1];u[20]=o;const L=Ke(T,20,2,"#host",null),G=L.mergedAttrs=s.hostAttrs;null!==G&&(kg(L,G,!0),null!==o&&(En(_,o,G),null!==L.classes&&zc(_,o,L.classes),null!==L.styles&&_a(_,o,L.styles)));const W=m.createRenderer(o,s),ae=ze(u,_t(s),null,s.onPush?64:16,u[20],L,m,W,C||null,null);return T.firstCreatePass&&(Ys(Is(L,u),T,s.type),ys(T,L),ba(L,u.length,1)),Tp(u,ae),u[20]=ae}(W,this.componentDef,st,T,L);if(W)if(m)En(L,W,["ng-version",w_.full]);else{const{attrs:pt,classes:Di}=function ll(o){const s=[],u=[];let m=1,_=2;for(;m<o.length;){let C=o[m];if("string"==typeof C)2===_?""!==C&&s.push(C,o[++m]):8===_&&u.push(C);else{if(!Xo(_))break;_=C}m++}return{attrs:s,classes:u}}(this.componentDef.selectors[0]);pt&&En(L,W,pt),Di&&Di.length>0&&zc(L,W,Di.join(" "))}if(Ut=zs(Re,20),void 0!==u){const pt=Ut.projection=[];for(let Di=0;Di<this.ngContentSelectors.length;Di++){const nn=u[Di];pt.push(null!=nn?Array.from(nn):null)}}Rt=function Y0(o,s,u,m,_){const C=u[1],T=function Ho(o,s,u){const m=gn();o.firstCreatePass&&(u.providersResolver&&u.providersResolver(u),vs(o,m,s,rt(o,s,1,null),u));const _=$a(s,o,m.directiveStart,m);Zr(_,s);const C=cr(m,s);return C&&Zr(C,s),_}(C,u,s);if(m.components.push(T),o[8]=T,_&&_.forEach(L=>L(T,s)),s.contentQueries){const L=gn();s.contentQueries(1,T,L.directiveStart)}const P=gn();return!C.firstCreatePass||null===s.hostBindings&&null===s.hostAttrs||(Bo(P.index),On(u[1],P,0,P.directiveStart,P.directiveEnd,s),Hr(s,T)),T}(ci,this.componentDef,st,ve,[zy]),Nt(Re,st,null)}finally{Yo()}return new $D(this.componentType,Rt,oc(Ut,st),st,Ut)}}class $D extends class Wv{}{constructor(s,u,m,_,C){super(),this.location=m,this._rootLView=_,this._tNode=C,this.instance=u,this.hostView=this.changeDetectorRef=new C_(_),this.componentType=s}get injector(){return new b(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(s){this.hostView.onDestroy(s)}}class Ih{}class nb{}const Jc=new Map;class vw extends Ih{constructor(s,u){super(),this._parent=u,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new Hp(this);const m=ie(s);this._bootstrapComponents=en(m.bootstrap),this._r3Injector=ky(s,u,[{provide:Ih,useValue:this},{provide:jp,useValue:this.componentFactoryResolver}],xe(s)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(s)}get(s,u=dl.THROW_IF_NOT_FOUND,m=pi.Default){return s===dl||s===Ih||s===Iy?this:this._r3Injector.get(s,u,m)}destroy(){const s=this._r3Injector;!s.destroyed&&s.destroy(),this.destroyCbs.forEach(u=>u()),this.destroyCbs=null}onDestroy(s){this.destroyCbs.push(s)}}class ob extends nb{constructor(s){super(),this.moduleType=s,null!==ie(s)&&function E_(o){const s=new Set;!function u(m){const _=ie(m,!0),C=_.id;null!==C&&(function rb(o,s,u){if(s&&s!==u)throw new Error(`Duplicate module registered for ${o} - ${xe(s)} vs ${xe(s.name)}`)}(C,Jc.get(C),m),Jc.set(C,m));const T=en(_.imports);for(const P of T)s.has(P)||(s.add(P),u(P))}(o)}(s)}create(s){return new vw(this.moduleType,s)}}function bw(o,s,u,m){return ab(dt(),Er(),o,s,u,m)}function ab(o,s,u,m,_,C){const T=s+u;return to(o,T,_)?function xa(o,s,u){return o[s]=u}(o,T+1,C?m.call(C,_):m(_)):function eu(o,s){const u=o[s];return u===Fi?void 0:u}(o,T+1)}function S_(o,s){const u=qi();let m;const _=o+20;u.firstCreatePass?(m=function Dw(o,s){if(s)for(let u=s.length-1;u>=0;u--){const m=s[u];if(o===m.name)return m}}(s,u.pipeRegistry),u.data[_]=m,m.onDestroy&&(u.destroyHooks||(u.destroyHooks=[])).push(_,m.onDestroy)):m=u.data[_];const C=m.factory||(m.factory=qo(m.type)),T=er(im);try{const P=Wo(!1),L=C();return Wo(P),function jM(o,s,u,m){u>=o.data.length&&(o.data[u]=null,o.blueprint[u]=null),s[u]=m}(u,dt(),_,L),L}finally{er(T)}}function T_(o,s,u){const m=o+20,_=dt(),C=uo(_,m);return function Dm(o,s){return o[1].data[s].pure}(_,m)?ab(_,Er(),s,C.transform,u,C):C.transform(u)}function I_(o){return s=>{setTimeout(o,void 0,s)}}const Sa=class A_ extends h.x{constructor(s=!1){super(),this.__isAsync=s}emit(s){super.next(s)}subscribe(s,u,m){var _,C,T;let P=s,L=u||(()=>null),G=m;if(s&&"object"==typeof s){const ae=s;P=null===(_=ae.next)||void 0===_?void 0:_.bind(ae),L=null===(C=ae.error)||void 0===C?void 0:C.bind(ae),G=null===(T=ae.complete)||void 0===T?void 0:T.bind(ae)}this.__isAsync&&(L=I_(L),P&&(P=I_(P)),G&&(G=I_(G)));const W=super.subscribe({next:P,error:L,complete:G});return s instanceof Te.w0&&s.add(W),W}};function k_(){return this._results[Ql()]()}class kh{constructor(s=!1){this._emitDistinctChangesOnly=s,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const u=Ql(),m=kh.prototype;m[u]||(m[u]=k_)}get changes(){return this._changes||(this._changes=new Sa)}get(s){return this._results[s]}map(s){return this._results.map(s)}filter(s){return this._results.filter(s)}find(s){return this._results.find(s)}reduce(s,u){return this._results.reduce(s,u)}forEach(s){this._results.forEach(s)}some(s){return this._results.some(s)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(s,u){const m=this;m.dirty=!1;const _=St(s);(this._changesDetected=!function Zt(o,s,u){if(o.length!==s.length)return!1;for(let m=0;m<o.length;m++){let _=o[m],C=s[m];if(u&&(_=u(_),C=u(C)),C!==_)return!1}return!0}(m._results,_,u))&&(m._results=_,m.length=_.length,m.last=_[this.length-1],m.first=_[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let Em=(()=>{class o{}return o.__NG_ELEMENT_ID__=Sm,o})();const R_=Em,qp=class extends R_{constructor(s,u,m){super(),this._declarationLView=s,this._declarationTContainer=u,this.elementRef=m}createEmbeddedView(s){const u=this._declarationTContainer.tViews,m=ze(this._declarationLView,u,s,16,null,u.declTNode,null,null,null,null);m[17]=this._declarationLView[this._declarationTContainer.index];const C=this._declarationLView[19];return null!==C&&(m[19]=C.createEmbeddedView(u)),Nt(u,m,s),new Ah(m)}};function Sm(){return sc(gn(),dt())}function sc(o,s){return 4&o.type?new qp(s,o,oc(o,s)):null}let tu=(()=>{class o{}return o.__NG_ELEMENT_ID__=Tw,o})();function Tw(){return Yp(gn(),dt())}const P_=tu,O_=class extends P_{constructor(s,u,m){super(),this._lContainer=s,this._hostTNode=u,this._hostLView=m}get element(){return oc(this._hostTNode,this._hostLView)}get injector(){return new b(this._hostTNode,this._hostLView)}get parentInjector(){const s=No(this._hostTNode,this._hostLView);if(zt(s)){const u=Jt(s,this._hostLView),m=Ei(s);return new b(u[1].data[m+8],u)}return new b(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(s){const u=Tm(this._lContainer);return null!==u&&u[s]||null}get length(){return this._lContainer.length-10}createEmbeddedView(s,u,m){const _=s.createEmbeddedView(u||{});return this.insert(_,m),_}createComponent(s,u,m,_,C){const T=s&&!function mt(o){return"function"==typeof o}(s);let P;if(T)P=u;else{const ae=u||{};P=ae.index,m=ae.injector,_=ae.projectableNodes,C=ae.ngModuleRef}const L=T?s:new Ea(z(s)),G=m||this.parentInjector;if(!C&&null==L.ngModule){const ve=(T?G:this.parentInjector).get(Ih,null);ve&&(C=ve)}const W=L.create(G,_,void 0,C);return this.insert(W.hostView,P),W}insert(s,u){const m=s._lView,_=m[1];if(function Ln(o){return Bi(o[3])}(m)){const W=this.indexOf(s);if(-1!==W)this.detach(W);else{const ae=m[3],ve=new O_(ae,ae[6],ae[3]);ve.detach(ve.indexOf(s))}}const C=this._adjustIndex(u),T=this._lContainer;!function Bc(o,s,u,m){const _=10+m,C=u.length;m>0&&(u[_-1][4]=s),m<C-10?(s[4]=u[_],Zi(u,10+m,s)):(u.push(s),s[4]=null),s[3]=u;const T=s[17];null!==T&&u!==T&&function Nc(o,s){const u=o[9];s[16]!==s[3][3][16]&&(o[2]=!0),null===u?o[9]=[s]:u.push(s)}(T,s);const P=s[19];null!==P&&P.insertView(o),s[2]|=128}(_,m,T,C);const P=Qu(C,T),L=m[11],G=Wu(L,T[7]);return null!==G&&function jo(o,s,u,m,_,C){m[0]=_,m[6]=s,jr(o,m,u,1,_,C)}(_,T[6],L,m,G,P),s.attachToViewContainerRef(),Zi(Am(T),C,s),s}move(s,u){return this.insert(s,u)}indexOf(s){const u=Tm(this._lContainer);return null!==u?u.indexOf(s):-1}remove(s){const u=this._adjustIndex(s,-1),m=$u(this._lContainer,u);m&&(mi(Am(this._lContainer),u),Nf(m[1],m))}detach(s){const u=this._adjustIndex(s,-1),m=$u(this._lContainer,u);return m&&null!=mi(Am(this._lContainer),u)?new Ah(m):null}_adjustIndex(s,u=0){return null==s?this.length+u:s}};function Tm(o){return o[8]}function Am(o){return o[8]||(o[8]=[])}function Yp(o,s){let u;const m=s[o.index];if(Bi(m))u=m;else{let _;if(8&o.type)_=dn(m);else{const C=s[11];_=C.createComment("");const T=cr(o,s);ma(C,Wu(C,T),_,function Xs(o,s){return qn(o)?o.nextSibling(s):s.nextSibling}(C,T),!1)}s[o.index]=u=Sp(m,s,_,o),Tp(s,u)}return new O_(u,o,s)}class Im{constructor(s){this.queryList=s,this.matches=null}clone(){return new Im(this.queryList)}setDirty(){this.queryList.setDirty()}}class km{constructor(s=[]){this.queries=s}createEmbeddedView(s){const u=s.queries;if(null!==u){const m=null!==s.contentQueries?s.contentQueries[0]:u.length,_=[];for(let C=0;C<m;C++){const T=u.getByIndex(C);_.push(this.queries[T.indexInDeclarationView].clone())}return new km(_)}return null}insertView(s){this.dirtyQueriesWithMatches(s)}detachView(s){this.dirtyQueriesWithMatches(s)}dirtyQueriesWithMatches(s){for(let u=0;u<this.queries.length;u++)null!==V_(s,u).matches&&this.queries[u].setDirty()}}class L_{constructor(s,u,m=null){this.predicate=s,this.flags=u,this.read=m}}class Wp{constructor(s=[]){this.queries=s}elementStart(s,u){for(let m=0;m<this.queries.length;m++)this.queries[m].elementStart(s,u)}elementEnd(s){for(let u=0;u<this.queries.length;u++)this.queries[u].elementEnd(s)}embeddedTView(s){let u=null;for(let m=0;m<this.length;m++){const _=null!==u?u.length:0,C=this.getByIndex(m).embeddedTView(s,_);C&&(C.indexInDeclarationView=m,null!==u?u.push(C):u=[C])}return null!==u?new Wp(u):null}template(s,u){for(let m=0;m<this.queries.length;m++)this.queries[m].template(s,u)}getByIndex(s){return this.queries[s]}get length(){return this.queries.length}track(s){this.queries.push(s)}}class Rm{constructor(s,u=-1){this.metadata=s,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=u}elementStart(s,u){this.isApplyingToNode(u)&&this.matchTNode(s,u)}elementEnd(s){this._declarationNodeIndex===s.index&&(this._appliesToNextNode=!1)}template(s,u){this.elementStart(s,u)}embeddedTView(s,u){return this.isApplyingToNode(s)?(this.crossesNgTemplate=!0,this.addMatch(-s.index,u),new Rm(this.metadata)):null}isApplyingToNode(s){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const u=this._declarationNodeIndex;let m=s.parent;for(;null!==m&&8&m.type&&m.index!==u;)m=m.parent;return u===(null!==m?m.index:-1)}return this._appliesToNextNode}matchTNode(s,u){const m=this.metadata.predicate;if(Array.isArray(m))for(let _=0;_<m.length;_++){const C=m[_];this.matchTNodeWithReadOption(s,u,B_(u,C)),this.matchTNodeWithReadOption(s,u,xn(u,s,C,!1,!1))}else m===Em?4&u.type&&this.matchTNodeWithReadOption(s,u,-1):this.matchTNodeWithReadOption(s,u,xn(u,s,m,!1,!1))}matchTNodeWithReadOption(s,u,m){if(null!==m){const _=this.metadata.read;if(null!==_)if(_===Th||_===tu||_===Em&&4&u.type)this.addMatch(u.index,-2);else{const C=xn(u,s,_,!1,!1);null!==C&&this.addMatch(u.index,C)}else this.addMatch(u.index,m)}}addMatch(s,u){null===this.matches?this.matches=[s,u]:this.matches.push(s,u)}}function B_(o,s){const u=o.localNames;if(null!==u)for(let m=0;m<u.length;m+=2)if(u[m]===s)return u[m+1];return null}function Iw(o,s,u,m){return-1===u?function Aw(o,s){return 11&o.type?oc(o,s):4&o.type?sc(o,s):null}(s,o):-2===u?function Zp(o,s,u){return u===Th?oc(s,o):u===Em?sc(s,o):u===tu?Yp(s,o):void 0}(o,s,m):$a(o,o[1],u,s)}function Kp(o,s,u,m){const _=s[19].queries[m];if(null===_.matches){const C=o.data,T=u.matches,P=[];for(let L=0;L<T.length;L+=2){const G=T[L];P.push(G<0?null:Iw(s,C[G],T[L+1],u.metadata.read))}_.matches=P}return _.matches}function Pm(o,s,u,m){const _=o.queries.getByIndex(u),C=_.matches;if(null!==C){const T=Kp(o,s,_,u);for(let P=0;P<C.length;P+=2){const L=C[P];if(L>0)m.push(T[P/2]);else{const G=C[P+1],W=s[-L];for(let ae=10;ae<W.length;ae++){const ve=W[ae];ve[17]===ve[3]&&Pm(ve[1],ve,G,m)}if(null!==W[9]){const ae=W[9];for(let ve=0;ve<ae.length;ve++){const Re=ae[ve];Pm(Re[1],Re,G,m)}}}}}return m}function kw(o){const s=dt(),u=qi(),m=jd();xc(m+1);const _=V_(u,m);if(o.dirty&&aa(s)===(2==(2&_.metadata.flags))){if(null===_.matches)o.reset([]);else{const C=_.crossesNgTemplate?Pm(u,s,m,[]):Kp(u,s,_,m);o.reset(C,Qv),o.notifyOnChanges()}return!0}return!1}function Rw(o,s,u){const m=qi();m.firstCreatePass&&(hb(m,new L_(o,s,u),-1),2==(2&s)&&(m.staticViewQueries=!0)),N_(m,dt(),s)}function Pw(o,s,u,m){const _=qi();if(_.firstCreatePass){const C=gn();hb(_,new L_(s,u,m),C.index),function pb(o,s){const u=o.contentQueries||(o.contentQueries=[]);s!==(u.length?u[u.length-1]:-1)&&u.push(o.queries.length-1,s)}(_,o),2==(2&u)&&(_.staticContentQueries=!0)}N_(_,dt(),u)}function Ow(){return function Fw(o,s){return o[19].queries[s].queryList}(dt(),jd())}function N_(o,s,u){const m=new kh(4==(4&u));In(o,s,m,m.destroy),null===s[19]&&(s[19]=new km),s[19].queries.push(new Im(m))}function hb(o,s,u){null===o.queries&&(o.queries=new Wp),o.queries.track(new Rm(s,u))}function V_(o,s){return o.queries.getByIndex(s)}function Q_(...o){}const Yw=new te("Application Initializer");let Sb=(()=>{class o{constructor(u){this.appInits=u,this.resolve=Q_,this.reject=Q_,this.initialized=!1,this.done=!1,this.donePromise=new Promise((m,_)=>{this.resolve=m,this.reject=_})}runInitializers(){if(this.initialized)return;const u=[],m=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let _=0;_<this.appInits.length;_++){const C=this.appInits[_]();if(cv(C))u.push(C);else if(dx(C)){const T=new Promise((P,L)=>{C.subscribe({complete:P,error:L})});u.push(T)}}Promise.all(u).then(()=>{m()}).catch(_=>{this.reject(_)}),0===u.length&&m(),this.initialized=!0}}return o.\u0275fac=function(u){return new(u||o)(Xn(Yw,8))},o.\u0275prov=Qi({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();const Ww=new te("AppId",{providedIn:"root",factory:function Zw(){return`${J_()}${J_()}${J_()}`}});function J_(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const Tb=new te("Platform Initializer"),Kw=new te("Platform ID"),Xw=new te("appBootstrapListener");let Ab=(()=>{class o{log(u){console.log(u)}warn(u){console.warn(u)}}return o.\u0275fac=function(u){return new(u||o)},o.\u0275prov=Qi({token:o,factory:o.\u0275fac}),o})();const ey=new te("LocaleId",{providedIn:"root",factory:()=>Sr(ey,pi.Optional|pi.SkipSelf)||function Qw(){return"undefined"!=typeof $localize&&$localize.locale||Da}()}),s1=new te("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class a1{constructor(s,u){this.ngModuleFactory=s,this.componentFactories=u}}let l1=(()=>{class o{compileModuleSync(u){return new ob(u)}compileModuleAsync(u){return Promise.resolve(this.compileModuleSync(u))}compileModuleAndAllComponentsSync(u){const m=this.compileModuleSync(u),C=en(ie(u).declarations).reduce((T,P)=>{const L=z(P);return L&&T.push(new Ea(L)),T},[]);return new a1(m,C)}compileModuleAndAllComponentsAsync(u){return Promise.resolve(this.compileModuleAndAllComponentsSync(u))}clearCache(){}clearCacheFor(u){}getModuleId(u){}}return o.\u0275fac=function(u){return new(u||o)},o.\u0275prov=Qi({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();const u1=(()=>Promise.resolve(0))();function Ib(o){"undefined"==typeof Zone?u1.then(()=>{o&&o.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",o)}class Ta{constructor({enableLongStackTrace:s=!1,shouldCoalesceEventChangeDetection:u=!1,shouldCoalesceRunChangeDetection:m=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Sa(!1),this.onMicrotaskEmpty=new Sa(!1),this.onStable=new Sa(!1),this.onError=new Sa(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const _=this;_._nesting=0,_._outer=_._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(_._inner=_._inner.fork(new Zone.TaskTrackingZoneSpec)),s&&Zone.longStackTraceZoneSpec&&(_._inner=_._inner.fork(Zone.longStackTraceZoneSpec)),_.shouldCoalesceEventChangeDetection=!m&&u,_.shouldCoalesceRunChangeDetection=m,_.lastRequestAnimationFrameId=-1,_.nativeRequestAnimationFrame=function eC(){let o=Vi.requestAnimationFrame,s=Vi.cancelAnimationFrame;if("undefined"!=typeof Zone&&o&&s){const u=o[Zone.__symbol__("OriginalDelegate")];u&&(o=u);const m=s[Zone.__symbol__("OriginalDelegate")];m&&(s=m)}return{nativeRequestAnimationFrame:o,nativeCancelAnimationFrame:s}}().nativeRequestAnimationFrame,function kb(o){const s=()=>{!function iC(o){o.isCheckStableRunning||-1!==o.lastRequestAnimationFrameId||(o.lastRequestAnimationFrameId=o.nativeRequestAnimationFrame.call(Vi,()=>{o.fakeTopEventTask||(o.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{o.lastRequestAnimationFrameId=-1,ef(o),o.isCheckStableRunning=!0,ty(o),o.isCheckStableRunning=!1},void 0,()=>{},()=>{})),o.fakeTopEventTask.invoke()}),ef(o))}(o)};o._inner=o._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(u,m,_,C,T,P)=>{try{return tf(o),u.invokeTask(_,C,T,P)}finally{(o.shouldCoalesceEventChangeDetection&&"eventTask"===C.type||o.shouldCoalesceRunChangeDetection)&&s(),nC(o)}},onInvoke:(u,m,_,C,T,P,L)=>{try{return tf(o),u.invoke(_,C,T,P,L)}finally{o.shouldCoalesceRunChangeDetection&&s(),nC(o)}},onHasTask:(u,m,_,C)=>{u.hasTask(_,C),m===_&&("microTask"==C.change?(o._hasPendingMicrotasks=C.microTask,ef(o),ty(o)):"macroTask"==C.change&&(o.hasPendingMacrotasks=C.macroTask))},onHandleError:(u,m,_,C)=>(u.handleError(_,C),o.runOutsideAngular(()=>o.onError.emit(C)),!1)})}(_)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Ta.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Ta.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(s,u,m){return this._inner.run(s,u,m)}runTask(s,u,m,_){const C=this._inner,T=C.scheduleEventTask("NgZoneEvent: "+_,s,tC,Q_,Q_);try{return C.runTask(T,u,m)}finally{C.cancelTask(T)}}runGuarded(s,u,m){return this._inner.runGuarded(s,u,m)}runOutsideAngular(s){return this._outer.run(s)}}const tC={};function ty(o){if(0==o._nesting&&!o.hasPendingMicrotasks&&!o.isStable)try{o._nesting++,o.onMicrotaskEmpty.emit(null)}finally{if(o._nesting--,!o.hasPendingMicrotasks)try{o.runOutsideAngular(()=>o.onStable.emit(null))}finally{o.isStable=!0}}}function ef(o){o.hasPendingMicrotasks=!!(o._hasPendingMicrotasks||(o.shouldCoalesceEventChangeDetection||o.shouldCoalesceRunChangeDetection)&&-1!==o.lastRequestAnimationFrameId)}function tf(o){o._nesting++,o.isStable&&(o.isStable=!1,o.onUnstable.emit(null))}function nC(o){o._nesting--,ty(o)}class d1{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Sa,this.onMicrotaskEmpty=new Sa,this.onStable=new Sa,this.onError=new Sa}run(s,u,m){return s.apply(u,m)}runGuarded(s,u,m){return s.apply(u,m)}runOutsideAngular(s){return s()}runTask(s,u,m,_){return s.apply(u,m)}}let rC=(()=>{class o{constructor(u){this._ngZone=u,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),u.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Ta.assertNotInAngularZone(),Ib(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Ib(()=>{for(;0!==this._callbacks.length;){let u=this._callbacks.pop();clearTimeout(u.timeoutId),u.doneCb(this._didWork)}this._didWork=!1});else{let u=this.getPendingTasks();this._callbacks=this._callbacks.filter(m=>!m.updateCb||!m.updateCb(u)||(clearTimeout(m.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(u=>({source:u.source,creationLocation:u.creationLocation,data:u.data})):[]}addCallback(u,m,_){let C=-1;m&&m>0&&(C=setTimeout(()=>{this._callbacks=this._callbacks.filter(T=>T.timeoutId!==C),u(this._didWork,this.getPendingTasks())},m)),this._callbacks.push({doneCb:u,timeoutId:C,updateCb:_})}whenStable(u,m,_){if(_&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(u,m,_),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(u,m,_){return[]}}return o.\u0275fac=function(u){return new(u||o)(Xn(Ta))},o.\u0275prov=Qi({token:o,factory:o.\u0275fac}),o})(),oC=(()=>{class o{constructor(){this._applications=new Map,iy.addToWindow(this)}registerApplication(u,m){this._applications.set(u,m)}unregisterApplication(u){this._applications.delete(u)}unregisterAllApplications(){this._applications.clear()}getTestability(u){return this._applications.get(u)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(u,m=!0){return iy.findTestabilityInTree(this,u,m)}}return o.\u0275fac=function(u){return new(u||o)},o.\u0275prov=Qi({token:o,factory:o.\u0275fac}),o})();class h1{addToWindow(s){}findTestabilityInTree(s,u,m){return null}}function sC(o){iy=o}let Aa,iy=new h1;const aC=new te("AllowMultipleToken");class lC{constructor(s,u){this.name=s,this.token=u}}function cC(o,s,u=[]){const m=`Platform: ${s}`,_=new te(m);return(C=[])=>{let T=uC();if(!T||T.injector.get(aC,!1))if(o)o(u.concat(C).concat({provide:_,useValue:!0}));else{const P=u.concat(C).concat({provide:_,useValue:!0},{provide:Rg,useValue:"platform"});!function m1(o){if(Aa&&!Aa.destroyed&&!Aa.injector.get(aC,!1))throw new vt(400,"");Aa=o.get(dC);const s=o.get(Tb,null);s&&s.forEach(u=>u())}(dl.create({providers:P,name:m}))}return function g1(o){const s=uC();if(!s)throw new vt(401,"");return s}()}}function uC(){return Aa&&!Aa.destroyed?Aa:null}let dC=(()=>{class o{constructor(u){this._injector=u,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(u,m){const P=function _1(o,s){let u;return u="noop"===o?new d1:("zone.js"===o?void 0:o)||new Ta({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==s?void 0:s.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==s?void 0:s.ngZoneRunCoalescing)}),u}(m?m.ngZone:void 0,{ngZoneEventCoalescing:m&&m.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:m&&m.ngZoneRunCoalescing||!1}),L=[{provide:Ta,useValue:P}];return P.run(()=>{const G=dl.create({providers:L,parent:this.injector,name:u.moduleType.name}),W=u.create(G),ae=W.injector.get(ah,null);if(!ae)throw new vt(402,"");return P.runOutsideAngular(()=>{const ve=P.onError.subscribe({next:Re=>{ae.handleError(Re)}});W.onDestroy(()=>{Pb(this._modules,W),ve.unsubscribe()})}),function hC(o,s,u){try{const m=u();return cv(m)?m.catch(_=>{throw s.runOutsideAngular(()=>o.handleError(_)),_}):m}catch(m){throw s.runOutsideAngular(()=>o.handleError(m)),m}}(ae,P,()=>{const ve=W.injector.get(Sb);return ve.runInitializers(),ve.donePromise.then(()=>(function Xc(o){si(o,"Expected localeId to be defined"),"string"==typeof o&&(o_=o.toLowerCase().replace(/_/g,"-"))}(W.injector.get(ey,Da)||Da),this._moduleDoBootstrap(W),W))})})}bootstrapModule(u,m=[]){const _=pC({},m);return function p1(o,s,u){const m=new ob(u);return Promise.resolve(m)}(0,0,u).then(C=>this.bootstrapModuleFactory(C,_))}_moduleDoBootstrap(u){const m=u.injector.get(Rb);if(u._bootstrapComponents.length>0)u._bootstrapComponents.forEach(_=>m.bootstrap(_));else{if(!u.instance.ngDoBootstrap)throw new vt(403,"");u.instance.ngDoBootstrap(m)}this._modules.push(u)}onDestroy(u){this._destroyListeners.push(u)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new vt(404,"");this._modules.slice().forEach(u=>u.destroy()),this._destroyListeners.forEach(u=>u()),this._destroyed=!0}get destroyed(){return this._destroyed}}return o.\u0275fac=function(u){return new(u||o)(Xn(dl))},o.\u0275prov=Qi({token:o,factory:o.\u0275fac}),o})();function pC(o,s){return Array.isArray(s)?s.reduce(pC,o):Object.assign(Object.assign({},o),s)}let Rb=(()=>{class o{constructor(u,m,_,C,T){this._zone=u,this._injector=m,this._exceptionHandler=_,this._componentFactoryResolver=C,this._initStatus=T,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const P=new Ve.y(G=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{G.next(this._stable),G.complete()})}),L=new Ve.y(G=>{let W;this._zone.runOutsideAngular(()=>{W=this._zone.onStable.subscribe(()=>{Ta.assertNotInAngularZone(),Ib(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,G.next(!0))})})});const ae=this._zone.onUnstable.subscribe(()=>{Ta.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{G.next(!1)}))});return()=>{W.unsubscribe(),ae.unsubscribe()}});this.isStable=(0,x.T)(P,L.pipe((0,Me.B)()))}bootstrap(u,m){if(!this._initStatus.done)throw new vt(405,"");let _;_=u instanceof __?u:this._componentFactoryResolver.resolveComponentFactory(u),this.componentTypes.push(_.componentType);const C=function f1(o){return o.isBoundToModule}(_)?void 0:this._injector.get(Ih),P=_.create(dl.NULL,[],m||_.selector,C),L=P.location.nativeElement,G=P.injector.get(rC,null),W=G&&P.injector.get(oC);return G&&W&&W.registerApplication(L,G),P.onDestroy(()=>{this.detachView(P.hostView),Pb(this.components,P),W&&W.unregisterApplication(L)}),this._loadComponent(P),P}tick(){if(this._runningTick)throw new vt(101,"");try{this._runningTick=!0;for(let u of this._views)u.detectChanges()}catch(u){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(u))}finally{this._runningTick=!1}}attachView(u){const m=u;this._views.push(m),m.attachToAppRef(this)}detachView(u){const m=u;Pb(this._views,m),m.detachFromAppRef()}_loadComponent(u){this.attachView(u.hostView),this.tick(),this.components.push(u),this._injector.get(Xw,[]).concat(this._bootstrapListeners).forEach(_=>_(u))}ngOnDestroy(){this._views.slice().forEach(u=>u.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return o.\u0275fac=function(u){return new(u||o)(Xn(Ta),Xn(dl),Xn(ah),Xn(jp),Xn(Sb))},o.\u0275prov=Qi({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();function Pb(o,s){const u=o.indexOf(s);u>-1&&o.splice(u,1)}let mC=!0,gC=!1;function v1(){return gC=!0,mC}function b1(){if(gC)throw new Error("Cannot enable prod mode after platform setup.");mC=!1}let x1=(()=>{class o{}return o.__NG_ELEMENT_ID__=w1,o})();function w1(o){return function C1(o,s,u){if(Ra(o)&&!u){const m=ho(o.index,s);return new Ah(m,m)}return 47&o.type?new Ah(s[16],s):null}(gn(),dt(),16==(16&o))}class Nb{constructor(){}supports(s){return em(s)}create(s){return new MC(s)}}const CC=(o,s)=>s;class MC{constructor(s){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=s||CC}forEachItem(s){let u;for(u=this._itHead;null!==u;u=u._next)s(u)}forEachOperation(s){let u=this._itHead,m=this._removalsHead,_=0,C=null;for(;u||m;){const T=!m||u&&u.currentIndex<EC(m,_,C)?u:m,P=EC(T,_,C),L=T.currentIndex;if(T===m)_--,m=m._nextRemoved;else if(u=u._next,null==T.previousIndex)_++;else{C||(C=[]);const G=P-_,W=L-_;if(G!=W){for(let ve=0;ve<G;ve++){const Re=ve<C.length?C[ve]:C[ve]=0,st=Re+ve;W<=st&&st<G&&(C[ve]=Re+1)}C[T.previousIndex]=W-G}}P!==L&&s(T,P,L)}}forEachPreviousItem(s){let u;for(u=this._previousItHead;null!==u;u=u._nextPrevious)s(u)}forEachAddedItem(s){let u;for(u=this._additionsHead;null!==u;u=u._nextAdded)s(u)}forEachMovedItem(s){let u;for(u=this._movesHead;null!==u;u=u._nextMoved)s(u)}forEachRemovedItem(s){let u;for(u=this._removalsHead;null!==u;u=u._nextRemoved)s(u)}forEachIdentityChange(s){let u;for(u=this._identityChangesHead;null!==u;u=u._nextIdentityChange)s(u)}diff(s){if(null==s&&(s=[]),!em(s))throw new vt(900,"");return this.check(s)?this:null}onDestroy(){}check(s){this._reset();let _,C,T,u=this._itHead,m=!1;if(Array.isArray(s)){this.length=s.length;for(let P=0;P<this.length;P++)C=s[P],T=this._trackByFn(P,C),null!==u&&Object.is(u.trackById,T)?(m&&(u=this._verifyReinsertion(u,C,T,P)),Object.is(u.item,C)||this._addIdentityChange(u,C)):(u=this._mismatch(u,C,T,P),m=!0),u=u._next}else _=0,function Gy(o,s){if(Array.isArray(o))for(let u=0;u<o.length;u++)s(o[u]);else{const u=o[Ql()]();let m;for(;!(m=u.next()).done;)s(m.value)}}(s,P=>{T=this._trackByFn(_,P),null!==u&&Object.is(u.trackById,T)?(m&&(u=this._verifyReinsertion(u,P,T,_)),Object.is(u.item,P)||this._addIdentityChange(u,P)):(u=this._mismatch(u,P,T,_),m=!0),u=u._next,_++}),this.length=_;return this._truncate(u),this.collection=s,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let s;for(s=this._previousItHead=this._itHead;null!==s;s=s._next)s._nextPrevious=s._next;for(s=this._additionsHead;null!==s;s=s._nextAdded)s.previousIndex=s.currentIndex;for(this._additionsHead=this._additionsTail=null,s=this._movesHead;null!==s;s=s._nextMoved)s.previousIndex=s.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(s,u,m,_){let C;return null===s?C=this._itTail:(C=s._prev,this._remove(s)),null!==(s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(m,null))?(Object.is(s.item,u)||this._addIdentityChange(s,u),this._reinsertAfter(s,C,_)):null!==(s=null===this._linkedRecords?null:this._linkedRecords.get(m,_))?(Object.is(s.item,u)||this._addIdentityChange(s,u),this._moveAfter(s,C,_)):s=this._addAfter(new E1(u,m),C,_),s}_verifyReinsertion(s,u,m,_){let C=null===this._unlinkedRecords?null:this._unlinkedRecords.get(m,null);return null!==C?s=this._reinsertAfter(C,s._prev,_):s.currentIndex!=_&&(s.currentIndex=_,this._addToMoves(s,_)),s}_truncate(s){for(;null!==s;){const u=s._next;this._addToRemovals(this._unlink(s)),s=u}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(s,u,m){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(s);const _=s._prevRemoved,C=s._nextRemoved;return null===_?this._removalsHead=C:_._nextRemoved=C,null===C?this._removalsTail=_:C._prevRemoved=_,this._insertAfter(s,u,m),this._addToMoves(s,m),s}_moveAfter(s,u,m){return this._unlink(s),this._insertAfter(s,u,m),this._addToMoves(s,m),s}_addAfter(s,u,m){return this._insertAfter(s,u,m),this._additionsTail=null===this._additionsTail?this._additionsHead=s:this._additionsTail._nextAdded=s,s}_insertAfter(s,u,m){const _=null===u?this._itHead:u._next;return s._next=_,s._prev=u,null===_?this._itTail=s:_._prev=s,null===u?this._itHead=s:u._next=s,null===this._linkedRecords&&(this._linkedRecords=new Vb),this._linkedRecords.put(s),s.currentIndex=m,s}_remove(s){return this._addToRemovals(this._unlink(s))}_unlink(s){null!==this._linkedRecords&&this._linkedRecords.remove(s);const u=s._prev,m=s._next;return null===u?this._itHead=m:u._next=m,null===m?this._itTail=u:m._prev=u,s}_addToMoves(s,u){return s.previousIndex===u||(this._movesTail=null===this._movesTail?this._movesHead=s:this._movesTail._nextMoved=s),s}_addToRemovals(s){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Vb),this._unlinkedRecords.put(s),s.currentIndex=null,s._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=s,s._prevRemoved=null):(s._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=s),s}_addIdentityChange(s,u){return s.item=u,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=s:this._identityChangesTail._nextIdentityChange=s,s}}class E1{constructor(s,u){this.item=s,this.trackById=u,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class DC{constructor(){this._head=null,this._tail=null}add(s){null===this._head?(this._head=this._tail=s,s._nextDup=null,s._prevDup=null):(this._tail._nextDup=s,s._prevDup=this._tail,s._nextDup=null,this._tail=s)}get(s,u){let m;for(m=this._head;null!==m;m=m._nextDup)if((null===u||u<=m.currentIndex)&&Object.is(m.trackById,s))return m;return null}remove(s){const u=s._prevDup,m=s._nextDup;return null===u?this._head=m:u._nextDup=m,null===m?this._tail=u:m._prevDup=u,null===this._head}}class Vb{constructor(){this.map=new Map}put(s){const u=s.trackById;let m=this.map.get(u);m||(m=new DC,this.map.set(u,m)),m.add(s)}get(s,u){const _=this.map.get(s);return _?_.get(s,u):null}remove(s){const u=s.trackById;return this.map.get(u).remove(s)&&this.map.delete(u),s}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function EC(o,s,u){const m=o.previousIndex;if(null===m)return m;let _=0;return u&&m<u.length&&(_=u[m]),m+s+_}class SC{constructor(){}supports(s){return s instanceof Map||Ip(s)}create(){return new zb}}class zb{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(s){let u;for(u=this._mapHead;null!==u;u=u._next)s(u)}forEachPreviousItem(s){let u;for(u=this._previousMapHead;null!==u;u=u._nextPrevious)s(u)}forEachChangedItem(s){let u;for(u=this._changesHead;null!==u;u=u._nextChanged)s(u)}forEachAddedItem(s){let u;for(u=this._additionsHead;null!==u;u=u._nextAdded)s(u)}forEachRemovedItem(s){let u;for(u=this._removalsHead;null!==u;u=u._nextRemoved)s(u)}diff(s){if(s){if(!(s instanceof Map||Ip(s)))throw new vt(900,"")}else s=new Map;return this.check(s)?this:null}onDestroy(){}check(s){this._reset();let u=this._mapHead;if(this._appendAfter=null,this._forEach(s,(m,_)=>{if(u&&u.key===_)this._maybeAddToChanges(u,m),this._appendAfter=u,u=u._next;else{const C=this._getOrCreateRecordForKey(_,m);u=this._insertBeforeOrAppend(u,C)}}),u){u._prev&&(u._prev._next=null),this._removalsHead=u;for(let m=u;null!==m;m=m._nextRemoved)m===this._mapHead&&(this._mapHead=null),this._records.delete(m.key),m._nextRemoved=m._next,m.previousValue=m.currentValue,m.currentValue=null,m._prev=null,m._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(s,u){if(s){const m=s._prev;return u._next=s,u._prev=m,s._prev=u,m&&(m._next=u),s===this._mapHead&&(this._mapHead=u),this._appendAfter=s,s}return this._appendAfter?(this._appendAfter._next=u,u._prev=this._appendAfter):this._mapHead=u,this._appendAfter=u,null}_getOrCreateRecordForKey(s,u){if(this._records.has(s)){const _=this._records.get(s);this._maybeAddToChanges(_,u);const C=_._prev,T=_._next;return C&&(C._next=T),T&&(T._prev=C),_._next=null,_._prev=null,_}const m=new TC(s);return this._records.set(s,m),m.currentValue=u,this._addToAdditions(m),m}_reset(){if(this.isDirty){let s;for(this._previousMapHead=this._mapHead,s=this._previousMapHead;null!==s;s=s._next)s._nextPrevious=s._next;for(s=this._changesHead;null!==s;s=s._nextChanged)s.previousValue=s.currentValue;for(s=this._additionsHead;null!=s;s=s._nextAdded)s.previousValue=s.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(s,u){Object.is(u,s.currentValue)||(s.previousValue=s.currentValue,s.currentValue=u,this._addToChanges(s))}_addToAdditions(s){null===this._additionsHead?this._additionsHead=this._additionsTail=s:(this._additionsTail._nextAdded=s,this._additionsTail=s)}_addToChanges(s){null===this._changesHead?this._changesHead=this._changesTail=s:(this._changesTail._nextChanged=s,this._changesTail=s)}_forEach(s,u){s instanceof Map?s.forEach(u):Object.keys(s).forEach(m=>u(s[m],m))}}class TC{constructor(s){this.key=s,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function jb(){return new ry([new Nb])}let ry=(()=>{class o{constructor(u){this.factories=u}static create(u,m){if(null!=m){const _=m.factories.slice();u=u.concat(_)}return new o(u)}static extend(u){return{provide:o,useFactory:m=>o.create(u,m||jb()),deps:[[o,new Ka,new Cn]]}}find(u){const m=this.factories.find(_=>_.supports(u));if(null!=m)return m;throw new vt(901,"")}}return o.\u0275prov=Qi({token:o,providedIn:"root",factory:jb}),o})();function oy(){return new sy([new SC])}let sy=(()=>{class o{constructor(u){this.factories=u}static create(u,m){if(m){const _=m.factories.slice();u=u.concat(_)}return new o(u)}static extend(u){return{provide:o,useFactory:m=>o.create(u,m||oy()),deps:[[o,new Ka,new Cn]]}}find(u){const m=this.factories.find(C=>C.supports(u));if(m)return m;throw new vt(901,"")}}return o.\u0275prov=Qi({token:o,providedIn:"root",factory:oy}),o})();const IC=cC(null,"core",[{provide:Kw,useValue:"unknown"},{provide:dC,deps:[dl]},{provide:oC,deps:[]},{provide:Ab,deps:[]}]);let kC=(()=>{class o{constructor(u){}}return o.\u0275fac=function(u){return new(u||o)(Xn(Rb))},o.\u0275mod=so({type:o}),o.\u0275inj=Do({}),o})()},9565:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{FT:()=>StoreDevtoolsModule});var _angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5e3),_ngrx_store__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(5620),rxjs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(515),rxjs__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(8306),rxjs__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(9646),rxjs__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(6451),rxjs__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(233),rxjs__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(4707),rxjs_operators__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(3099),rxjs_operators__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(9300),rxjs_operators__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(4004),rxjs_operators__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(4351),rxjs_operators__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(7414),rxjs_operators__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(8372),rxjs_operators__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(262),rxjs_operators__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(5698),rxjs_operators__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(2722),rxjs_operators__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(3900),rxjs_operators__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(5684),rxjs_operators__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(5363),rxjs_operators__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(1365),rxjs_operators__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(5026);class StoreDevtoolsConfig{constructor(){this.maxAge=!1}}const STORE_DEVTOOLS_CONFIG=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.OlP("@ngrx/store-devtools Options"),INITIAL_OPTIONS=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.OlP("@ngrx/store-devtools Initial Config");function noMonitor(){return null}const DEFAULT_NAME="NgRx Store DevTools";function createConfig(Ie){const _e={maxAge:!1,monitor:noMonitor,actionSanitizer:void 0,stateSanitizer:void 0,name:DEFAULT_NAME,serialize:!1,logOnly:!1,autoPause:!1,features:{pause:!0,lock:!0,persist:!0,export:!0,import:"custom",jump:!0,skip:!0,reorder:!0,dispatch:!0,test:!0}},Y="function"==typeof Ie?Ie():Ie,Ve=Object.assign({},_e,{features:Y.features||!!Y.logOnly&&{pause:!0,export:!0,test:!0}||_e.features},Y);if(Ve.maxAge&&Ve.maxAge<2)throw new Error(`Devtools 'maxAge' cannot be less than 2, got ${Ve.maxAge}`);return Ve}const PERFORM_ACTION="PERFORM_ACTION",REFRESH="REFRESH",RESET="RESET",ROLLBACK="ROLLBACK",COMMIT="COMMIT",SWEEP="SWEEP",TOGGLE_ACTION="TOGGLE_ACTION",SET_ACTIONS_ACTIVE="SET_ACTIONS_ACTIVE",JUMP_TO_STATE="JUMP_TO_STATE",JUMP_TO_ACTION="JUMP_TO_ACTION",IMPORT_STATE="IMPORT_STATE",LOCK_CHANGES="LOCK_CHANGES",PAUSE_RECORDING="PAUSE_RECORDING";class PerformAction{constructor(_e,Y){if(this.action=_e,this.timestamp=Y,this.type=PERFORM_ACTION,void 0===_e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?')}}class Refresh{constructor(){this.type=REFRESH}}class Reset{constructor(_e){this.timestamp=_e,this.type=RESET}}class Rollback{constructor(_e){this.timestamp=_e,this.type=ROLLBACK}}class Commit{constructor(_e){this.timestamp=_e,this.type=COMMIT}}class Sweep{constructor(){this.type=SWEEP}}class ToggleAction{constructor(_e){this.id=_e,this.type=TOGGLE_ACTION}}class SetActionsActive{constructor(_e,Y,h=!0){this.start=_e,this.end=Y,this.active=h,this.type=SET_ACTIONS_ACTIVE}}class JumpToState{constructor(_e){this.index=_e,this.type=JUMP_TO_STATE}}class JumpToAction{constructor(_e){this.actionId=_e,this.type=JUMP_TO_ACTION}}class ImportState{constructor(_e){this.nextLiftedState=_e,this.type=IMPORT_STATE}}class LockChanges{constructor(_e){this.status=_e,this.type=LOCK_CHANGES}}class PauseRecording{constructor(_e){this.status=_e,this.type=PAUSE_RECORDING}}function difference(Ie,_e){return Ie.filter(Y=>_e.indexOf(Y)<0)}function unliftState(Ie){const{computedStates:_e,currentStateIndex:Y}=Ie;if(Y>=_e.length){const{state:Te}=_e[_e.length-1];return Te}const{state:h}=_e[Y];return h}function unliftAction(Ie){return Ie.actionsById[Ie.nextActionId-1]}function liftAction(Ie){return new PerformAction(Ie,+Date.now())}function sanitizeActions(Ie,_e){return Object.keys(_e).reduce((Y,h)=>{const Te=Number(h);return Y[Te]=sanitizeAction(Ie,_e[Te],Te),Y},{})}function sanitizeAction(Ie,_e,Y){return Object.assign(Object.assign({},_e),{action:Ie(_e.action,Y)})}function sanitizeStates(Ie,_e){return _e.map((Y,h)=>({state:sanitizeState(Ie,Y.state,h),error:Y.error}))}function sanitizeState(Ie,_e,Y){return Ie(_e,Y)}function shouldFilterActions(Ie){return Ie.predicate||Ie.actionsSafelist||Ie.actionsBlocklist}function filterLiftedState(Ie,_e,Y,h){const Te=[],Ve={},x=[];return Ie.stagedActionIds.forEach((Me,Pe)=>{const ye=Ie.actionsById[Me];!ye||Pe&&isActionFiltered(Ie.computedStates[Pe],ye,_e,Y,h)||(Ve[Me]=ye,Te.push(Me),x.push(Ie.computedStates[Pe]))}),Object.assign(Object.assign({},Ie),{stagedActionIds:Te,actionsById:Ve,computedStates:x})}function isActionFiltered(Ie,_e,Y,h,Te){const Ve=Y&&!Y(Ie,_e.action),x=h&&!_e.action.type.match(h.map(Pe=>escapeRegExp(Pe)).join("|")),Me=Te&&_e.action.type.match(Te.map(Pe=>escapeRegExp(Pe)).join("|"));return Ve||x||Me}function escapeRegExp(Ie){return Ie.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}const INIT_ACTION={type:_ngrx_store__WEBPACK_IMPORTED_MODULE_1__.qg},RECOMPUTE="@ngrx/store-devtools/recompute",RECOMPUTE_ACTION={type:RECOMPUTE};function computeNextEntry(Ie,_e,Y,h,Te){if(h)return{state:Y,error:"Interrupted by an error up the chain"};let x,Ve=Y;try{Ve=Ie(Y,_e)}catch(Me){x=Me.toString(),Te.handleError(Me)}return{state:Ve,error:x}}function recomputeStates(Ie,_e,Y,h,Te,Ve,x,Me,Pe){if(_e>=Ie.length&&Ie.length===Ve.length)return Ie;const ye=Ie.slice(0,_e),xe=Ve.length-(Pe?1:0);for(let ne=_e;ne<xe;ne++){const Le=Ve[ne],ke=Te[Le].action,Be=ye[ne-1],yt=Be?Be.state:h,gt=Be?Be.error:void 0,Tt=x.indexOf(Le)>-1?Be:computeNextEntry(Y,ke,yt,gt,Me);ye.push(Tt)}return Pe&&ye.push(Ie[Ie.length-1]),ye}function liftInitialState(Ie,_e){return{monitorState:_e(void 0,{}),nextActionId:1,actionsById:{0:liftAction(INIT_ACTION)},stagedActionIds:[0],skippedActionIds:[],committedState:Ie,currentStateIndex:0,computedStates:[],isLocked:!1,isPaused:!1}}function liftReducerWith(Ie,_e,Y,h,Te={}){return Ve=>(x,Me)=>{let{monitorState:Pe,actionsById:ye,nextActionId:xe,stagedActionIds:ne,skippedActionIds:Le,committedState:ke,currentStateIndex:Be,computedStates:yt,isLocked:gt,isPaused:vt}=x||_e;function Tt(Ht){let $t=Ht,xt=ne.slice(1,$t+1);for(let ut=0;ut<xt.length;ut++){if(yt[ut+1].error){$t=ut,xt=ne.slice(1,$t+1);break}delete ye[xt[ut]]}Le=Le.filter(ut=>-1===xt.indexOf(ut)),ne=[0,...ne.slice($t+1)],ke=yt[$t].state,yt=yt.slice($t),Be=Be>$t?Be-$t:0}function nt(){ye={0:liftAction(INIT_ACTION)},xe=1,ne=[0],Le=[],ke=yt[Be].state,Be=0,yt=[]}x||(ye=Object.create(ye));let Dt=0;switch(Me.type){case LOCK_CHANGES:gt=Me.status,Dt=1/0;break;case PAUSE_RECORDING:vt=Me.status,vt?(ne=[...ne,xe],ye[xe]=new PerformAction({type:"@ngrx/devtools/pause"},+Date.now()),xe++,Dt=ne.length-1,yt=yt.concat(yt[yt.length-1]),Be===ne.length-2&&Be++,Dt=1/0):nt();break;case RESET:ye={0:liftAction(INIT_ACTION)},xe=1,ne=[0],Le=[],ke=Ie,Be=0,yt=[];break;case COMMIT:nt();break;case ROLLBACK:ye={0:liftAction(INIT_ACTION)},xe=1,ne=[0],Le=[],Be=0,yt=[];break;case TOGGLE_ACTION:{const{id:Ht}=Me;Le=-1===Le.indexOf(Ht)?[Ht,...Le]:Le.filter(xt=>xt!==Ht),Dt=ne.indexOf(Ht);break}case SET_ACTIONS_ACTIVE:{const{start:Ht,end:$t,active:xt}=Me,ut=[];for(let kt=Ht;kt<$t;kt++)ut.push(kt);Le=xt?difference(Le,ut):[...Le,...ut],Dt=ne.indexOf(Ht);break}case JUMP_TO_STATE:Be=Me.index,Dt=1/0;break;case JUMP_TO_ACTION:{const Ht=ne.indexOf(Me.actionId);-1!==Ht&&(Be=Ht),Dt=1/0;break}case SWEEP:ne=difference(ne,Le),Le=[],Be=Math.min(Be,ne.length-1);break;case PERFORM_ACTION:{if(gt)return x||_e;if(vt||x&&isActionFiltered(x.computedStates[Be],Me,Te.predicate,Te.actionsSafelist,Te.actionsBlocklist)){const $t=yt[yt.length-1];yt=[...yt.slice(0,-1),computeNextEntry(Ve,Me.action,$t.state,$t.error,Y)],Dt=1/0;break}Te.maxAge&&ne.length===Te.maxAge&&Tt(1),Be===ne.length-1&&Be++;const Ht=xe++;ye[Ht]=Me,ne=[...ne,Ht],Dt=ne.length-1;break}case IMPORT_STATE:({monitorState:Pe,actionsById:ye,nextActionId:xe,stagedActionIds:ne,skippedActionIds:Le,committedState:ke,currentStateIndex:Be,computedStates:yt,isLocked:gt,isPaused:vt}=Me.nextLiftedState);break;case _ngrx_store__WEBPACK_IMPORTED_MODULE_1__.qg:Dt=0,Te.maxAge&&ne.length>Te.maxAge&&(yt=recomputeStates(yt,Dt,Ve,ke,ye,ne,Le,Y,vt),Tt(ne.length-Te.maxAge),Dt=1/0);break;case _ngrx_store__WEBPACK_IMPORTED_MODULE_1__.wb:if(yt.filter($t=>$t.error).length>0)Dt=0,Te.maxAge&&ne.length>Te.maxAge&&(yt=recomputeStates(yt,Dt,Ve,ke,ye,ne,Le,Y,vt),Tt(ne.length-Te.maxAge),Dt=1/0);else{if(!vt&&!gt){Be===ne.length-1&&Be++;const $t=xe++;ye[$t]=new PerformAction(Me,+Date.now()),ne=[...ne,$t],Dt=ne.length-1,yt=recomputeStates(yt,Dt,Ve,ke,ye,ne,Le,Y,vt)}yt=yt.map($t=>Object.assign(Object.assign({},$t),{state:Ve($t.state,RECOMPUTE_ACTION)})),Be=ne.length-1,Te.maxAge&&ne.length>Te.maxAge&&Tt(ne.length-Te.maxAge),Dt=1/0}break;default:Dt=1/0}return yt=recomputeStates(yt,Dt,Ve,ke,ye,ne,Le,Y,vt),Pe=h(Pe,Me),{monitorState:Pe,actionsById:ye,nextActionId:xe,stagedActionIds:ne,skippedActionIds:Le,committedState:ke,currentStateIndex:Be,computedStates:yt,isLocked:gt,isPaused:vt}}}let DevtoolsDispatcher=(()=>{class Ie extends _ngrx_store__WEBPACK_IMPORTED_MODULE_1__.UO{}return Ie.\u0275fac=function(){let _e;return function(h){return(_e||(_e=_angular_core__WEBPACK_IMPORTED_MODULE_0__.n5z(Ie)))(h||Ie)}}(),Ie.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_0__.Yz7({token:Ie,factory:Ie.\u0275fac}),Ie})();const ExtensionActionTypes={START:"START",DISPATCH:"DISPATCH",STOP:"STOP",ACTION:"ACTION"},REDUX_DEVTOOLS_EXTENSION=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.OlP("@ngrx/store-devtools Redux Devtools Extension");let DevtoolsExtension=(()=>{class DevtoolsExtension{constructor(Ie,_e,Y){this.config=_e,this.dispatcher=Y,this.devtoolsExtension=Ie,this.createActionStreams()}notify(Ie,_e){if(this.devtoolsExtension)if(Ie.type===PERFORM_ACTION){if(_e.isLocked||_e.isPaused)return;const Y=unliftState(_e);if(shouldFilterActions(this.config)&&isActionFiltered(Y,Ie,this.config.predicate,this.config.actionsSafelist,this.config.actionsBlocklist))return;const h=this.config.stateSanitizer?sanitizeState(this.config.stateSanitizer,Y,_e.currentStateIndex):Y,Te=this.config.actionSanitizer?sanitizeAction(this.config.actionSanitizer,Ie,_e.nextActionId):Ie;this.sendToReduxDevtools(()=>this.extensionConnection.send(Te,h))}else{const Y=Object.assign(Object.assign({},_e),{stagedActionIds:_e.stagedActionIds,actionsById:this.config.actionSanitizer?sanitizeActions(this.config.actionSanitizer,_e.actionsById):_e.actionsById,computedStates:this.config.stateSanitizer?sanitizeStates(this.config.stateSanitizer,_e.computedStates):_e.computedStates});this.sendToReduxDevtools(()=>this.devtoolsExtension.send(null,Y,this.getExtensionConfig(this.config)))}}createChangesObservable(){return this.devtoolsExtension?new rxjs__WEBPACK_IMPORTED_MODULE_3__.y(Ie=>{const _e=this.devtoolsExtension.connect(this.getExtensionConfig(this.config));return this.extensionConnection=_e,_e.init(),_e.subscribe(Y=>Ie.next(Y)),_e.unsubscribe}):rxjs__WEBPACK_IMPORTED_MODULE_2__.E}createActionStreams(){const Ie=this.createChangesObservable().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.B)()),_e=Ie.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.h)(Me=>Me.type===ExtensionActionTypes.START)),Y=Ie.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.h)(Me=>Me.type===ExtensionActionTypes.STOP)),h=Ie.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.h)(Me=>Me.type===ExtensionActionTypes.DISPATCH),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.U)(Me=>this.unwrapAction(Me.payload)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.b)(Me=>Me.type===IMPORT_STATE?this.dispatcher.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.h)(Pe=>Pe.type===_ngrx_store__WEBPACK_IMPORTED_MODULE_1__.wb),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.V)(1e3),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_9__.b)(1e3),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.U)(()=>Me),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_10__.K)(()=>(0,rxjs__WEBPACK_IMPORTED_MODULE_11__.of)(Me)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.q)(1)):(0,rxjs__WEBPACK_IMPORTED_MODULE_11__.of)(Me))),Ve=Ie.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.h)(Me=>Me.type===ExtensionActionTypes.ACTION),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.U)(Me=>this.unwrapAction(Me.payload))).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.R)(Y)),x=h.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.R)(Y));this.start$=_e.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.R)(Y)),this.actions$=this.start$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_14__.w)(()=>Ve)),this.liftedActions$=this.start$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_14__.w)(()=>x))}unwrapAction(action){return"string"==typeof action?eval(`(${action})`):action}getExtensionConfig(Ie){var _e;const Y={name:Ie.name,features:Ie.features,serialize:Ie.serialize,autoPause:null!==(_e=Ie.autoPause)&&void 0!==_e&&_e};return!1!==Ie.maxAge&&(Y.maxAge=Ie.maxAge),Y}sendToReduxDevtools(Ie){try{Ie()}catch(_e){console.warn("@ngrx/store-devtools: something went wrong inside the redux devtools",_e)}}}return DevtoolsExtension.\u0275fac=function Ie(_e){return new(_e||DevtoolsExtension)(_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(REDUX_DEVTOOLS_EXTENSION),_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(STORE_DEVTOOLS_CONFIG),_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(DevtoolsDispatcher))},DevtoolsExtension.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_0__.Yz7({token:DevtoolsExtension,factory:DevtoolsExtension.\u0275fac}),DevtoolsExtension})(),StoreDevtools=(()=>{class Ie{constructor(Y,h,Te,Ve,x,Me,Pe,ye){const xe=liftInitialState(Pe,ye.monitor),ne=liftReducerWith(Pe,xe,Me,ye.monitor,ye),Le=(0,rxjs__WEBPACK_IMPORTED_MODULE_15__.T)((0,rxjs__WEBPACK_IMPORTED_MODULE_15__.T)(h.asObservable().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_16__.T)(1)),Ve.actions$).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.U)(liftAction)),Y,Ve.liftedActions$).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_17__.Q)(rxjs__WEBPACK_IMPORTED_MODULE_18__.N)),ke=Te.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.U)(ne)),Be=new rxjs__WEBPACK_IMPORTED_MODULE_19__.t(1),yt=Le.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_20__.M)(ke),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_21__.R)(({state:nt},[Dt,Ht])=>{let $t=Ht(nt,Dt);return Dt.type!==PERFORM_ACTION&&shouldFilterActions(ye)&&($t=filterLiftedState($t,ye.predicate,ye.actionsSafelist,ye.actionsBlocklist)),Ve.notify(Dt,$t),{state:$t,action:Dt}},{state:xe,action:null})).subscribe(({state:nt,action:Dt})=>{Be.next(nt),Dt.type===PERFORM_ACTION&&x.next(Dt.action)}),gt=Ve.start$.subscribe(()=>{this.refresh()}),vt=Be.asObservable(),Tt=vt.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.U)(unliftState));this.extensionStartSubscription=gt,this.stateSubscription=yt,this.dispatcher=Y,this.liftedState=vt,this.state=Tt}dispatch(Y){this.dispatcher.next(Y)}next(Y){this.dispatcher.next(Y)}error(Y){}complete(){}performAction(Y){this.dispatch(new PerformAction(Y,+Date.now()))}refresh(){this.dispatch(new Refresh)}reset(){this.dispatch(new Reset(+Date.now()))}rollback(){this.dispatch(new Rollback(+Date.now()))}commit(){this.dispatch(new Commit(+Date.now()))}sweep(){this.dispatch(new Sweep)}toggleAction(Y){this.dispatch(new ToggleAction(Y))}jumpToAction(Y){this.dispatch(new JumpToAction(Y))}jumpToState(Y){this.dispatch(new JumpToState(Y))}importState(Y){this.dispatch(new ImportState(Y))}lockChanges(Y){this.dispatch(new LockChanges(Y))}pauseRecording(Y){this.dispatch(new PauseRecording(Y))}}return Ie.\u0275fac=function(Y){return new(Y||Ie)(_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(DevtoolsDispatcher),_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(_ngrx_store__WEBPACK_IMPORTED_MODULE_1__.UO),_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(_ngrx_store__WEBPACK_IMPORTED_MODULE_1__.n$),_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(DevtoolsExtension),_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(_ngrx_store__WEBPACK_IMPORTED_MODULE_1__.Y$),_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(_angular_core__WEBPACK_IMPORTED_MODULE_0__.qLn),_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(_ngrx_store__WEBPACK_IMPORTED_MODULE_1__.Y6),_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(STORE_DEVTOOLS_CONFIG))},Ie.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_0__.Yz7({token:Ie,factory:Ie.\u0275fac}),Ie})();const IS_EXTENSION_OR_MONITOR_PRESENT=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.OlP("@ngrx/store-devtools Is Devtools Extension or Monitor Present");function createIsExtensionOrMonitorPresent(Ie,_e){return Boolean(Ie)||_e.monitor!==noMonitor}function createReduxDevtoolsExtension(){const Ie="__REDUX_DEVTOOLS_EXTENSION__";return"object"==typeof window&&void 0!==window[Ie]?window[Ie]:null}function createStateObservable(Ie){return Ie.state}let StoreDevtoolsModule=(()=>{class Ie{static instrument(Y={}){return{ngModule:Ie,providers:[DevtoolsExtension,DevtoolsDispatcher,StoreDevtools,{provide:INITIAL_OPTIONS,useValue:Y},{provide:IS_EXTENSION_OR_MONITOR_PRESENT,deps:[REDUX_DEVTOOLS_EXTENSION,STORE_DEVTOOLS_CONFIG],useFactory:createIsExtensionOrMonitorPresent},{provide:REDUX_DEVTOOLS_EXTENSION,useFactory:createReduxDevtoolsExtension},{provide:STORE_DEVTOOLS_CONFIG,deps:[INITIAL_OPTIONS],useFactory:createConfig},{provide:_ngrx_store__WEBPACK_IMPORTED_MODULE_1__.FR,deps:[StoreDevtools],useFactory:createStateObservable},{provide:_ngrx_store__WEBPACK_IMPORTED_MODULE_1__.mK,useExisting:DevtoolsDispatcher}]}}}return Ie.\u0275fac=function(Y){return new(Y||Ie)},Ie.\u0275mod=_angular_core__WEBPACK_IMPORTED_MODULE_0__.oAB({type:Ie}),Ie.\u0275inj=_angular_core__WEBPACK_IMPORTED_MODULE_0__.cJS({}),Ie})()},5620:(Ie,_e,Y)=>{"use strict";Y.d(_e,{UO:()=>Ht,qg:()=>Dt,Y6:()=>kt,mK:()=>Cs,n$:()=>Jn,Y$:()=>rs,FR:()=>Or,yh:()=>Po,Aw:()=>Ri,wb:()=>Ro,ZF:()=>so,Lq:()=>Lr,P1:()=>Rn});var h=Y(5e3),Te=Y(1135),Ve=Y(8306),x=Y(7579),Me=Y(233),Pe=Y(4004),xe=Y(5363),ne=Y(1365),Le=Y(5026),ke=Y(1884);const Be={},Dt="@ngrx/store/init";let Ht=(()=>{class ue extends Te.X{constructor(){super({type:Dt})}next(Ae){if("function"==typeof Ae)throw new TypeError("\n        Dispatch expected an object, instead it received a function.\n        If you're using the createAction function, make sure to invoke the function\n        before dispatching the action. For example, someAction should be someAction().");if(void 0===Ae)throw new TypeError("Actions must be objects");if(void 0===Ae.type)throw new TypeError("Actions must have a type property");super.next(Ae)}complete(){}ngOnDestroy(){super.complete()}}return ue.\u0275fac=function(Ae){return new(Ae||ue)},ue.\u0275prov=h.Yz7({token:ue,factory:ue.\u0275fac}),ue})();const $t=[Ht],xt=new h.OlP("@ngrx/store Internal Root Guard"),ut=new h.OlP("@ngrx/store Internal Initial State"),kt=new h.OlP("@ngrx/store Initial State"),qt=new h.OlP("@ngrx/store Reducer Factory"),ni=new h.OlP("@ngrx/store Internal Reducer Factory Provider"),xi=new h.OlP("@ngrx/store Initial Reducers"),Ue=new h.OlP("@ngrx/store Internal Initial Reducers"),et=new h.OlP("@ngrx/store Store Features"),Oe=new h.OlP("@ngrx/store Internal Store Reducers"),Qe=new h.OlP("@ngrx/store Internal Feature Reducers"),Et=new h.OlP("@ngrx/store Internal Feature Configs"),Ze=new h.OlP("@ngrx/store Internal Store Features"),Ci=new h.OlP("@ngrx/store Internal Feature Reducers Token"),tn=new h.OlP("@ngrx/store Feature Reducers"),br=new h.OlP("@ngrx/store User Provided Meta Reducers"),si=new h.OlP("@ngrx/store Meta Reducers"),_i=new h.OlP("@ngrx/store Internal Resolved Meta Reducers"),Pr=new h.OlP("@ngrx/store User Runtime Checks Config"),hn=new h.OlP("@ngrx/store Internal User Runtime Checks Config"),Gn=new h.OlP("@ngrx/store Internal Runtime Checks"),Qi=new h.OlP("@ngrx/store Check if Action types are unique");function Mo(ue,tt={}){const Ae=Object.keys(ue),Fe={};for(let At=0;At<Ae.length;At++){const ui=Ae[At];"function"==typeof ue[ui]&&(Fe[ui]=ue[ui])}const Ot=Object.keys(Fe);return function(ui,Kn){ui=void 0===ui?tt:ui;let pn=!1;const mn={};for(let Bi=0;Bi<Ot.length;Bi++){const Mr=Ot[Bi],ao=ui[Mr],Dr=(0,Fe[Mr])(ao,Kn);mn[Mr]=Dr,pn=pn||Dr!==ao}return pn?mn:ui}}function Wn(...ue){return function(tt){if(0===ue.length)return tt;const Ae=ue[ue.length-1];return ue.slice(0,-1).reduceRight((Ot,At)=>At(Ot),Ae(tt))}}function is(ue,tt){return Array.isArray(tt)&&tt.length>0&&(ue=Wn.apply(null,[...tt,ue])),(Ae,Fe)=>{const Ot=ue(Ae);return(At,ui)=>Ot(At=void 0===At?Fe:At,ui)}}class Jn extends Ve.y{}class Cs extends Ht{}const Ro="@ngrx/store/update-reducers";let oo=(()=>{class ue extends Te.X{constructor(Ae,Fe,Ot,At){super(At(Ot,Fe)),this.dispatcher=Ae,this.initialState=Fe,this.reducers=Ot,this.reducerFactory=At}get currentReducers(){return this.reducers}addFeature(Ae){this.addFeatures([Ae])}addFeatures(Ae){const Fe=Ae.reduce((Ot,{reducers:At,reducerFactory:ui,metaReducers:Kn,initialState:pn,key:mn})=>{const Bi="function"==typeof At?function ns(ue){const tt=Array.isArray(ue)&&ue.length>0?Wn(...ue):Ae=>Ae;return(Ae,Fe)=>(Ae=tt(Ae),(Ot,At)=>Ae(Ot=void 0===Ot?Fe:Ot,At))}(Kn)(At,pn):is(ui,Kn)(At,pn);return Ot[mn]=Bi,Ot},{});this.addReducers(Fe)}removeFeature(Ae){this.removeFeatures([Ae])}removeFeatures(Ae){this.removeReducers(Ae.map(Fe=>Fe.key))}addReducer(Ae,Fe){this.addReducers({[Ae]:Fe})}addReducers(Ae){this.reducers=Object.assign(Object.assign({},this.reducers),Ae),this.updateReducers(Object.keys(Ae))}removeReducer(Ae){this.removeReducers([Ae])}removeReducers(Ae){Ae.forEach(Fe=>{this.reducers=function Do(ue,tt){return Object.keys(ue).filter(Ae=>Ae!==tt).reduce((Ae,Fe)=>Object.assign(Ae,{[Fe]:ue[Fe]}),{})}(this.reducers,Fe)}),this.updateReducers(Ae)}updateReducers(Ae){this.next(this.reducerFactory(this.reducers,this.initialState)),this.dispatcher.next({type:Ro,features:Ae})}ngOnDestroy(){this.complete()}}return ue.\u0275fac=function(Ae){return new(Ae||ue)(h.LFG(Cs),h.LFG(kt),h.LFG(xi),h.LFG(qt))},ue.\u0275prov=h.Yz7({token:ue,factory:ue.\u0275fac}),ue})();const Eo=[oo,{provide:Jn,useExisting:oo},{provide:Cs,useExisting:Ht}];let rs=(()=>{class ue extends x.x{ngOnDestroy(){this.complete()}}return ue.\u0275fac=function(){let tt;return function(Fe){return(tt||(tt=h.n5z(ue)))(Fe||ue)}}(),ue.\u0275prov=h.Yz7({token:ue,factory:ue.\u0275fac}),ue})();const pi=[rs];class Or extends Ve.y{}let mr=(()=>{class ue extends Te.X{constructor(Ae,Fe,Ot,At){super(At);const mn=Ae.pipe((0,xe.Q)(Me.N)).pipe((0,ne.M)(Fe)).pipe((0,Le.R)(er,{state:At}));this.stateSubscription=mn.subscribe(({state:Bi,action:Mr})=>{this.next(Bi),Ot.next(Mr)})}ngOnDestroy(){this.stateSubscription.unsubscribe(),this.complete()}}return ue.INIT=Dt,ue.\u0275fac=function(Ae){return new(Ae||ue)(h.LFG(Ht),h.LFG(Jn),h.LFG(rs),h.LFG(kt))},ue.\u0275prov=h.Yz7({token:ue,factory:ue.\u0275fac}),ue})();function er(ue={state:void 0},[tt,Ae]){const{state:Fe}=ue;return{state:Ae(Fe,tt),action:tt}}const Hi=[mr,{provide:Or,useExisting:mr}];let Po=(()=>{class ue extends Ve.y{constructor(Ae,Fe,Ot){super(),this.actionsObserver=Fe,this.reducerManager=Ot,this.source=Ae}select(Ae,...Fe){return wr.call(null,Ae,...Fe)(this)}lift(Ae){const Fe=new ue(this,this.actionsObserver,this.reducerManager);return Fe.operator=Ae,Fe}dispatch(Ae){this.actionsObserver.next(Ae)}next(Ae){this.actionsObserver.next(Ae)}error(Ae){this.actionsObserver.error(Ae)}complete(){this.actionsObserver.complete()}addReducer(Ae,Fe){this.reducerManager.addReducer(Ae,Fe)}removeReducer(Ae){this.reducerManager.removeReducer(Ae)}}return ue.\u0275fac=function(Ae){return new(Ae||ue)(h.LFG(Or),h.LFG(Ht),h.LFG(oo))},ue.\u0275prov=h.Yz7({token:ue,factory:ue.\u0275fac}),ue})();const xr=[Po];function wr(ue,tt,...Ae){return function(Ot){let At;if("string"==typeof ue){const ui=[tt,...Ae].filter(Boolean);At=Ot.pipe(function ye(...ue){const tt=ue.length;if(0===tt)throw new Error("list of properties cannot be empty.");return(0,Pe.U)(Ae=>{let Fe=Ae;for(let Ot=0;Ot<tt;Ot++){const At=null==Fe?void 0:Fe[ue[Ot]];if(void 0===At)return;Fe=At}return Fe})}(ue,...ui))}else{if("function"!=typeof ue)throw new TypeError(`Unexpected type '${typeof ue}' in select operator, expected 'string' or 'function'`);At=Ot.pipe((0,Pe.U)(ui=>ue(ui,tt)))}return At.pipe((0,ke.x)())}}const Pt="https://ngrx.io/guide/store/configuration/runtime-checks";function Yi(ue){return void 0===ue}function ai(ue){return null===ue}function Kt(ue){return Array.isArray(ue)}function Zn(ue){return"object"==typeof ue&&null!==ue}function wt(ue){return"function"==typeof ue}function Fn(ue,tt){return ue===tt}function Cr(ue,tt,Ae){for(let Fe=0;Fe<ue.length;Fe++)if(!Ae(ue[Fe],tt[Fe]))return!0;return!1}function os(ue,tt=Fn,Ae=Fn){let At,Fe=null,Ot=null;return{memoized:function mn(){if(void 0!==At)return At.result;if(!Fe)return Ot=ue.apply(null,arguments),Fe=arguments,Ot;if(!Cr(arguments,Fe,tt))return Ot;const Bi=ue.apply(null,arguments);return Fe=arguments,Ae(Ot,Bi)?Ot:(Ot=Bi,Bi)},reset:function ui(){Fe=null,Ot=null},setResult:function Kn(Bi){At={result:Bi}},clearResult:function pn(){At=void 0}}}function Rn(...ue){return function Dn(ue,tt={stateFn:Fo}){return function(...Ae){let Fe=Ae;if(Array.isArray(Fe[0])){const[Bi,...Mr]=Fe;Fe=[...Bi,...Mr]}const Ot=Fe.slice(0,Fe.length-1),At=Fe[Fe.length-1],ui=Ot.filter(Bi=>Bi.release&&"function"==typeof Bi.release),Kn=ue(function(...Bi){return At.apply(null,Bi)}),pn=os(function(Bi,Mr){return tt.stateFn.apply(null,[Bi,Ot,Mr,Kn])});return Object.assign(pn.memoized,{release:function mn(){pn.reset(),Kn.reset(),ui.forEach(Bi=>Bi.release())},projector:Kn.memoized,setResult:pn.setResult,clearResult:pn.clearResult})}}(os)(...ue)}function Fo(ue,tt,Ae,Fe){if(void 0===Ae){const At=tt.map(ui=>ui(ue));return Fe.memoized.apply(null,At)}const Ot=tt.map(At=>At(ue,Ae));return Fe.memoized.apply(null,[...Ot,Ae])}function so(ue){return Rn(tt=>{const Ae=tt[ue];return(0,h.X6Q)()&&!(ue in tt)&&console.warn(`@ngrx/store: The feature name "${ue}" does not exist in the state, therefore createFeatureSelector cannot access it.  Be sure it is imported in a loaded module using StoreModule.forRoot('${ue}', ...) or StoreModule.forFeature('${ue}', ...).  If the default state is intended to be undefined, as is the case with router state, this development-only warning message can be ignored.`),Ae},tt=>tt)}function z(ue){Object.freeze(ue);const tt=wt(ue);return Object.getOwnPropertyNames(ue).forEach(Ae=>{if(!Ae.startsWith("\u0275")&&function Li(ue,tt){return Object.prototype.hasOwnProperty.call(ue,tt)}(ue,Ae)&&(!tt||"caller"!==Ae&&"callee"!==Ae&&"arguments"!==Ae)){const Fe=ue[Ae];(Zn(Fe)||wt(Fe))&&!Object.isFrozen(Fe)&&z(Fe)}}),ue}function J(ue,tt=[]){return(Yi(ue)||ai(ue))&&0===tt.length?{path:["root"],value:ue}:Object.keys(ue).reduce((Fe,Ot)=>{if(Fe)return Fe;const At=ue[Ot];return function sr(ue){return wt(ue)&&ue.hasOwnProperty("\u0275cmp")}(At)?Fe:!(Yi(At)||ai(At)||function Vi(ue){return"number"==typeof ue}(At)||function gr(ue){return"boolean"==typeof ue}(At)||function Fr(ue){return"string"==typeof ue}(At)||Kt(At))&&(function vi(ue){if(!function ft(ue){return Zn(ue)&&!Kt(ue)}(ue))return!1;const tt=Object.getPrototypeOf(ue);return tt===Object.prototype||null===tt}(At)?J(At,[...tt,Ot]):{path:[...tt,Ot],value:At})},!1)}function ie(ue,tt){if(!1===ue)return;const Ae=ue.path.join("."),Fe=new Error(`Detected unserializable ${tt} at "${Ae}". ${Pt}#strict${tt}serializability`);throw Fe.value=ue.value,Fe.unserializablePath=Ae,Fe}function we(ue){return(0,h.X6Q)()?Object.assign({strictStateSerializability:!1,strictActionSerializability:!1,strictStateImmutability:!0,strictActionImmutability:!0,strictActionWithinNgZone:!1,strictActionTypeUniqueness:!1},ue):{strictStateSerializability:!1,strictActionSerializability:!1,strictStateImmutability:!1,strictActionImmutability:!1,strictActionWithinNgZone:!1,strictActionTypeUniqueness:!1}}function fe({strictActionSerializability:ue,strictStateSerializability:tt}){return Ae=>ue||tt?function U(ue,tt){return function(Ae,Fe){tt.action(Fe)&&ie(J(Fe),"action");const Ot=ue(Ae,Fe);return tt.state()&&ie(J(Ot),"state"),Ot}}(Ae,{action:Fe=>ue&&!be(Fe),state:()=>tt}):Ae}function me({strictActionImmutability:ue,strictStateImmutability:tt}){return Ae=>ue||tt?function re(ue,tt){return function(Ae,Fe){const Ot=tt.action(Fe)?z(Fe):Fe,At=ue(Ae,Ot);return tt.state()?z(At):At}}(Ae,{action:Fe=>ue&&!be(Fe),state:()=>tt}):Ae}function be(ue){return ue.type.startsWith("@ngrx")}function He({strictActionWithinNgZone:ue}){return tt=>ue?function le(ue,tt){return function(Ae,Fe){if(tt.action(Fe)&&!h.R0b.isInAngularZone())throw new Error(`Action '${Fe.type}' running outside NgZone. ${Pt}#strictactionwithinngzone`);return ue(Ae,Fe)}}(tt,{action:Ae=>ue&&!be(Ae)}):tt}function at(ue){return[{provide:hn,useValue:ue},{provide:Pr,useFactory:We,deps:[hn]},{provide:Gn,deps:[Pr],useFactory:we},{provide:si,multi:!0,deps:[Gn],useFactory:me},{provide:si,multi:!0,deps:[Gn],useFactory:fe},{provide:si,multi:!0,deps:[Gn],useFactory:He}]}function je(){return[{provide:Qi,multi:!0,deps:[Gn],useFactory:lt}]}function We(ue){return ue}function lt(ue){if(!ue.strictActionTypeUniqueness)return;const tt=Object.entries(Be).filter(([,Ae])=>Ae>1).map(([Ae])=>Ae);if(tt.length)throw new Error(`Action types are registered more than once, ${tt.map(Ae=>`"${Ae}"`).join(", ")}. ${Pt}#strictactiontypeuniqueness`)}let Ct=(()=>{class ue{constructor(Ae,Fe,Ot,At,ui,Kn){}}return ue.\u0275fac=function(Ae){return new(Ae||ue)(h.LFG(Ht),h.LFG(Jn),h.LFG(rs),h.LFG(Po),h.LFG(xt,8),h.LFG(Qi,8))},ue.\u0275mod=h.oAB({type:ue}),ue.\u0275inj=h.cJS({}),ue})(),Yt=(()=>{class ue{constructor(Ae,Fe,Ot,At,ui){this.features=Ae,this.featureReducers=Fe,this.reducerManager=Ot;const Kn=Ae.map((pn,mn)=>{const Mr=Fe.shift()[mn];return Object.assign(Object.assign({},pn),{reducers:Mr,initialState:bi(pn.initialState)})});Ot.addFeatures(Kn)}ngOnDestroy(){this.reducerManager.removeFeatures(this.features)}}return ue.\u0275fac=function(Ae){return new(Ae||ue)(h.LFG(Ze),h.LFG(tn),h.LFG(oo),h.LFG(Ct),h.LFG(Qi,8))},ue.\u0275mod=h.oAB({type:ue}),ue.\u0275inj=h.cJS({}),ue})(),Ri=(()=>{class ue{static forRoot(Ae,Fe={}){return{ngModule:Ct,providers:[{provide:xt,useFactory:ri,deps:[[Po,new h.FiY,new h.tp0]]},{provide:ut,useValue:Fe.initialState},{provide:kt,useFactory:bi,deps:[ut]},{provide:Ue,useValue:Ae},{provide:Oe,useExisting:Ae instanceof h.OlP?Ae:Ue},{provide:xi,deps:[h.zs3,Ue,[new h.tBr(Oe)]],useFactory:fi},{provide:br,useValue:Fe.metaReducers?Fe.metaReducers:[]},{provide:_i,deps:[si,br],useFactory:on},{provide:ni,useValue:Fe.reducerFactory?Fe.reducerFactory:Mo},{provide:qt,deps:[ni,_i],useFactory:is},$t,Eo,pi,Hi,xr,at(Fe.runtimeChecks),je()]}}static forFeature(Ae,Fe,Ot={}){return{ngModule:Yt,providers:[{provide:Et,multi:!0,useValue:Ae instanceof Object?{}:Ot},{provide:et,multi:!0,useValue:{key:Ae instanceof Object?Ae.name:Ae,reducerFactory:Ot instanceof h.OlP||!Ot.reducerFactory?Mo:Ot.reducerFactory,metaReducers:Ot instanceof h.OlP||!Ot.metaReducers?[]:Ot.metaReducers,initialState:Ot instanceof h.OlP||!Ot.initialState?void 0:Ot.initialState}},{provide:Ze,deps:[h.zs3,Et,et],useFactory:wi},{provide:Qe,multi:!0,useValue:Ae instanceof Object?Ae.reducer:Fe},{provide:Ci,multi:!0,useExisting:Fe instanceof h.OlP?Fe:Qe},{provide:tn,multi:!0,deps:[h.zs3,Qe,[new h.tBr(Ci)]],useFactory:Xt},je()]}}}return ue.\u0275fac=function(Ae){return new(Ae||ue)},ue.\u0275mod=h.oAB({type:ue}),ue.\u0275inj=h.cJS({}),ue})();function fi(ue,tt){return tt instanceof h.OlP?ue.get(tt):tt}function wi(ue,tt,Ae){return Ae.map((Fe,Ot)=>{if(tt[Ot]instanceof h.OlP){const At=ue.get(tt[Ot]);return{key:Fe.key,reducerFactory:At.reducerFactory?At.reducerFactory:Mo,metaReducers:At.metaReducers?At.metaReducers:[],initialState:At.initialState}}return Fe})}function Xt(ue,tt){return tt.map(Fe=>Fe instanceof h.OlP?ue.get(Fe):Fe)}function bi(ue){return"function"==typeof ue?ue():ue}function on(ue,tt){return ue.concat(tt)}function ri(ue){if(ue)throw new TypeError("StoreModule.forRoot() called twice. Feature modules should use StoreModule.forFeature() instead.");return"guarded"}function Lr(ue,...tt){const Ae=new Map;for(const Fe of tt)for(const Ot of Fe.types){const At=Ae.get(Ot);Ae.set(Ot,At?(Kn,pn)=>Fe.reducer(At(Kn,pn),pn):Fe.reducer)}return function(Fe=ue,Ot){const At=Ae.get(Ot.type);return At?At(Fe,Ot):Fe}}}},Ie=>{Ie(Ie.s=1456)}]);